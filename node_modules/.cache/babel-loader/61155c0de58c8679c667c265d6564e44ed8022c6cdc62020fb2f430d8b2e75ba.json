{"ast":null,"code":"import _objectSpread from\"C:/Users/somme/Downloads/pool-authority-app/pool-authority-app/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import{LineChart,Line,AreaChart,Area,BarChart,Bar,XAxis,YAxis,CartesianGrid,Tooltip,ResponsiveContainer,Legend,PieChart,Pie,Cell}from'recharts';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const GOOGLE_MAPS_KEY='AIzaSyDnhsQnmylUDFWgbiMF-Etktm-9ZY6Aaw8';const STRIPE_PUBLISHABLE_KEY='pk_test_51SpDftDHbtPuLg7A3guJcp7uNOUYPzADC1Uk0qqlXBvudJB6TwozWNqaCutnDcTXF0VzZWeqDVoWs4YY4ooBDwSl00W4DbIbcf';const PAYMENT_SERVER_URL='https://pool-authority-server.onrender.com';// Icons as simple SVG components\nconst Icons={Users:()=>/*#__PURE__*/_jsxs(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",width:\"20\",height:\"20\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"2\",strokeLinecap:\"round\",strokeLinejoin:\"round\",children:[/*#__PURE__*/_jsx(\"path\",{d:\"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2\"}),/*#__PURE__*/_jsx(\"circle\",{cx:\"9\",cy:\"7\",r:\"4\"}),/*#__PURE__*/_jsx(\"path\",{d:\"M22 21v-2a4 4 0 0 0-3-3.87\"}),/*#__PURE__*/_jsx(\"path\",{d:\"M16 3.13a4 4 0 0 1 0 7.75\"})]}),Clock:()=>/*#__PURE__*/_jsxs(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",width:\"16\",height:\"16\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"2\",strokeLinecap:\"round\",strokeLinejoin:\"round\",children:[/*#__PURE__*/_jsx(\"circle\",{cx:\"12\",cy:\"12\",r:\"10\"}),/*#__PURE__*/_jsx(\"polyline\",{points:\"12 6 12 12 16 14\"})]}),MapPin:()=>/*#__PURE__*/_jsxs(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",width:\"20\",height:\"20\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"2\",strokeLinecap:\"round\",strokeLinejoin:\"round\",children:[/*#__PURE__*/_jsx(\"path\",{d:\"M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z\"}),/*#__PURE__*/_jsx(\"circle\",{cx:\"12\",cy:\"10\",r:\"3\"})]}),Plus:()=>/*#__PURE__*/_jsxs(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",width:\"20\",height:\"20\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"2\",strokeLinecap:\"round\",strokeLinejoin:\"round\",children:[/*#__PURE__*/_jsx(\"line\",{x1:\"12\",y1:\"5\",x2:\"12\",y2:\"19\"}),/*#__PURE__*/_jsx(\"line\",{x1:\"5\",y1:\"12\",x2:\"19\",y2:\"12\"})]}),X:()=>/*#__PURE__*/_jsxs(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",width:\"20\",height:\"20\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"2\",strokeLinecap:\"round\",strokeLinejoin:\"round\",children:[/*#__PURE__*/_jsx(\"line\",{x1:\"18\",y1:\"6\",x2:\"6\",y2:\"18\"}),/*#__PURE__*/_jsx(\"line\",{x1:\"6\",y1:\"6\",x2:\"18\",y2:\"18\"})]}),Navigation:()=>/*#__PURE__*/_jsx(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",width:\"20\",height:\"20\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"2\",strokeLinecap:\"round\",strokeLinejoin:\"round\",children:/*#__PURE__*/_jsx(\"polygon\",{points:\"3 11 22 2 13 21 11 13 3 11\"})}),Download:()=>/*#__PURE__*/_jsxs(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",width:\"20\",height:\"20\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"2\",strokeLinecap:\"round\",strokeLinejoin:\"round\",children:[/*#__PURE__*/_jsx(\"path\",{d:\"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4\"}),/*#__PURE__*/_jsx(\"polyline\",{points:\"7 10 12 15 17 10\"}),/*#__PURE__*/_jsx(\"line\",{x1:\"12\",y1:\"15\",x2:\"12\",y2:\"3\"})]}),Calendar:()=>/*#__PURE__*/_jsxs(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",width:\"20\",height:\"20\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"2\",strokeLinecap:\"round\",strokeLinejoin:\"round\",children:[/*#__PURE__*/_jsx(\"rect\",{x:\"3\",y:\"4\",width:\"18\",height:\"18\",rx:\"2\",ry:\"2\"}),/*#__PURE__*/_jsx(\"line\",{x1:\"16\",y1:\"2\",x2:\"16\",y2:\"6\"}),/*#__PURE__*/_jsx(\"line\",{x1:\"8\",y1:\"2\",x2:\"8\",y2:\"6\"}),/*#__PURE__*/_jsx(\"line\",{x1:\"3\",y1:\"10\",x2:\"21\",y2:\"10\"})]}),History:()=>/*#__PURE__*/_jsxs(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",width:\"20\",height:\"20\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"2\",strokeLinecap:\"round\",strokeLinejoin:\"round\",children:[/*#__PURE__*/_jsx(\"path\",{d:\"M3 3v5h5\"}),/*#__PURE__*/_jsx(\"path\",{d:\"M3.05 13A9 9 0 1 0 6 5.3L3 8\"}),/*#__PURE__*/_jsx(\"path\",{d:\"M12 7v5l4 2\"})]}),DollarSign:()=>/*#__PURE__*/_jsxs(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",width:\"20\",height:\"20\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"2\",strokeLinecap:\"round\",strokeLinejoin:\"round\",children:[/*#__PURE__*/_jsx(\"line\",{x1:\"12\",y1:\"1\",x2:\"12\",y2:\"23\"}),/*#__PURE__*/_jsx(\"path\",{d:\"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6\"})]}),Edit:()=>/*#__PURE__*/_jsxs(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",width:\"16\",height:\"16\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"2\",strokeLinecap:\"round\",strokeLinejoin:\"round\",children:[/*#__PURE__*/_jsx(\"path\",{d:\"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7\"}),/*#__PURE__*/_jsx(\"path\",{d:\"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z\"})]}),Trash:()=>/*#__PURE__*/_jsxs(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",width:\"16\",height:\"16\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"2\",strokeLinecap:\"round\",strokeLinejoin:\"round\",children:[/*#__PURE__*/_jsx(\"polyline\",{points:\"3 6 5 6 21 6\"}),/*#__PURE__*/_jsx(\"path\",{d:\"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2\"})]}),Check:()=>/*#__PURE__*/_jsx(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",width:\"20\",height:\"20\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"2\",strokeLinecap:\"round\",strokeLinejoin:\"round\",children:/*#__PURE__*/_jsx(\"polyline\",{points:\"20 6 9 17 4 12\"})}),Map:()=>/*#__PURE__*/_jsxs(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",width:\"20\",height:\"20\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"2\",strokeLinecap:\"round\",strokeLinejoin:\"round\",children:[/*#__PURE__*/_jsx(\"polygon\",{points:\"1 6 1 22 8 18 16 22 23 18 23 2 16 6 8 2 1 6\"}),/*#__PURE__*/_jsx(\"line\",{x1:\"8\",y1:\"2\",x2:\"8\",y2:\"18\"}),/*#__PURE__*/_jsx(\"line\",{x1:\"16\",y1:\"6\",x2:\"16\",y2:\"22\"})]}),Beaker:()=>/*#__PURE__*/_jsxs(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",width:\"20\",height:\"20\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"2\",strokeLinecap:\"round\",strokeLinejoin:\"round\",children:[/*#__PURE__*/_jsx(\"path\",{d:\"M4.5 3h15\"}),/*#__PURE__*/_jsx(\"path\",{d:\"M6 3v16a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V3\"}),/*#__PURE__*/_jsx(\"path\",{d:\"M6 14h12\"})]}),Wrench:()=>/*#__PURE__*/_jsx(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",width:\"20\",height:\"20\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"2\",strokeLinecap:\"round\",strokeLinejoin:\"round\",children:/*#__PURE__*/_jsx(\"path\",{d:\"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z\"})}),Home:()=>/*#__PURE__*/_jsxs(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",width:\"20\",height:\"20\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"2\",strokeLinecap:\"round\",strokeLinejoin:\"round\",children:[/*#__PURE__*/_jsx(\"path\",{d:\"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z\"}),/*#__PURE__*/_jsx(\"polyline\",{points:\"9 22 9 12 15 12 15 22\"})]}),ChevronLeft:()=>/*#__PURE__*/_jsx(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",width:\"20\",height:\"20\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"2\",strokeLinecap:\"round\",strokeLinejoin:\"round\",children:/*#__PURE__*/_jsx(\"polyline\",{points:\"15 18 9 12 15 6\"})}),ChevronRight:()=>/*#__PURE__*/_jsx(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",width:\"20\",height:\"20\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"2\",strokeLinecap:\"round\",strokeLinejoin:\"round\",children:/*#__PURE__*/_jsx(\"polyline\",{points:\"9 18 15 12 9 6\"})}),FileText:()=>/*#__PURE__*/_jsxs(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",width:\"20\",height:\"20\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"2\",strokeLinecap:\"round\",strokeLinejoin:\"round\",children:[/*#__PURE__*/_jsx(\"path\",{d:\"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z\"}),/*#__PURE__*/_jsx(\"polyline\",{points:\"14 2 14 8 20 8\"}),/*#__PURE__*/_jsx(\"line\",{x1:\"16\",y1:\"13\",x2:\"8\",y2:\"13\"}),/*#__PURE__*/_jsx(\"line\",{x1:\"16\",y1:\"17\",x2:\"8\",y2:\"17\"}),/*#__PURE__*/_jsx(\"polyline\",{points:\"10 9 9 9 8 9\"})]}),CreditCard:()=>/*#__PURE__*/_jsxs(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",width:\"20\",height:\"20\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"2\",strokeLinecap:\"round\",strokeLinejoin:\"round\",children:[/*#__PURE__*/_jsx(\"rect\",{x:\"1\",y:\"4\",width:\"22\",height:\"16\",rx:\"2\",ry:\"2\"}),/*#__PURE__*/_jsx(\"line\",{x1:\"1\",y1:\"10\",x2:\"23\",y2:\"10\"})]}),Receipt:()=>/*#__PURE__*/_jsxs(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",width:\"20\",height:\"20\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"2\",strokeLinecap:\"round\",strokeLinejoin:\"round\",children:[/*#__PURE__*/_jsx(\"path\",{d:\"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1-2-1z\"}),/*#__PURE__*/_jsx(\"path\",{d:\"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8\"}),/*#__PURE__*/_jsx(\"path\",{d:\"M12 17V7\"})]}),Settings:()=>/*#__PURE__*/_jsxs(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",width:\"20\",height:\"20\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"2\",strokeLinecap:\"round\",strokeLinejoin:\"round\",children:[/*#__PURE__*/_jsx(\"circle\",{cx:\"12\",cy:\"12\",r:\"3\"}),/*#__PURE__*/_jsx(\"path\",{d:\"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z\"})]}),Menu:()=>/*#__PURE__*/_jsxs(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",width:\"20\",height:\"20\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"2\",strokeLinecap:\"round\",strokeLinejoin:\"round\",children:[/*#__PURE__*/_jsx(\"line\",{x1:\"3\",y1:\"12\",x2:\"21\",y2:\"12\"}),/*#__PURE__*/_jsx(\"line\",{x1:\"3\",y1:\"6\",x2:\"21\",y2:\"6\"}),/*#__PURE__*/_jsx(\"line\",{x1:\"3\",y1:\"18\",x2:\"21\",y2:\"18\"})]}),Phone:()=>/*#__PURE__*/_jsx(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",width:\"20\",height:\"20\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"2\",strokeLinecap:\"round\",strokeLinejoin:\"round\",children:/*#__PURE__*/_jsx(\"path\",{d:\"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z\"})})};// Helper to get local date string (YYYY-MM-DD) without timezone issues\nconst getLocalDateString=function(){let date=arguments.length>0&&arguments[0]!==undefined?arguments[0]:new Date();const year=date.getFullYear();const month=String(date.getMonth()+1).padStart(2,'0');const day=String(date.getDate()).padStart(2,'0');return\"\".concat(year,\"-\").concat(month,\"-\").concat(day);};const getLocalMonthString=function(){let date=arguments.length>0&&arguments[0]!==undefined?arguments[0]:new Date();const year=date.getFullYear();const month=String(date.getMonth()+1).padStart(2,'0');return\"\".concat(year,\"-\").concat(month);};// Get prior month for billing (services performed last month)\nconst getPriorMonthString=()=>{const date=new Date();date.setMonth(date.getMonth()-1);const year=date.getFullYear();const month=String(date.getMonth()+1).padStart(2,'0');return\"\".concat(year,\"-\").concat(month);};// Payment terms helper\nconst getPaymentTermsDays=terms=>{switch(terms){case'due_receipt':return 0;case'net7':return 7;case'net15':return 15;case'net30':return 30;case'net45':return 45;case'net60':return 60;default:return 15;}};const getPaymentTermsText=terms=>{switch(terms){case'due_receipt':return'Due Upon Receipt';case'net7':return'Net 7';case'net15':return'Net 15';case'net30':return'Net 30';case'net45':return'Net 45';case'net60':return'Net 60';default:return'Net 15';}};// Employee colors for visual identification\nconst employeeColors=[{bg:'#3b82f6',text:'#ffffff',name:'Blue'},{bg:'#10b981',text:'#ffffff',name:'Green'},{bg:'#f59e0b',text:'#000000',name:'Amber'},{bg:'#ef4444',text:'#ffffff',name:'Red'},{bg:'#8b5cf6',text:'#ffffff',name:'Purple'},{bg:'#ec4899',text:'#ffffff',name:'Pink'},{bg:'#06b6d4',text:'#ffffff',name:'Cyan'},{bg:'#84cc16',text:'#000000',name:'Lime'}];export default function PoolAuthority(){var _jobToComplete$jobTyp,_jobToComplete$price,_jobToComplete$price2;// State\nconst[customers,setCustomers]=useState([]);const[serviceHistory,setServiceHistory]=useState([]);const[recurringServices,setRecurringServices]=useState([]);const[chemicalInventory,setChemicalInventory]=useState([]);const[oneTimeJobs,setOneTimeJobs]=useState([]);const[invoices,setInvoices]=useState([]);const[activeTab,setActiveTab]=useState('home');const[showMobileMenu,setShowMobileMenu]=useState(false);// Mobile navigation menu\nconst[showAddCustomer,setShowAddCustomer]=useState(false);const[showAddChemical,setShowAddChemical]=useState(false);const[showAddJob,setShowAddJob]=useState(false);const[editingCustomer,setEditingCustomer]=useState(null);const[routeCustomers,setRouteCustomers]=useState([]);const[showMap,setShowMap]=useState(false);const[routeDate,setRouteDate]=useState(getLocalDateString());const[selectedDate,setSelectedDate]=useState(getLocalDateString());const[calendarDate,setCalendarDate]=useState(new Date());const[invoiceMonth,setInvoiceMonth]=useState(getPriorMonthString());const[defaultPaymentTerms,setDefaultPaymentTerms]=useState('net15');const[showCustomInvoice,setShowCustomInvoice]=useState(false);const[showCreateQuote,setShowCreateQuote]=useState(false);const[quotes,setQuotes]=useState([]);const[customInvoice,setCustomInvoice]=useState({customerId:'',items:[],notes:''});// Employee management\nconst[employees,setEmployees]=useState([]);const[showEmployeeManager,setShowEmployeeManager]=useState(false);const[newEmployee,setNewEmployee]=useState({name:'',phone:'',email:''});const[editingEmployee,setEditingEmployee]=useState(null);const[selectedRouteEmployee,setSelectedRouteEmployee]=useState('all');// Filter routes by employee\nconst[currentQuote,setCurrentQuote]=useState({customerId:'',items:[],notes:'',validDays:30});const[editingQuoteId,setEditingQuoteId]=useState(null);// Track if editing existing quote\nconst[newLineItem,setNewLineItem]=useState({type:'labor',description:'',modelNumber:'',quantity:1,price:0});const[savedQuoteItems,setSavedQuoteItems]=useState([]);// Saved items for reuse in quotes\nconst[showSavedItems,setShowSavedItems]=useState(false);const[showScheduleQuoteJob,setShowScheduleQuoteJob]=useState(false);// Modal for scheduling quote as job\nconst[quoteToSchedule,setQuoteToSchedule]=useState(null);// Quote being scheduled as job\nconst[quoteJobDate,setQuoteJobDate]=useState('');// Selected date for the job\nconst[showPaymentModal,setShowPaymentModal]=useState(false);const[paymentDetails,setPaymentDetails]=useState({customerId:'',amount:0,description:'',invoiceId:''});const[showCompleteServiceModal,setShowCompleteServiceModal]=useState(false);const[serviceToComplete,setServiceToComplete]=useState(null);const[serviceChemicals,setServiceChemicals]=useState([]);const[serviceWaterTest,setServiceWaterTest]=useState({chlorine:'',ph:'',alkalinity:'',cya:'',hardness:'',phosphates:'',notes:''});const[sendEmailOnComplete,setSendEmailOnComplete]=useState(true);const[editingService,setEditingService]=useState(null);const[showEditServiceModal,setShowEditServiceModal]=useState(false);const[selectedCustomerBilling,setSelectedCustomerBilling]=useState(null);const[billingAdjustments,setBillingAdjustments]=useState([]);const[editingChemical,setEditingChemical]=useState(null);const[chemicalChartScale,setChemicalChartScale]=useState('monthly');const[wearItems,setWearItems]=useState([]);const[showWearItemsSettings,setShowWearItemsSettings]=useState(false);const[newWearItem,setNewWearItem]=useState({name:'',price:0,description:''});const[showCompleteJobModal,setShowCompleteJobModal]=useState(false);const[jobToComplete,setJobToComplete]=useState(null);const[jobCompletionItems,setJobCompletionItems]=useState([]);const[jobChemicals,setJobChemicals]=useState([]);const[jobCompletionNotes,setJobCompletionNotes]=useState('');const[sendJobEmailOnComplete,setSendJobEmailOnComplete]=useState(true);// Search state for billing and history\nconst[billingSearch,setBillingSearch]=useState('');const[billingDateFilter,setBillingDateFilter]=useState('');const[jobsSearch,setJobsSearch]=useState('');const[jobsDateFilter,setJobsDateFilter]=useState('');const[historySearch,setHistorySearch]=useState('');const[historyDateFilter,setHistoryDateFilter]=useState('');// Email state\nconst[emailLog,setEmailLog]=useState([]);const[billedCustomers,setBilledCustomers]=useState({});// Track customers billed this month: { 'customerId-YYYY-MM': true }\nconst[emailNotification,setEmailNotification]=useState(null);const[isSendingEmail,setIsSendingEmail]=useState(false);// Payment tracking state\nconst[showPaymentMethodModal,setShowPaymentMethodModal]=useState(false);const[paymentToMark,setPaymentToMark]=useState(null);// { invoiceId, customerId, amount }\nconst[paymentMethod,setPaymentMethod]=useState({method:'electronic',checkNumber:'',source:''});const[paidInvoices,setPaidInvoices]=useState({});// { 'customerId-YYYY-MM': { paid: true, method: 'check', checkNumber: '123', paidDate: '...' } }\n// Invoice terms modal state\nconst[showInvoiceTermsModal,setShowInvoiceTermsModal]=useState(false);const[invoiceTermsAction,setInvoiceTermsAction]=useState(null);// { type: 'pdf' | 'email', customer, services, totals }\nconst[selectedInvoiceTerms,setSelectedInvoiceTerms]=useState('net15');// Company Settings & Email Templates\nconst[companySettings,setCompanySettings]=useState({companyName:'Pool Authority',ownerName:'',phone:'',email:'',address:'',website:'',logoUrl:'',primaryColor:'#1e3a5f',accentColor:'#5bb4d8'});const[emailTemplates,setEmailTemplates]=useState({weeklyUpdate:{subject:'Weekly Pool Service Update - {{company_name}}',body:\"Hi {{customer_name}},\\n\\nHere's your weekly pool service update from {{company_name}}.\\n\\n**Service Date:** {{service_date}}\\n**Services Performed:** Weekly maintenance, chemical balancing, skimming, vacuuming\\n\\n{{#if water_test}}\\n**Water Test Results:** {{water_test}}\\n{{/if}}\\n\\n{{#if chemicals_used}}\\n**Chemicals Applied:**\\n{{chemicals_used}}\\n{{/if}}\\n\\n{{#if service_notes}}\\n**Notes:** {{service_notes}}\\n{{/if}}\\n\\n**Pool Status:** Your pool is looking great! \\u2713\\n\\nIf you have any questions, feel free to reach out.\\n\\nBest regards,\\n{{owner_name}}\\n{{company_name}}\\n{{company_phone}}\"},monthlyInvoice:{subject:'Invoice for {{month}} - {{company_name}}',body:\"Hi {{customer_name}},\\n\\nPlease find your invoice for pool services in {{month}}.\\n\\n**Invoice Summary:**\\n{{service_summary}}\\n\\n{{#if itemized_services}}\\n**Service Details:**\\n{{itemized_services}}\\n{{/if}}\\n\\n**Subtotal:** ${{subtotal}}\\n**Chemicals:** ${{chemical_total}}\\n**Total Due:** ${{total}}\\n\\n**Payment Terms:** {{payment_terms}}\\n**Due Date:** {{due_date}}\\n\\n{{#if payment_link}}\\n**Pay Online:** {{payment_link}}\\n{{/if}}\\n\\nThank you for your business!\\n\\nBest regards,\\n{{owner_name}}\\n{{company_name}}\\n{{company_phone}}\\n{{company_email}}\"},quote:{subject:'Quote #{{quote_number}} from {{company_name}}',body:\"Hi {{customer_name}},\\n\\nThank you for your interest in our services! Here's your quote:\\n\\n**Quote #:** {{quote_number}}\\n**Date:** {{quote_date}}\\n**Valid For:** {{valid_days}} days\\n\\n**Services:**\\n{{line_items}}\\n\\n**Total:** ${{total}}\\n\\nTo accept this quote, simply reply to this email or give us a call.\\n\\nBest regards,\\n{{owner_name}}\\n{{company_name}}\\n{{company_phone}}\\n{{company_email}}\"},paymentReminder:{subject:'Friendly Reminder: Invoice for {{month}} - {{company_name}}',body:\"Hi {{customer_name}},\\n\\nWe hope this message finds you well! This is a friendly reminder that your invoice for pool services in {{month}} is now past due.\\n\\n**Invoice Details:**\\n{{service_summary}}\\n\\n**Amount Due:** ${{total}}\\n**Days Past Due:** {{days_past_due}}\\n\\nWe understand that things can slip through the cracks, so we wanted to reach out. If you've already sent payment, please disregard this reminder and thank you!\\n\\n{{#if payment_link}}\\n**Pay Online:** {{payment_link}}\\n{{/if}}\\n\\nIf you have any questions about this invoice or would like to discuss payment options, please don't hesitate to reach out.\\n\\nThank you for your continued business!\\n\\nBest regards,\\n{{owner_name}}\\n{{company_name}}\\n{{company_phone}}\\n{{company_email}}\"}});const[editingTemplate,setEditingTemplate]=useState(null);const[previewTemplate,setPreviewTemplate]=useState(null);const[newCustomer,setNewCustomer]=useState({name:'',address:'',poolType:'inground',phone:'',email:'',weeklyRate:100,gateCode:'',dogName:'',notes:''});const[newChemical,setNewChemical]=useState({name:'',quantity:0,unit:'lbs',costPerUnit:0});const[newJob,setNewJob]=useState({customerId:'',jobType:'opening',date:'',price:250,notes:''});// Load data from storage\nuseEffect(()=>{const loadData=()=>{try{const keys=['pool-customers','pool-history','pool-recurring','pool-chemicals','pool-jobs','pool-invoices','pool-quotes','pool-wear-items','pool-company-settings','pool-email-templates','pool-email-log','pool-paid-invoices','pool-billed-customers','pool-saved-quote-items','pool-employees'];const setters=[setCustomers,setServiceHistory,setRecurringServices,setChemicalInventory,setOneTimeJobs,setInvoices,setQuotes,setWearItems,setCompanySettings,setEmailTemplates,setEmailLog,setPaidInvoices,setBilledCustomers,setSavedQuoteItems,setEmployees];for(let i=0;i<keys.length;i++){const result=localStorage.getItem(keys[i]);if(result){// Merge with defaults for settings/templates to preserve new fields\nif(keys[i]==='pool-company-settings'){setters[i](prev=>_objectSpread(_objectSpread({},prev),JSON.parse(result)));}else if(keys[i]==='pool-email-templates'){setters[i](prev=>_objectSpread(_objectSpread({},prev),JSON.parse(result)));}else{setters[i](JSON.parse(result));}}}}catch(e){console.log('No existing data');}};loadData();},[]);// Save helpers\nconst saveData=(key,data,setter)=>{setter(data);try{localStorage.setItem(key,JSON.stringify(data));}catch(e){console.error('Save error:',e);}};const saveCustomers=data=>saveData('pool-customers',data,setCustomers);const saveHistory=data=>saveData('pool-history',data,setServiceHistory);const saveRecurring=data=>saveData('pool-recurring',data,setRecurringServices);const saveChemicals=data=>saveData('pool-chemicals',data,setChemicalInventory);const saveJobs=data=>saveData('pool-jobs',data,setOneTimeJobs);const saveInvoices=data=>saveData('pool-invoices',data,setInvoices);const saveQuotes=data=>saveData('pool-quotes',data,setQuotes);const saveWearItems=data=>saveData('pool-wear-items',data,setWearItems);const saveCompanySettings=data=>saveData('pool-company-settings',data,setCompanySettings);const saveEmailTemplates=data=>saveData('pool-email-templates',data,setEmailTemplates);const saveEmailLog=data=>saveData('pool-email-log',data,setEmailLog);const savePaidInvoices=data=>saveData('pool-paid-invoices',data,setPaidInvoices);const saveBilledCustomers=data=>saveData('pool-billed-customers',data,setBilledCustomers);const saveSavedQuoteItems=data=>saveData('pool-saved-quote-items',data,setSavedQuoteItems);const saveEmployees=data=>saveData('pool-employees',data,setEmployees);// Searchable Customer Select Component\nconst CustomerSelect=_ref=>{let{value,onChange,placeholder=\"Search or select customer...\",className=\"\"}=_ref;const[search,setSearch]=useState('');const[isOpen,setIsOpen]=useState(false);const selectedCustomer=customers.find(c=>c.id===parseInt(value));const filteredCustomers=customers.filter(c=>c.name.toLowerCase().includes(search.toLowerCase())||c.address.toLowerCase().includes(search.toLowerCase()));return/*#__PURE__*/_jsxs(\"div\",{className:\"relative \".concat(className),children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:isOpen?search:(selectedCustomer===null||selectedCustomer===void 0?void 0:selectedCustomer.name)||'',onChange:e=>{setSearch(e.target.value);setIsOpen(true);},onFocus:()=>setIsOpen(true),placeholder:placeholder,className:\"w-full px-4 py-2 border rounded-lg\"}),isOpen&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 z-40\",onClick:()=>setIsOpen(false)}),/*#__PURE__*/_jsx(\"div\",{className:\"absolute z-50 w-full mt-1 bg-white border rounded-lg shadow-lg max-h-60 overflow-y-auto\",children:filteredCustomers.length>0?filteredCustomers.map(c=>/*#__PURE__*/_jsxs(\"div\",{onClick:()=>{onChange(c.id.toString());setSearch('');setIsOpen(false);},className:\"px-4 py-2 cursor-pointer hover:bg-blue-50 \".concat(parseInt(value)===c.id?'bg-blue-100':''),children:[/*#__PURE__*/_jsx(\"div\",{className:\"font-medium\",children:c.name}),/*#__PURE__*/_jsx(\"div\",{className:\"text-xs text-gray-500\",children:c.address})]},c.id)):/*#__PURE__*/_jsx(\"div\",{className:\"px-4 py-2 text-gray-500\",children:\"No customers found\"})})]})]});};// Customer functions\nconst addCustomer=()=>{if(newCustomer.name&&newCustomer.address){const customer=_objectSpread(_objectSpread({},newCustomer),{},{id:Date.now(),createdDate:new Date().toISOString()});saveCustomers([...customers,customer]);setNewCustomer({name:'',address:'',poolType:'inground',phone:'',email:'',weeklyRate:100,gateCode:'',dogName:'',notes:''});setShowAddCustomer(false);}};const updateCustomer=()=>{if(editingCustomer){saveCustomers(customers.map(c=>c.id===editingCustomer.id?editingCustomer:c));setEditingCustomer(null);}};const deleteCustomer=id=>{if(confirm('Delete this customer?')){saveCustomers(customers.filter(c=>c.id!==id));setRouteCustomers(routeCustomers.filter(c=>c.id!==id));}};// Route functions\nconst toggleRouteCustomer=customer=>{const exists=routeCustomers.find(c=>c.id===customer.id);if(exists){setRouteCustomers(routeCustomers.filter(c=>c.id!==customer.id));}else{setRouteCustomers([...routeCustomers,customer]);}};const moveInRoute=(index,direction)=>{const newRoute=[...routeCustomers];const newIndex=index+direction;if(newIndex<0||newIndex>=newRoute.length)return;[newRoute[index],newRoute[newIndex]]=[newRoute[newIndex],newRoute[index]];setRouteCustomers(newRoute);};const getGoogleMapsRouteUrl=()=>{if(routeCustomers.length===0)return'';const addresses=routeCustomers.map(c=>encodeURIComponent(c.address));if(addresses.length===1)return\"https://www.google.com/maps/search/?api=1&query=\".concat(addresses[0]);const origin=addresses[0];const destination=addresses[addresses.length-1];const waypoints=addresses.slice(1,-1).join('|');return\"https://www.google.com/maps/dir/?api=1&origin=\".concat(origin,\"&destination=\").concat(destination).concat(waypoints?'&waypoints='+waypoints:'',\"&mode=driving\");};const getEmbedMapUrl=()=>{if(routeCustomers.length===0)return'';if(routeCustomers.length===1)return\"https://www.google.com/maps/embed/v1/place?key=\".concat(GOOGLE_MAPS_KEY,\"&q=\").concat(encodeURIComponent(routeCustomers[0].address));const origin=encodeURIComponent(routeCustomers[0].address);const destination=encodeURIComponent(routeCustomers[routeCustomers.length-1].address);const waypoints=routeCustomers.slice(1,-1).map(c=>encodeURIComponent(c.address)).join('|');return\"https://www.google.com/maps/embed/v1/directions?key=\".concat(GOOGLE_MAPS_KEY,\"&origin=\").concat(origin,\"&destination=\").concat(destination).concat(waypoints?'&waypoints='+waypoints:'',\"&mode=driving\");};// Service functions\n// Open service completion modal\nconst openCompleteServiceModal=customer=>{setServiceToComplete(customer);setServiceChemicals([]);setServiceWaterTest({chlorine:'',ph:'',alkalinity:'',cya:'',hardness:'',phosphates:'',notes:''});setShowCompleteServiceModal(true);};// Add chemical to current service\nconst addChemicalToService=(chemical,quantity)=>{if(quantity<=0)return;const existingIndex=serviceChemicals.findIndex(c=>c.id===chemical.id);if(existingIndex>=0){const updated=[...serviceChemicals];updated[existingIndex].quantity+=quantity;setServiceChemicals(updated);}else{setServiceChemicals([...serviceChemicals,_objectSpread(_objectSpread({},chemical),{},{quantityUsed:quantity})]);}};// Remove chemical from current service\nconst removeChemicalFromService=chemicalId=>{setServiceChemicals(serviceChemicals.filter(c=>c.id!==chemicalId));};// Complete the service with chemicals\nconst completeServiceWithChemicals=async()=>{if(!serviceToComplete)return;const chemicalCost=serviceChemicals.reduce((sum,c)=>sum+c.quantityUsed*c.costPerUnit,0);const chemicalsUsed=serviceChemicals.map(c=>({id:c.id,name:c.name,quantity:c.quantityUsed,unit:c.unit,costPerUnit:c.costPerUnit,totalCost:c.quantityUsed*c.costPerUnit}));// Only include water test if any values were entered\nconst hasWaterTest=serviceWaterTest.chlorine||serviceWaterTest.ph||serviceWaterTest.alkalinity||serviceWaterTest.cya||serviceWaterTest.hardness||serviceWaterTest.phosphates;const service={id:Date.now(),customerId:serviceToComplete.id,customerName:serviceToComplete.name,date:new Date().toISOString(),weeklyRate:serviceToComplete.isOneTimeJob?serviceToComplete.jobPrice:serviceToComplete.weeklyRate,chemicalCost,chemicalsUsed,totalAmount:(serviceToComplete.isOneTimeJob?serviceToComplete.jobPrice:serviceToComplete.weeklyRate)+chemicalCost,poolType:serviceToComplete.poolType||serviceToComplete.jobType||'service',waterTest:hasWaterTest?_objectSpread({},serviceWaterTest):null,serviceNotes:serviceWaterTest.notes||''};saveHistory([service,...serviceHistory]);// Update chemical inventory (reduce quantities)\nconst updatedChemicals=chemicalInventory.map(chem=>{const used=serviceChemicals.find(c=>c.id===chem.id);if(used){return _objectSpread(_objectSpread({},chem),{},{quantity:Math.max(0,chem.quantity-used.quantityUsed)});}return chem;});saveChemicals(updatedChemicals);// Auto-send weekly update email if enabled and customer has email\nif(sendEmailOnComplete&&serviceToComplete.email){await sendWeeklyUpdateEmail(serviceToComplete,{date:service.date,chemicalsUsed:chemicalsUsed,waterTest:hasWaterTest?serviceWaterTest:null,notes:serviceWaterTest.notes});}setShowCompleteServiceModal(false);setServiceToComplete(null);setServiceChemicals([]);setServiceWaterTest({chlorine:'',ph:'',alkalinity:'',cya:'',hardness:'',phosphates:'',notes:''});};// Quick complete without chemicals (legacy support)\nconst completeService=function(customer){let chemicalCost=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;openCompleteServiceModal(customer);};// Get recurring services for a month (excludes one-time jobs)\nconst getMonthServices=(custId,yearMonth)=>serviceHistory.filter(s=>s.customerId===custId&&s.date.startsWith(yearMonth)&&!s.isJobService);// Get job/service call completions for a month\nconst getMonthJobServices=(custId,yearMonth)=>serviceHistory.filter(s=>s.customerId===custId&&s.date.startsWith(yearMonth)&&s.isJobService);// Get all job services for a month (across all customers)\nconst getAllMonthJobServices=yearMonth=>serviceHistory.filter(s=>s.date.startsWith(yearMonth)&&s.isJobService);const getMonthTotal=(custId,yearMonth)=>getMonthServices(custId,yearMonth).reduce((sum,s)=>sum+s.totalAmount,0);// Calendar helpers\nconst getDaysInMonth=date=>{const year=date.getFullYear();const month=date.getMonth();const firstDay=new Date(year,month,1).getDay();const daysInMonth=new Date(year,month+1,0).getDate();return{year,month,firstDay,daysInMonth};};const getEventsForDate=dateStr=>{const jobs=oneTimeJobs.filter(j=>j.date===dateStr);const recurring=recurringServices.filter(r=>{const customer=customers.find(c=>c.id===r.customerId);if(!customer)return false;const serviceDate=new Date(dateStr);const startDate=new Date(r.startDate||customer.createdDate);if(serviceDate<startDate)return false;const dayOfWeek=serviceDate.getDay();const scheduledDay=r.dayOfWeek||1;// Default Monday\nif(r.frequency==='weekly')return dayOfWeek===scheduledDay;if(r.frequency==='biweekly'){const weeksDiff=Math.floor((serviceDate-startDate)/(7*24*60*60*1000));return dayOfWeek===scheduledDay&&weeksDiff%2===0;}if(r.frequency==='monthly'){return serviceDate.getDate()===startDate.getDate();}return false;});const completed=serviceHistory.filter(s=>s.date.startsWith(dateStr));return{jobs,recurring,completed};};// Get customers scheduled for a specific date (from recurring services)\nconst getScheduledCustomersForDate=function(dateStr){let employeeFilter=arguments.length>1&&arguments[1]!==undefined?arguments[1]:'all';let scheduledCustomers=[];// Get customers from recurring services\nrecurringServices.filter(r=>r.active).forEach(r=>{const customer=customers.find(c=>c.id===r.customerId);if(!customer)return;// Filter by employee if specified\nif(employeeFilter!=='all'&&r.employeeId!==employeeFilter)return;const serviceDate=new Date(dateStr+'T12:00:00');const startDate=new Date(r.startDate||customer.createdDate);if(serviceDate<startDate)return;const dayOfWeek=serviceDate.getDay();const scheduledDay=r.dayOfWeek||1;let isScheduled=false;if(r.frequency==='weekly'){isScheduled=dayOfWeek===scheduledDay;}else if(r.frequency==='biweekly'){const weeksDiff=Math.floor((serviceDate-startDate)/(7*24*60*60*1000));isScheduled=dayOfWeek===scheduledDay&&weeksDiff%2===0;}else if(r.frequency==='monthly'){isScheduled=serviceDate.getDate()===startDate.getDate();}if(isScheduled&&!scheduledCustomers.find(c=>c.id===customer.id&&c.recurringId===r.id)){scheduledCustomers.push(_objectSpread(_objectSpread({},customer),{},{recurringId:r.id,frequency:r.frequency,scheduledTime:r.scheduledTime||null,// Add time\nemployeeId:r.employeeId||null// Add employee\n}));}});// Also add customers from one-time jobs scheduled for this date\noneTimeJobs.filter(j=>j.date===dateStr).forEach(job=>{// Filter by employee if specified\nif(employeeFilter!=='all'&&job.employeeId!==employeeFilter)return;const customer=customers.find(c=>c.id===parseInt(job.customerId));if(customer&&!scheduledCustomers.find(c=>c.id===customer.id&&c.isOneTimeJob&&c.jobId===job.id)){scheduledCustomers.push(_objectSpread(_objectSpread({},customer),{},{isOneTimeJob:true,jobType:job.jobType,jobPrice:job.price,jobId:job.id,jobData:job,scheduledTime:job.scheduledTime||null,// Add time\nemployeeId:job.employeeId||null// Add employee\n}));}});// Sort: timed appointments first (by time), then untimed\nscheduledCustomers.sort((a,b)=>{// Both have times - sort by time\nif(a.scheduledTime&&b.scheduledTime){return a.scheduledTime.localeCompare(b.scheduledTime);}// Only a has time - a comes first\nif(a.scheduledTime&&!b.scheduledTime)return-1;// Only b has time - b comes first\nif(!a.scheduledTime&&b.scheduledTime)return 1;// Neither has time - keep original order (could add distance sorting here later)\nreturn 0;});return scheduledCustomers;};// Update route when date changes or employee filter changes\nuseEffect(()=>{const scheduled=getScheduledCustomersForDate(routeDate,selectedRouteEmployee);setRouteCustomers(scheduled);},[routeDate,recurringServices,oneTimeJobs,customers,selectedRouteEmployee,employees]);// Helper to change route date\nconst changeRouteDate=days=>{const current=new Date(routeDate+'T12:00:00');// Add time to avoid timezone issues\ncurrent.setDate(current.getDate()+days);setRouteDate(getLocalDateString(current));};const formatRouteDate=dateStr=>{// Parse the date string as local time, not UTC\nconst[year,month,day]=dateStr.split('-').map(Number);const date=new Date(year,month-1,day);const today=getLocalDateString();const tomorrow=new Date();tomorrow.setDate(tomorrow.getDate()+1);const tomorrowStr=getLocalDateString(tomorrow);const yesterday=new Date();yesterday.setDate(yesterday.getDate()-1);const yesterdayStr=getLocalDateString(yesterday);if(dateStr===today)return'Today';if(dateStr===tomorrowStr)return'Tomorrow';if(dateStr===yesterdayStr)return'Yesterday';return date.toLocaleDateString('en-US',{weekday:'long',month:'short',day:'numeric'});};const monthNames=['January','February','March','April','May','June','July','August','September','October','November','December'];// Revenue data for charts\nconst[selectedYear,setSelectedYear]=useState(new Date().getFullYear());const getAvailableYears=()=>{const years=new Set();years.add(new Date().getFullYear());// Always include current year\nserviceHistory.forEach(s=>{const year=new Date(s.date).getFullYear();years.add(year);});return Array.from(years).sort((a,b)=>b-a);// Descending order\n};const getMonthlyRevenueData=()=>{const months=[];for(let i=0;i<12;i++){const date=new Date(selectedYear,i,1);const yearMonth=date.toISOString().slice(0,7);const monthRevenue=serviceHistory.filter(s=>s.date.startsWith(yearMonth)).reduce((sum,s)=>sum+s.totalAmount,0);months.push({month:monthNames[i].slice(0,3),revenue:monthRevenue,fullMonth:monthNames[i],year:selectedYear});}return months;};const getYearlyRevenueData=()=>{const years=[];const currentYear=new Date().getFullYear();for(let i=4;i>=0;i--){const year=currentYear-i;const yearRevenue=serviceHistory.filter(s=>new Date(s.date).getFullYear()===year).reduce((sum,s)=>sum+s.totalAmount,0);years.push({year:year.toString(),revenue:yearRevenue});}return years;};const getYearTotal=year=>{return serviceHistory.filter(s=>new Date(s.date).getFullYear()===year).reduce((sum,s)=>sum+s.totalAmount,0);};const getAccountsReceivable=()=>{// Calculate what's owed by each customer (services - payments)\nreturn customers.map(customer=>{const totalServices=serviceHistory.filter(s=>s.customerId===customer.id).reduce((sum,s)=>sum+s.totalAmount,0);const totalPaid=invoices.filter(inv=>inv.customerId===customer.id&&inv.paid).reduce((sum,inv)=>sum+inv.amount,0);const balance=totalServices-totalPaid;return{id:customer.id,name:customer.name,totalServices,totalPaid,balance:Math.max(0,balance)};}).filter(c=>c.balance>0);};const getWeeklyRevenueData=()=>{const weeks=[];const now=new Date();for(let i=7;i>=0;i--){const weekStart=new Date(now);weekStart.setDate(now.getDate()-i*7);const weekEnd=new Date(weekStart);weekEnd.setDate(weekStart.getDate()+6);const weekRevenue=serviceHistory.filter(s=>{const serviceDate=new Date(s.date);return serviceDate>=weekStart&&serviceDate<=weekEnd;}).reduce((sum,s)=>sum+s.totalAmount,0);weeks.push({week:\"\".concat(weekStart.getMonth()+1,\"/\").concat(weekStart.getDate()),revenue:weekRevenue});}return weeks;};// Chemical usage tracking functions\nconst getChemicalUsageData=timeScale=>{// Get all unique chemicals used\nconst chemicalNames=new Set();serviceHistory.forEach(s=>{if(s.chemicalsUsed){s.chemicalsUsed.forEach(c=>chemicalNames.add(c.name));}});const chemicals=Array.from(chemicalNames);if(timeScale==='weekly'){// Last 8 weeks\nconst weeks=[];const now=new Date();for(let i=7;i>=0;i--){const weekStart=new Date(now);weekStart.setDate(now.getDate()-i*7);const weekEnd=new Date(weekStart);weekEnd.setDate(weekStart.getDate()+6);const weekData={period:\"\".concat(weekStart.getMonth()+1,\"/\").concat(weekStart.getDate()),fullPeriod:\"Week of \".concat(weekStart.toLocaleDateString())};// Calculate usage for each chemical\nchemicals.forEach(chemName=>{let totalUsage=0;serviceHistory.forEach(s=>{const serviceDate=new Date(s.date);if(serviceDate>=weekStart&&serviceDate<=weekEnd&&s.chemicalsUsed){const chem=s.chemicalsUsed.find(c=>c.name===chemName);if(chem)totalUsage+=chem.quantity;}});weekData[chemName]=totalUsage;});weeks.push(weekData);}return{data:weeks,chemicals};}else if(timeScale==='monthly'){// Last 12 months\nconst months=[];const now=new Date();for(let i=11;i>=0;i--){const monthDate=new Date(now.getFullYear(),now.getMonth()-i,1);const yearMonth=monthDate.toISOString().slice(0,7);const monthData={period:monthNames[monthDate.getMonth()].slice(0,3),fullPeriod:\"\".concat(monthNames[monthDate.getMonth()],\" \").concat(monthDate.getFullYear())};chemicals.forEach(chemName=>{let totalUsage=0;serviceHistory.forEach(s=>{if(s.date.startsWith(yearMonth)&&s.chemicalsUsed){const chem=s.chemicalsUsed.find(c=>c.name===chemName);if(chem)totalUsage+=chem.quantity;}});monthData[chemName]=totalUsage;});months.push(monthData);}return{data:months,chemicals};}else{// Annual - last 5 years\nconst years=[];const currentYear=new Date().getFullYear();for(let i=4;i>=0;i--){const year=currentYear-i;const yearData={period:year.toString(),fullPeriod:year.toString()};chemicals.forEach(chemName=>{let totalUsage=0;serviceHistory.forEach(s=>{if(new Date(s.date).getFullYear()===year&&s.chemicalsUsed){const chem=s.chemicalsUsed.find(c=>c.name===chemName);if(chem)totalUsage+=chem.quantity;}});yearData[chemName]=totalUsage;});years.push(yearData);}return{data:years,chemicals};}};// Get chemical usage summary for current period\nconst getChemicalUsageSummary=()=>{const now=new Date();const currentMonth=now.toISOString().slice(0,7);const lastMonth=new Date(now.getFullYear(),now.getMonth()-1,1).toISOString().slice(0,7);const summary={};serviceHistory.forEach(s=>{if(s.chemicalsUsed){s.chemicalsUsed.forEach(chem=>{if(!summary[chem.name]){summary[chem.name]={name:chem.name,unit:chem.unit,thisMonth:0,lastMonth:0,total:0};}summary[chem.name].total+=chem.quantity;if(s.date.startsWith(currentMonth)){summary[chem.name].thisMonth+=chem.quantity;}else if(s.date.startsWith(lastMonth)){summary[chem.name].lastMonth+=chem.quantity;}});}});return Object.values(summary);};// Colors for different chemicals in chart\nconst chemicalColors=['#0d9488','#0ea5e9','#8b5cf6','#f59e0b','#ef4444','#22c55e','#ec4899','#6366f1'];// Mark invoice as paid\nconst markInvoicePaid=(customerId,amount)=>{const newInvoice={id:Date.now(),customerId,amount,paid:true,paidDate:new Date().toISOString()};saveInvoices([...invoices,newInvoice]);};// Recurring service functions\nconst addRecurringService=function(customerId,frequency,dayOfWeek,startDate){let scheduledTime=arguments.length>4&&arguments[4]!==undefined?arguments[4]:null;let employeeId=arguments.length>5&&arguments[5]!==undefined?arguments[5]:null;const customer=customers.find(c=>c.id===customerId);if(!customer)return;const recurring={id:Date.now(),customerId,customerName:customer.name,frequency,dayOfWeek:parseInt(dayOfWeek),startDate,scheduledTime,// Optional time for appointment\nemployeeId:employeeId?parseInt(employeeId):null,// Optional employee assignment\nactive:true};saveRecurring([...recurringServices,recurring]);};const deleteRecurringService=id=>{saveRecurring(recurringServices.filter(r=>r.id!==id));};// Update recurring service (for editing time/employee)\nconst updateRecurringService=(id,updates)=>{saveRecurring(recurringServices.map(r=>r.id===id?_objectSpread(_objectSpread({},r),updates):r));};// Update job (for editing time/employee)\nconst updateJob=(id,updates)=>{saveJobs(oneTimeJobs.map(j=>j.id===id?_objectSpread(_objectSpread({},j),updates):j));};// Custom invoice functions\nconst addLineItem=(targetState,setTargetState)=>{if(newLineItem.description&&newLineItem.price>0){setTargetState(_objectSpread(_objectSpread({},targetState),{},{items:[...targetState.items,_objectSpread(_objectSpread({},newLineItem),{},{id:Date.now()})]}));setNewLineItem({type:'labor',description:'',modelNumber:'',quantity:1,price:0});}};const removeLineItem=(targetState,setTargetState,itemId)=>{setTargetState(_objectSpread(_objectSpread({},targetState),{},{items:targetState.items.filter(i=>i.id!==itemId)}));};const generateCustomInvoice=()=>{const customer=customers.find(c=>c.id===parseInt(customInvoice.customerId));if(!customer||customInvoice.items.length===0)return;const total=customInvoice.items.reduce((sum,item)=>sum+item.quantity*item.price,0);const invoiceNumber=\"INV-\".concat(Date.now().toString().slice(-8));const html=\"<!DOCTYPE html>\\n<html><head><style>\\n  body { font-family: 'Segoe UI', Arial, sans-serif; max-width: 800px; margin: 40px auto; padding: 20px; color: #1e3a5f; }\\n  .header { background: linear-gradient(135deg, #1e3a5f 0%, #2d5a87 100%); color: white; padding: 30px; border-radius: 12px; margin-bottom: 30px; }\\n  .header h1 { margin: 0 0 5px 0; font-size: 28px; }\\n  .info-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 30px; margin-bottom: 30px; }\\n  .info-box h3 { margin: 0 0 10px 0; color: #1e3a5f; font-size: 14px; text-transform: uppercase; }\\n  table { width: 100%; border-collapse: collapse; margin: 20px 0; }\\n  th { background: #1e3a5f; color: white; padding: 12px; text-align: left; }\\n  td { padding: 12px; border-bottom: 1px solid #e2e8f0; }\\n  .item-type { font-size: 11px; background: #e2e8f0; padding: 2px 8px; border-radius: 4px; margin-right: 8px; }\\n  .model-num { font-size: 12px; color: #666; margin-top: 4px; }\\n  .total-row { background: #f1f5f9; font-weight: bold; font-size: 18px; }\\n  .notes { background: #fef3c7; padding: 15px; border-radius: 8px; margin: 20px 0; }\\n  .total-box { background: linear-gradient(135deg, #1e3a5f 0%, #2d5a87 100%); color: white; padding: 20px 30px; border-radius: 12px; text-align: right; }\\n</style></head>\\n<body>\\n  <div class=\\\"header\\\"><h1>\\uD83C\\uDFCA POOL AUTHORITY</h1><p>Service Invoice</p></div>\\n  <div class=\\\"info-grid\\\">\\n    <div class=\\\"info-box\\\"><h3>Invoice Details</h3><p><strong>Invoice #:</strong> \".concat(invoiceNumber,\"</p><p><strong>Date:</strong> \").concat(new Date().toLocaleDateString(),\"</p></div>\\n    <div class=\\\"info-box\\\"><h3>Bill To</h3><p><strong>\").concat(customer.name,\"</strong></p><p>\").concat(customer.address,\"</p><p>\").concat(customer.phone||'',\"</p><p>\").concat(customer.email||'',\"</p></div>\\n  </div>\\n  <table>\\n    <tr><th>Description</th><th>Qty</th><th>Price</th><th>Total</th></tr>\\n    \").concat(customInvoice.items.map(item=>\"\\n      <tr>\\n        <td>\\n          <span class=\\\"item-type\\\">\".concat(item.type.toUpperCase(),\"</span>\").concat(item.description,\"\\n          \").concat(item.modelNumber?\"<div class=\\\"model-num\\\">Model/Part #: \".concat(item.modelNumber,\"</div>\"):'',\"\\n        </td>\\n        <td>\").concat(item.quantity,\"</td>\\n        <td>$\").concat(item.price.toFixed(2),\"</td>\\n        <td>$\").concat((item.quantity*item.price).toFixed(2),\"</td>\\n      </tr>\\n    \")).join(''),\"\\n    <tr class=\\\"total-row\\\"><td colspan=\\\"3\\\">Total Due</td><td>$\").concat(total.toFixed(2),\"</td></tr>\\n  </table>\\n  \").concat(customInvoice.notes?\"<div class=\\\"notes\\\"><strong>Notes:</strong> \".concat(customInvoice.notes,\"</div>\"):'',\"\\n  <div class=\\\"total-box\\\"><span>Amount Due</span><div style=\\\"font-size:32px;font-weight:bold;margin-top:5px;\\\">$\").concat(total.toFixed(2),\"</div></div>\\n</body></html>\");const blob=new Blob([html],{type:'text/html'});const a=document.createElement('a');a.href=URL.createObjectURL(blob);a.download=\"PoolAuthority-Invoice-\".concat(customer.name.replace(/\\s+/g,'-'),\"-\").concat(invoiceNumber,\".html\");a.click();// Save to history\nconst service={id:Date.now(),customerId:customer.id,customerName:customer.name,date:new Date().toISOString(),invoiceNumber,invoiceItems:customInvoice.items,totalAmount:total,notes:customInvoice.notes,type:'custom-invoice'};saveHistory([service,...serviceHistory]);// Email\nif(customer.email){const subject=\"Invoice \".concat(invoiceNumber,\" from Pool Authority\");const body=\"Hi \".concat(customer.name,\",\\n\\nPlease find attached your invoice \").concat(invoiceNumber,\" for $\").concat(total.toFixed(2),\".\\n\\nItems:\\n\").concat(customInvoice.items.map(i=>\"- \".concat(i.description,\": $\").concat((i.quantity*i.price).toFixed(2))).join('\\n'),\"\\n\\nTotal: $\").concat(total.toFixed(2),\"\\n\\nThank you for your business!\\n\\nPool Authority\");window.open(\"mailto:\".concat(customer.email,\"?subject=\").concat(encodeURIComponent(subject),\"&body=\").concat(encodeURIComponent(body)));}setCustomInvoice({customerId:'',items:[],notes:''});setShowCustomInvoice(false);};// Quote functions\nconst generateQuote=()=>{const customer=customers.find(c=>c.id===parseInt(currentQuote.customerId));if(!customer||currentQuote.items.length===0)return;const total=currentQuote.items.reduce((sum,item)=>sum+item.quantity*item.price,0);const validUntil=new Date();validUntil.setDate(validUntil.getDate()+currentQuote.validDays);if(editingQuoteId){// Update existing quote\nconst updatedQuotes=quotes.map(q=>{if(q.id===editingQuoteId){return _objectSpread(_objectSpread({},q),{},{customerId:customer.id,customerName:customer.name,customerEmail:customer.email,items:currentQuote.items,notes:currentQuote.notes,total,validUntil:validUntil.toISOString(),validDays:currentQuote.validDays,updatedDate:new Date().toISOString()});}return q;});saveQuotes(updatedQuotes);setEditingQuoteId(null);setCurrentQuote({customerId:'',items:[],notes:'',validDays:30});setShowCreateQuote(false);showEmailNotification('success','Quote updated successfully');return;}// Create new quote\nconst quoteNumber=\"QT-\".concat(Date.now().toString().slice(-8));const quote={id:Date.now(),quoteNumber,customerId:customer.id,customerName:customer.name,customerEmail:customer.email,items:currentQuote.items,notes:currentQuote.notes,total,validDays:currentQuote.validDays,validUntil:validUntil.toISOString(),status:'pending',date:new Date().toISOString(),createdDate:new Date().toISOString()};saveQuotes([quote,...quotes]);const html=\"<!DOCTYPE html>\\n<html><head><style>\\n  body { font-family: 'Segoe UI', Arial, sans-serif; max-width: 800px; margin: 40px auto; padding: 20px; color: #1e3a5f; }\\n  .header { background: linear-gradient(135deg, #7c3aed 0%, #a855f7 100%); color: white; padding: 30px; border-radius: 12px; margin-bottom: 30px; }\\n  .header h1 { margin: 0 0 5px 0; font-size: 28px; }\\n  .validity { background: #fef3c7; padding: 15px; border-radius: 8px; margin-bottom: 20px; text-align: center; }\\n  .info-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 30px; margin-bottom: 30px; }\\n  .info-box h3 { margin: 0 0 10px 0; color: #1e3a5f; font-size: 14px; text-transform: uppercase; }\\n  table { width: 100%; border-collapse: collapse; margin: 20px 0; }\\n  th { background: #7c3aed; color: white; padding: 12px; text-align: left; }\\n  td { padding: 12px; border-bottom: 1px solid #e2e8f0; }\\n  .item-type { font-size: 11px; background: #e2e8f0; padding: 2px 8px; border-radius: 4px; margin-right: 8px; }\\n  .model-num { font-size: 12px; color: #666; margin-top: 4px; }\\n  .total-row { background: #f1f5f9; font-weight: bold; font-size: 18px; }\\n  .notes { background: #f3e8ff; padding: 15px; border-radius: 8px; margin: 20px 0; }\\n  .total-box { background: linear-gradient(135deg, #7c3aed 0%, #a855f7 100%); color: white; padding: 20px 30px; border-radius: 12px; text-align: right; }\\n  .approve-box { background: #d1fae5; padding: 20px; border-radius: 8px; text-align: center; margin-top: 20px; }\\n  .approve-btn { display: inline-block; background: #059669; color: white; padding: 15px 40px; border-radius: 8px; text-decoration: none; font-weight: bold; font-size: 18px; }\\n</style></head>\\n<body>\\n  <div class=\\\"header\\\"><h1>\\uD83C\\uDFCA POOL AUTHORITY</h1><p>Service Quote</p></div>\\n  <div class=\\\"validity\\\">\\u23F0 This quote is valid until <strong>\".concat(validUntil.toLocaleDateString(),\"</strong></div>\\n  <div class=\\\"info-grid\\\">\\n    <div class=\\\"info-box\\\"><h3>Quote Details</h3><p><strong>Quote #:</strong> \").concat(quoteNumber,\"</p><p><strong>Date:</strong> \").concat(new Date().toLocaleDateString(),\"</p></div>\\n    <div class=\\\"info-box\\\"><h3>Prepared For</h3><p><strong>\").concat(customer.name,\"</strong></p><p>\").concat(customer.address,\"</p><p>\").concat(customer.phone||'',\"</p></div>\\n  </div>\\n  <table>\\n    <tr><th>Description</th><th>Qty</th><th>Price</th><th>Total</th></tr>\\n    \").concat(currentQuote.items.map(item=>\"\\n      <tr>\\n        <td>\\n          <span class=\\\"item-type\\\">\".concat(item.type.toUpperCase(),\"</span>\").concat(item.description,\"\\n          \").concat(item.modelNumber?\"<div class=\\\"model-num\\\">Model/Part #: \".concat(item.modelNumber,\"</div>\"):'',\"\\n        </td>\\n        <td>\").concat(item.quantity,\"</td>\\n        <td>$\").concat(item.price.toFixed(2),\"</td>\\n        <td>$\").concat((item.quantity*item.price).toFixed(2),\"</td>\\n      </tr>\\n    \")).join(''),\"\\n    <tr class=\\\"total-row\\\"><td colspan=\\\"3\\\">Quoted Total</td><td>$\").concat(total.toFixed(2),\"</td></tr>\\n  </table>\\n  \").concat(currentQuote.notes?\"<div class=\\\"notes\\\"><strong>Notes:</strong> \".concat(currentQuote.notes,\"</div>\"):'',\"\\n  <div class=\\\"total-box\\\"><span>Quoted Price</span><div style=\\\"font-size:32px;font-weight:bold;margin-top:5px;\\\">$\").concat(total.toFixed(2),\"</div></div>\\n  <div class=\\\"approve-box\\\">\\n    <p><strong>Ready to proceed?</strong></p>\\n    <p>Reply to this email or call us to approve this quote!</p>\\n  </div>\\n</body></html>\");// Store the HTML in the quote for later PDF download (don't auto-download)\nquote.pdfHtml=html;saveQuotes([quote,...quotes]);setCurrentQuote({customerId:'',items:[],notes:'',validDays:30});setShowCreateQuote(false);showEmailNotification('success',\"Quote \".concat(quoteNumber,\" created! Use PDF or Email buttons to send to customer.\"));};// Stripe Payment Functions\nconst[isProcessingPayment,setIsProcessingPayment]=useState(false);const[paymentError,setPaymentError]=useState('');const createStripeCheckout=async(customer,amount,description,invoiceNumber)=>{setIsProcessingPayment(true);setPaymentError('');try{const response=await fetch(\"\".concat(PAYMENT_SERVER_URL,\"/api/create-checkout-session\"),{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({customerName:customer.name,customerEmail:customer.email,amount:amount,description:description,invoiceNumber:invoiceNumber,customerId:customer.id.toString(),successUrl:window.location.origin+'/payment-success',cancelUrl:window.location.origin+'/payment-cancelled'})});const data=await response.json();if(data.success&&data.paymentUrl){return data;}else{throw new Error(data.error||'Failed to create payment session');}}catch(error){console.error('Stripe checkout error:',error);setPaymentError(error.message);return null;}finally{setIsProcessingPayment(false);}};const openPaymentRequest=function(customerId,amount){let description=arguments.length>2&&arguments[2]!==undefined?arguments[2]:'';let invoiceId=arguments.length>3&&arguments[3]!==undefined?arguments[3]:'';setPaymentDetails({customerId,amount,description,invoiceId});setPaymentError('');setShowPaymentModal(true);};const sendPaymentRequest=async()=>{const customer=customers.find(c=>c.id===parseInt(paymentDetails.customerId));if(!customer){setPaymentError('Please select a customer');return;}if(paymentDetails.amount<=0){setPaymentError('Please enter a valid amount');return;}const invoiceNumber=paymentDetails.invoiceId||\"PAY-\".concat(Date.now().toString().slice(-8));// Try to create real Stripe Checkout\nconst stripeResult=await createStripeCheckout(customer,paymentDetails.amount,paymentDetails.description||\"Pool Authority - Invoice \".concat(invoiceNumber),invoiceNumber);if(stripeResult&&stripeResult.paymentUrl){// Save payment request to track it\nconst newInvoice={id:Date.now(),customerId:customer.id,customerName:customer.name,customerEmail:customer.email,amount:paymentDetails.amount,description:paymentDetails.description,invoiceNumber,stripeSessionId:stripeResult.sessionId,paymentUrl:stripeResult.paymentUrl,status:'pending',paid:false,createdDate:new Date().toISOString(),type:'payment-request'};saveInvoices([newInvoice,...invoices]);setShowPaymentModal(false);setPaymentDetails({customerId:'',amount:0,description:'',invoiceId:''});// Ask if they want to open the payment link or copy it\nconst openNow=window.confirm(\"\\u2705 Payment link created!\\n\\n\"+\"Customer: \".concat(customer.name,\"\\n\")+\"Amount: $\".concat(paymentDetails.amount.toFixed(2),\"\\n\")+\"Invoice #: \".concat(invoiceNumber,\"\\n\\n\")+\"Click OK to open the payment page now, or Cancel to copy the link.\");if(openNow){window.open(stripeResult.paymentUrl,'_blank');}else{// Copy to clipboard\nnavigator.clipboard.writeText(stripeResult.paymentUrl).then(()=>{alert('Payment link copied to clipboard!\\n\\nSend this link to your customer.');}).catch(()=>{// Fallback - show the URL\nprompt('Copy this payment link:',stripeResult.paymentUrl);});}}else{// Fallback to offline mode if server not available\nconst fallbackConfirm=window.confirm(\"\\u26A0\\uFE0F Could not connect to payment server.\\n\\n\"+\"Error: \".concat(paymentError||'Server unavailable',\"\\n\\n\")+\"Would you like to create an offline payment request instead?\");if(fallbackConfirm){createOfflinePaymentRequest(customer,paymentDetails.amount,paymentDetails.description,invoiceNumber);}}};const createOfflinePaymentRequest=(customer,amount,description,invoiceNumber)=>{// Fallback HTML payment request for when server is not available\nconst html=\"<!DOCTYPE html>\\n<html><head><style>\\n  body { font-family: 'Segoe UI', Arial, sans-serif; max-width: 600px; margin: 40px auto; padding: 20px; color: #1e3a5f; }\\n  .header { background: linear-gradient(135deg, #1e3a5f 0%, #2d5a87 100%); color: white; padding: 30px; border-radius: 12px; margin-bottom: 30px; text-align: center; }\\n  .amount-box { background: #f8fafc; border: 2px solid #e2e8f0; border-radius: 12px; padding: 30px; text-align: center; margin: 20px 0; }\\n  .amount { font-size: 48px; font-weight: bold; color: #1e3a5f; }\\n  .details { background: #f1f5f9; padding: 20px; border-radius: 8px; margin: 20px 0; }\\n  .note { background: #fef3c7; padding: 15px; border-radius: 8px; margin-top: 20px; }\\n</style></head>\\n<body>\\n  <div class=\\\"header\\\">\\n    <h1>\\uD83C\\uDFCA POOL AUTHORITY</h1>\\n    <p>Payment Request</p>\\n  </div>\\n  <p>Hi \".concat(customer.name,\",</p>\\n  <p>\").concat(description||'Please find your payment request below.',\"</p>\\n  <div class=\\\"amount-box\\\">\\n    <div style=\\\"color:#666;font-size:14px;margin-bottom:10px;\\\">Amount Due</div>\\n    <div class=\\\"amount\\\">$\").concat(amount.toFixed(2),\"</div>\\n  </div>\\n  <div class=\\\"details\\\">\\n    <strong>Payment Details:</strong><br>\\n    Invoice #: \").concat(invoiceNumber,\"<br>\\n    Date: \").concat(new Date().toLocaleDateString(),\"<br>\\n    \").concat(description?\"Description: \".concat(description):'',\"\\n  </div>\\n  <div class=\\\"note\\\">\\n    <strong>How to Pay:</strong><br>\\n    Please contact Pool Authority to arrange payment via credit card, check, or bank transfer.\\n  </div>\\n</body></html>\");const blob=new Blob([html],{type:'text/html'});const a=document.createElement('a');a.href=URL.createObjectURL(blob);a.download=\"PoolAuthority-PaymentRequest-\".concat(customer.name.replace(/\\s+/g,'-'),\"-\").concat(invoiceNumber,\".html\");a.click();// Save payment request\nconst newInvoice={id:Date.now(),customerId:customer.id,customerName:customer.name,amount:amount,description:description,invoiceNumber,status:'pending',paid:false,createdDate:new Date().toISOString(),type:'payment-request',offline:true};saveInvoices([newInvoice,...invoices]);setShowPaymentModal(false);setPaymentDetails({customerId:'',amount:0,description:'',invoiceId:''});};const checkPaymentStatus=async sessionId=>{try{const response=await fetch(\"\".concat(PAYMENT_SERVER_URL,\"/api/payment-status/\").concat(sessionId));const data=await response.json();return data;}catch(error){console.error('Error checking payment status:',error);return null;}};const refreshPaymentStatuses=async()=>{const pendingPayments=invoices.filter(i=>i.stripeSessionId&&!i.paid);for(const payment of pendingPayments){const status=await checkPaymentStatus(payment.stripeSessionId);if(status&&status.status==='paid'){saveInvoices(invoices.map(inv=>inv.id===payment.id?_objectSpread(_objectSpread({},inv),{},{status:'paid',paid:true,paidDate:new Date().toISOString()}):inv));}}};const markPaymentReceived=invoiceId=>{saveInvoices(invoices.map(inv=>inv.id===invoiceId?_objectSpread(_objectSpread({},inv),{},{status:'paid',paid:true,paidDate:new Date().toISOString()}):inv));};// Email Functions\nconst showEmailNotification=(type,message)=>{setEmailNotification({type,message});setTimeout(()=>setEmailNotification(null),4000);};const sendInvoiceEmail=async function(customer,invoiceData){let paymentLink=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;if(!customer.email){showEmailNotification('error','Customer has no email address');return false;}setIsSendingEmail(true);try{// Build itemized service list\nlet itemizedServices='';if(invoiceData.services&&invoiceData.services.length>0){itemizedServices=invoiceData.services.map(s=>\"\\u2022 \".concat(new Date(s.date).toLocaleDateString(),\" - $\").concat(s.totalAmount.toFixed(2))).join('\\n');}// Calculate due date based on payment terms\nconst termsDays=invoiceData.paymentTerms==='due_receipt'?0:invoiceData.paymentTerms==='net15'?15:invoiceData.paymentTerms==='net30'?30:15;const dueDate=new Date();dueDate.setDate(dueDate.getDate()+termsDays);const dueDateStr=dueDate.toLocaleDateString();const termsText=invoiceData.paymentTerms==='due_receipt'?'Due Upon Receipt':invoiceData.paymentTerms==='net15'?'Net 15':invoiceData.paymentTerms==='net30'?'Net 30':'Net 15';const response=await fetch(\"\".concat(PAYMENT_SERVER_URL,\"/send-invoice\"),{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({to:customer.email,template:emailTemplates.monthlyInvoice,data:{customer_name:customer.name,month:invoiceData.month,service_summary:invoiceData.serviceSummary,itemized_services:itemizedServices,subtotal:invoiceData.subtotal.toFixed(2),chemical_total:invoiceData.chemicalTotal.toFixed(2),total:invoiceData.total.toFixed(2),payment_terms:termsText,due_date:dueDateStr},companySettings,paymentLink})});const result=await response.json();if(result.success){// Log the email\nconst logEntry={id:Date.now(),type:'invoice',to:customer.email,customerName:customer.name,subject:\"Invoice for \".concat(invoiceData.month),sentDate:new Date().toISOString(),status:'sent'};saveEmailLog([logEntry,...emailLog]);// Mark customer as billed for this month (persisted with date and terms)\nif(invoiceData.billingMonth){const newBilledCustomers=_objectSpread(_objectSpread({},billedCustomers),{},{[\"\".concat(customer.id,\"-\").concat(invoiceData.billingMonth)]:{billed:true,billedDate:new Date().toISOString(),terms:invoiceData.paymentTerms||'net15',amount:invoiceData.total}});saveBilledCustomers(newBilledCustomers);}showEmailNotification('success',\"Invoice sent to \".concat(customer.email));return true;}else{throw new Error(result.error||'Failed to send email');}}catch(error){console.error('Email error:',error);showEmailNotification('error',\"Failed to send email: \".concat(error.message));return false;}finally{setIsSendingEmail(false);}};const sendWeeklyUpdateEmail=async(customer,serviceData)=>{if(!customer.email){showEmailNotification('error','Customer has no email address');return false;}setIsSendingEmail(true);try{var _serviceData$chemical;const chemicalsUsed=((_serviceData$chemical=serviceData.chemicalsUsed)===null||_serviceData$chemical===void 0?void 0:_serviceData$chemical.length)>0?serviceData.chemicalsUsed.map(c=>\"\\u2022 \".concat(c.name,\": \").concat(c.quantity,\" \").concat(c.unit)).join('\\n'):'';// Format water test results if available\nlet waterTestResults='';if(serviceData.waterTest){const wt=serviceData.waterTest;const results=[];if(wt.chlorine)results.push(\"Chlorine: \".concat(wt.chlorine,\" ppm\"));if(wt.ph)results.push(\"pH: \".concat(wt.ph));if(wt.alkalinity)results.push(\"Alkalinity: \".concat(wt.alkalinity));if(wt.cya)results.push(\"CYA: \".concat(wt.cya));if(wt.hardness)results.push(\"Hardness: \".concat(wt.hardness));if(wt.phosphates)results.push(\"Phosphates: \".concat(wt.phosphates,\" ppb\"));if(results.length>0){waterTestResults=results.join(' | ');}}const response=await fetch(\"\".concat(PAYMENT_SERVER_URL,\"/send-weekly-update\"),{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({to:customer.email,template:emailTemplates.weeklyUpdate,data:{customer_name:customer.name,service_date:new Date(serviceData.date).toLocaleDateString(),chemicals_used:chemicalsUsed,water_test:waterTestResults,service_notes:serviceData.notes||''},companySettings})});const result=await response.json();if(result.success){const logEntry={id:Date.now(),type:'weekly-update',to:customer.email,customerName:customer.name,subject:'Weekly Pool Service Update',sentDate:new Date().toISOString(),status:'sent'};saveEmailLog([logEntry,...emailLog]);showEmailNotification('success',\"Weekly update sent to \".concat(customer.email));return true;}else{throw new Error(result.error||'Failed to send email');}}catch(error){console.error('Email error:',error);showEmailNotification('error',\"Failed to send email: \".concat(error.message));return false;}finally{setIsSendingEmail(false);}};// Download Quote as PDF/HTML\nconst downloadQuotePdf=quote=>{const customer=customers.find(c=>c.id===quote.customerId);const validUntil=new Date(quote.validUntil).toLocaleDateString();const html=\"<!DOCTYPE html>\\n<html><head><style>\\n  body { font-family: 'Segoe UI', Arial, sans-serif; max-width: 800px; margin: 40px auto; padding: 20px; color: #1e3a5f; }\\n  .header { background: linear-gradient(135deg, #7c3aed 0%, #9333ea 100%); color: white; padding: 30px; border-radius: 12px; margin-bottom: 30px; display: flex; align-items: center; gap: 20px; }\\n  .header h1 { margin: 0 0 5px 0; font-size: 28px; }\\n  .logo { width: 60px; height: 60px; }\\n  .info-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 30px; margin-bottom: 30px; }\\n  .info-box h3 { margin: 0 0 10px 0; color: #1e3a5f; font-size: 14px; text-transform: uppercase; letter-spacing: 1px; }\\n  .info-box p { margin: 5px 0; color: #4a5568; }\\n  table { width: 100%; border-collapse: collapse; margin: 20px 0; }\\n  th { background: #7c3aed; color: white; padding: 12px; text-align: left; }\\n  td { padding: 12px; border-bottom: 1px solid #e2e8f0; }\\n  .total-box { background: linear-gradient(135deg, #7c3aed 0%, #9333ea 100%); color: white; padding: 20px 30px; border-radius: 12px; text-align: right; }\\n  .total-box span { font-size: 14px; opacity: 0.9; }\\n  .total-box div { font-size: 32px; font-weight: bold; margin-top: 5px; }\\n  .validity { background: #fef3c7; padding: 15px; border-radius: 8px; margin-bottom: 20px; text-align: center; }\\n</style></head>\\n<body>\\n  <div class=\\\"header\\\">\\n    <svg viewBox=\\\"0 0 100 110\\\" class=\\\"logo\\\">\\n      <path d=\\\"M50 5 L90 25 L90 70 Q90 95 50 105 Q10 95 10 70 L10 25 Z\\\" fill=\\\"#a855f7\\\"/>\\n      <path d=\\\"M50 12 L83 28 L83 68 Q83 88 50 98 Q17 88 17 68 L17 28 Z\\\" fill=\\\"white\\\" opacity=\\\"0.3\\\"/>\\n      <path d=\\\"M20 35 Q35 40 50 35 Q65 30 80 35\\\" stroke=\\\"white\\\" stroke-width=\\\"2\\\" fill=\\\"none\\\" opacity=\\\"0.8\\\"/>\\n      <path d=\\\"M20 48 Q35 53 50 48 Q65 43 80 48\\\" stroke=\\\"white\\\" stroke-width=\\\"2\\\" fill=\\\"none\\\" opacity=\\\"0.8\\\"/>\\n      <path d=\\\"M20 61 Q35 66 50 61 Q65 56 80 61\\\" stroke=\\\"white\\\" stroke-width=\\\"2\\\" fill=\\\"none\\\" opacity=\\\"0.8\\\"/>\\n    </svg>\\n    <div>\\n      <h1>POOL AUTHORITY</h1>\\n      <p style=\\\"margin:0;opacity:0.9;\\\">Quote</p>\\n    </div>\\n  </div>\\n  <h2 style=\\\"color:#7c3aed;\\\">\".concat(quote.quoteNumber,\"</h2>\\n  <div class=\\\"validity\\\">\\u23F0 This quote is valid until <strong>\").concat(validUntil,\"</strong></div>\\n  <div class=\\\"info-grid\\\">\\n    <div class=\\\"info-box\\\">\\n      <h3>Quote For</h3>\\n      <p><strong>\").concat((customer===null||customer===void 0?void 0:customer.name)||quote.customerName,\"</strong></p>\\n      <p>\").concat((customer===null||customer===void 0?void 0:customer.address)||'',\"</p>\\n      \").concat(customer!==null&&customer!==void 0&&customer.phone?\"<p>\".concat(customer.phone,\"</p>\"):'',\"\\n      \").concat(customer!==null&&customer!==void 0&&customer.email?\"<p>\".concat(customer.email,\"</p>\"):'',\"\\n    </div>\\n    <div class=\\\"info-box\\\">\\n      <h3>Quote Details</h3>\\n      <p><strong>Quote #:</strong> \").concat(quote.quoteNumber,\"</p>\\n      <p><strong>Date:</strong> \").concat(new Date(quote.date).toLocaleDateString(),\"</p>\\n      <p><strong>Valid Until:</strong> \").concat(validUntil,\"</p>\\n    </div>\\n  </div>\\n  <table>\\n    <thead>\\n      <tr>\\n        <th>Description</th>\\n        <th>Type</th>\\n        <th>Qty</th>\\n        <th>Price</th>\\n        <th>Total</th>\\n      </tr>\\n    </thead>\\n    <tbody>\\n      \").concat(quote.items.map(item=>\"\\n        <tr>\\n          <td>\".concat(item.description).concat(item.modelNumber?\"<br><small style=\\\"color:#666;\\\">Part #: \".concat(item.modelNumber,\"</small>\"):'',\"</td>\\n          <td><span style=\\\"background:#f3e8ff;padding:2px 8px;border-radius:4px;font-size:12px;\\\">\").concat(item.type,\"</span></td>\\n          <td>\").concat(item.quantity,\"</td>\\n          <td>$\").concat(item.price.toFixed(2),\"</td>\\n          <td><strong>$\").concat((item.quantity*item.price).toFixed(2),\"</strong></td>\\n        </tr>\\n      \")).join(''),\"\\n    </tbody>\\n  </table>\\n  <div class=\\\"total-box\\\">\\n    <span>Quote Total</span>\\n    <div>$\").concat(quote.total.toFixed(2),\"</div>\\n  </div>\\n  \").concat(quote.notes?\"<div style=\\\"margin-top:20px;padding:15px;background:#f8fafc;border-radius:8px;\\\"><strong>Notes:</strong><br>\".concat(quote.notes,\"</div>\"):'',\"\\n  <p style=\\\"text-align:center;margin-top:30px;color:#666;\\\">To accept this quote, please contact us. Thank you for choosing Pool Authority!</p>\\n</body></html>\");const blob=new Blob([html],{type:'text/html'});const a=document.createElement('a');a.href=URL.createObjectURL(blob);a.download=\"PoolAuthority-Quote-\".concat(quote.quoteNumber,\".html\");a.click();};const sendQuoteEmail=async(quote,customer)=>{if(!customer.email){showEmailNotification('error','Customer has no email address');return false;}setIsSendingEmail(true);try{const lineItems=quote.items.map(i=>\"\\u2022 \".concat(i.description).concat(i.modelNumber?\" (\".concat(i.modelNumber,\")\"):'',\" x\").concat(i.quantity,\" - $\").concat((i.quantity*i.price).toFixed(2))).join('\\n');const response=await fetch(\"\".concat(PAYMENT_SERVER_URL,\"/send-quote\"),{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({to:customer.email,template:emailTemplates.quote,data:{customer_name:customer.name,quote_number:quote.quoteNumber,quote_date:new Date(quote.date).toLocaleDateString(),valid_days:quote.validDays||'30',line_items:lineItems,total:quote.total.toFixed(2)},companySettings})});const result=await response.json();if(result.success){const logEntry={id:Date.now(),type:'quote',to:customer.email,customerName:customer.name,subject:\"Quote #\".concat(quote.quoteNumber),sentDate:new Date().toISOString(),status:'sent'};saveEmailLog([logEntry,...emailLog]);showEmailNotification('success',\"Quote sent to \".concat(customer.email));return true;}else{throw new Error(result.error||'Failed to send email');}}catch(error){console.error('Email error:',error);showEmailNotification('error',\"Failed to send email: \".concat(error.message));return false;}finally{setIsSendingEmail(false);}};const sendJobCompletionEmail=async function(customer,jobData){let paymentLink=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;if(!customer.email){showEmailNotification('error','Customer has no email address');return false;}setIsSendingEmail(true);try{var _jobData$additionalIt,_jobData$chemicalsUse;// Build itemized list\nlet itemsList='';if(((_jobData$additionalIt=jobData.additionalItems)===null||_jobData$additionalIt===void 0?void 0:_jobData$additionalIt.length)>0){itemsList=jobData.additionalItems.map(i=>\"\\u2022 \".concat(i.name,\" x\").concat(i.quantity,\" - $\").concat(i.totalCost.toFixed(2))).join('\\n');}const chemicalsUsed=((_jobData$chemicalsUse=jobData.chemicalsUsed)===null||_jobData$chemicalsUse===void 0?void 0:_jobData$chemicalsUse.length)>0?jobData.chemicalsUsed.map(c=>\"\\u2022 \".concat(c.name,\": \").concat(c.quantity,\" \").concat(c.unit)).join('\\n'):'';const paymentSection=paymentLink?\"\\n**Pay Online:** \".concat(paymentLink,\"\\n\"):'';const jobTemplate={subject:\"Service Invoice - \".concat(jobData.jobType,\" - {{company_name}}\"),body:\"Hi {{customer_name}},\\n\\nWe've completed the following work at your property:\\n\\n**Job Type:** \".concat(jobData.jobType,\"\\n**Date:** {{service_date}}\\n\\n**Invoice Details:**\\n\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\nLabor/Service: $\").concat(jobData.basePrice.toFixed(2),\"\\n\").concat(itemsList?\"\\n**Parts & Materials:**\\n\".concat(itemsList,\"\\n\"):'').concat(chemicalsUsed?\"\\n**Chemicals Applied:**\\n\".concat(chemicalsUsed,\"\\n\"):'',\"\\n\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\n**Total Due:** $\").concat(jobData.total.toFixed(2),\"\\n\").concat(paymentSection,\"\\n\").concat(jobData.notes?\"**Technician Notes:**\\n\".concat(jobData.notes,\"\\n\"):'',\"\\nThank you for your business!\\n\\nBest regards,\\n{{owner_name}}\\n{{company_name}}\\n{{company_phone}}\")};const response=await fetch(\"\".concat(PAYMENT_SERVER_URL,\"/send-weekly-update\"),{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({to:customer.email,template:jobTemplate,data:{customer_name:customer.name,service_date:new Date().toLocaleDateString()},companySettings,paymentLink})});const result=await response.json();if(result.success){const logEntry={id:Date.now(),type:'job-invoice',to:customer.email,customerName:customer.name,subject:\"Service Invoice - \".concat(jobData.jobType),sentDate:new Date().toISOString(),status:'sent'};saveEmailLog([logEntry,...emailLog]);showEmailNotification('success',\"Job invoice email sent to \".concat(customer.email));return true;}else{throw new Error(result.error||'Failed to send email');}}catch(error){console.error('Email error:',error);showEmailNotification('error',\"Failed to send email: \".concat(error.message));return false;}finally{setIsSendingEmail(false);}};const sendPaymentReminder=async function(customer,reminderData){let paymentLink=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;if(!customer.email){showEmailNotification('error','Customer has no email address');return false;}setIsSendingEmail(true);try{const response=await fetch(\"\".concat(PAYMENT_SERVER_URL,\"/send-invoice\"),{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({to:customer.email,template:emailTemplates.paymentReminder,data:{customer_name:customer.name,month:reminderData.month,service_summary:reminderData.serviceSummary,total:reminderData.total.toFixed(2),days_past_due:reminderData.daysPastDue},companySettings,paymentLink})});const result=await response.json();if(result.success){const logEntry={id:Date.now(),type:'payment-reminder',to:customer.email,customerName:customer.name,subject:\"Payment Reminder for \".concat(reminderData.month),sentDate:new Date().toISOString(),status:'sent'};saveEmailLog([logEntry,...emailLog]);showEmailNotification('success',\"Payment reminder sent to \".concat(customer.email));return true;}else{throw new Error(result.error||'Failed to send email');}}catch(error){console.error('Email error:',error);showEmailNotification('error',\"Failed to send email: \".concat(error.message));return false;}finally{setIsSendingEmail(false);}};const updateQuoteStatus=(quoteId,status)=>{saveQuotes(quotes.map(q=>q.id===quoteId?_objectSpread(_objectSpread({},q),{},{status}):q));};// Open modal to schedule quote as job\nconst convertQuoteToJob=quote=>{setQuoteToSchedule(quote);setQuoteJobDate(getLocalDateString());// Default to today\nsetShowScheduleQuoteJob(true);};// Actually create the job with selected date\nconst confirmQuoteToJob=()=>{if(!quoteToSchedule||!quoteJobDate)return;const customer=customers.find(c=>c.id===quoteToSchedule.customerId);if(!customer)return;const job={id:Date.now(),customerId:quoteToSchedule.customerId,customerName:quoteToSchedule.customerName,jobType:'quoted-work',date:quoteJobDate,price:quoteToSchedule.total,notes:\"From Quote \".concat(quoteToSchedule.quoteNumber,\": \").concat(quoteToSchedule.items.map(i=>i.description).join(', ')),quoteId:quoteToSchedule.id,quoteItems:quoteToSchedule.items// Store quote items for reference\n};saveJobs([...oneTimeJobs,job]);updateQuoteStatus(quoteToSchedule.id,'approved');// Close modal and reset\nsetShowScheduleQuoteJob(false);setQuoteToSchedule(null);setQuoteJobDate('');showEmailNotification('success',\"Job scheduled for \".concat(new Date(quoteJobDate+'T12:00:00').toLocaleDateString('en-US',{weekday:'long',month:'short',day:'numeric'})));};// Convert approved quote directly to invoice\nconst convertQuoteToInvoice=quote=>{const customer=customers.find(c=>c.id===quote.customerId);if(!customer)return;const invoiceNumber=\"INV-\".concat(Date.now().toString().slice(-8));const total=quote.total;const html=\"<!DOCTYPE html>\\n<html><head><style>\\n  body { font-family: 'Segoe UI', Arial, sans-serif; max-width: 800px; margin: 40px auto; padding: 20px; color: #1e3a5f; }\\n  .header { background: linear-gradient(135deg, #1e3a5f 0%, #2d5a87 100%); color: white; padding: 30px; border-radius: 12px; margin-bottom: 30px; display: flex; align-items: center; gap: 20px; }\\n  .header h1 { margin: 0 0 5px 0; font-size: 28px; }\\n  .logo { width: 60px; height: 60px; }\\n  .info-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 30px; margin-bottom: 30px; }\\n  .info-box h3 { margin: 0 0 10px 0; color: #1e3a5f; font-size: 14px; text-transform: uppercase; }\\n  table { width: 100%; border-collapse: collapse; margin: 20px 0; }\\n  th { background: #1e3a5f; color: white; padding: 12px; text-align: left; }\\n  td { padding: 12px; border-bottom: 1px solid #e2e8f0; }\\n  .item-type { font-size: 11px; background: #e2e8f0; padding: 2px 8px; border-radius: 4px; margin-right: 8px; }\\n  .model-num { font-size: 12px; color: #666; margin-top: 4px; }\\n  .total-row { background: #f1f5f9; font-weight: bold; font-size: 18px; }\\n  .quote-ref { background: #fef3c7; padding: 10px 15px; border-radius: 8px; margin-bottom: 20px; font-size: 14px; }\\n  .total-box { background: linear-gradient(135deg, #1e3a5f 0%, #2d5a87 100%); color: white; padding: 20px 30px; border-radius: 12px; text-align: right; }\\n</style></head>\\n<body>\\n  <div class=\\\"header\\\">\\n    <svg viewBox=\\\"0 0 100 110\\\" class=\\\"logo\\\">\\n      <path d=\\\"M50 5 L90 25 L90 70 Q90 95 50 105 Q10 95 10 70 L10 25 Z\\\" fill=\\\"#5bb4d8\\\"/>\\n      <path d=\\\"M50 12 L83 28 L83 68 Q83 88 50 98 Q17 88 17 68 L17 28 Z\\\" fill=\\\"white\\\" opacity=\\\"0.3\\\"/>\\n      <path d=\\\"M20 35 Q35 40 50 35 Q65 30 80 35\\\" stroke=\\\"white\\\" stroke-width=\\\"2\\\" fill=\\\"none\\\" opacity=\\\"0.8\\\"/>\\n      <path d=\\\"M20 48 Q35 53 50 48 Q65 43 80 48\\\" stroke=\\\"white\\\" stroke-width=\\\"2\\\" fill=\\\"none\\\" opacity=\\\"0.8\\\"/>\\n      <path d=\\\"M20 61 Q35 66 50 61 Q65 56 80 61\\\" stroke=\\\"white\\\" stroke-width=\\\"2\\\" fill=\\\"none\\\" opacity=\\\"0.8\\\"/>\\n    </svg>\\n    <div>\\n      <h1>POOL AUTHORITY</h1>\\n      <p style=\\\"margin:0;opacity:0.9;\\\">Service Invoice</p>\\n    </div>\\n  </div>\\n  <div class=\\\"quote-ref\\\">\\uD83D\\uDCCB Based on approved Quote: <strong>\".concat(quote.quoteNumber,\"</strong></div>\\n  <div class=\\\"info-grid\\\">\\n    <div class=\\\"info-box\\\"><h3>Invoice Details</h3><p><strong>Invoice #:</strong> \").concat(invoiceNumber,\"</p><p><strong>Date:</strong> \").concat(new Date().toLocaleDateString(),\"</p></div>\\n    <div class=\\\"info-box\\\"><h3>Bill To</h3><p><strong>\").concat(customer.name,\"</strong></p><p>\").concat(customer.address,\"</p><p>\").concat(customer.phone||'',\"</p><p>\").concat(customer.email||'',\"</p></div>\\n  </div>\\n  <table>\\n    <tr><th>Description</th><th>Qty</th><th>Price</th><th>Total</th></tr>\\n    \").concat(quote.items.map(item=>\"\\n      <tr>\\n        <td>\\n          <span class=\\\"item-type\\\">\".concat(item.type.toUpperCase(),\"</span>\").concat(item.description,\"\\n          \").concat(item.modelNumber?\"<div class=\\\"model-num\\\">Model/Part #: \".concat(item.modelNumber,\"</div>\"):'',\"\\n        </td>\\n        <td>\").concat(item.quantity,\"</td>\\n        <td>$\").concat(item.price.toFixed(2),\"</td>\\n        <td>$\").concat((item.quantity*item.price).toFixed(2),\"</td>\\n      </tr>\\n    \")).join(''),\"\\n    <tr class=\\\"total-row\\\"><td colspan=\\\"3\\\">Total Due</td><td>$\").concat(total.toFixed(2),\"</td></tr>\\n  </table>\\n  \").concat(quote.notes?\"<div style=\\\"background:#f3e8ff;padding:15px;border-radius:8px;margin:20px 0;\\\"><strong>Notes:</strong> \".concat(quote.notes,\"</div>\"):'',\"\\n  <div class=\\\"total-box\\\"><span>Amount Due</span><div style=\\\"font-size:32px;font-weight:bold;margin-top:5px;\\\">$\").concat(total.toFixed(2),\"</div></div>\\n</body></html>\");const blob=new Blob([html],{type:'text/html'});const a=document.createElement('a');a.href=URL.createObjectURL(blob);a.download=\"PoolAuthority-Invoice-\".concat(customer.name.replace(/\\s+/g,'-'),\"-\").concat(invoiceNumber,\".html\");a.click();// Save to history\nconst service={id:Date.now(),customerId:customer.id,customerName:customer.name,date:new Date().toISOString(),invoiceNumber,invoiceItems:quote.items,totalAmount:total,notes:\"Converted from Quote \".concat(quote.quoteNumber),type:'custom-invoice',quoteNumber:quote.quoteNumber};saveHistory([service,...serviceHistory]);updateQuoteStatus(quote.id,'invoiced');// Email\nif(customer.email){const subject=\"Invoice \".concat(invoiceNumber,\" from Pool Authority\");const body=\"Hi \".concat(customer.name,\",\\n\\nThank you for approving Quote \").concat(quote.quoteNumber,\"!\\n\\nPlease find attached your invoice \").concat(invoiceNumber,\" for $\").concat(total.toFixed(2),\".\\n\\nItems:\\n\").concat(quote.items.map(i=>\"- \".concat(i.description,\": $\").concat((i.quantity*i.price).toFixed(2))).join('\\n'),\"\\n\\nTotal: $\").concat(total.toFixed(2),\"\\n\\nThank you for your business!\\n\\nPool Authority\");window.open(\"mailto:\".concat(customer.email,\"?subject=\").concat(encodeURIComponent(subject),\"&body=\").concat(encodeURIComponent(body)));}};// Invoice generation\nconst downloadInvoice=function(customer,yearMonth){let paymentTerms=arguments.length>2&&arguments[2]!==undefined?arguments[2]:'net15';const services=getMonthServices(customer.id,yearMonth);const total=services.reduce((sum,s)=>sum+s.totalAmount,0);const totalChemicals=services.reduce((sum,s)=>sum+(s.chemicalCost||0),0);const monthName=new Date(yearMonth+'-01').toLocaleDateString('en-US',{month:'long',year:'numeric'});// Calculate due date\nconst termsDays=paymentTerms==='due_receipt'?0:paymentTerms==='net15'?15:30;const dueDate=new Date();dueDate.setDate(dueDate.getDate()+termsDays);const dueDateStr=dueDate.toLocaleDateString();const termsText=paymentTerms==='due_receipt'?'Due Upon Receipt':paymentTerms==='net15'?'Net 15':'Net 30';const html=\"<!DOCTYPE html>\\n<html><head><style>\\n  body { font-family: 'Segoe UI', Arial, sans-serif; max-width: 800px; margin: 40px auto; padding: 20px; color: #1e3a5f; }\\n  .header { background: linear-gradient(135deg, #1e3a5f 0%, #2d5a87 100%); color: white; padding: 30px; border-radius: 12px; margin-bottom: 30px; display: flex; align-items: center; gap: 20px; }\\n  .header h1 { margin: 0 0 5px 0; font-size: 28px; }\\n  .logo { width: 60px; height: 60px; }\\n  .info-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 30px; margin-bottom: 30px; }\\n  .info-box h3 { margin: 0 0 10px 0; color: #1e3a5f; font-size: 14px; text-transform: uppercase; letter-spacing: 1px; }\\n  .info-box p { margin: 5px 0; color: #4a5568; }\\n  table { width: 100%; border-collapse: collapse; margin: 20px 0; }\\n  th { background: #1e3a5f; color: white; padding: 12px; text-align: left; }\\n  td { padding: 12px; border-bottom: 1px solid #e2e8f0; }\\n  .chemicals-detail { font-size: 12px; color: #0d9488; margin-top: 4px; }\\n  .chemical-item { background: #f0fdfa; padding: 2px 6px; border-radius: 4px; margin-right: 4px; display: inline-block; margin-top: 2px; }\\n  .subtotal-row { background: #f8fafc; }\\n  .total-box { background: linear-gradient(135deg, #1e3a5f 0%, #2d5a87 100%); color: white; padding: 20px 30px; border-radius: 12px; text-align: right; }\\n  .total-box span { font-size: 14px; opacity: 0.9; }\\n  .total-box div { font-size: 32px; font-weight: bold; margin-top: 5px; }\\n  .summary-box { background: #f0f9ff; padding: 15px; border-radius: 8px; margin-bottom: 20px; }\\n  .terms-box { background: #fef3c7; padding: 15px; border-radius: 8px; margin-bottom: 20px; }\\n</style></head>\\n<body>\\n  <div class=\\\"header\\\">\\n    <svg viewBox=\\\"0 0 100 110\\\" class=\\\"logo\\\">\\n      <path d=\\\"M50 5 L90 25 L90 70 Q90 95 50 105 Q10 95 10 70 L10 25 Z\\\" fill=\\\"#5bb4d8\\\"/>\\n      <path d=\\\"M50 12 L83 28 L83 68 Q83 88 50 98 Q17 88 17 68 L17 28 Z\\\" fill=\\\"white\\\" opacity=\\\"0.3\\\"/>\\n      <path d=\\\"M20 35 Q35 40 50 35 Q65 30 80 35\\\" stroke=\\\"white\\\" stroke-width=\\\"2\\\" fill=\\\"none\\\" opacity=\\\"0.8\\\"/>\\n      <path d=\\\"M20 48 Q35 53 50 48 Q65 43 80 48\\\" stroke=\\\"white\\\" stroke-width=\\\"2\\\" fill=\\\"none\\\" opacity=\\\"0.8\\\"/>\\n      <path d=\\\"M20 61 Q35 66 50 61 Q65 56 80 61\\\" stroke=\\\"white\\\" stroke-width=\\\"2\\\" fill=\\\"none\\\" opacity=\\\"0.8\\\"/>\\n    </svg>\\n    <div>\\n      <h1>POOL AUTHORITY</h1>\\n      <p style=\\\"margin:0;opacity:0.9;\\\">Monthly Service Invoice</p>\\n    </div>\\n  </div>\\n  <h2 style=\\\"color:#1e3a5f;\\\">Invoice - \".concat(monthName,\"</h2>\\n  <div class=\\\"terms-box\\\">\\n    <strong>Payment Terms:</strong> \").concat(termsText,\" | <strong>Due Date:</strong> \").concat(dueDateStr,\"\\n  </div>\\n  <div class=\\\"info-grid\\\">\\n    <div class=\\\"info-box\\\">\\n      <h3>Bill To</h3>\\n      <p><strong>\").concat(customer.name,\"</strong></p>\\n      <p>\").concat(customer.address,\"</p>\\n      \").concat(customer.phone?\"<p>\".concat(customer.phone,\"</p>\"):'',\"\\n      \").concat(customer.email?\"<p>\".concat(customer.email,\"</p>\"):'',\"\\n    </div>\\n    <div class=\\\"info-box\\\">\\n      <h3>Service Details</h3>\\n      <p>Pool Type: \").concat(customer.poolType,\"</p>\\n      <p>Weekly Rate: $\").concat(customer.weeklyRate,\"</p>\\n      <p>Services This Month: \").concat(services.length,\"</p>\\n    </div>\\n  </div>\\n  <table>\\n    <tr><th>Date</th><th>Service</th><th>Chemicals</th><th>Total</th></tr>\\n    \").concat(services.map(s=>\"\\n      <tr>\\n        <td>\".concat(new Date(s.date).toLocaleDateString(),\"</td>\\n        <td>\\n          Weekly Service - $\").concat(s.weeklyRate.toFixed(2),\"\\n        </td>\\n        <td>\\n          $\").concat((s.chemicalCost||0).toFixed(2),\"\\n          \").concat(s.chemicalsUsed&&s.chemicalsUsed.length>0?\"\\n            <div class=\\\"chemicals-detail\\\">\\n              \".concat(s.chemicalsUsed.map(c=>\"<span class=\\\"chemical-item\\\">\".concat(c.name,\": \").concat(c.quantity,\" \").concat(c.unit,\"</span>\")).join(''),\"\\n            </div>\\n          \"):'',\"\\n        </td>\\n        <td><strong>$\").concat(s.totalAmount.toFixed(2),\"</strong></td>\\n      </tr>\\n    \")).join(''),\"\\n    <tr class=\\\"subtotal-row\\\">\\n      <td colspan=\\\"2\\\" style=\\\"text-align:right;\\\"><strong>Service Subtotal:</strong></td>\\n      <td colspan=\\\"2\\\"><strong>$\").concat(services.reduce((sum,s)=>sum+s.weeklyRate,0).toFixed(2),\"</strong></td>\\n    </tr>\\n    <tr class=\\\"subtotal-row\\\">\\n      <td colspan=\\\"2\\\" style=\\\"text-align:right;\\\"><strong>Chemicals Subtotal:</strong></td>\\n      <td colspan=\\\"2\\\"><strong>$\").concat(totalChemicals.toFixed(2),\"</strong></td>\\n    </tr>\\n  </table>\\n  <div class=\\\"total-box\\\">\\n    <span>Amount Due</span>\\n    <div>$\").concat(total.toFixed(2),\"</div>\\n  </div>\\n  <p style=\\\"text-align:center;margin-top:30px;color:#666;\\\">Thank you for choosing Pool Authority!</p>\\n</body></html>\");const blob=new Blob([html],{type:'text/html'});const a=document.createElement('a');a.href=URL.createObjectURL(blob);a.download=\"PoolAuthority-Invoice-\".concat(customer.name.replace(/\\s+/g,'-'),\"-\").concat(yearMonth,\".html\");a.click();};// Generate PDF for job/service call invoice\nconst downloadJobInvoice=function(service){let paymentTerms=arguments.length>1&&arguments[1]!==undefined?arguments[1]:'net15';const customer=customers.find(c=>c.id===service.customerId);if(!customer)return;const invoiceNumber=\"JOB-\".concat(service.id.toString().slice(-8));const serviceDate=new Date(service.date).toLocaleDateString();// Calculate due date\nconst termsDays=paymentTerms==='due_receipt'?0:paymentTerms==='net7'?7:paymentTerms==='net15'?15:paymentTerms==='net30'?30:paymentTerms==='net45'?45:paymentTerms==='net60'?60:15;const dueDate=new Date(service.date);dueDate.setDate(dueDate.getDate()+termsDays);const dueDateStr=dueDate.toLocaleDateString();const termsText=paymentTerms==='due_receipt'?'Due Upon Receipt':\"Net \".concat(termsDays);const html=\"<!DOCTYPE html>\\n<html><head><style>\\n  body { font-family: 'Segoe UI', Arial, sans-serif; max-width: 800px; margin: 40px auto; padding: 20px; color: #1e3a5f; }\\n  .header { background: linear-gradient(135deg, #7c3aed 0%, #a855f7 100%); color: white; padding: 30px; border-radius: 12px; margin-bottom: 30px; display: flex; align-items: center; gap: 20px; }\\n  .header h1 { margin: 0 0 5px 0; font-size: 28px; }\\n  .logo { width: 60px; height: 60px; }\\n  .info-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 30px; margin-bottom: 30px; }\\n  .info-box h3 { margin: 0 0 10px 0; color: #1e3a5f; font-size: 14px; text-transform: uppercase; letter-spacing: 1px; }\\n  .info-box p { margin: 5px 0; color: #4a5568; }\\n  table { width: 100%; border-collapse: collapse; margin: 20px 0; }\\n  th { background: #7c3aed; color: white; padding: 12px; text-align: left; }\\n  td { padding: 12px; border-bottom: 1px solid #e2e8f0; }\\n  .total-box { background: linear-gradient(135deg, #7c3aed 0%, #a855f7 100%); color: white; padding: 20px 30px; border-radius: 12px; text-align: right; }\\n  .total-box span { font-size: 14px; opacity: 0.9; }\\n  .total-box div { font-size: 32px; font-weight: bold; margin-top: 5px; }\\n  .terms-box { background: #fef3c7; padding: 15px; border-radius: 8px; margin-bottom: 20px; }\\n  .notes-box { background: #f0fdf4; padding: 15px; border-radius: 8px; margin-top: 20px; }\\n</style></head>\\n<body>\\n  <div class=\\\"header\\\">\\n    <svg viewBox=\\\"0 0 100 110\\\" class=\\\"logo\\\">\\n      <path d=\\\"M50 5 L90 25 L90 70 Q90 95 50 105 Q10 95 10 70 L10 25 Z\\\" fill=\\\"#a855f7\\\"/>\\n      <path d=\\\"M50 12 L83 28 L83 68 Q83 88 50 98 Q17 88 17 68 L17 28 Z\\\" fill=\\\"white\\\" opacity=\\\"0.3\\\"/>\\n      <path d=\\\"M35 45 L45 55 L65 35\\\" stroke=\\\"white\\\" stroke-width=\\\"6\\\" fill=\\\"none\\\" stroke-linecap=\\\"round\\\" stroke-linejoin=\\\"round\\\"/>\\n    </svg>\\n    <div>\\n      <h1>POOL AUTHORITY</h1>\\n      <p style=\\\"margin:0;opacity:0.9;\\\">Service Call Invoice</p>\\n    </div>\\n  </div>\\n  <h2 style=\\\"color:#7c3aed;\\\">Invoice #\".concat(invoiceNumber,\"</h2>\\n  <div class=\\\"terms-box\\\">\\n    <strong>Payment Terms:</strong> \").concat(termsText,\" | <strong>Due Date:</strong> \").concat(dueDateStr,\"\\n  </div>\\n  <div class=\\\"info-grid\\\">\\n    <div class=\\\"info-box\\\">\\n      <h3>Bill To</h3>\\n      <p><strong>\").concat(customer.name,\"</strong></p>\\n      <p>\").concat(customer.address,\"</p>\\n      \").concat(customer.phone?\"<p>\".concat(customer.phone,\"</p>\"):'',\"\\n      \").concat(customer.email?\"<p>\".concat(customer.email,\"</p>\"):'',\"\\n    </div>\\n    <div class=\\\"info-box\\\">\\n      <h3>Service Details</h3>\\n      <p><strong>Job Type:</strong> \").concat(service.jobType||service.poolType,\"</p>\\n      <p><strong>Service Date:</strong> \").concat(serviceDate,\"</p>\\n      <p><strong>Invoice Date:</strong> \").concat(new Date().toLocaleDateString(),\"</p>\\n    </div>\\n  </div>\\n  \\n  <table>\\n    <thead>\\n      <tr>\\n        <th>Description</th>\\n        <th style=\\\"text-align:right;\\\">Amount</th>\\n      </tr>\\n    </thead>\\n    <tbody>\\n      <tr>\\n        <td><strong>\").concat(service.jobType||service.poolType,\"</strong> - Labor</td>\\n        <td style=\\\"text-align:right;\\\">$\").concat(service.weeklyRate.toFixed(2),\"</td>\\n      </tr>\\n      \").concat((service.additionalItems||[]).map(item=>\"\\n      <tr>\\n        <td>\".concat(item.name,\" (x\").concat(item.quantity,\")</td>\\n        <td style=\\\"text-align:right;\\\">$\").concat(item.totalCost.toFixed(2),\"</td>\\n      </tr>\")).join(''),\"\\n      \").concat((service.chemicalsUsed||[]).map(chem=>\"\\n      <tr>\\n        <td>\".concat(chem.name,\" (\").concat(chem.quantity,\" \").concat(chem.unit,\")</td>\\n        <td style=\\\"text-align:right;\\\">$\").concat(chem.totalCost.toFixed(2),\"</td>\\n      </tr>\")).join(''),\"\\n    </tbody>\\n  </table>\\n  \\n  <div class=\\\"total-box\\\">\\n    <span>Total Due</span>\\n    <div>$\").concat(service.totalAmount.toFixed(2),\"</div>\\n  </div>\\n  \\n  \").concat(service.techNotes?\"<div class=\\\"notes-box\\\"><strong>Service Notes:</strong><br>\".concat(service.techNotes,\"</div>\"):'',\"\\n  \\n  <div style=\\\"margin-top: 40px; text-align: center; color: #718096; font-size: 14px;\\\">\\n    <p>Thank you for your business!</p>\\n    <p>\").concat(companySettings.companyName||'Pool Authority',\" | \").concat(companySettings.phone||'',\" | \").concat(companySettings.email||'',\"</p>\\n  </div>\\n</body></html>\");const blob=new Blob([html],{type:'text/html'});const a=document.createElement('a');a.href=URL.createObjectURL(blob);a.download=\"PoolAuthority-Job-\".concat(invoiceNumber,\"-\").concat(customer.name.replace(/\\s+/g,'-'),\".html\");a.click();};// Chemical functions\nconst addChemical=()=>{if(newChemical.name){saveChemicals([...chemicalInventory,_objectSpread(_objectSpread({},newChemical),{},{id:Date.now()})]);setNewChemical({name:'',quantity:0,unit:'lbs',costPerUnit:0});setShowAddChemical(false);}};// Edit chemical in inventory\nconst updateChemical=()=>{if(editingChemical){saveChemicals(chemicalInventory.map(c=>c.id===editingChemical.id?editingChemical:c));setEditingChemical(null);}};const deleteChemical=id=>{if(confirm('Delete this chemical from inventory?')){saveChemicals(chemicalInventory.filter(c=>c.id!==id));}};// Edit service history entry\nconst openEditServiceModal=service=>{setEditingService(_objectSpread({},service));setShowEditServiceModal(true);};const updateService=()=>{if(editingService){var _editingService$chemi;// Recalculate total\nconst chemicalCost=((_editingService$chemi=editingService.chemicalsUsed)===null||_editingService$chemi===void 0?void 0:_editingService$chemi.reduce((sum,c)=>sum+c.quantity*c.costPerUnit,0))||editingService.chemicalCost||0;const updatedService=_objectSpread(_objectSpread({},editingService),{},{chemicalCost,totalAmount:editingService.weeklyRate+chemicalCost});saveHistory(serviceHistory.map(s=>s.id===editingService.id?updatedService:s));setShowEditServiceModal(false);setEditingService(null);}};const deleteService=serviceId=>{if(confirm('Delete this service record? This cannot be undone.')){saveHistory(serviceHistory.filter(s=>s.id!==serviceId));}};// Add/edit chemical in a service record\nconst addChemicalToEditingService=(chemical,quantity)=>{if(!editingService||quantity<=0)return;const chemicalsUsed=editingService.chemicalsUsed||[];const existingIndex=chemicalsUsed.findIndex(c=>c.id===chemical.id);let updatedChemicals;if(existingIndex>=0){updatedChemicals=chemicalsUsed.map((c,i)=>i===existingIndex?_objectSpread(_objectSpread({},c),{},{quantity:c.quantity+quantity,totalCost:(c.quantity+quantity)*c.costPerUnit}):c);}else{updatedChemicals=[...chemicalsUsed,{id:chemical.id,name:chemical.name,quantity:quantity,unit:chemical.unit,costPerUnit:chemical.costPerUnit,totalCost:quantity*chemical.costPerUnit}];}const newChemicalCost=updatedChemicals.reduce((sum,c)=>sum+c.totalCost,0);setEditingService(_objectSpread(_objectSpread({},editingService),{},{chemicalsUsed:updatedChemicals,chemicalCost:newChemicalCost,totalAmount:editingService.weeklyRate+newChemicalCost}));};const removeChemicalFromEditingService=chemicalId=>{if(!editingService)return;const updatedChemicals=(editingService.chemicalsUsed||[]).filter(c=>c.id!==chemicalId);const newChemicalCost=updatedChemicals.reduce((sum,c)=>sum+c.totalCost,0);setEditingService(_objectSpread(_objectSpread({},editingService),{},{chemicalsUsed:updatedChemicals,chemicalCost:newChemicalCost,totalAmount:editingService.weeklyRate+newChemicalCost}));};// Open customer billing detail view\nconst openCustomerBillingDetail=customer=>{const services=getMonthServices(customer.id,invoiceMonth);setSelectedCustomerBilling({customer,services});setBillingAdjustments([]);};// Add manual adjustment to bill\nconst addBillingAdjustment=(description,amount)=>{if(description&&amount!==0){setBillingAdjustments([...billingAdjustments,{id:Date.now(),description,amount}]);}};const removeBillingAdjustment=id=>{setBillingAdjustments(billingAdjustments.filter(a=>a.id!==id));};// Job functions\nconst addJob=()=>{if(newJob.customerId&&newJob.date){const customer=customers.find(c=>c.id===parseInt(newJob.customerId));saveJobs([...oneTimeJobs,_objectSpread(_objectSpread({},newJob),{},{id:Date.now(),customerName:(customer===null||customer===void 0?void 0:customer.name)||'Unknown',scheduledTime:newJob.scheduledTime||null,employeeId:newJob.employeeId||null})]);setNewJob({customerId:'',jobType:'opening',date:'',price:250,notes:'',scheduledTime:null,employeeId:null});setShowAddJob(false);}};// Open job completion modal\nconst openCompleteJobModal=job=>{setJobToComplete(job);setJobCompletionItems([]);setJobChemicals([]);setJobCompletionNotes('');setShowCompleteJobModal(true);};// Add wear item to job completion\nconst addWearItemToJob=function(item){let quantity=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;const existingIndex=jobCompletionItems.findIndex(i=>i.id===item.id);if(existingIndex>=0){const updated=[...jobCompletionItems];updated[existingIndex].quantity+=quantity;setJobCompletionItems(updated);}else{setJobCompletionItems([...jobCompletionItems,_objectSpread(_objectSpread({},item),{},{quantity})]);}};// Add custom item to job completion\nconst addCustomItemToJob=(name,price)=>{if(name&&price>0){setJobCompletionItems([...jobCompletionItems,{id:Date.now(),name,price,quantity:1,isCustom:true}]);}};// Remove item from job completion\nconst removeItemFromJob=itemId=>{setJobCompletionItems(jobCompletionItems.filter(i=>i.id!==itemId));};// Add chemical to job completion\nconst addChemicalToJob=(chemical,quantity)=>{if(quantity<=0)return;const existingIndex=jobChemicals.findIndex(c=>c.id===chemical.id);if(existingIndex>=0){const updated=[...jobChemicals];updated[existingIndex].quantityUsed+=quantity;setJobChemicals(updated);}else{setJobChemicals([...jobChemicals,_objectSpread(_objectSpread({},chemical),{},{quantityUsed:quantity})]);}};// Remove chemical from job completion\nconst removeChemicalFromJob=chemicalId=>{setJobChemicals(jobChemicals.filter(c=>c.id!==chemicalId));};// Complete job with additional items and chemicals\nconst completeJobWithItems=async()=>{if(!jobToComplete)return;const additionalCost=jobCompletionItems.reduce((sum,i)=>sum+i.price*i.quantity,0);const chemicalCost=jobChemicals.reduce((sum,c)=>sum+c.quantityUsed*c.costPerUnit,0);const totalAmount=jobToComplete.price+additionalCost+chemicalCost;const itemsUsed=jobCompletionItems.map(i=>({id:i.id,name:i.name,price:i.price,quantity:i.quantity,totalCost:i.price*i.quantity}));const chemicalsUsed=jobChemicals.map(c=>({id:c.id,name:c.name,quantity:c.quantityUsed,unit:c.unit,costPerUnit:c.costPerUnit,totalCost:c.quantityUsed*c.costPerUnit}));const service={id:Date.now(),customerId:parseInt(jobToComplete.customerId),customerName:jobToComplete.customerName,date:new Date().toISOString(),weeklyRate:jobToComplete.price,chemicalCost:chemicalCost,chemicalsUsed:chemicalsUsed,additionalItemsCost:additionalCost,additionalItems:itemsUsed,totalAmount:totalAmount,poolType:jobToComplete.jobType,jobNotes:jobToComplete.notes,techNotes:jobCompletionNotes,isJobService:true,// Flag to distinguish from recurring services\njobType:jobToComplete.jobType};saveHistory([service,...serviceHistory]);saveJobs(oneTimeJobs.filter(j=>j.id!==jobToComplete.id));// Update chemical inventory\nconst updatedChemicals=chemicalInventory.map(chem=>{const used=jobChemicals.find(c=>c.id===chem.id);if(used){return _objectSpread(_objectSpread({},chem),{},{quantity:Math.max(0,chem.quantity-used.quantityUsed)});}return chem;});saveChemicals(updatedChemicals);// Send job completion email if enabled\nconst customer=customers.find(c=>c.id===parseInt(jobToComplete.customerId));if(sendJobEmailOnComplete&&customer!==null&&customer!==void 0&&customer.email){await sendJobCompletionEmail(customer,{jobType:jobToComplete.jobType,basePrice:jobToComplete.price,additionalItems:itemsUsed,chemicalsUsed:chemicalsUsed,total:totalAmount,notes:jobCompletionNotes});}setShowCompleteJobModal(false);setJobToComplete(null);setJobCompletionItems([]);setJobChemicals([]);setJobCompletionNotes('');};// Legacy completeJob - now opens modal\nconst completeJob=job=>{openCompleteJobModal(job);};// Wear item management\nconst addWearItem=()=>{if(newWearItem.name&&newWearItem.price>0){saveWearItems([...wearItems,_objectSpread(_objectSpread({},newWearItem),{},{id:Date.now()})]);setNewWearItem({name:'',price:0,description:''});}};const deleteWearItem=id=>{saveWearItems(wearItems.filter(w=>w.id!==id));};// Stats\nconst totalRevenue=serviceHistory.reduce((sum,s)=>sum+s.totalAmount,0);const thisMonthRevenue=serviceHistory.filter(s=>s.date.startsWith(new Date().toISOString().slice(0,7))).reduce((sum,s)=>sum+s.totalAmount,0);const todayServices=serviceHistory.filter(s=>s.date.startsWith(selectedDate)).length;// Tab config\nconst tabs=[{key:'home',label:'Home',icon:Icons.Home},{key:'calendar',label:'Calendar',icon:Icons.Calendar},{key:'routes',label:'Routes',icon:Icons.Map},{key:'customers',label:'Customers',icon:Icons.Users},{key:'recurring',label:'Recurring',icon:Icons.History},{key:'jobs',label:'Jobs',icon:Icons.Wrench},{key:'quotes',label:'Quotes',icon:Icons.FileText},{key:'billing',label:'Billing',icon:Icons.Receipt},{key:'payments',label:'Payments',icon:Icons.CreditCard},{key:'chemicals',label:'Chemicals',icon:Icons.Beaker},{key:'history',label:'History',icon:Icons.DollarSign},{key:'settings',label:'Settings',icon:Icons.Settings}];return/*#__PURE__*/_jsxs(\"div\",{className:\"min-h-screen pb-20 md:pb-8\",style:{background:'linear-gradient(180deg, #f0f9ff 0%, #e0f2fe 100%)'},children:[emailNotification&&/*#__PURE__*/_jsxs(\"div\",{className:\"fixed top-4 left-4 right-4 md:left-auto md:right-4 md:w-auto z-50 p-4 rounded-lg shadow-lg flex items-center gap-3 animate-pulse \".concat(emailNotification.type==='success'?'bg-green-500 text-white':'bg-red-500 text-white'),children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-xl\",children:emailNotification.type==='success'?'':''}),/*#__PURE__*/_jsx(\"span\",{children:emailNotification.message})]}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-white shadow-lg border-b-4 sticky top-0 z-40\",style:{borderColor:'#5bb4d8'},children:/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-6xl mx-auto px-3 md:px-4 py-3 md:py-4 flex items-center gap-3 md:gap-4\",children:[/*#__PURE__*/_jsxs(\"svg\",{viewBox:\"0 0 100 110\",className:\"w-10 h-10 md:w-14 md:h-14 flex-shrink-0\",children:[/*#__PURE__*/_jsx(\"path\",{d:\"M50 5 L90 25 L90 70 Q90 95 50 105 Q10 95 10 70 L10 25 Z\",fill:\"#1e3a5f\",stroke:\"#1e3a5f\",strokeWidth:\"2\"}),/*#__PURE__*/_jsx(\"path\",{d:\"M50 12 L83 28 L83 68 Q83 88 50 98 Q17 88 17 68 L17 28 Z\",fill:\"#5bb4d8\"}),/*#__PURE__*/_jsx(\"path\",{d:\"M20 35 Q35 40 50 35 Q65 30 80 35\",stroke:\"white\",strokeWidth:\"2.5\",fill:\"none\",opacity:\"0.7\"}),/*#__PURE__*/_jsx(\"path\",{d:\"M20 48 Q35 53 50 48 Q65 43 80 48\",stroke:\"white\",strokeWidth:\"2.5\",fill:\"none\",opacity:\"0.7\"}),/*#__PURE__*/_jsx(\"path\",{d:\"M20 61 Q35 66 50 61 Q65 56 80 61\",stroke:\"white\",strokeWidth:\"2.5\",fill:\"none\",opacity:\"0.7\"}),/*#__PURE__*/_jsx(\"path\",{d:\"M25 74 Q40 79 55 74 Q70 69 78 74\",stroke:\"white\",strokeWidth:\"2.5\",fill:\"none\",opacity:\"0.7\"}),/*#__PURE__*/_jsx(\"path\",{d:\"M35 85 Q45 88 55 85 Q65 82 70 85\",stroke:\"white\",strokeWidth:\"2\",fill:\"none\",opacity:\"0.6\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 min-w-0\",children:[/*#__PURE__*/_jsxs(\"h1\",{className:\"text-lg md:text-2xl font-black tracking-tight truncate\",children:[/*#__PURE__*/_jsx(\"span\",{style:{color:'#1e3a5f'},children:\"POOL\"}),/*#__PURE__*/_jsx(\"span\",{style:{color:'#9b3544'},children:\" AUTHORITY\"})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs md:text-sm text-gray-500 hidden sm:block\",children:\"Professional Pool Service Management\"})]}),/*#__PURE__*/_jsx(\"span\",{className:\"text-xs text-gray-400 hidden md:block\",children:\"v2.4.0\"})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"max-w-6xl mx-auto px-4 py-4 hidden md:block\",children:/*#__PURE__*/_jsx(\"div\",{className:\"flex gap-1 bg-white rounded-xl p-1.5 shadow-md overflow-x-auto\",children:tabs.map(_ref2=>{let{key,label,icon:Icon}=_ref2;return/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setActiveTab(key),className:\"flex items-center gap-2 px-4 py-2.5 rounded-lg text-sm font-medium transition-all whitespace-nowrap \".concat(activeTab===key?'text-white shadow-md':'text-gray-600 hover:bg-gray-100'),style:activeTab===key?{background:'linear-gradient(135deg, #1e3a5f 0%, #0ea5e9 100%)'}:{},children:[/*#__PURE__*/_jsx(Icon,{}),label]},key);})})}),/*#__PURE__*/_jsx(\"div\",{className:\"md:hidden fixed bottom-0 left-0 right-0 bg-white border-t shadow-lg z-50 safe-area-bottom\",children:/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-around items-center py-2 px-1\",children:[{key:'home',label:'Home',icon:Icons.Home},{key:'routes',label:'Routes',icon:Icons.Map},{key:'customers',label:'Customers',icon:Icons.Users},{key:'jobs',label:'Jobs',icon:Icons.Wrench},{key:'more',label:'More',icon:Icons.Menu}].map(_ref3=>{let{key,label,icon:Icon}=_ref3;return key==='more'?/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setShowMobileMenu(!showMobileMenu),className:\"flex flex-col items-center px-3 py-1 rounded-lg \".concat(showMobileMenu?'text-blue-600':'text-gray-600'),children:[/*#__PURE__*/_jsx(Icon,{}),/*#__PURE__*/_jsx(\"span\",{className:\"text-xs mt-1\",children:label})]}),showMobileMenu&&/*#__PURE__*/_jsx(\"div\",{className:\"absolute bottom-full right-0 mb-2 bg-white rounded-xl shadow-2xl border p-2 min-w-48\",children:tabs.filter(t=>!['home','routes','customers','jobs'].includes(t.key)).map(_ref4=>{let{key,label,icon:TabIcon}=_ref4;return/*#__PURE__*/_jsxs(\"button\",{onClick:()=>{setActiveTab(key);setShowMobileMenu(false);},className:\"w-full flex items-center gap-3 px-4 py-3 rounded-lg text-left \".concat(activeTab===key?'bg-blue-50 text-blue-700':'text-gray-700 hover:bg-gray-50'),children:[/*#__PURE__*/_jsx(TabIcon,{}),/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:label})]},key);})})]},key):/*#__PURE__*/_jsxs(\"button\",{onClick:()=>{setActiveTab(key);setShowMobileMenu(false);},className:\"flex flex-col items-center px-3 py-1 rounded-lg transition-all \".concat(activeTab===key?'text-blue-600':'text-gray-600'),children:[/*#__PURE__*/_jsx(\"div\",{className:\"p-1.5 rounded-lg \".concat(activeTab===key?'bg-blue-100':''),children:/*#__PURE__*/_jsx(Icon,{})}),/*#__PURE__*/_jsx(\"span\",{className:\"text-xs mt-1 font-medium\",children:label})]},key);})})}),showMobileMenu&&/*#__PURE__*/_jsx(\"div\",{className:\"md:hidden fixed inset-0 z-40\",onClick:()=>setShowMobileMenu(false)}),/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-6xl mx-auto px-3 md:px-4 pb-8 md:pt-0 pt-2\",children:[activeTab==='home'&&/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-4 gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-xl p-6 shadow-lg border-l-4\",style:{borderColor:'#22c55e'},children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-gray-500 font-medium\",children:\"Total Revenue\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-3xl font-black text-gray-800\",children:[\"$\",totalRevenue.toFixed(2)]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-xl p-6 shadow-lg border-l-4\",style:{borderColor:'#0ea5e9'},children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-gray-500 font-medium\",children:\"This Month\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-3xl font-black text-gray-800\",children:[\"$\",thisMonthRevenue.toFixed(2)]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-xl p-6 shadow-lg border-l-4\",style:{borderColor:'#8b5cf6'},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm text-gray-500 font-medium\",children:[selectedYear,\" Total\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-3xl font-black text-gray-800\",children:[\"$\",getYearTotal(selectedYear).toFixed(2)]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-xl p-6 shadow-lg border-l-4\",style:{borderColor:'#f59e0b'},children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-gray-500 font-medium\",children:\"Accounts Receivable\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-3xl font-black text-gray-800\",children:[\"$\",getAccountsReceivable().reduce((sum,c)=>sum+c.balance,0).toFixed(2)]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-xl p-6 shadow-lg\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-bold text-gray-800 mb-4\",children:\"Yearly Revenue (5 Year History)\"}),/*#__PURE__*/_jsx(ResponsiveContainer,{width:\"100%\",height:200,children:/*#__PURE__*/_jsxs(BarChart,{data:getYearlyRevenueData(),children:[/*#__PURE__*/_jsx(CartesianGrid,{strokeDasharray:\"3 3\",stroke:\"#e5e7eb\"}),/*#__PURE__*/_jsx(XAxis,{dataKey:\"year\",stroke:\"#6b7280\",fontSize:12}),/*#__PURE__*/_jsx(YAxis,{stroke:\"#6b7280\",fontSize:12,tickFormatter:v=>\"$\".concat(v>=1000?(v/1000).toFixed(0)+'k':v)}),/*#__PURE__*/_jsx(Tooltip,{formatter:value=>[\"$\".concat(value.toFixed(2)),'Revenue'],contentStyle:{borderRadius:'8px',border:'1px solid #e5e7eb'}}),/*#__PURE__*/_jsx(Bar,{dataKey:\"revenue\",fill:\"#1e3a5f\",radius:[4,4,0,0]})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-xl p-6 shadow-lg\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-4\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-bold text-gray-800\",children:\"Monthly Revenue\"}),/*#__PURE__*/_jsx(\"select\",{value:selectedYear,onChange:e=>setSelectedYear(parseInt(e.target.value)),className:\"px-4 py-2 border rounded-lg font-medium\",style:{borderColor:'#1e3a5f',color:'#1e3a5f'},children:getAvailableYears().map(year=>/*#__PURE__*/_jsx(\"option\",{value:year,children:year},year))})]}),/*#__PURE__*/_jsx(ResponsiveContainer,{width:\"100%\",height:250,children:/*#__PURE__*/_jsxs(AreaChart,{data:getMonthlyRevenueData(),children:[/*#__PURE__*/_jsx(\"defs\",{children:/*#__PURE__*/_jsxs(\"linearGradient\",{id:\"colorRevenue\",x1:\"0\",y1:\"0\",x2:\"0\",y2:\"1\",children:[/*#__PURE__*/_jsx(\"stop\",{offset:\"5%\",stopColor:\"#5bb4d8\",stopOpacity:0.8}),/*#__PURE__*/_jsx(\"stop\",{offset:\"95%\",stopColor:\"#5bb4d8\",stopOpacity:0.1})]})}),/*#__PURE__*/_jsx(CartesianGrid,{strokeDasharray:\"3 3\",stroke:\"#e5e7eb\"}),/*#__PURE__*/_jsx(XAxis,{dataKey:\"month\",stroke:\"#6b7280\",fontSize:12}),/*#__PURE__*/_jsx(YAxis,{stroke:\"#6b7280\",fontSize:12,tickFormatter:v=>\"$\".concat(v)}),/*#__PURE__*/_jsx(Tooltip,{formatter:value=>[\"$\".concat(value.toFixed(2)),'Revenue'],labelFormatter:(label,payload)=>{var _payload$,_payload$$payload,_payload$2,_payload$2$payload;return((_payload$=payload[0])===null||_payload$===void 0?void 0:(_payload$$payload=_payload$.payload)===null||_payload$$payload===void 0?void 0:_payload$$payload.fullMonth)+' '+((_payload$2=payload[0])===null||_payload$2===void 0?void 0:(_payload$2$payload=_payload$2.payload)===null||_payload$2$payload===void 0?void 0:_payload$2$payload.year);},contentStyle:{borderRadius:'8px',border:'1px solid #e5e7eb'}}),/*#__PURE__*/_jsx(Area,{type:\"monotone\",dataKey:\"revenue\",stroke:\"#1e3a5f\",fillOpacity:1,fill:\"url(#colorRevenue)\",strokeWidth:2})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-xl p-6 shadow-lg\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-bold text-gray-800 mb-4\",children:\"Weekly Revenue (Last 8 Weeks)\"}),/*#__PURE__*/_jsx(ResponsiveContainer,{width:\"100%\",height:200,children:/*#__PURE__*/_jsxs(BarChart,{data:getWeeklyRevenueData(),children:[/*#__PURE__*/_jsx(CartesianGrid,{strokeDasharray:\"3 3\",stroke:\"#e5e7eb\"}),/*#__PURE__*/_jsx(XAxis,{dataKey:\"week\",stroke:\"#6b7280\",fontSize:12}),/*#__PURE__*/_jsx(YAxis,{stroke:\"#6b7280\",fontSize:12,tickFormatter:v=>\"$\".concat(v)}),/*#__PURE__*/_jsx(Tooltip,{formatter:value=>[\"$\".concat(value.toFixed(2)),'Revenue'],contentStyle:{borderRadius:'8px',border:'1px solid #e5e7eb'}}),/*#__PURE__*/_jsx(Bar,{dataKey:\"revenue\",fill:\"#22c55e\",radius:[4,4,0,0]})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-xl p-6 shadow-lg\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-bold text-gray-800 mb-4\",children:\"Accounts Receivable\"}),getAccountsReceivable().length>0?/*#__PURE__*/_jsx(\"div\",{className:\"space-y-3\",children:getAccountsReceivable().map(account=>/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between p-4 bg-amber-50 rounded-lg border-l-4 border-amber-500\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"font-bold text-gray-800\",children:account.name}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm text-gray-500\",children:[\"Services: $\",account.totalServices.toFixed(2),\" | Paid: $\",account.totalPaid.toFixed(2)]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-xl font-bold text-amber-600\",children:[\"$\",account.balance.toFixed(2)]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setPaymentToMark({invoiceKey:\"ar-\".concat(account.id),customerId:account.id,customerName:account.name,amount:account.balance});setPaymentMethod({method:'electronic',checkNumber:'',source:''});setShowPaymentMethodModal(true);},className:\"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 text-sm\",children:\"Mark Paid\"})]})]},account.id))}):/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500 text-center py-8\",children:\"No outstanding balances! \\uD83C\\uDF89\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-xl p-6 shadow-lg\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-bold text-gray-800 mb-4\",children:\"Quick Actions\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 md:grid-cols-4 gap-3\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>{setActiveTab('customers');setShowAddCustomer(true);},className:\"p-4 bg-blue-50 rounded-xl hover:bg-blue-100 transition-all text-center\",children:[/*#__PURE__*/_jsx(Icons.Plus,{}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm font-medium text-gray-700 mt-2\",children:\"Add Customer\"})]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setActiveTab('routes'),className:\"p-4 bg-green-50 rounded-xl hover:bg-green-100 transition-all text-center\",children:[/*#__PURE__*/_jsx(Icons.Map,{}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm font-medium text-gray-700 mt-2\",children:\"Plan Route\"})]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>{setActiveTab('jobs');setShowAddJob(true);},className:\"p-4 bg-purple-50 rounded-xl hover:bg-purple-100 transition-all text-center\",children:[/*#__PURE__*/_jsx(Icons.Wrench,{}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm font-medium text-gray-700 mt-2\",children:\"Add Job\"})]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setActiveTab('calendar'),className:\"p-4 bg-cyan-50 rounded-xl hover:bg-cyan-100 transition-all text-center\",children:[/*#__PURE__*/_jsx(Icons.Calendar,{}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm font-medium text-gray-700 mt-2\",children:\"Calendar\"})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-xl p-6 shadow-lg\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-bold text-gray-800 mb-4\",children:\"Upcoming Jobs\"}),oneTimeJobs.length>0?/*#__PURE__*/_jsx(\"div\",{className:\"space-y-3\",children:oneTimeJobs.slice(0,5).map(job=>/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between p-4 bg-gray-50 rounded-lg\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"font-bold\",children:job.customerName}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm text-gray-500\",children:[job.jobType,\" \\u2022 \",(()=>{const[y,m,d]=job.date.split('-').map(Number);return new Date(y,m-1,d).toLocaleDateString();})()]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"font-bold text-green-600\",children:[\"$\",job.price]})]},job.id))}):/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500 text-center py-8\",children:\"No upcoming jobs scheduled\"})]})]}),activeTab==='calendar'&&/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-xl p-6 shadow-lg\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-6\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setCalendarDate(new Date(calendarDate.getFullYear(),calendarDate.getMonth()-1)),className:\"p-2 hover:bg-gray-100 rounded-lg\",children:/*#__PURE__*/_jsx(Icons.ChevronLeft,{})}),/*#__PURE__*/_jsxs(\"h2\",{className:\"text-2xl font-bold text-gray-800\",children:[monthNames[calendarDate.getMonth()],\" \",calendarDate.getFullYear()]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setCalendarDate(new Date(calendarDate.getFullYear(),calendarDate.getMonth()+1)),className:\"p-2 hover:bg-gray-100 rounded-lg\",children:/*#__PURE__*/_jsx(Icons.ChevronRight,{})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-7 gap-1\",children:[['Sun','Mon','Tue','Wed','Thu','Fri','Sat'].map(day=>/*#__PURE__*/_jsx(\"div\",{className:\"p-2 text-center text-sm font-bold text-gray-500\",children:day},day)),(()=>{const{year,month,firstDay,daysInMonth}=getDaysInMonth(calendarDate);const days=[];// Empty cells for days before the 1st\nfor(let i=0;i<firstDay;i++){days.push(/*#__PURE__*/_jsx(\"div\",{className:\"p-2 h-24\"},\"empty-\".concat(i)));}// Days of the month\nfor(let day=1;day<=daysInMonth;day++){const dateStr=\"\".concat(year,\"-\").concat(String(month+1).padStart(2,'0'),\"-\").concat(String(day).padStart(2,'0'));const events=getEventsForDate(dateStr);const isToday=dateStr===getLocalDateString();const isSelected=dateStr===selectedDate;const hasEvents=events.jobs.length>0||events.recurring.length>0||events.completed.length>0;days.push(/*#__PURE__*/_jsxs(\"div\",{onClick:()=>setSelectedDate(dateStr),className:\"p-2 h-24 border rounded-lg cursor-pointer transition-all overflow-hidden \".concat(isSelected?'border-blue-500 bg-blue-50':'border-gray-200 hover:border-blue-300',\" \").concat(isToday?'bg-cyan-50':''),children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-sm font-bold mb-1 \".concat(isToday?'text-cyan-600':'text-gray-700'),children:day}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-0.5\",children:[events.jobs.slice(0,2).map(job=>/*#__PURE__*/_jsx(\"div\",{className:\"text-xs bg-purple-100 text-purple-700 px-1 rounded truncate\",children:job.jobType},job.id)),events.recurring.slice(0,2).map(r=>{const customer=customers.find(c=>c.id===r.customerId);return customer?/*#__PURE__*/_jsx(\"div\",{className:\"text-xs bg-blue-100 text-blue-700 px-1 rounded truncate\",children:customer.name},r.id):null;}),events.completed.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"text-xs bg-green-100 text-green-700 px-1 rounded\",children:[\"\\u2713 \",events.completed.length,\" done\"]}),hasEvents&&events.jobs.length+events.recurring.length>2&&/*#__PURE__*/_jsxs(\"div\",{className:\"text-xs text-gray-500\",children:[\"+\",events.jobs.length+events.recurring.length-2,\" more\"]})]})]},day));}return days;})()]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-xl p-6 shadow-lg\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-bold text-gray-800 mb-4\",children:new Date(selectedDate).toLocaleDateString('en-US',{weekday:'long',month:'long',day:'numeric',year:'numeric'})}),(()=>{const events=getEventsForDate(selectedDate);const hasAny=events.jobs.length>0||events.recurring.length>0||events.completed.length>0;if(!hasAny){return/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500 text-center py-8\",children:\"No events scheduled for this day\"});}return/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[events.jobs.length>0&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h4\",{className:\"text-sm font-bold text-purple-700 mb-2\",children:\"ONE-TIME JOBS\"}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-2\",children:events.jobs.map(job=>/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between p-3 bg-purple-50 rounded-lg\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-xs font-bold text-purple-700 bg-purple-200 px-2 py-0.5 rounded mr-2\",children:job.jobType.toUpperCase()}),/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:job.customerName})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"font-bold text-green-600\",children:[\"$\",job.price]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>completeJob(job),className:\"px-3 py-1 bg-green-600 text-white rounded text-sm hover:bg-green-700\",children:\"Complete\"})]})]},job.id))})]}),events.recurring.length>0&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h4\",{className:\"text-sm font-bold text-blue-700 mb-2\",children:\"RECURRING SERVICES\"}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-2\",children:events.recurring.map(r=>{const customer=customers.find(c=>c.id===r.customerId);if(!customer)return null;return/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between p-3 bg-blue-50 rounded-lg\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-xs font-bold text-blue-700 bg-blue-200 px-2 py-0.5 rounded mr-2\",children:r.frequency.toUpperCase()}),/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:customer.name}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm text-gray-500 ml-2\",children:customer.address})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"font-bold text-green-600\",children:[\"$\",customer.weeklyRate]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>completeService(customer),className:\"px-3 py-1 bg-green-600 text-white rounded text-sm hover:bg-green-700\",children:\"Complete\"})]})]},r.id);})})]}),events.completed.length>0&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h4\",{className:\"text-sm font-bold text-green-700 mb-2\",children:\"COMPLETED\"}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-2\",children:events.completed.map(s=>/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between p-3 bg-green-50 rounded-lg\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-xs font-bold text-green-700 bg-green-200 px-2 py-0.5 rounded mr-2\",children:\"\\u2713 DONE\"}),/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:s.customerName})]}),/*#__PURE__*/_jsxs(\"span\",{className:\"font-bold text-green-600\",children:[\"$\",s.totalAmount.toFixed(2)]})]},s.id))})]})]});})()]})]}),activeTab==='routes'&&/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-xl p-4 shadow-lg\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>changeRouteDate(-1),className:\"flex items-center gap-2 px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg transition-all\",children:[/*#__PURE__*/_jsx(Icons.ChevronLeft,{}),\"Previous Day\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-2xl font-bold text-gray-800\",children:formatRouteDate(routeDate)}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-gray-500\",children:(()=>{const[y,m,d]=routeDate.split('-').map(Number);return new Date(y,m-1,d).toLocaleDateString('en-US',{weekday:'long',month:'long',day:'numeric',year:'numeric'});})()}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",value:routeDate,onChange:e=>setRouteDate(e.target.value),className:\"mt-2 px-3 py-1 border rounded-lg text-sm\"})]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>changeRouteDate(1),className:\"flex items-center gap-2 px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg transition-all\",children:[\"Next Day\",/*#__PURE__*/_jsx(Icons.ChevronRight,{})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-4 pt-4 border-t flex items-center justify-between flex-wrap gap-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"text-sm font-medium text-gray-700\",children:\"Filter by Employee:\"}),/*#__PURE__*/_jsxs(\"select\",{value:selectedRouteEmployee,onChange:e=>setSelectedRouteEmployee(e.target.value),className:\"px-3 py-2 border rounded-lg text-sm\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"all\",children:\"All Employees\"}),/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Unassigned\"}),employees.map(emp=>/*#__PURE__*/_jsx(\"option\",{value:emp.id,children:emp.name},emp.id))]}),selectedRouteEmployee!=='all'&&/*#__PURE__*/_jsx(\"button\",{onClick:()=>setSelectedRouteEmployee('all'),className:\"text-sm text-blue-600 hover:underline\",children:\"Show All\"})]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setShowEmployeeManager(true),className:\"flex items-center gap-2 px-4 py-2 bg-indigo-100 text-indigo-700 rounded-lg hover:bg-indigo-200 transition-all\",children:[/*#__PURE__*/_jsx(Icons.Users,{}),\"Manage Employees\"]})]}),routeDate!==getLocalDateString()&&/*#__PURE__*/_jsx(\"div\",{className:\"mt-3 text-center\",children:/*#__PURE__*/_jsx(\"button\",{onClick:()=>setRouteDate(getLocalDateString()),className:\"text-sm text-blue-600 hover:text-blue-800 underline\",children:\"Jump to Today\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 lg:grid-cols-2 gap-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-xl p-6 shadow-lg\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-bold text-gray-800 mb-2\",children:\"Add Extra Customers\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-500 mb-4\",children:\"Recurring customers are auto-added. Check others to add to today's route.\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2 max-h-96 overflow-y-auto\",children:[customers.map(customer=>{var _routeCustomers$find;const isScheduled=routeCustomers.some(c=>c.id===customer.id&&(c.recurringId||c.isOneTimeJob));const isInRoute=routeCustomers.some(c=>c.id===customer.id);return/*#__PURE__*/_jsxs(\"label\",{className:\"flex items-center gap-3 p-3 rounded-lg cursor-pointer transition-all \".concat(isScheduled?'bg-blue-50 border-l-4 border-blue-500':'hover:bg-gray-50'),children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:isInRoute,onChange:()=>toggleRouteCustomer(customer),className:\"w-5 h-5 rounded\",disabled:isScheduled}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"font-medium flex items-center gap-2\",children:[customer.name,isScheduled&&/*#__PURE__*/_jsx(\"span\",{className:\"text-xs bg-blue-200 text-blue-800 px-2 py-0.5 rounded\",children:(_routeCustomers$find=routeCustomers.find(c=>c.id===customer.id))!==null&&_routeCustomers$find!==void 0&&_routeCustomers$find.isOneTimeJob?'Job Scheduled':'Recurring'})]}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-gray-500\",children:customer.address}),customer.gateCode&&/*#__PURE__*/_jsxs(\"div\",{className:\"text-xs text-blue-600\",children:[\"Gate: \",customer.gateCode]}),customer.dogName&&/*#__PURE__*/_jsxs(\"div\",{className:\"text-xs text-amber-600\",children:[\"\\uD83D\\uDC15 \",customer.dogName]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"font-bold text-green-600\",children:[\"$\",customer.weeklyRate]})]},customer.id);}),customers.length===0&&/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500 text-center py-8\",children:\"No customers yet. Add some first!\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-xl p-6 shadow-lg\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"h2\",{className:\"text-xl font-bold text-gray-800\",children:[\"Route for \",formatRouteDate(routeDate)]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-gray-500\",children:[routeCustomers.length,\" stops\"]})]}),routeCustomers.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-2\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setShowMap(!showMap),className:\"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-all\",children:[/*#__PURE__*/_jsx(Icons.Map,{}),showMap?'Hide Map':'Show Map']}),/*#__PURE__*/_jsxs(\"a\",{href:getGoogleMapsRouteUrl(),target:\"_blank\",rel:\"noopener noreferrer\",className:\"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-all\",children:[/*#__PURE__*/_jsx(Icons.Navigation,{}),\"Navigate\"]})]})]}),showMap&&routeCustomers.length>0&&/*#__PURE__*/_jsx(\"div\",{className:\"mb-4 rounded-lg overflow-hidden border-2 border-gray-200\",children:/*#__PURE__*/_jsx(\"iframe\",{src:getEmbedMapUrl(),width:\"100%\",height:\"300\",style:{border:0},allowFullScreen:true,loading:\"lazy\",referrerPolicy:\"no-referrer-when-downgrade\"})}),routeCustomers.length>0?/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2\",children:[routeCustomers.map((customer,idx)=>{const employee=customer.employeeId?employees.find(e=>e.id===customer.employeeId):null;const employeeColor=employee?employeeColors[employees.indexOf(employee)%employeeColors.length]:null;return/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3 p-3 rounded-lg \".concat(customer.recurringId?'bg-blue-50':customer.isOneTimeJob?'bg-purple-50':'bg-gray-50'),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col gap-1\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>moveInRoute(idx,-1),disabled:idx===0,className:\"text-gray-400 hover:text-gray-600 disabled:opacity-30\",children:\"\\u25B2\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>moveInRoute(idx,1),disabled:idx===routeCustomers.length-1,className:\"text-gray-400 hover:text-gray-600 disabled:opacity-30\",children:\"\\u25BC\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"w-8 h-8 rounded-full flex items-center justify-center text-white font-bold\",style:{background:customer.isOneTimeJob?'#7c3aed':'#1e3a5f'},children:idx+1}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"font-medium flex items-center gap-2 flex-wrap\",children:[customer.name,customer.scheduledTime&&/*#__PURE__*/_jsxs(\"span\",{className:\"text-xs bg-amber-100 text-amber-800 px-2 py-0.5 rounded font-bold\",children:[\"\\uD83D\\uDD50 \",customer.scheduledTime]}),customer.recurringId&&/*#__PURE__*/_jsx(\"span\",{className:\"text-xs bg-blue-200 text-blue-800 px-2 py-0.5 rounded capitalize\",children:customer.frequency}),customer.isOneTimeJob&&/*#__PURE__*/_jsx(\"span\",{className:\"text-xs bg-purple-200 text-purple-800 px-2 py-0.5 rounded\",children:customer.jobType}),employee&&/*#__PURE__*/_jsx(\"span\",{className:\"text-xs px-2 py-0.5 rounded\",style:{backgroundColor:employeeColor===null||employeeColor===void 0?void 0:employeeColor.bg,color:employeeColor===null||employeeColor===void 0?void 0:employeeColor.text},children:employee.name})]}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-gray-500\",children:customer.address}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2 mt-1 flex-wrap\",children:[customer.gateCode&&/*#__PURE__*/_jsxs(\"span\",{className:\"text-xs text-blue-600\",children:[\"Gate: \",customer.gateCode]}),customer.dogName&&/*#__PURE__*/_jsxs(\"span\",{className:\"text-xs text-amber-600\",children:[\"\\uD83D\\uDC15 \",customer.dogName]}),(customer.recurringId||customer.isOneTimeJob)&&employees.length>0&&/*#__PURE__*/_jsxs(\"select\",{value:customer.employeeId||'',onChange:e=>{const newEmployeeId=e.target.value?parseInt(e.target.value):null;if(customer.isOneTimeJob){updateJob(customer.jobId,{employeeId:newEmployeeId});}else if(customer.recurringId){updateRecurringService(customer.recurringId,{employeeId:newEmployeeId});}},className:\"text-xs px-2 py-1 border rounded bg-white\",title:\"Assign to employee\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Unassigned\"}),employees.map(emp=>/*#__PURE__*/_jsx(\"option\",{value:emp.id,children:emp.name},emp.id))]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"font-bold text-green-600\",children:[\"$\",customer.isOneTimeJob?customer.jobPrice:customer.weeklyRate]}),customer.isOneTimeJob?/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:e=>{e.preventDefault();e.stopPropagation();console.log('JOB Complete clicked',customer);const job=customer.jobData||oneTimeJobs.find(j=>j.id===customer.jobId)||oneTimeJobs.find(j=>String(j.customerId)===String(customer.id)&&j.date===routeDate);console.log('Found job:',job);if(job){setJobToComplete(job);setJobCompletionItems([]);setJobChemicals([]);setJobCompletionNotes('');setShowCompleteJobModal(true);}else{alert('Job not found. oneTimeJobs count: '+oneTimeJobs.length);}},className:\"px-3 py-1 bg-purple-600 text-white text-sm rounded-lg hover:bg-purple-700\",children:\"Complete Job\"}):/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:e=>{e.preventDefault();e.stopPropagation();console.log('SERVICE Complete clicked',customer);completeService(customer);},className:\"px-3 py-1 bg-green-600 text-white text-sm rounded-lg hover:bg-green-700\",children:\"Complete\"}),!customer.recurringId&&!customer.isOneTimeJob&&/*#__PURE__*/_jsx(\"button\",{onClick:()=>toggleRouteCustomer(customer),className:\"text-red-500 hover:text-red-700\",children:/*#__PURE__*/_jsx(Icons.X,{})})]},\"\".concat(customer.id,\"-\").concat(customer.isOneTimeJob?'job':'recurring',\"-\").concat(idx));}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-4 p-4 bg-blue-50 rounded-lg border-2 border-blue-200\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-lg font-bold text-gray-800\",children:[\"Route Total: $\",routeCustomers.reduce((sum,c)=>sum+(c.isOneTimeJob?c.jobPrice:c.weeklyRate),0)]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm text-gray-600\",children:[routeCustomers.filter(c=>c.recurringId).length,\" recurring \\u2022 \",routeCustomers.filter(c=>c.isOneTimeJob).length,\" jobs \\u2022 \",routeCustomers.filter(c=>!c.recurringId&&!c.isOneTimeJob).length,\" extra\"]})]})})]}):/*#__PURE__*/_jsxs(\"div\",{className:\"text-center py-8\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"text-gray-500 mb-2\",children:[\"No customers scheduled for \",formatRouteDate(routeDate)]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-400\",children:\"Add recurring services or one-time jobs to populate routes automatically\"})]})]})]})]}),activeTab==='customers'&&/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center\",children:[/*#__PURE__*/_jsxs(\"h2\",{className:\"text-xl font-bold text-gray-800\",children:[\"Customers (\",customers.length,\")\"]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setShowAddCustomer(true),className:\"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-all\",children:[/*#__PURE__*/_jsx(Icons.Plus,{}),\"Add Customer\"]})]}),showAddCustomer&&/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-xl p-6 w-full max-w-lg max-h-[90vh] overflow-y-auto\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-4\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-bold\",children:\"Add New Customer\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowAddCustomer(false),className:\"text-gray-500 hover:text-gray-700\",children:/*#__PURE__*/_jsx(Icons.X,{})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Name *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:newCustomer.name,onChange:e=>setNewCustomer(_objectSpread(_objectSpread({},newCustomer),{},{name:e.target.value})),className:\"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500\",placeholder:\"John Smith\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Address *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:newCustomer.address,onChange:e=>setNewCustomer(_objectSpread(_objectSpread({},newCustomer),{},{address:e.target.value})),className:\"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500\",placeholder:\"123 Main St, City, State\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Phone\"}),/*#__PURE__*/_jsx(\"input\",{type:\"tel\",value:newCustomer.phone,onChange:e=>setNewCustomer(_objectSpread(_objectSpread({},newCustomer),{},{phone:e.target.value})),className:\"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500\",placeholder:\"(555) 123-4567\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Email\"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",value:newCustomer.email,onChange:e=>setNewCustomer(_objectSpread(_objectSpread({},newCustomer),{},{email:e.target.value})),className:\"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500\",placeholder:\"john@email.com\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Pool Type\"}),/*#__PURE__*/_jsxs(\"select\",{value:newCustomer.poolType,onChange:e=>setNewCustomer(_objectSpread(_objectSpread({},newCustomer),{},{poolType:e.target.value})),className:\"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"inground\",children:\"Inground\"}),/*#__PURE__*/_jsx(\"option\",{value:\"above-ground\",children:\"Above Ground\"}),/*#__PURE__*/_jsx(\"option\",{value:\"saltwater\",children:\"Saltwater\"}),/*#__PURE__*/_jsx(\"option\",{value:\"hot-tub\",children:\"Hot Tub\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Weekly Rate ($)\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",value:newCustomer.weeklyRate,onChange:e=>setNewCustomer(_objectSpread(_objectSpread({},newCustomer),{},{weeklyRate:parseInt(e.target.value)||0})),className:\"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Gate Code\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:newCustomer.gateCode,onChange:e=>setNewCustomer(_objectSpread(_objectSpread({},newCustomer),{},{gateCode:e.target.value})),className:\"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500\",placeholder:\"#1234\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Dog's Name\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:newCustomer.dogName,onChange:e=>setNewCustomer(_objectSpread(_objectSpread({},newCustomer),{},{dogName:e.target.value})),className:\"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500\",placeholder:\"Buddy\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Notes\"}),/*#__PURE__*/_jsx(\"textarea\",{value:newCustomer.notes,onChange:e=>setNewCustomer(_objectSpread(_objectSpread({},newCustomer),{},{notes:e.target.value})),className:\"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500\",rows:\"2\",placeholder:\"Any special instructions...\"})]}),/*#__PURE__*/_jsx(\"button\",{onClick:addCustomer,className:\"w-full py-3 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition-all\",children:\"Add Customer\"})]})]})}),editingCustomer&&/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-xl p-6 w-full max-w-lg max-h-[90vh] overflow-y-auto\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-4\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-bold\",children:\"Edit Customer\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setEditingCustomer(null),className:\"text-gray-500 hover:text-gray-700\",children:/*#__PURE__*/_jsx(Icons.X,{})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Name\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:editingCustomer.name,onChange:e=>setEditingCustomer(_objectSpread(_objectSpread({},editingCustomer),{},{name:e.target.value})),className:\"w-full px-4 py-2 border rounded-lg\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Address\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:editingCustomer.address,onChange:e=>setEditingCustomer(_objectSpread(_objectSpread({},editingCustomer),{},{address:e.target.value})),className:\"w-full px-4 py-2 border rounded-lg\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Phone\"}),/*#__PURE__*/_jsx(\"input\",{type:\"tel\",value:editingCustomer.phone||'',onChange:e=>setEditingCustomer(_objectSpread(_objectSpread({},editingCustomer),{},{phone:e.target.value})),className:\"w-full px-4 py-2 border rounded-lg\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Email\"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",value:editingCustomer.email||'',onChange:e=>setEditingCustomer(_objectSpread(_objectSpread({},editingCustomer),{},{email:e.target.value})),className:\"w-full px-4 py-2 border rounded-lg\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Pool Type\"}),/*#__PURE__*/_jsxs(\"select\",{value:editingCustomer.poolType,onChange:e=>setEditingCustomer(_objectSpread(_objectSpread({},editingCustomer),{},{poolType:e.target.value})),className:\"w-full px-4 py-2 border rounded-lg\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"inground\",children:\"Inground\"}),/*#__PURE__*/_jsx(\"option\",{value:\"above-ground\",children:\"Above Ground\"}),/*#__PURE__*/_jsx(\"option\",{value:\"saltwater\",children:\"Saltwater\"}),/*#__PURE__*/_jsx(\"option\",{value:\"hot-tub\",children:\"Hot Tub\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Weekly Rate ($)\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",value:editingCustomer.weeklyRate,onChange:e=>setEditingCustomer(_objectSpread(_objectSpread({},editingCustomer),{},{weeklyRate:parseInt(e.target.value)||0})),className:\"w-full px-4 py-2 border rounded-lg\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Gate Code\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:editingCustomer.gateCode||'',onChange:e=>setEditingCustomer(_objectSpread(_objectSpread({},editingCustomer),{},{gateCode:e.target.value})),className:\"w-full px-4 py-2 border rounded-lg\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Dog's Name\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:editingCustomer.dogName||'',onChange:e=>setEditingCustomer(_objectSpread(_objectSpread({},editingCustomer),{},{dogName:e.target.value})),className:\"w-full px-4 py-2 border rounded-lg\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Notes\"}),/*#__PURE__*/_jsx(\"textarea\",{value:editingCustomer.notes||'',onChange:e=>setEditingCustomer(_objectSpread(_objectSpread({},editingCustomer),{},{notes:e.target.value})),className:\"w-full px-4 py-2 border rounded-lg\",rows:\"2\"})]}),/*#__PURE__*/_jsx(\"button\",{onClick:updateCustomer,className:\"w-full py-3 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700\",children:\"Update Customer\"})]})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 gap-4\",children:customers.map(customer=>/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-xl p-5 shadow-lg border-l-4\",style:{borderColor:'#0ea5e9'},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-start mb-3\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-bold text-gray-800\",children:customer.name}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-gray-500 flex items-center gap-1\",children:[/*#__PURE__*/_jsx(Icons.MapPin,{}),customer.address]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-xl font-black text-green-600\",children:[\"$\",customer.weeklyRate,\"/wk\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 gap-2 text-sm mb-3\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-500\",children:\"Pool:\"}),\" \",customer.poolType]}),customer.phone&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-500\",children:\"Phone:\"}),\" \",customer.phone]}),customer.gateCode&&/*#__PURE__*/_jsxs(\"div\",{className:\"text-blue-600\",children:[\"\\uD83D\\uDD11 Gate: \",customer.gateCode]}),customer.dogName&&/*#__PURE__*/_jsxs(\"div\",{className:\"text-amber-600\",children:[\"\\uD83D\\uDC15 \",customer.dogName]})]}),customer.notes&&/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600 italic mb-3\",children:customer.notes}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-2\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setEditingCustomer(customer),className:\"flex-1 py-2 bg-blue-100 text-blue-700 rounded-lg hover:bg-blue-200 transition-all text-sm font-medium\",children:\"Edit\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>completeService(customer),className:\"flex-1 py-2 bg-green-100 text-green-700 rounded-lg hover:bg-green-200 transition-all text-sm font-medium\",children:\"Log Service\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>deleteCustomer(customer.id),className:\"px-3 py-2 bg-red-100 text-red-700 rounded-lg hover:bg-red-200 transition-all\",children:/*#__PURE__*/_jsx(Icons.Trash,{})})]})]},customer.id))}),customers.length===0&&/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-xl p-12 shadow-lg text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-6xl mb-4\",children:\"\\uD83C\\uDFCA\"}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-bold text-gray-800 mb-2\",children:\"No customers yet\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500 mb-4\",children:\"Add your first customer to get started!\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowAddCustomer(true),className:\"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-all\",children:\"Add First Customer\"})]})]}),activeTab==='recurring'&&/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-xl p-6 shadow-lg\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-bold text-gray-800 mb-4\",children:\"Set Up Recurring Service\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-3 gap-4 items-end\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Customer\"}),/*#__PURE__*/_jsxs(\"select\",{id:\"recurringCustomer\",className:\"w-full px-4 py-2 border rounded-lg\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select customer...\"}),customers.filter(c=>!recurringServices.find(r=>r.customerId===c.id&&r.active)).map(c=>/*#__PURE__*/_jsx(\"option\",{value:c.id,children:c.name},c.id))]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Frequency\"}),/*#__PURE__*/_jsxs(\"select\",{id:\"recurringFrequency\",className:\"w-full px-4 py-2 border rounded-lg\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"weekly\",children:\"Weekly\"}),/*#__PURE__*/_jsx(\"option\",{value:\"biweekly\",children:\"Bi-Weekly\"}),/*#__PURE__*/_jsx(\"option\",{value:\"monthly\",children:\"Monthly\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Day of Week\"}),/*#__PURE__*/_jsxs(\"select\",{id:\"recurringDay\",className:\"w-full px-4 py-2 border rounded-lg\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"1\",children:\"Monday\"}),/*#__PURE__*/_jsx(\"option\",{value:\"2\",children:\"Tuesday\"}),/*#__PURE__*/_jsx(\"option\",{value:\"3\",children:\"Wednesday\"}),/*#__PURE__*/_jsx(\"option\",{value:\"4\",children:\"Thursday\"}),/*#__PURE__*/_jsx(\"option\",{value:\"5\",children:\"Friday\"}),/*#__PURE__*/_jsx(\"option\",{value:\"6\",children:\"Saturday\"}),/*#__PURE__*/_jsx(\"option\",{value:\"0\",children:\"Sunday\"})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-3 gap-4 items-end mt-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Start Date\"}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",id:\"recurringStart\",defaultValue:getLocalDateString(),className:\"w-full px-4 py-2 border rounded-lg\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:[\"Scheduled Time \",/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-400 font-normal\",children:\"(optional)\"})]}),/*#__PURE__*/_jsx(\"input\",{type:\"time\",id:\"recurringTime\",className:\"w-full px-4 py-2 border rounded-lg\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:[\"Assign To \",/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-400 font-normal\",children:\"(optional)\"})]}),/*#__PURE__*/_jsxs(\"select\",{id:\"recurringEmployee\",className:\"w-full px-4 py-2 border rounded-lg\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Unassigned\"}),employees.map(emp=>/*#__PURE__*/_jsx(\"option\",{value:emp.id,children:emp.name},emp.id))]})]})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{const customerId=parseInt(document.getElementById('recurringCustomer').value);const frequency=document.getElementById('recurringFrequency').value;const dayOfWeek=document.getElementById('recurringDay').value;const startDate=document.getElementById('recurringStart').value;const scheduledTime=document.getElementById('recurringTime').value||null;const employeeId=document.getElementById('recurringEmployee').value||null;if(customerId){addRecurringService(customerId,frequency,dayOfWeek,startDate,scheduledTime,employeeId);document.getElementById('recurringCustomer').value='';document.getElementById('recurringTime').value='';document.getElementById('recurringEmployee').value='';}},className:\"mt-4 px-6 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700\",children:\"Add Recurring Service\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-xl p-6 shadow-lg\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-bold text-gray-800 mb-4\",children:\"Active Recurring Schedules\"}),recurringServices.filter(r=>r.active).length>0?/*#__PURE__*/_jsx(\"div\",{className:\"space-y-3\",children:recurringServices.filter(r=>r.active).map(recurring=>{const customer=customers.find(c=>c.id===recurring.customerId);const employee=recurring.employeeId?employees.find(e=>e.id===recurring.employeeId):null;const employeeColor=employee?employeeColors[employees.indexOf(employee)%employeeColors.length]:null;const dayNames=['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'];return/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between p-4 bg-purple-50 rounded-lg border-l-4 border-purple-500\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"font-bold text-gray-800 flex items-center gap-2 flex-wrap\",children:[recurring.customerName,recurring.scheduledTime&&/*#__PURE__*/_jsxs(\"span\",{className:\"text-xs bg-amber-100 text-amber-800 px-2 py-0.5 rounded font-bold\",children:[\"\\uD83D\\uDD50 \",recurring.scheduledTime]}),employee&&/*#__PURE__*/_jsx(\"span\",{className:\"text-xs px-2 py-0.5 rounded\",style:{backgroundColor:employeeColor===null||employeeColor===void 0?void 0:employeeColor.bg,color:employeeColor===null||employeeColor===void 0?void 0:employeeColor.text},children:employee.name})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm text-gray-600\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-medium text-purple-700 capitalize\",children:recurring.frequency}),' on ',dayNames[recurring.dayOfWeek||1],/*#__PURE__*/_jsx(\"span\",{className:\"mx-2\",children:\"\\u2022\"}),\"Started: \",new Date(recurring.startDate).toLocaleDateString()]}),customer&&/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm text-green-600 font-medium\",children:[\"$\",customer.weeklyRate,\"/visit\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2 mt-2 flex-wrap\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"time\",value:recurring.scheduledTime||'',onChange:e=>updateRecurringService(recurring.id,{scheduledTime:e.target.value||null}),className:\"text-xs px-2 py-1 border rounded\",title:\"Set appointment time\"}),/*#__PURE__*/_jsxs(\"select\",{value:recurring.employeeId||'',onChange:e=>updateRecurringService(recurring.id,{employeeId:e.target.value?parseInt(e.target.value):null}),className:\"text-xs px-2 py-1 border rounded bg-white\",title:\"Assign to employee\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Unassigned\"}),employees.map(emp=>/*#__PURE__*/_jsx(\"option\",{value:emp.id,children:emp.name},emp.id))]})]})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>deleteRecurringService(recurring.id),className:\"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 ml-3\",children:\"Cancel\"})]},recurring.id);})}):/*#__PURE__*/_jsxs(\"div\",{className:\"text-center py-12 text-gray-500\",children:[/*#__PURE__*/_jsx(Icons.Calendar,{}),/*#__PURE__*/_jsx(\"p\",{className:\"mt-2\",children:\"No recurring services set up yet\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm\",children:\"Add customers to recurring schedules above\"})]})]})]}),activeTab==='quotes'&&/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-bold text-gray-800\",children:\"Quotes\"}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setShowCreateQuote(true),className:\"flex items-center gap-2 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700\",children:[/*#__PURE__*/_jsx(Icons.Plus,{}),\"Create Quote\"]})]}),showCreateQuote&&/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-xl p-6 w-full max-w-4xl max-h-[90vh] overflow-y-auto\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-4\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-bold\",children:editingQuoteId?'Edit Quote':'Create Quote'}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setShowCreateQuote(false);setEditingQuoteId(null);setCurrentQuote({customerId:'',items:[],notes:'',validDays:30});},className:\"text-gray-500 hover:text-gray-700\",children:/*#__PURE__*/_jsx(Icons.X,{})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Customer\"}),/*#__PURE__*/_jsx(CustomerSelect,{value:currentQuote.customerId,onChange:val=>setCurrentQuote(_objectSpread(_objectSpread({},currentQuote),{},{customerId:val})),placeholder:\"Search customer...\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Valid For (Days)\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",value:currentQuote.validDays,onChange:e=>setCurrentQuote(_objectSpread(_objectSpread({},currentQuote),{},{validDays:parseInt(e.target.value)||30})),className:\"w-full px-4 py-2 border rounded-lg\"})]})]}),savedQuoteItems.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"bg-purple-50 p-4 rounded-lg\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-2\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"font-medium text-purple-800\",children:\"\\uD83D\\uDCCB Saved Items (click to add to quote)\"}),/*#__PURE__*/_jsx(\"div\",{className:\"flex gap-2\",children:/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setShowSavedItems(!showSavedItems),className:\"text-sm text-purple-600 hover:underline\",children:[showSavedItems?'Hide':'Show',\" (\",savedQuoteItems.length,\")\"]})})]}),showSavedItems&&/*#__PURE__*/_jsx(\"div\",{className:\"space-y-2 mt-2\",children:savedQuoteItems.map((item,idx)=>/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between bg-white p-2 rounded-lg border border-purple-200\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>{setCurrentQuote(_objectSpread(_objectSpread({},currentQuote),{},{items:[...currentQuote.items,_objectSpread(_objectSpread({},item),{},{id:Date.now()})]}));},className:\"flex-1 text-left hover:text-purple-700\",title:\"Click to add to quote\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-xs bg-purple-100 px-2 py-0.5 rounded mr-2\",children:item.type}),/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:item.description}),item.modelNumber&&/*#__PURE__*/_jsxs(\"span\",{className:\"text-xs text-gray-500 ml-2\",children:[\"#\",item.modelNumber]}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-green-600 ml-2\",children:[\"$\",item.price]})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{if(confirm(\"Remove \\\"\".concat(item.description,\"\\\" from saved items?\"))){saveSavedQuoteItems(savedQuoteItems.filter((_,i)=>i!==idx));}},className:\"text-red-500 hover:text-red-700 p-1 ml-2\",title:\"Remove saved item\",children:/*#__PURE__*/_jsx(Icons.X,{})})]},idx))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gray-50 p-4 rounded-lg\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"font-medium mb-3\",children:\"Add New Line Item\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-6 gap-3\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-xs text-gray-500 mb-1\",children:\"Type\"}),/*#__PURE__*/_jsxs(\"select\",{value:newLineItem.type,onChange:e=>setNewLineItem(_objectSpread(_objectSpread({},newLineItem),{},{type:e.target.value})),className:\"w-full px-3 py-2 border rounded-lg\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"labor\",children:\"Labor\"}),/*#__PURE__*/_jsx(\"option\",{value:\"part\",children:\"Part/Equipment\"}),/*#__PURE__*/_jsx(\"option\",{value:\"chemical\",children:\"Chemical\"}),/*#__PURE__*/_jsx(\"option\",{value:\"other\",children:\"Other\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-span-2\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-xs text-gray-500 mb-1\",children:\"Description\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"e.g., Pool Pump Installation\",value:newLineItem.description,onChange:e=>setNewLineItem(_objectSpread(_objectSpread({},newLineItem),{},{description:e.target.value})),className:\"w-full px-3 py-2 border rounded-lg\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-xs text-gray-500 mb-1\",children:\"Model/Part #\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"e.g., SP2610X15\",value:newLineItem.modelNumber,onChange:e=>setNewLineItem(_objectSpread(_objectSpread({},newLineItem),{},{modelNumber:e.target.value})),className:\"w-full px-3 py-2 border rounded-lg\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-xs text-gray-500 mb-1\",children:\"Qty\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",min:\"1\",value:newLineItem.quantity,onChange:e=>setNewLineItem(_objectSpread(_objectSpread({},newLineItem),{},{quantity:parseInt(e.target.value)||1})),className:\"w-full px-3 py-2 border rounded-lg\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-xs text-gray-500 mb-1\",children:\"Price ($)\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",min:\"0\",step:\"0.01\",value:newLineItem.price,onChange:e=>setNewLineItem(_objectSpread(_objectSpread({},newLineItem),{},{price:parseFloat(e.target.value)||0})),className:\"w-full px-3 py-2 border rounded-lg\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-2 mt-3\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>addLineItem(currentQuote,setCurrentQuote),disabled:!newLineItem.description||newLineItem.price<=0,className:\"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-300\",children:\"Add to Quote\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{if(newLineItem.description&&newLineItem.price>0){const itemToSave=_objectSpread({},newLineItem);if(!savedQuoteItems.find(i=>i.description===itemToSave.description&&i.modelNumber===itemToSave.modelNumber)){saveSavedQuoteItems([...savedQuoteItems,itemToSave]);showEmailNotification('success','Item saved for future quotes');}}},disabled:!newLineItem.description||newLineItem.price<=0,className:\"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:bg-gray-300\",children:\"\\uD83D\\uDCBE Save Item\"})]})]}),currentQuote.items.length>0&&/*#__PURE__*/_jsx(\"div\",{className:\"border rounded-lg overflow-hidden\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"w-full\",children:[/*#__PURE__*/_jsx(\"thead\",{className:\"bg-gray-50\",children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-2 text-left text-sm font-medium\",children:\"Description\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-2 text-left text-sm font-medium\",children:\"Qty\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-2 text-left text-sm font-medium\",children:\"Price\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-2 text-left text-sm font-medium\",children:\"Total\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-2\"})]})}),/*#__PURE__*/_jsxs(\"tbody\",{children:[currentQuote.items.map(item=>/*#__PURE__*/_jsxs(\"tr\",{className:\"border-t\",children:[/*#__PURE__*/_jsxs(\"td\",{className:\"px-4 py-2\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-xs bg-gray-200 px-2 py-0.5 rounded mr-2\",children:item.type}),item.description,item.modelNumber&&/*#__PURE__*/_jsxs(\"div\",{className:\"text-xs text-gray-500\",children:[\"Part #: \",item.modelNumber]})]}),/*#__PURE__*/_jsx(\"td\",{className:\"px-4 py-2\",children:item.quantity}),/*#__PURE__*/_jsxs(\"td\",{className:\"px-4 py-2\",children:[\"$\",item.price.toFixed(2)]}),/*#__PURE__*/_jsxs(\"td\",{className:\"px-4 py-2 font-medium\",children:[\"$\",(item.quantity*item.price).toFixed(2)]}),/*#__PURE__*/_jsx(\"td\",{className:\"px-4 py-2\",children:/*#__PURE__*/_jsx(\"button\",{onClick:()=>removeLineItem(currentQuote,setCurrentQuote,item.id),className:\"text-red-500 hover:text-red-700\",children:/*#__PURE__*/_jsx(Icons.X,{})})})]},item.id)),/*#__PURE__*/_jsxs(\"tr\",{className:\"border-t bg-purple-50\",children:[/*#__PURE__*/_jsx(\"td\",{colSpan:\"3\",className:\"px-4 py-2 font-bold text-right\",children:\"Quote Total:\"}),/*#__PURE__*/_jsxs(\"td\",{colSpan:\"2\",className:\"px-4 py-2 font-bold text-purple-700\",children:[\"$\",currentQuote.items.reduce((sum,i)=>sum+i.quantity*i.price,0).toFixed(2)]})]})]})]})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Notes\"}),/*#__PURE__*/_jsx(\"textarea\",{value:currentQuote.notes,onChange:e=>setCurrentQuote(_objectSpread(_objectSpread({},currentQuote),{},{notes:e.target.value})),className:\"w-full px-4 py-2 border rounded-lg\",rows:\"2\",placeholder:\"Any additional notes for the customer...\"})]}),/*#__PURE__*/_jsx(\"button\",{onClick:generateQuote,disabled:!currentQuote.customerId||currentQuote.items.length===0,className:\"w-full py-3 bg-purple-600 text-white rounded-lg font-medium hover:bg-purple-700 disabled:bg-gray-300\",children:editingQuoteId?' Update Quote':' Generate Quote'})]})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-xl p-6 shadow-lg\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-bold text-gray-800 mb-4\",children:\"Pending Quotes\"}),quotes.filter(q=>q.status==='pending').length>0?/*#__PURE__*/_jsx(\"div\",{className:\"space-y-3\",children:quotes.filter(q=>q.status==='pending').map(quote=>{const customer=customers.find(c=>c.id===quote.customerId);return/*#__PURE__*/_jsxs(\"div\",{className:\"p-4 bg-amber-50 rounded-lg border-l-4 border-amber-500\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-start\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"font-bold\",children:quote.customerName}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-gray-500\",children:quote.quoteNumber}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-xs text-gray-400\",children:[\"Valid until: \",new Date(quote.validUntil).toLocaleDateString()]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-xl font-bold text-amber-600\",children:[\"$\",quote.total.toFixed(2)]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-2 mt-3\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>downloadQuotePdf(quote),className:\"flex-1 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 text-sm\",children:\"\\uD83D\\uDCC4 PDF\"}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>{if(customer!==null&&customer!==void 0&&customer.email){sendQuoteEmail(quote,customer);}else{alert('Customer has no email address');}},disabled:!(customer!==null&&customer!==void 0&&customer.email)||isSendingEmail,className:\"flex-1 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 text-sm disabled:bg-gray-300\",children:[isSendingEmail?'':'',\" Email\"]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setCurrentQuote(_objectSpread(_objectSpread({},quote),{},{customerId:quote.customerId,validDays:Math.ceil((new Date(quote.validUntil)-new Date())/(1000*60*60*24))}));setEditingQuoteId(quote.id);setShowCreateQuote(true);},className:\"flex-1 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 text-sm\",children:\"\\u270F\\uFE0F Edit\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-2 mt-2\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>convertQuoteToJob(quote),className:\"flex-1 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 text-sm\",children:\"\\u2713 Approve \\u2192 Job\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>convertQuoteToInvoice(quote),className:\"flex-1 py-2 text-white rounded-lg hover:opacity-90 text-sm\",style:{backgroundColor:'#1e3a5f'},children:\"\\u2713 Approve \\u2192 Invoice\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{if(confirm('Delete this quote?')){saveQuotes(quotes.filter(q=>q.id!==quote.id));}},className:\"px-3 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 text-sm\",children:\"\\uD83D\\uDDD1\\uFE0F\"})]})]},quote.id);})}):/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500 text-center py-8\",children:\"No pending quotes\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-xl p-6 shadow-lg\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-bold text-gray-800 mb-4\",children:\"Quote History\"}),quotes.filter(q=>q.status!=='pending').length>0?/*#__PURE__*/_jsx(\"div\",{className:\"space-y-3\",children:quotes.filter(q=>q.status!=='pending').map(quote=>/*#__PURE__*/_jsxs(\"div\",{className:\"p-4 rounded-lg border-l-4 \".concat(quote.status==='approved'?'bg-green-50 border-green-500':quote.status==='invoiced'?'bg-blue-50 border-blue-500':'bg-red-50 border-red-500'),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-start\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"font-bold\",children:quote.customerName}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-gray-500\",children:quote.quoteNumber}),/*#__PURE__*/_jsx(\"span\",{className:\"text-xs px-2 py-0.5 rounded \".concat(quote.status==='approved'?'bg-green-200 text-green-800':quote.status==='invoiced'?'bg-blue-200 text-blue-800':'bg-red-200 text-red-800'),children:quote.status.toUpperCase()})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-lg font-bold text-gray-600\",children:[\"$\",quote.total.toFixed(2)]})]}),quote.status==='approved'&&/*#__PURE__*/_jsx(\"button\",{onClick:()=>convertQuoteToInvoice(quote),className:\"mt-3 w-full py-2 text-white rounded-lg text-sm\",style:{backgroundColor:'#1e3a5f'},children:\"Convert to Invoice\"})]},quote.id))}):/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500 text-center py-8\",children:\"No quote history\"})]})]})]}),activeTab==='jobs'&&/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-bold text-gray-800\",children:\"One-Time Jobs\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-2\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setShowWearItemsSettings(true),className:\"flex items-center gap-2 px-4 py-2 bg-amber-100 text-amber-800 rounded-lg hover:bg-amber-200 transition-all border border-amber-300\",children:[/*#__PURE__*/_jsx(Icons.Wrench,{}),\"Quick Add Items\"]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setShowAddJob(true),className:\"flex items-center gap-2 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-all\",children:[/*#__PURE__*/_jsx(Icons.Plus,{}),\"Add Job\"]})]})]}),showWearItemsSettings&&/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-xl p-6 w-full max-w-lg max-h-[90vh] overflow-y-auto\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-4\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-bold text-gray-800\",children:\"\\u2699\\uFE0F Common Wear Items\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowWearItemsSettings(false),className:\"text-gray-500 hover:text-gray-700\",children:/*#__PURE__*/_jsx(Icons.X,{})})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600 mb-4\",children:\"Save common parts and wear items here. They'll be available to quickly add when completing jobs.\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gray-50 p-4 rounded-lg mb-4\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"font-medium text-gray-700 mb-3\",children:\"Add New Item\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 gap-3\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Item name (e.g., O-ring)\",value:newWearItem.name,onChange:e=>setNewWearItem(_objectSpread(_objectSpread({},newWearItem),{},{name:e.target.value})),className:\"px-3 py-2 border rounded-lg\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",step:\"0.01\",placeholder:\"Price ($)\",value:newWearItem.price||'',onChange:e=>setNewWearItem(_objectSpread(_objectSpread({},newWearItem),{},{price:parseFloat(e.target.value)||0})),className:\"px-3 py-2 border rounded-lg\"})]}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Description (optional)\",value:newWearItem.description,onChange:e=>setNewWearItem(_objectSpread(_objectSpread({},newWearItem),{},{description:e.target.value})),className:\"w-full px-3 py-2 border rounded-lg\"}),/*#__PURE__*/_jsx(\"button\",{onClick:addWearItem,disabled:!newWearItem.name||newWearItem.price<=0,className:\"w-full py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:bg-gray-300\",children:\"Add Item\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"h4\",{className:\"font-medium text-gray-700 mb-3\",children:[\"Saved Items (\",wearItems.length,\")\"]}),wearItems.length>0?/*#__PURE__*/_jsx(\"div\",{className:\"space-y-2\",children:wearItems.map(item=>/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between p-3 bg-white border rounded-lg\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"font-medium text-gray-800\",children:item.name}),item.description&&/*#__PURE__*/_jsx(\"div\",{className:\"text-xs text-gray-500\",children:item.description})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"font-bold text-green-600\",children:[\"$\",item.price.toFixed(2)]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>deleteWearItem(item.id),className:\"text-red-500 hover:text-red-700\",children:/*#__PURE__*/_jsx(Icons.Trash,{})})]})]},item.id))}):/*#__PURE__*/_jsx(\"p\",{className:\"text-center text-gray-500 py-4\",children:\"No wear items saved yet\"})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowWearItemsSettings(false),className:\"w-full mt-4 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300\",children:\"Done\"})]})}),showAddJob&&/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-xl p-6 w-full max-w-md\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-4\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-bold\",children:\"Schedule Job\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowAddJob(false),className:\"text-gray-500 hover:text-gray-700\",children:/*#__PURE__*/_jsx(Icons.X,{})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Customer\"}),/*#__PURE__*/_jsx(CustomerSelect,{value:newJob.customerId,onChange:val=>setNewJob(_objectSpread(_objectSpread({},newJob),{},{customerId:val})),placeholder:\"Search customer...\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Job Type\"}),/*#__PURE__*/_jsxs(\"select\",{value:newJob.jobType,onChange:e=>setNewJob(_objectSpread(_objectSpread({},newJob),{},{jobType:e.target.value})),className:\"w-full px-4 py-2 border rounded-lg\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"opening\",children:\"Pool Opening\"}),/*#__PURE__*/_jsx(\"option\",{value:\"closing\",children:\"Pool Closing\"}),/*#__PURE__*/_jsx(\"option\",{value:\"repair\",children:\"Repair\"}),/*#__PURE__*/_jsx(\"option\",{value:\"green-to-clean\",children:\"Green to Clean\"}),/*#__PURE__*/_jsx(\"option\",{value:\"equipment\",children:\"Equipment Install\"}),/*#__PURE__*/_jsx(\"option\",{value:\"other\",children:\"Other\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Date\"}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",value:newJob.date,onChange:e=>setNewJob(_objectSpread(_objectSpread({},newJob),{},{date:e.target.value})),className:\"w-full px-4 py-2 border rounded-lg\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:[\"Time \",/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-400 font-normal\",children:\"(optional)\"})]}),/*#__PURE__*/_jsx(\"input\",{type:\"time\",value:newJob.scheduledTime||'',onChange:e=>setNewJob(_objectSpread(_objectSpread({},newJob),{},{scheduledTime:e.target.value||null})),className:\"w-full px-4 py-2 border rounded-lg\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Price ($)\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",value:newJob.price,onChange:e=>setNewJob(_objectSpread(_objectSpread({},newJob),{},{price:parseInt(e.target.value)||0})),className:\"w-full px-4 py-2 border rounded-lg\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:[\"Assign To \",/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-400 font-normal\",children:\"(optional)\"})]}),/*#__PURE__*/_jsxs(\"select\",{value:newJob.employeeId||'',onChange:e=>setNewJob(_objectSpread(_objectSpread({},newJob),{},{employeeId:e.target.value?parseInt(e.target.value):null})),className:\"w-full px-4 py-2 border rounded-lg\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Unassigned\"}),employees.map(emp=>/*#__PURE__*/_jsx(\"option\",{value:emp.id,children:emp.name},emp.id))]})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Notes\"}),/*#__PURE__*/_jsx(\"textarea\",{value:newJob.notes,onChange:e=>setNewJob(_objectSpread(_objectSpread({},newJob),{},{notes:e.target.value})),className:\"w-full px-4 py-2 border rounded-lg\",rows:\"2\"})]}),/*#__PURE__*/_jsx(\"button\",{onClick:addJob,className:\"w-full py-3 bg-purple-600 text-white rounded-lg font-medium hover:bg-purple-700\",children:\"Schedule Job\"})]})]})}),oneTimeJobs.length>0?/*#__PURE__*/_jsx(\"div\",{className:\"space-y-3\",children:oneTimeJobs.map(job=>/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-xl p-5 shadow-lg flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"font-bold text-gray-800\",children:job.customerName}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm text-gray-500\",children:[job.jobType,\" \\u2022 \",(()=>{const[y,m,d]=job.date.split('-').map(Number);return new Date(y,m-1,d).toLocaleDateString();})()]}),job.notes&&/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-gray-600 italic mt-1\",children:job.notes})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-xl font-bold text-green-600\",children:[\"$\",job.price]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>completeJob(job),className:\"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700\",children:\"Complete\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>saveJobs(oneTimeJobs.filter(j=>j.id!==job.id)),className:\"p-2 text-red-500 hover:text-red-700\",children:/*#__PURE__*/_jsx(Icons.Trash,{})})]})]},job.id))}):/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-xl p-12 shadow-lg text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-6xl mb-4\",children:\"\\uD83D\\uDD27\"}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-bold text-gray-800 mb-2\",children:\"No jobs scheduled\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500\",children:\"Schedule openings, closings, repairs, and more.\"})]})]}),activeTab==='payments'&&/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"bg-white rounded-xl p-6 shadow-lg border-l-4\",style:{borderColor:'#635bff'},children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-12 h-12 rounded-lg flex items-center justify-center\",style:{backgroundColor:'#635bff'},children:/*#__PURE__*/_jsx(\"span\",{className:\"text-white text-2xl\",children:\"\\uD83D\\uDCB3\"})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-bold text-gray-800\",children:\"Stripe Payments\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-green-600\",children:\"\\u2713 Connected (Test Mode)\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-xs text-gray-500\",children:[\"Server: \",PAYMENT_SERVER_URL]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-2\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:refreshPaymentStatuses,className:\"px-4 py-2 border rounded-lg hover:bg-gray-50 text-sm\",children:\"\\uD83D\\uDD04 Refresh Status\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowPaymentModal(true),className:\"px-6 py-3 text-white rounded-lg font-medium hover:opacity-90\",style:{backgroundColor:'#635bff'},children:\"+ Request Payment\"})]})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 gap-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-xl p-6 shadow-lg\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-bold text-gray-800 mb-4\",children:\"Quick Payment Request\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 mb-4\",children:\"Send a Stripe payment link to any customer.\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-3\",children:[/*#__PURE__*/_jsxs(\"select\",{id:\"quickPayCustomer\",className:\"w-full px-4 py-2 border rounded-lg\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select customer...\"}),customers.map(c=>/*#__PURE__*/_jsx(\"option\",{value:c.id,children:c.name},c.id))]}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",id:\"quickPayAmount\",placeholder:\"Amount ($)\",className:\"w-full px-4 py-2 border rounded-lg\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",id:\"quickPayDesc\",placeholder:\"Description (optional)\",className:\"w-full px-4 py-2 border rounded-lg\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{const customerId=document.getElementById('quickPayCustomer').value;const amount=parseFloat(document.getElementById('quickPayAmount').value)||0;const desc=document.getElementById('quickPayDesc').value;if(customerId&&amount>0){openPaymentRequest(customerId,amount,desc);}},className:\"w-full py-3 text-white rounded-lg font-medium\",style:{backgroundColor:'#635bff'},children:\"Generate Stripe Link\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-xl p-6 shadow-lg\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-bold text-gray-800 mb-4\",children:\"Payment Overview\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center p-3 bg-green-50 rounded-lg\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-600\",children:\"Paid\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-xl font-bold text-green-600\",children:[\"$\",invoices.filter(i=>i.paid).reduce((sum,i)=>sum+(i.amount||0),0).toFixed(2)]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center p-3 bg-amber-50 rounded-lg\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-600\",children:\"Pending\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-xl font-bold text-amber-600\",children:[\"$\",invoices.filter(i=>!i.paid&&i.type==='payment-request').reduce((sum,i)=>sum+(i.amount||0),0).toFixed(2)]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center p-3 bg-gray-50 rounded-lg\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-600\",children:\"Total Requests\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-xl font-bold text-gray-800\",children:invoices.filter(i=>i.type==='payment-request').length})]})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-xl p-6 shadow-lg\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-bold text-gray-800 mb-4\",children:\"Pending Payment Requests\"}),invoices.filter(i=>i.type==='payment-request'&&!i.paid).length>0?/*#__PURE__*/_jsx(\"div\",{className:\"space-y-3\",children:invoices.filter(i=>i.type==='payment-request'&&!i.paid).map(inv=>/*#__PURE__*/_jsxs(\"div\",{className:\"p-4 bg-amber-50 rounded-lg border-l-4 border-amber-500\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-2\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"font-bold text-gray-800\",children:inv.customerName}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm text-gray-500\",children:[inv.invoiceNumber,\" \\u2022 \",new Date(inv.createdDate).toLocaleDateString()]}),inv.description&&/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-gray-600\",children:inv.description})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-xl font-bold text-amber-600\",children:[\"$\",inv.amount.toFixed(2)]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-2 mt-3\",children:[inv.paymentUrl&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>window.open(inv.paymentUrl,'_blank'),className:\"flex-1 py-2 text-white rounded-lg text-sm\",style:{backgroundColor:'#635bff'},children:\"Open Payment Link\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{navigator.clipboard.writeText(inv.paymentUrl);alert('Payment link copied!');},className:\"px-4 py-2 border rounded-lg text-sm hover:bg-gray-50\",children:\"\\uD83D\\uDCCB Copy\"})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>markPaymentReceived(inv.id),className:\"px-4 py-2 bg-green-600 text-white rounded-lg text-sm hover:bg-green-700\",children:\"\\u2713 Mark Paid\"})]})]},inv.id))}):/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500 text-center py-8\",children:\"No pending payment requests\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-xl p-6 shadow-lg\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-bold text-gray-800 mb-4\",children:\"Payment History\"}),invoices.filter(i=>i.type==='payment-request'&&i.paid).length>0?/*#__PURE__*/_jsx(\"div\",{className:\"space-y-3\",children:invoices.filter(i=>i.type==='payment-request'&&i.paid).map(inv=>/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between p-4 bg-green-50 rounded-lg border-l-4 border-green-500\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"font-bold text-gray-800\",children:inv.customerName}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm text-gray-500\",children:[inv.invoiceNumber,\" \\u2022 Paid \",new Date(inv.paidDate).toLocaleDateString()]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-xl font-bold text-green-600\",children:[\"$\",inv.amount.toFixed(2)]})]},inv.id))}):/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500 text-center py-8\",children:\"No payment history yet\"})]})]}),showPaymentModal&&/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-xl p-6 w-full max-w-md\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-4\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-bold\",style:{color:'#635bff'},children:\"\\uD83D\\uDCB3 Request Payment\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setShowPaymentModal(false);setPaymentError('');},className:\"text-gray-500 hover:text-gray-700\",children:/*#__PURE__*/_jsx(Icons.X,{})})]}),paymentError&&/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm\",children:[\"\\u26A0\\uFE0F \",paymentError]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Customer\"}),/*#__PURE__*/_jsxs(\"select\",{value:paymentDetails.customerId,onChange:e=>setPaymentDetails(_objectSpread(_objectSpread({},paymentDetails),{},{customerId:e.target.value})),className:\"w-full px-4 py-2 border rounded-lg\",disabled:isProcessingPayment,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select customer...\"}),customers.map(c=>/*#__PURE__*/_jsxs(\"option\",{value:c.id,children:[c.name,\" \",c.email?\"(\".concat(c.email,\")\"):'']},c.id))]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Amount ($)\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",step:\"0.01\",value:paymentDetails.amount||'',onChange:e=>setPaymentDetails(_objectSpread(_objectSpread({},paymentDetails),{},{amount:parseFloat(e.target.value)||0})),className:\"w-full px-4 py-3 border-2 rounded-lg text-2xl font-bold text-center\",style:{borderColor:'#635bff'},placeholder:\"0.00\",disabled:isProcessingPayment})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Description (optional)\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:paymentDetails.description,onChange:e=>setPaymentDetails(_objectSpread(_objectSpread({},paymentDetails),{},{description:e.target.value})),className:\"w-full px-4 py-2 border rounded-lg\",placeholder:\"e.g., Monthly pool service - January\",disabled:isProcessingPayment})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gray-50 p-4 rounded-lg\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-gray-600 mb-2\",children:\"Payment will be processed via:\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-2xl\",children:\"\\uD83D\\uDCB3\"}),/*#__PURE__*/_jsx(\"span\",{className:\"font-bold\",style:{color:'#635bff'},children:\"Stripe Checkout\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-xs bg-green-100 text-green-700 px-2 py-0.5 rounded\",children:\"Secure\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"text-xs text-gray-500 mt-2\",children:\"Creates a real Stripe payment link your customer can use to pay instantly.\"})]}),/*#__PURE__*/_jsx(\"button\",{onClick:sendPaymentRequest,disabled:!paymentDetails.customerId||paymentDetails.amount<=0||isProcessingPayment,className:\"w-full py-3 text-white rounded-lg font-medium disabled:bg-gray-300 flex items-center justify-center gap-2\",style:{backgroundColor:paymentDetails.customerId&&paymentDetails.amount>0&&!isProcessingPayment?'#635bff':undefined},children:isProcessingPayment?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"svg\",{className:\"animate-spin h-5 w-5 text-white\",xmlns:\"http://www.w3.org/2000/svg\",fill:\"none\",viewBox:\"0 0 24 24\",children:[/*#__PURE__*/_jsx(\"circle\",{className:\"opacity-25\",cx:\"12\",cy:\"12\",r:\"10\",stroke:\"currentColor\",strokeWidth:\"4\"}),/*#__PURE__*/_jsx(\"path\",{className:\"opacity-75\",fill:\"currentColor\",d:\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"})]}),\"Creating Payment Link...\"]}):'Generate Stripe Payment Link'}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-500 text-center\",children:\"A real Stripe Checkout link will be created. You can open it or copy it to send to your customer.\"})]})]})}),showCompleteServiceModal&&serviceToComplete&&/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-xl p-6 w-full max-w-lg max-h-[90vh] overflow-y-auto\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-4\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-bold text-green-700\",children:\"\\u2713 Complete Service\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setShowCompleteServiceModal(false);setServiceToComplete(null);setServiceChemicals([]);setServiceWaterTest({chlorine:'',ph:'',alkalinity:'',cya:'',hardness:'',phosphates:'',notes:''});},className:\"text-gray-500 hover:text-gray-700\",children:/*#__PURE__*/_jsx(Icons.X,{})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gray-50 p-4 rounded-lg mb-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"font-bold text-lg\",children:serviceToComplete.name}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-gray-500\",children:serviceToComplete.address}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-gray-600 mt-1\",children:serviceToComplete.poolType&&/*#__PURE__*/_jsxs(\"span\",{className:\"capitalize\",children:[serviceToComplete.poolType,\" Pool\"]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center p-3 bg-blue-50 rounded-lg mb-4\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:\"Service Rate:\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-xl font-bold text-blue-700\",children:[\"$\",(serviceToComplete.isOneTimeJob?serviceToComplete.jobPrice:serviceToComplete.weeklyRate).toFixed(2)]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"font-bold text-gray-700 mb-2\",children:\"\\uD83D\\uDCA7 Water Test Results\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-cyan-50 p-3 rounded-lg\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-3 gap-3 mb-3\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-xs text-gray-600 mb-1\",children:\"Chlorine (ppm)\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",step:\"0.1\",placeholder:\"0-10\",value:serviceWaterTest.chlorine,onChange:e=>setServiceWaterTest(_objectSpread(_objectSpread({},serviceWaterTest),{},{chlorine:e.target.value})),className:\"w-full px-2 py-1 border rounded text-center text-sm\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-xs text-gray-600 mb-1\",children:\"pH\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",step:\"0.1\",placeholder:\"6.8-8.0\",value:serviceWaterTest.ph,onChange:e=>setServiceWaterTest(_objectSpread(_objectSpread({},serviceWaterTest),{},{ph:e.target.value})),className:\"w-full px-2 py-1 border rounded text-center text-sm\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-xs text-gray-600 mb-1\",children:\"Alkalinity\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",placeholder:\"80-120\",value:serviceWaterTest.alkalinity,onChange:e=>setServiceWaterTest(_objectSpread(_objectSpread({},serviceWaterTest),{},{alkalinity:e.target.value})),className:\"w-full px-2 py-1 border rounded text-center text-sm\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-xs text-gray-600 mb-1\",children:\"CYA\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",placeholder:\"30-50\",value:serviceWaterTest.cya,onChange:e=>setServiceWaterTest(_objectSpread(_objectSpread({},serviceWaterTest),{},{cya:e.target.value})),className:\"w-full px-2 py-1 border rounded text-center text-sm\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-xs text-gray-600 mb-1\",children:\"Hardness\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",placeholder:\"200-400\",value:serviceWaterTest.hardness,onChange:e=>setServiceWaterTest(_objectSpread(_objectSpread({},serviceWaterTest),{},{hardness:e.target.value})),className:\"w-full px-2 py-1 border rounded text-center text-sm\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-xs text-gray-600 mb-1\",children:\"Phosphates (ppb)\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",placeholder:\"0-500\",value:serviceWaterTest.phosphates,onChange:e=>setServiceWaterTest(_objectSpread(_objectSpread({},serviceWaterTest),{},{phosphates:e.target.value})),className:\"w-full px-2 py-1 border rounded text-center text-sm\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-xs text-gray-600 mb-1\",children:\"Service Notes\"}),/*#__PURE__*/_jsx(\"textarea\",{placeholder:\"Pool condition, issues noticed, work performed...\",value:serviceWaterTest.notes,onChange:e=>setServiceWaterTest(_objectSpread(_objectSpread({},serviceWaterTest),{},{notes:e.target.value})),className:\"w-full px-2 py-1 border rounded text-sm\",rows:\"2\"})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"font-bold text-gray-700 mb-2\",children:\"Add Chemicals Used\"}),chemicalInventory.length>0?/*#__PURE__*/_jsx(\"div\",{className:\"space-y-2\",children:chemicalInventory.map(chem=>/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3 p-3 bg-gray-50 rounded-lg\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"font-medium\",children:chem.name}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-xs text-gray-500\",children:[\"$\",chem.costPerUnit.toFixed(2),\"/\",chem.unit,\" \\u2022 \",chem.quantity,\" \",chem.unit,\" in stock\"]})]}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",min:\"0\",max:chem.quantity,step:\"0.1\",placeholder:\"Qty\",className:\"w-20 px-2 py-1 border rounded text-center\",id:\"chem-qty-\".concat(chem.id)}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{const input=document.getElementById(\"chem-qty-\".concat(chem.id));const qty=parseFloat(input.value)||0;if(qty>0&&qty<=chem.quantity){addChemicalToService(chem,qty);input.value='';}},className:\"px-3 py-1 bg-teal-600 text-white rounded hover:bg-teal-700 text-sm\",children:\"Add\"})]},chem.id))}):/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500 text-sm p-3 bg-gray-50 rounded-lg\",children:\"No chemicals in inventory. Add chemicals in the Chemicals tab.\"})]}),serviceChemicals.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"font-bold text-gray-700 mb-2\",children:\"Chemicals for This Service\"}),/*#__PURE__*/_jsx(\"div\",{className:\"border rounded-lg overflow-hidden\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"w-full\",children:[/*#__PURE__*/_jsx(\"thead\",{className:\"bg-teal-50\",children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{className:\"px-3 py-2 text-left text-sm\",children:\"Chemical\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-3 py-2 text-left text-sm\",children:\"Qty\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-3 py-2 text-left text-sm\",children:\"Cost\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-3 py-2\"})]})}),/*#__PURE__*/_jsxs(\"tbody\",{children:[serviceChemicals.map(chem=>/*#__PURE__*/_jsxs(\"tr\",{className:\"border-t\",children:[/*#__PURE__*/_jsx(\"td\",{className:\"px-3 py-2 text-sm\",children:chem.name}),/*#__PURE__*/_jsxs(\"td\",{className:\"px-3 py-2 text-sm\",children:[chem.quantityUsed,\" \",chem.unit]}),/*#__PURE__*/_jsxs(\"td\",{className:\"px-3 py-2 text-sm font-medium\",children:[\"$\",(chem.quantityUsed*chem.costPerUnit).toFixed(2)]}),/*#__PURE__*/_jsx(\"td\",{className:\"px-3 py-2\",children:/*#__PURE__*/_jsx(\"button\",{onClick:()=>removeChemicalFromService(chem.id),className:\"text-red-500 hover:text-red-700\",children:/*#__PURE__*/_jsx(Icons.X,{})})})]},chem.id)),/*#__PURE__*/_jsxs(\"tr\",{className:\"border-t bg-teal-50\",children:[/*#__PURE__*/_jsx(\"td\",{colSpan:\"2\",className:\"px-3 py-2 font-bold text-right\",children:\"Chemical Total:\"}),/*#__PURE__*/_jsxs(\"td\",{colSpan:\"2\",className:\"px-3 py-2 font-bold text-teal-700\",children:[\"$\",serviceChemicals.reduce((sum,c)=>sum+c.quantityUsed*c.costPerUnit,0).toFixed(2)]})]})]})]})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-green-50 p-4 rounded-lg mb-4 border-2 border-green-200\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-gray-600\",children:\"Service Rate\"}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-gray-600\",children:\"Chemicals\"}),/*#__PURE__*/_jsx(\"div\",{className:\"font-bold text-lg mt-1\",children:\"Total\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-right\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm\",children:[\"$\",(serviceToComplete.isOneTimeJob?serviceToComplete.jobPrice:serviceToComplete.weeklyRate).toFixed(2)]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm\",children:[\"$\",serviceChemicals.reduce((sum,c)=>sum+c.quantityUsed*c.costPerUnit,0).toFixed(2)]}),/*#__PURE__*/_jsxs(\"div\",{className:\"font-bold text-xl text-green-700\",children:[\"$\",((serviceToComplete.isOneTimeJob?serviceToComplete.jobPrice:serviceToComplete.weeklyRate)+serviceChemicals.reduce((sum,c)=>sum+c.quantityUsed*c.costPerUnit,0)).toFixed(2)]})]})]})}),(serviceToComplete===null||serviceToComplete===void 0?void 0:serviceToComplete.email)&&/*#__PURE__*/_jsx(\"div\",{className:\"mb-4 p-3 bg-green-50 rounded-lg\",children:/*#__PURE__*/_jsxs(\"label\",{className:\"flex items-center gap-3 cursor-pointer\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:sendEmailOnComplete,onChange:e=>setSendEmailOnComplete(e.target.checked),className:\"w-5 h-5 text-green-600 rounded\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-medium text-green-800\",children:\"\\uD83D\\uDCE7 Send service report email\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-xs text-green-600\",children:[\"Will send to: \",serviceToComplete.email]})]})]})}),serviceToComplete&&!serviceToComplete.email&&/*#__PURE__*/_jsx(\"div\",{className:\"mb-4 p-3 bg-amber-50 rounded-lg text-sm text-amber-700\",children:\"\\u26A0\\uFE0F No email on file for this customer. Add their email in the Customers tab to enable service reports.\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-3\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setShowCompleteServiceModal(false);setServiceToComplete(null);setServiceChemicals([]);setServiceWaterTest({chlorine:'',ph:'',alkalinity:'',cya:'',hardness:'',phosphates:'',notes:''});},className:\"flex-1 py-3 border-2 border-gray-300 text-gray-700 rounded-lg font-medium hover:bg-gray-50\",children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{onClick:completeServiceWithChemicals,disabled:isSendingEmail,className:\"flex-1 py-3 bg-green-600 text-white rounded-lg font-medium hover:bg-green-700 disabled:bg-green-400\",children:isSendingEmail?' Sending...':' Complete Service'})]})]})}),activeTab==='chemicals'&&/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-xl p-6 shadow-lg\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-4\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-bold text-gray-800\",children:\"Chemical Usage Tracking\"}),/*#__PURE__*/_jsx(\"div\",{className:\"flex bg-gray-100 rounded-lg p-1\",children:['weekly','monthly','annual'].map(scale=>/*#__PURE__*/_jsx(\"button\",{onClick:()=>setChemicalChartScale(scale),className:\"px-4 py-2 rounded-lg text-sm font-medium transition-all \".concat(chemicalChartScale===scale?'bg-teal-600 text-white shadow':'text-gray-600 hover:bg-gray-200'),children:scale.charAt(0).toUpperCase()+scale.slice(1)},scale))})]}),(()=>{const{data,chemicals}=getChemicalUsageData(chemicalChartScale);if(chemicals.length===0){return/*#__PURE__*/_jsxs(\"div\",{className:\"text-center py-12 text-gray-500\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-4xl mb-3\",children:\"\\uD83D\\uDCCA\"}),/*#__PURE__*/_jsx(\"p\",{children:\"No chemical usage data yet.\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm\",children:\"Complete services with chemicals to see usage trends.\"})]});}return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(ResponsiveContainer,{width:\"100%\",height:300,children:/*#__PURE__*/_jsxs(BarChart,{data:data,children:[/*#__PURE__*/_jsx(CartesianGrid,{strokeDasharray:\"3 3\",stroke:\"#e5e7eb\"}),/*#__PURE__*/_jsx(XAxis,{dataKey:\"period\",stroke:\"#6b7280\",fontSize:12}),/*#__PURE__*/_jsx(YAxis,{stroke:\"#6b7280\",fontSize:12}),/*#__PURE__*/_jsx(Tooltip,{content:_ref5=>{let{active,payload,label}=_ref5;if(active&&payload&&payload.length){var _payload$3,_payload$3$payload;return/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white p-3 rounded-lg shadow-lg border\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-bold text-gray-800 mb-2\",children:((_payload$3=payload[0])===null||_payload$3===void 0?void 0:(_payload$3$payload=_payload$3.payload)===null||_payload$3$payload===void 0?void 0:_payload$3$payload.fullPeriod)||label}),payload.map((entry,idx)=>{var _serviceHistory$find,_serviceHistory$find$,_serviceHistory$find$2;return/*#__PURE__*/_jsxs(\"p\",{style:{color:entry.color},className:\"text-sm\",children:[entry.name,\": \",entry.value.toFixed(1),\" \",((_serviceHistory$find=serviceHistory.find(s=>{var _s$chemicalsUsed;return(_s$chemicalsUsed=s.chemicalsUsed)===null||_s$chemicalsUsed===void 0?void 0:_s$chemicalsUsed.find(c=>c.name===entry.name);}))===null||_serviceHistory$find===void 0?void 0:(_serviceHistory$find$=_serviceHistory$find.chemicalsUsed)===null||_serviceHistory$find$===void 0?void 0:(_serviceHistory$find$2=_serviceHistory$find$.find(c=>c.name===entry.name))===null||_serviceHistory$find$2===void 0?void 0:_serviceHistory$find$2.unit)||'units']},idx);})]});}return null;}}),chemicals.map((chem,idx)=>/*#__PURE__*/_jsx(Bar,{dataKey:chem,fill:chemicalColors[idx%chemicalColors.length],name:chem,radius:[4,4,0,0]},chem))]})}),/*#__PURE__*/_jsx(\"div\",{className:\"flex flex-wrap gap-4 justify-center mt-4\",children:chemicals.map((chem,idx)=>/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-4 h-4 rounded\",style:{backgroundColor:chemicalColors[idx%chemicalColors.length]}}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm text-gray-700\",children:chem})]},chem))})]});})()]}),getChemicalUsageSummary().length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-xl p-6 shadow-lg\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-bold text-gray-800 mb-4\",children:\"Monthly Usage Summary\"}),/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\",children:getChemicalUsageSummary().map(chem=>{const trend=chem.lastMonth>0?((chem.thisMonth-chem.lastMonth)/chem.lastMonth*100).toFixed(0):chem.thisMonth>0?'+100':'0';const trendUp=parseFloat(trend)>0;const trendDown=parseFloat(trend)<0;return/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gray-50 p-4 rounded-lg\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"font-bold text-gray-800 mb-2\",children:chem.name}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 gap-2 text-sm\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-gray-500\",children:\"This Month\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-lg font-bold text-teal-600\",children:[chem.thisMonth.toFixed(1),\" \",chem.unit]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-gray-500\",children:\"Last Month\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-lg font-bold text-gray-600\",children:[chem.lastMonth.toFixed(1),\" \",chem.unit]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-2 text-sm font-medium \".concat(trendUp?'text-amber-600':trendDown?'text-green-600':'text-gray-500'),children:[trendUp?'':trendDown?'':'',\" \",Math.abs(parseFloat(trend)),\"% vs last month\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-xs text-gray-400 mt-1\",children:[\"All-time: \",chem.total.toFixed(1),\" \",chem.unit]})]},chem.name);})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-bold text-gray-800\",children:\"Chemical Inventory\"}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setShowAddChemical(true),className:\"flex items-center gap-2 px-4 py-2 bg-teal-600 text-white rounded-lg hover:bg-teal-700 transition-all\",children:[/*#__PURE__*/_jsx(Icons.Plus,{}),\"Add Chemical\"]})]}),showAddChemical&&/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-xl p-6 w-full max-w-md\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-4\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-bold\",children:\"Add Chemical\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowAddChemical(false),className:\"text-gray-500 hover:text-gray-700\",children:/*#__PURE__*/_jsx(Icons.X,{})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Chemical Name\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:newChemical.name,onChange:e=>setNewChemical(_objectSpread(_objectSpread({},newChemical),{},{name:e.target.value})),className:\"w-full px-4 py-2 border rounded-lg\",placeholder:\"Chlorine tablets\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-3 gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Quantity\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",value:newChemical.quantity,onChange:e=>setNewChemical(_objectSpread(_objectSpread({},newChemical),{},{quantity:parseFloat(e.target.value)||0})),className:\"w-full px-4 py-2 border rounded-lg\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Unit\"}),/*#__PURE__*/_jsxs(\"select\",{value:newChemical.unit,onChange:e=>setNewChemical(_objectSpread(_objectSpread({},newChemical),{},{unit:e.target.value})),className:\"w-full px-4 py-2 border rounded-lg\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"lbs\",children:\"lbs\"}),/*#__PURE__*/_jsx(\"option\",{value:\"gal\",children:\"gallons\"}),/*#__PURE__*/_jsx(\"option\",{value:\"oz\",children:\"oz\"}),/*#__PURE__*/_jsx(\"option\",{value:\"tablets\",children:\"tablets\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"$/Unit\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",step:\"0.01\",value:newChemical.costPerUnit,onChange:e=>setNewChemical(_objectSpread(_objectSpread({},newChemical),{},{costPerUnit:parseFloat(e.target.value)||0})),className:\"w-full px-4 py-2 border rounded-lg\"})]})]}),/*#__PURE__*/_jsx(\"button\",{onClick:addChemical,className:\"w-full py-3 bg-teal-600 text-white rounded-lg font-medium hover:bg-teal-700\",children:\"Add Chemical\"})]})]})}),chemicalInventory.length>0?/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\",children:chemicalInventory.map(chem=>/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-xl p-5 shadow-lg\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-start mb-2\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-bold text-gray-800\",children:chem.name}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-1\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setEditingChemical(_objectSpread({},chem)),className:\"text-blue-500 hover:text-blue-700 p-1\",children:/*#__PURE__*/_jsx(Icons.Edit,{})}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>deleteChemical(chem.id),className:\"text-red-500 hover:text-red-700 p-1\",children:/*#__PURE__*/_jsx(Icons.Trash,{})})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-2xl font-black mb-1 \".concat(chem.quantity<=5?'text-red-600':chem.quantity<=10?'text-amber-600':'text-teal-600'),children:[chem.quantity,\" \",chem.unit,chem.quantity<=5&&/*#__PURE__*/_jsx(\"span\",{className:\"text-sm ml-2\",children:\"\\u26A0\\uFE0F Low!\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm text-gray-500\",children:[\"$\",chem.costPerUnit.toFixed(2),\"/\",chem.unit,\" \\u2022 Value: $\",(chem.quantity*chem.costPerUnit).toFixed(2)]})]},chem.id))}):/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-xl p-12 shadow-lg text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-6xl mb-4\",children:\"\\uD83E\\uDDEA\"}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-bold text-gray-800 mb-2\",children:\"No chemicals tracked\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500\",children:\"Track your chemical inventory and costs.\"})]}),editingChemical&&/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-xl p-6 w-full max-w-md\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-4\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-bold\",children:\"Edit Chemical\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setEditingChemical(null),className:\"text-gray-500 hover:text-gray-700\",children:/*#__PURE__*/_jsx(Icons.X,{})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Chemical Name\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:editingChemical.name,onChange:e=>setEditingChemical(_objectSpread(_objectSpread({},editingChemical),{},{name:e.target.value})),className:\"w-full px-4 py-2 border rounded-lg\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-3 gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Quantity\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",step:\"0.1\",value:editingChemical.quantity,onChange:e=>setEditingChemical(_objectSpread(_objectSpread({},editingChemical),{},{quantity:parseFloat(e.target.value)||0})),className:\"w-full px-4 py-2 border rounded-lg\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Unit\"}),/*#__PURE__*/_jsxs(\"select\",{value:editingChemical.unit,onChange:e=>setEditingChemical(_objectSpread(_objectSpread({},editingChemical),{},{unit:e.target.value})),className:\"w-full px-4 py-2 border rounded-lg\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"lbs\",children:\"lbs\"}),/*#__PURE__*/_jsx(\"option\",{value:\"gal\",children:\"gallons\"}),/*#__PURE__*/_jsx(\"option\",{value:\"oz\",children:\"oz\"}),/*#__PURE__*/_jsx(\"option\",{value:\"tablets\",children:\"tablets\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"$/Unit\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",step:\"0.01\",value:editingChemical.costPerUnit,onChange:e=>setEditingChemical(_objectSpread(_objectSpread({},editingChemical),{},{costPerUnit:parseFloat(e.target.value)||0})),className:\"w-full px-4 py-2 border rounded-lg\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-teal-50 p-3 rounded-lg\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-gray-600\",children:\"Inventory Value:\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-xl font-bold text-teal-700\",children:[\"$\",(editingChemical.quantity*editingChemical.costPerUnit).toFixed(2)]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-3\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setEditingChemical(null),className:\"flex-1 py-3 border-2 border-gray-300 text-gray-700 rounded-lg font-medium hover:bg-gray-50\",children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{onClick:updateChemical,className:\"flex-1 py-3 bg-teal-600 text-white rounded-lg font-medium hover:bg-teal-700\",children:\"Save Changes\"})]})]})]})})]}),activeTab==='billing'&&/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-xl p-6 shadow-lg\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-4\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-bold text-gray-800\",children:\"Custom / Ad-Hoc Invoice\"}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setShowCustomInvoice(true),className:\"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700\",children:[/*#__PURE__*/_jsx(Icons.Plus,{}),\"Create Custom Invoice\"]})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600\",children:\"Create one-off invoices for repairs, equipment, or special services not included in monthly billing.\"})]}),showCustomInvoice&&/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-xl p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-4\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-bold\",children:\"Create Service Invoice\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowCustomInvoice(false),className:\"text-gray-500 hover:text-gray-700\",children:/*#__PURE__*/_jsx(Icons.X,{})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Customer\"}),/*#__PURE__*/_jsx(CustomerSelect,{value:customInvoice.customerId,onChange:val=>setCustomInvoice(_objectSpread(_objectSpread({},customInvoice),{},{customerId:val})),placeholder:\"Search customer...\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gray-50 p-4 rounded-lg\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"font-medium mb-3\",children:\"Add Parts & Labor\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 md:grid-cols-4 gap-3\",children:[/*#__PURE__*/_jsxs(\"select\",{value:newLineItem.type,onChange:e=>setNewLineItem(_objectSpread(_objectSpread({},newLineItem),{},{type:e.target.value})),className:\"px-3 py-2 border rounded-lg\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"labor\",children:\"Labor\"}),/*#__PURE__*/_jsx(\"option\",{value:\"part\",children:\"Part/Equipment\"}),/*#__PURE__*/_jsx(\"option\",{value:\"chemical\",children:\"Chemical\"}),/*#__PURE__*/_jsx(\"option\",{value:\"other\",children:\"Other\"})]}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",placeholder:\"Qty\",value:newLineItem.quantity,onChange:e=>setNewLineItem(_objectSpread(_objectSpread({},newLineItem),{},{quantity:parseInt(e.target.value)||1})),className:\"px-3 py-2 border rounded-lg\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",placeholder:\"Price ($)\",value:newLineItem.price||'',onChange:e=>setNewLineItem(_objectSpread(_objectSpread({},newLineItem),{},{price:parseFloat(e.target.value)||0})),className:\"px-3 py-2 border rounded-lg\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Model/Part # (optional)\",value:newLineItem.modelNumber,onChange:e=>setNewLineItem(_objectSpread(_objectSpread({},newLineItem),{},{modelNumber:e.target.value})),className:\"px-3 py-2 border rounded-lg\"})]}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Description (e.g., 'Replaced pool pump motor - Pentair WhisperFlo 1.5HP')\",value:newLineItem.description,onChange:e=>setNewLineItem(_objectSpread(_objectSpread({},newLineItem),{},{description:e.target.value})),className:\"w-full px-3 py-2 border rounded-lg\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>addLineItem(customInvoice,setCustomInvoice),className:\"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700\",children:\"Add Item\"})]})]}),customInvoice.items.length>0&&/*#__PURE__*/_jsx(\"div\",{className:\"border rounded-lg overflow-hidden\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"w-full\",children:[/*#__PURE__*/_jsx(\"thead\",{className:\"bg-gray-50\",children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-2 text-left text-sm font-medium\",children:\"Description\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-2 text-left text-sm font-medium\",children:\"Qty\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-2 text-left text-sm font-medium\",children:\"Price\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-2 text-left text-sm font-medium\",children:\"Total\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-2\"})]})}),/*#__PURE__*/_jsxs(\"tbody\",{children:[customInvoice.items.map(item=>/*#__PURE__*/_jsxs(\"tr\",{className:\"border-t\",children:[/*#__PURE__*/_jsxs(\"td\",{className:\"px-4 py-2\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-xs px-2 py-0.5 rounded mr-2 \".concat(item.type==='labor'?'bg-blue-200 text-blue-800':item.type==='part'?'bg-orange-200 text-orange-800':item.type==='chemical'?'bg-green-200 text-green-800':'bg-gray-200 text-gray-800'),children:item.type.toUpperCase()}),item.description,item.modelNumber&&/*#__PURE__*/_jsxs(\"div\",{className:\"text-xs text-gray-500 mt-1\",children:[\"Model/Part #: \",item.modelNumber]})]}),/*#__PURE__*/_jsx(\"td\",{className:\"px-4 py-2\",children:item.quantity}),/*#__PURE__*/_jsxs(\"td\",{className:\"px-4 py-2\",children:[\"$\",item.price.toFixed(2)]}),/*#__PURE__*/_jsxs(\"td\",{className:\"px-4 py-2 font-medium\",children:[\"$\",(item.quantity*item.price).toFixed(2)]}),/*#__PURE__*/_jsx(\"td\",{className:\"px-4 py-2\",children:/*#__PURE__*/_jsx(\"button\",{onClick:()=>removeLineItem(customInvoice,setCustomInvoice,item.id),className:\"text-red-500 hover:text-red-700\",children:/*#__PURE__*/_jsx(Icons.X,{})})})]},item.id)),/*#__PURE__*/_jsxs(\"tr\",{className:\"border-t bg-green-50\",children:[/*#__PURE__*/_jsx(\"td\",{colSpan:\"3\",className:\"px-4 py-3 font-bold text-right\",children:\"Invoice Total:\"}),/*#__PURE__*/_jsxs(\"td\",{colSpan:\"2\",className:\"px-4 py-3 font-bold text-green-700 text-xl\",children:[\"$\",customInvoice.items.reduce((sum,i)=>sum+i.quantity*i.price,0).toFixed(2)]})]})]})]})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Notes for Customer\"}),/*#__PURE__*/_jsx(\"textarea\",{value:customInvoice.notes,onChange:e=>setCustomInvoice(_objectSpread(_objectSpread({},customInvoice),{},{notes:e.target.value})),className:\"w-full px-4 py-2 border rounded-lg\",rows:\"2\",placeholder:\"Any additional notes (warranty info, maintenance tips, etc.)\"})]}),/*#__PURE__*/_jsx(\"button\",{onClick:generateCustomInvoice,disabled:!customInvoice.customerId||customInvoice.items.length===0,className:\"w-full py-3 bg-green-600 text-white rounded-lg font-medium hover:bg-green-700 disabled:bg-gray-300\",children:\"Generate & Email Invoice\"})]})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-xl p-6 shadow-lg\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-4 flex-wrap gap-3\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-bold text-gray-800\",children:\"Monthly Service Invoices\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-3 items-center flex-wrap\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"text-xs text-gray-500 block\",children:\"Search Customer\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"\\uD83D\\uDD0D Customer name...\",value:billingSearch,onChange:e=>setBillingSearch(e.target.value),className:\"px-3 py-2 border rounded-lg text-sm w-40\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"text-xs text-gray-500 block\",children:\"Payment Terms\"}),/*#__PURE__*/_jsxs(\"select\",{value:defaultPaymentTerms,onChange:e=>setDefaultPaymentTerms(e.target.value),className:\"px-3 py-2 border rounded-lg text-sm\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"due_receipt\",children:\"Due on Receipt\"}),/*#__PURE__*/_jsx(\"option\",{value:\"net7\",children:\"Net 7\"}),/*#__PURE__*/_jsx(\"option\",{value:\"net15\",children:\"Net 15\"}),/*#__PURE__*/_jsx(\"option\",{value:\"net30\",children:\"Net 30\"}),/*#__PURE__*/_jsx(\"option\",{value:\"net45\",children:\"Net 45\"}),/*#__PURE__*/_jsx(\"option\",{value:\"net60\",children:\"Net 60\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"text-xs text-gray-500 block\",children:\"Year\"}),/*#__PURE__*/_jsx(\"select\",{value:invoiceMonth.split('-')[0],onChange:e=>setInvoiceMonth(\"\".concat(e.target.value,\"-\").concat(invoiceMonth.split('-')[1])),className:\"px-3 py-2 border rounded-lg text-sm\",children:[...Array(5)].map((_,i)=>{const year=new Date().getFullYear()-2+i;return/*#__PURE__*/_jsx(\"option\",{value:year,children:year},year);})})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"text-xs text-gray-500 block\",children:\"Month\"}),/*#__PURE__*/_jsxs(\"select\",{value:invoiceMonth.split('-')[1],onChange:e=>setInvoiceMonth(\"\".concat(invoiceMonth.split('-')[0],\"-\").concat(e.target.value)),className:\"px-3 py-2 border rounded-lg text-sm\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"01\",children:\"January\"}),/*#__PURE__*/_jsx(\"option\",{value:\"02\",children:\"February\"}),/*#__PURE__*/_jsx(\"option\",{value:\"03\",children:\"March\"}),/*#__PURE__*/_jsx(\"option\",{value:\"04\",children:\"April\"}),/*#__PURE__*/_jsx(\"option\",{value:\"05\",children:\"May\"}),/*#__PURE__*/_jsx(\"option\",{value:\"06\",children:\"June\"}),/*#__PURE__*/_jsx(\"option\",{value:\"07\",children:\"July\"}),/*#__PURE__*/_jsx(\"option\",{value:\"08\",children:\"August\"}),/*#__PURE__*/_jsx(\"option\",{value:\"09\",children:\"September\"}),/*#__PURE__*/_jsx(\"option\",{value:\"10\",children:\"October\"}),/*#__PURE__*/_jsx(\"option\",{value:\"11\",children:\"November\"}),/*#__PURE__*/_jsx(\"option\",{value:\"12\",children:\"December\"})]})]})]})]}),/*#__PURE__*/_jsxs(\"table\",{className:\"w-full\",children:[/*#__PURE__*/_jsx(\"thead\",{className:\"bg-gray-50\",children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-3 text-left text-sm font-medium text-gray-500\",children:\"Customer\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-3 text-left text-sm font-medium text-gray-500\",children:\"Services\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-3 text-left text-sm font-medium text-gray-500\",children:\"Service $\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-3 text-left text-sm font-medium text-gray-500\",children:\"Chemicals $\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-3 text-left text-sm font-medium text-gray-500\",children:\"Total\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-3 text-right text-sm font-medium text-gray-500\",children:\"Actions\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{className:\"divide-y divide-gray-200\",children:customers.filter(customer=>!billingSearch||customer.name.toLowerCase().includes(billingSearch.toLowerCase())).map(customer=>{var _paidInvoices$invoice;const services=getMonthServices(customer.id,invoiceMonth);const serviceTotal=services.reduce((sum,s)=>sum+s.weeklyRate,0);const chemicalTotal=services.reduce((sum,s)=>sum+(s.chemicalCost||0),0);const total=services.reduce((sum,s)=>sum+s.totalAmount,0);const invoiceKey=\"\".concat(customer.id,\"-\").concat(invoiceMonth);const isPaid=(_paidInvoices$invoice=paidInvoices[invoiceKey])===null||_paidInvoices$invoice===void 0?void 0:_paidInvoices$invoice.paid;const isBilled=billedCustomers[invoiceKey];const billedInfo=billedCustomers[invoiceKey];const paymentInfo=paidInvoices[invoiceKey];// Check if overdue (billed more than 30 days ago and not paid)\nlet isOverdue=false;let daysPastDue=0;if(isBilled&&!isPaid&&billedInfo!==null&&billedInfo!==void 0&&billedInfo.billedDate){const billedDate=new Date(billedInfo.billedDate);const termsDays=billedInfo.terms==='due_receipt'?0:billedInfo.terms==='net15'?15:30;const dueDate=new Date(billedDate);dueDate.setDate(dueDate.getDate()+termsDays);const today=new Date();if(today>dueDate){isOverdue=true;daysPastDue=Math.floor((today-dueDate)/(1000*60*60*24));}}// Determine row color based on status\nlet rowClass='hover:bg-gray-50';if(isPaid){rowClass='bg-blue-50 hover:bg-blue-100';}else if(isOverdue){rowClass='bg-red-50 hover:bg-red-100';}else if(isBilled){rowClass='bg-green-50 hover:bg-green-100';}return/*#__PURE__*/_jsxs(\"tr\",{className:rowClass,children:[/*#__PURE__*/_jsxs(\"td\",{className:\"px-4 py-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2 flex-wrap\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"font-medium text-gray-800\",children:customer.name}),isPaid&&/*#__PURE__*/_jsxs(\"span\",{className:\"text-xs bg-blue-500 text-white px-2 py-0.5 rounded\",children:[\"\\u2713 Paid \",(paymentInfo===null||paymentInfo===void 0?void 0:paymentInfo.method)==='check'?\"(Check #\".concat(paymentInfo.checkNumber,\")\"):(paymentInfo===null||paymentInfo===void 0?void 0:paymentInfo.method)==='cash'?'(Cash)':(paymentInfo===null||paymentInfo===void 0?void 0:paymentInfo.method)==='electronic'?\"(\".concat(paymentInfo.source||'Card',\")\"):'']}),isOverdue&&/*#__PURE__*/_jsxs(\"span\",{className:\"text-xs bg-red-500 text-white px-2 py-0.5 rounded\",children:[\"\\u26A0\\uFE0F Overdue (\",daysPastDue,\" days)\"]}),!isPaid&&!isOverdue&&isBilled&&/*#__PURE__*/_jsx(\"span\",{className:\"text-xs bg-green-500 text-white px-2 py-0.5 rounded\",children:\"\\u2713 Billed\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-gray-500\",children:customer.address})]}),/*#__PURE__*/_jsx(\"td\",{className:\"px-4 py-4 text-gray-600\",children:services.length}),/*#__PURE__*/_jsxs(\"td\",{className:\"px-4 py-4 text-gray-600\",children:[\"$\",serviceTotal.toFixed(2)]}),/*#__PURE__*/_jsxs(\"td\",{className:\"px-4 py-4 text-teal-600\",children:[\"$\",chemicalTotal.toFixed(2)]}),/*#__PURE__*/_jsxs(\"td\",{className:\"px-4 py-4 font-bold text-green-600\",children:[\"$\",total.toFixed(2)]}),/*#__PURE__*/_jsx(\"td\",{className:\"px-4 py-4 text-right\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-1 justify-end flex-wrap\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>openCustomerBillingDetail(customer),disabled:services.length===0,className:\"px-2 py-1 bg-gray-100 text-gray-700 rounded hover:bg-gray-200 disabled:opacity-50 text-xs\",children:\"View\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setInvoiceTermsAction({type:'pdf',customer,services,serviceTotal,chemicalTotal,total});setShowInvoiceTermsModal(true);},disabled:services.length===0,className:\"px-2 py-1 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:bg-gray-300 text-xs\",children:\"PDF\"}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>{setInvoiceTermsAction({type:'email',customer,services,serviceTotal,chemicalTotal,total});setShowInvoiceTermsModal(true);},disabled:services.length===0||!customer.email||isSendingEmail,className:\"px-2 py-1 bg-green-600 text-white rounded hover:bg-green-700 disabled:bg-gray-300 text-xs\",title:!customer.email?'Customer has no email':'Send invoice with payment link',children:[isSendingEmail?'':'',\" Email\"]}),isOverdue&&customer.email&&/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setInvoiceTermsAction({type:'reminder',customer,services,serviceTotal,chemicalTotal,total,daysPastDue});setShowInvoiceTermsModal(true);},disabled:isSendingEmail,className:\"px-2 py-1 bg-red-600 text-white rounded hover:bg-red-700 text-xs\",children:\"\\uD83D\\uDCE7 Reminder\"}),!isPaid&&services.length>0&&total>0&&/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setPaymentToMark({invoiceKey,customerId:customer.id,customerName:customer.name,amount:total});setPaymentMethod({method:'electronic',checkNumber:'',source:''});setShowPaymentMethodModal(true);},className:\"px-2 py-1 bg-purple-600 text-white rounded hover:bg-purple-700 text-xs\",children:\"Mark Paid\"})]})})]},customer.id);})})]}),customers.length===0&&/*#__PURE__*/_jsx(\"div\",{className:\"p-12 text-center text-gray-500\",children:\"No customers to invoice\"})]}),selectedCustomerBilling&&/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-xl p-6 w-full max-w-4xl max-h-[90vh] overflow-y-auto\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-bold text-gray-800\",children:selectedCustomerBilling.customer.name}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-gray-500\",children:[\"Billing Detail - \",new Date(invoiceMonth+'-01').toLocaleDateString('en-US',{month:'long',year:'numeric'})]})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setSelectedCustomerBilling(null),className:\"text-gray-500 hover:text-gray-700\",children:/*#__PURE__*/_jsx(Icons.X,{})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-6\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"font-bold text-gray-700 mb-3\",children:\"Services This Month\"}),selectedCustomerBilling.services.length>0?/*#__PURE__*/_jsx(\"div\",{className:\"space-y-3\",children:selectedCustomerBilling.services.map(service=>/*#__PURE__*/_jsxs(\"div\",{className:\"border rounded-lg p-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-start mb-2\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"font-medium\",children:new Date(service.date).toLocaleDateString()}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-gray-500\",children:service.poolType})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-right\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"font-bold text-green-600\",children:[\"$\",service.totalAmount.toFixed(2)]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>openEditServiceModal(service),className:\"text-xs text-blue-600 hover:text-blue-800\",children:\"Edit\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 gap-4 text-sm\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-500\",children:\"Service Rate:\"}),\" $\",service.weeklyRate.toFixed(2)]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-500\",children:\"Chemicals:\"}),\" $\",(service.chemicalCost||0).toFixed(2)]})]}),service.chemicalsUsed&&service.chemicalsUsed.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-2 pt-2 border-t\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-xs text-gray-500 mb-1\",children:\"Chemicals Used:\"}),/*#__PURE__*/_jsx(\"div\",{className:\"flex flex-wrap gap-1\",children:service.chemicalsUsed.map((chem,idx)=>/*#__PURE__*/_jsxs(\"span\",{className:\"text-xs bg-teal-50 text-teal-700 px-2 py-0.5 rounded\",children:[chem.name,\": \",chem.quantity,\" \",chem.unit,\" ($\",chem.totalCost.toFixed(2),\")\"]},idx))})]})]},service.id))}):/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500 text-center py-4\",children:\"No services this month\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-6 bg-amber-50 p-4 rounded-lg\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"font-bold text-gray-700 mb-3\",children:\"Manual Adjustments\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-2 mb-3\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Description (e.g., Discount, Extra charge)\",className:\"flex-1 px-3 py-2 border rounded-lg text-sm\",id:\"adjustmentDesc\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",placeholder:\"Amount\",className:\"w-24 px-3 py-2 border rounded-lg text-sm\",id:\"adjustmentAmount\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{const desc=document.getElementById('adjustmentDesc').value;const amount=parseFloat(document.getElementById('adjustmentAmount').value)||0;if(desc&&amount!==0){addBillingAdjustment(desc,amount);document.getElementById('adjustmentDesc').value='';document.getElementById('adjustmentAmount').value='';}},className:\"px-4 py-2 bg-amber-600 text-white rounded-lg hover:bg-amber-700 text-sm\",children:\"Add\"})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-500 mb-2\",children:\"Use negative amounts for discounts, positive for extra charges\"}),billingAdjustments.length>0&&/*#__PURE__*/_jsx(\"div\",{className:\"space-y-2\",children:billingAdjustments.map(adj=>/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center bg-white p-2 rounded\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-sm\",children:adj.description}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"font-medium \".concat(adj.amount<0?'text-red-600':'text-green-600'),children:[adj.amount<0?'-':'+',\"$\",Math.abs(adj.amount).toFixed(2)]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>removeBillingAdjustment(adj.id),className:\"text-red-500 hover:text-red-700\",children:/*#__PURE__*/_jsx(Icons.X,{})})]})]},adj.id))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gray-50 p-4 rounded-lg mb-4\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"font-bold text-gray-700 mb-3\",children:\"Invoice Summary\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between\",children:[/*#__PURE__*/_jsxs(\"span\",{children:[\"Service Charges (\",selectedCustomerBilling.services.length,\" services)\"]}),/*#__PURE__*/_jsxs(\"span\",{children:[\"$\",selectedCustomerBilling.services.reduce((sum,s)=>sum+s.weeklyRate,0).toFixed(2)]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Chemical Charges\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-teal-600\",children:[\"$\",selectedCustomerBilling.services.reduce((sum,s)=>sum+(s.chemicalCost||0),0).toFixed(2)]})]}),billingAdjustments.map(adj=>/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between text-amber-700\",children:[/*#__PURE__*/_jsx(\"span\",{children:adj.description}),/*#__PURE__*/_jsxs(\"span\",{children:[adj.amount<0?'-':'+',\"$\",Math.abs(adj.amount).toFixed(2)]})]},adj.id)),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between pt-2 border-t-2 border-gray-300 font-bold text-lg\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Total Due\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-green-600\",children:[\"$\",(selectedCustomerBilling.services.reduce((sum,s)=>sum+s.totalAmount,0)+billingAdjustments.reduce((sum,a)=>sum+a.amount,0)).toFixed(2)]})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-3\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setSelectedCustomerBilling(null),className:\"flex-1 py-3 border-2 border-gray-300 text-gray-700 rounded-lg font-medium hover:bg-gray-50\",children:\"Close\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{downloadInvoice(selectedCustomerBilling.customer,invoiceMonth);setSelectedCustomerBilling(null);},className:\"flex-1 py-3 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700\",children:\"Download Invoice\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{const total=selectedCustomerBilling.services.reduce((sum,s)=>sum+s.totalAmount,0)+billingAdjustments.reduce((sum,a)=>sum+a.amount,0);openPaymentRequest(selectedCustomerBilling.customer.id,total,\"Monthly service - \".concat(new Date(invoiceMonth+'-01').toLocaleDateString('en-US',{month:'long',year:'numeric'})));setSelectedCustomerBilling(null);},className:\"flex-1 py-3 text-white rounded-lg font-medium\",style:{backgroundColor:'#635bff'},children:\"\\uD83D\\uDCB3 Request Payment\"})]})]})}),showEditServiceModal&&editingService&&/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-xl p-6 w-full max-w-lg max-h-[90vh] overflow-y-auto\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-4\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-bold text-gray-800\",children:\"Edit Service Record\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setShowEditServiceModal(false);setEditingService(null);},className:\"text-gray-500 hover:text-gray-700\",children:/*#__PURE__*/_jsx(Icons.X,{})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gray-50 p-3 rounded-lg\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"font-medium\",children:editingService.customerName}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-gray-500\",children:new Date(editingService.date).toLocaleDateString()})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Service Rate ($)\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",value:editingService.weeklyRate,onChange:e=>setEditingService(_objectSpread(_objectSpread({},editingService),{},{weeklyRate:parseFloat(e.target.value)||0,totalAmount:(parseFloat(e.target.value)||0)+(editingService.chemicalCost||0)})),className:\"w-full px-4 py-2 border rounded-lg\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-2\",children:\"Chemicals Used\"}),editingService.chemicalsUsed&&editingService.chemicalsUsed.length>0?/*#__PURE__*/_jsx(\"div\",{className:\"space-y-2 mb-3\",children:editingService.chemicalsUsed.map(chem=>/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between bg-teal-50 p-2 rounded\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"text-sm\",children:[chem.name,\": \",chem.quantity,\" \",chem.unit]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"font-medium text-teal-700\",children:[\"$\",chem.totalCost.toFixed(2)]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>removeChemicalFromEditingService(chem.id),className:\"text-red-500 hover:text-red-700\",children:/*#__PURE__*/_jsx(Icons.X,{})})]})]},chem.id))}):/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-500 mb-3\",children:\"No chemicals recorded\"}),chemicalInventory.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gray-50 p-3 rounded-lg\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-sm font-medium mb-2\",children:\"Add Chemical:\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-2\",children:[/*#__PURE__*/_jsxs(\"select\",{id:\"editServiceChemical\",className:\"flex-1 px-3 py-2 border rounded-lg text-sm\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select chemical...\"}),chemicalInventory.map(c=>/*#__PURE__*/_jsxs(\"option\",{value:c.id,children:[c.name,\" ($\",c.costPerUnit,\"/\",c.unit,\")\"]},c.id))]}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",step:\"0.1\",placeholder:\"Qty\",className:\"w-20 px-3 py-2 border rounded-lg text-sm\",id:\"editServiceChemicalQty\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{const chemId=parseInt(document.getElementById('editServiceChemical').value);const qty=parseFloat(document.getElementById('editServiceChemicalQty').value)||0;const chem=chemicalInventory.find(c=>c.id===chemId);if(chem&&qty>0){addChemicalToEditingService(chem,qty);document.getElementById('editServiceChemical').value='';document.getElementById('editServiceChemicalQty').value='';}},className:\"px-3 py-2 bg-teal-600 text-white rounded-lg text-sm hover:bg-teal-700\",children:\"Add\"})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-green-50 p-4 rounded-lg border-2 border-green-200\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between mb-1\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Service Rate:\"}),/*#__PURE__*/_jsxs(\"span\",{children:[\"$\",editingService.weeklyRate.toFixed(2)]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between mb-1\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Chemical Cost:\"}),/*#__PURE__*/_jsxs(\"span\",{children:[\"$\",(editingService.chemicalCost||0).toFixed(2)]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between font-bold text-lg pt-2 border-t border-green-300\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Total:\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-green-700\",children:[\"$\",editingService.totalAmount.toFixed(2)]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-3\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>deleteService(editingService.id),className:\"px-4 py-3 bg-red-100 text-red-700 rounded-lg font-medium hover:bg-red-200\",children:\"Delete\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setShowEditServiceModal(false);setEditingService(null);},className:\"flex-1 py-3 border-2 border-gray-300 text-gray-700 rounded-lg font-medium hover:bg-gray-50\",children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{onClick:updateService,className:\"flex-1 py-3 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700\",children:\"Save Changes\"})]})]})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-xl p-6 shadow-lg\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-4 flex-wrap gap-3\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-bold text-gray-800\",children:\"Completed Jobs / Service Calls\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-3 items-center flex-wrap\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"text-xs text-gray-500 block\",children:\"Search Customer\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"\\uD83D\\uDD0D Customer name...\",value:jobsSearch,onChange:e=>setJobsSearch(e.target.value),className:\"px-3 py-2 border rounded-lg text-sm w-40\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"text-xs text-gray-500 block\",children:\"Filter Date\"}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",value:jobsDateFilter,onChange:e=>setJobsDateFilter(e.target.value),className:\"px-3 py-2 border rounded-lg text-sm\"})]}),jobsDateFilter&&/*#__PURE__*/_jsx(\"button\",{onClick:()=>setJobsDateFilter(''),className:\"text-xs text-blue-600 hover:underline mt-4\",children:\"Clear Date\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm text-gray-500 mt-4\",children:[\"Showing: \",new Date(invoiceMonth+'-01').toLocaleDateString('en-US',{month:'long',year:'numeric'})]})]})]}),/*#__PURE__*/_jsxs(\"table\",{className:\"w-full\",children:[/*#__PURE__*/_jsx(\"thead\",{className:\"bg-purple-50\",children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-3 text-left text-sm font-medium text-gray-500\",children:\"Customer\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-3 text-left text-sm font-medium text-gray-500\",children:\"Job Type\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-3 text-left text-sm font-medium text-gray-500\",children:\"Date\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-3 text-left text-sm font-medium text-gray-500\",children:\"Labor\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-3 text-left text-sm font-medium text-gray-500\",children:\"Parts/Chem\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-3 text-left text-sm font-medium text-gray-500\",children:\"Total\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-3 text-right text-sm font-medium text-gray-500\",children:\"Actions\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{className:\"divide-y divide-gray-200\",children:getAllMonthJobServices(invoiceMonth).filter(s=>!jobsSearch||s.customerName.toLowerCase().includes(jobsSearch.toLowerCase())).filter(s=>!jobsDateFilter||s.date===jobsDateFilter).length>0?getAllMonthJobServices(invoiceMonth).filter(s=>!jobsSearch||s.customerName.toLowerCase().includes(jobsSearch.toLowerCase())).filter(s=>!jobsDateFilter||s.date===jobsDateFilter).map(s=>{var _paidInvoices$jobInvo;const customer=customers.find(c=>c.id===s.customerId);const jobInvoiceKey=\"job-\".concat(s.id);const isJobPaid=(_paidInvoices$jobInvo=paidInvoices[jobInvoiceKey])===null||_paidInvoices$jobInvo===void 0?void 0:_paidInvoices$jobInvo.paid;const jobPaymentInfo=paidInvoices[jobInvoiceKey];const isJobBilled=billedCustomers[jobInvoiceKey];let rowClass='hover:bg-gray-50';if(isJobPaid){rowClass='bg-blue-50 hover:bg-blue-100';}else if(isJobBilled){rowClass='bg-green-50 hover:bg-green-100';}return/*#__PURE__*/_jsxs(\"tr\",{className:rowClass,children:[/*#__PURE__*/_jsx(\"td\",{className:\"px-4 py-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2 flex-wrap\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"font-medium text-gray-800\",children:s.customerName}),isJobPaid&&/*#__PURE__*/_jsxs(\"span\",{className:\"text-xs bg-blue-500 text-white px-2 py-0.5 rounded\",children:[\"\\u2713 Paid \",(jobPaymentInfo===null||jobPaymentInfo===void 0?void 0:jobPaymentInfo.method)==='check'?\"(#\".concat(jobPaymentInfo.checkNumber,\")\"):(jobPaymentInfo===null||jobPaymentInfo===void 0?void 0:jobPaymentInfo.method)==='cash'?'(Cash)':\"(\".concat((jobPaymentInfo===null||jobPaymentInfo===void 0?void 0:jobPaymentInfo.source)||'Card',\")\")]}),!isJobPaid&&isJobBilled&&/*#__PURE__*/_jsx(\"span\",{className:\"text-xs bg-green-500 text-white px-2 py-0.5 rounded\",children:\"\\u2713 Billed\"})]})}),/*#__PURE__*/_jsx(\"td\",{className:\"px-4 py-4 text-gray-600 capitalize\",children:s.jobType||s.poolType}),/*#__PURE__*/_jsx(\"td\",{className:\"px-4 py-4 text-gray-600\",children:new Date(s.date).toLocaleDateString()}),/*#__PURE__*/_jsxs(\"td\",{className:\"px-4 py-4 text-gray-600\",children:[\"$\",s.weeklyRate.toFixed(2)]}),/*#__PURE__*/_jsxs(\"td\",{className:\"px-4 py-4 text-teal-600\",children:[\"$\",((s.additionalItemsCost||0)+(s.chemicalCost||0)).toFixed(2)]}),/*#__PURE__*/_jsxs(\"td\",{className:\"px-4 py-4 font-bold text-green-600\",children:[\"$\",s.totalAmount.toFixed(2)]}),/*#__PURE__*/_jsx(\"td\",{className:\"px-4 py-4 text-right\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-1 justify-end flex-wrap\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>downloadJobInvoice(s,defaultPaymentTerms),className:\"px-2 py-1 bg-blue-600 text-white rounded hover:bg-blue-700 text-xs\",children:\"PDF\"}),(customer===null||customer===void 0?void 0:customer.email)&&/*#__PURE__*/_jsxs(\"button\",{onClick:async()=>{let paymentLink=null;if(s.totalAmount>0){const invoiceNumber=\"JOB-\".concat(s.id.toString().slice(-8));const stripeResult=await createStripeCheckout(customer,s.totalAmount,\"\".concat(s.jobType||'Service Call',\" - \").concat(customer.name),invoiceNumber);if(stripeResult!==null&&stripeResult!==void 0&&stripeResult.paymentUrl){paymentLink=stripeResult.paymentUrl;}}await sendJobCompletionEmail(customer,{jobType:s.jobType||s.poolType,basePrice:s.weeklyRate,additionalItems:s.additionalItems||[],chemicalsUsed:s.chemicalsUsed||[],total:s.totalAmount,notes:s.techNotes||''},paymentLink);// Mark as billed\nconst newBilledCustomers=_objectSpread(_objectSpread({},billedCustomers),{},{[jobInvoiceKey]:{billed:true,billedDate:new Date().toISOString()}});saveBilledCustomers(newBilledCustomers);},disabled:isSendingEmail,className:\"px-2 py-1 bg-green-600 text-white rounded hover:bg-green-700 text-xs\",children:[isSendingEmail?'':'',\" Email\"]}),!isJobPaid&&/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setPaymentToMark({invoiceKey:jobInvoiceKey,customerId:s.customerId,customerName:s.customerName,amount:s.totalAmount});setPaymentMethod({method:'electronic',checkNumber:'',source:''});setShowPaymentMethodModal(true);},className:\"px-2 py-1 bg-purple-600 text-white rounded hover:bg-purple-700 text-xs\",children:\"Mark Paid\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>openEditServiceModal(s),className:\"px-2 py-1 bg-gray-500 text-white rounded hover:bg-gray-600 text-xs\",title:\"Edit\",children:\"\\u270F\\uFE0F\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{if(confirm(\"Delete this \".concat(s.jobType||'service',\" invoice for \").concat(s.customerName,\"?\"))){saveHistory(serviceHistory.filter(h=>h.id!==s.id));}},className:\"px-2 py-1 bg-red-500 text-white rounded hover:bg-red-600 text-xs\",title:\"Delete\",children:\"\\uD83D\\uDDD1\\uFE0F\"})]})})]},s.id);}):/*#__PURE__*/_jsx(\"tr\",{children:/*#__PURE__*/_jsx(\"td\",{colSpan:\"7\",className:\"px-4 py-8 text-center text-gray-500\",children:jobsSearch||jobsDateFilter?'No jobs match your search':'No completed jobs for this month'})})})]})]})]}),activeTab==='history'&&/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center flex-wrap gap-3\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-bold text-gray-800\",children:\"Service History\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3 flex-wrap\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"text-xs text-gray-500 block\",children:\"Search Customer\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"\\uD83D\\uDD0D Customer name...\",value:historySearch,onChange:e=>setHistorySearch(e.target.value),className:\"px-3 py-2 border rounded-lg text-sm w-40\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"text-xs text-gray-500 block\",children:\"Filter Date\"}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",value:historyDateFilter,onChange:e=>setHistoryDateFilter(e.target.value),className:\"px-3 py-2 border rounded-lg text-sm\"})]}),(historySearch||historyDateFilter)&&/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setHistorySearch('');setHistoryDateFilter('');},className:\"text-xs text-blue-600 hover:underline mt-4\",children:\"Clear Filters\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-lg font-bold text-green-600 mt-4\",children:[\"Total: $\",serviceHistory.filter(s=>!historySearch||s.customerName.toLowerCase().includes(historySearch.toLowerCase())).filter(s=>!historyDateFilter||s.date===historyDateFilter).reduce((sum,s)=>sum+s.totalAmount,0).toFixed(2)]})]})]}),serviceHistory.filter(s=>!historySearch||s.customerName.toLowerCase().includes(historySearch.toLowerCase())).filter(s=>!historyDateFilter||s.date===historyDateFilter).length>0?/*#__PURE__*/_jsx(\"div\",{className:\"space-y-3\",children:serviceHistory.filter(s=>!historySearch||s.customerName.toLowerCase().includes(historySearch.toLowerCase())).filter(s=>!historyDateFilter||s.date===historyDateFilter).map(service=>/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-xl p-4 shadow-lg border-l-4 border-green-500\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"font-bold text-gray-800\",children:service.customerName}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm text-gray-500\",children:[new Date(service.date).toLocaleDateString(),\" \\u2022 \",service.poolType]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-right\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-xl font-bold text-green-600\",children:[\"$\",service.totalAmount.toFixed(2)]}),(service.chemicalCost>0||service.additionalItemsCost>0)&&/*#__PURE__*/_jsxs(\"div\",{className:\"text-xs text-gray-500\",children:[\"Base: $\",service.weeklyRate.toFixed(2),service.chemicalCost>0&&\" + Chemicals: $\".concat(service.chemicalCost.toFixed(2)),service.additionalItemsCost>0&&\" + Items: $\".concat(service.additionalItemsCost.toFixed(2))]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-1 ml-3\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>openEditServiceModal(service),className:\"p-2 text-blue-500 hover:text-blue-700 hover:bg-blue-50 rounded\",title:\"Edit\",children:/*#__PURE__*/_jsx(Icons.Edit,{})}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>deleteService(service.id),className:\"p-2 text-red-500 hover:text-red-700 hover:bg-red-50 rounded\",title:\"Delete\",children:/*#__PURE__*/_jsx(Icons.Trash,{})})]})]}),service.chemicalsUsed&&service.chemicalsUsed.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-2 pt-2 border-t border-gray-100\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-xs text-teal-700 font-medium mb-1\",children:\"Chemicals Used:\"}),/*#__PURE__*/_jsx(\"div\",{className:\"flex flex-wrap gap-1\",children:service.chemicalsUsed.map((chem,idx)=>/*#__PURE__*/_jsxs(\"span\",{className:\"text-xs bg-teal-50 text-teal-700 px-2 py-0.5 rounded\",children:[chem.name,\": \",chem.quantity,\" \",chem.unit,\" ($\",chem.totalCost.toFixed(2),\")\"]},idx))})]}),service.additionalItems&&service.additionalItems.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-2 pt-2 border-t border-gray-100\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-xs text-purple-700 font-medium mb-1\",children:\"Additional Items:\"}),/*#__PURE__*/_jsx(\"div\",{className:\"flex flex-wrap gap-1\",children:service.additionalItems.map((item,idx)=>/*#__PURE__*/_jsxs(\"span\",{className:\"text-xs bg-purple-50 text-purple-700 px-2 py-0.5 rounded\",children:[item.name,\" x\",item.quantity,\" ($\",item.totalCost.toFixed(2),\")\"]},idx))})]})]},service.id))}):/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-xl p-12 shadow-lg text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-6xl mb-4\",children:\"\\uD83D\\uDCCB\"}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-bold text-gray-800 mb-2\",children:historySearch||historyDateFilter?'No matching services':'No service history'}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500\",children:historySearch||historyDateFilter?'Try adjusting your search filters.':'Complete services to see them here.'})]})]}),activeTab==='settings'&&/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-xl p-6 shadow-lg\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-bold text-gray-800 mb-4\",children:\"\\uD83C\\uDFE2 Company Profile\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-500 mb-4\",children:\"This information will be used in your emails and invoices.\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Company Name\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:companySettings.companyName,onChange:e=>setCompanySettings(_objectSpread(_objectSpread({},companySettings),{},{companyName:e.target.value})),className:\"w-full px-4 py-2 border rounded-lg\",placeholder:\"Your Pool Company\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Owner/Contact Name\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:companySettings.ownerName,onChange:e=>setCompanySettings(_objectSpread(_objectSpread({},companySettings),{},{ownerName:e.target.value})),className:\"w-full px-4 py-2 border rounded-lg\",placeholder:\"John Smith\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Phone\"}),/*#__PURE__*/_jsx(\"input\",{type:\"tel\",value:companySettings.phone,onChange:e=>setCompanySettings(_objectSpread(_objectSpread({},companySettings),{},{phone:e.target.value})),className:\"w-full px-4 py-2 border rounded-lg\",placeholder:\"(555) 123-4567\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Email\"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",value:companySettings.email,onChange:e=>setCompanySettings(_objectSpread(_objectSpread({},companySettings),{},{email:e.target.value})),className:\"w-full px-4 py-2 border rounded-lg\",placeholder:\"info@yourpoolco.com\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"md:col-span-2\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Business Address\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:companySettings.address,onChange:e=>setCompanySettings(_objectSpread(_objectSpread({},companySettings),{},{address:e.target.value})),className:\"w-full px-4 py-2 border rounded-lg\",placeholder:\"123 Main St, City, State ZIP\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Website (optional)\"}),/*#__PURE__*/_jsx(\"input\",{type:\"url\",value:companySettings.website,onChange:e=>setCompanySettings(_objectSpread(_objectSpread({},companySettings),{},{website:e.target.value})),className:\"w-full px-4 py-2 border rounded-lg\",placeholder:\"https://yourpoolco.com\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Logo URL (optional)\"}),/*#__PURE__*/_jsx(\"input\",{type:\"url\",value:companySettings.logoUrl,onChange:e=>setCompanySettings(_objectSpread(_objectSpread({},companySettings),{},{logoUrl:e.target.value})),className:\"w-full px-4 py-2 border rounded-lg\",placeholder:\"https://yoursite.com/logo.png\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-4 pt-4 border-t\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"font-medium text-gray-700 mb-3\",children:\"Brand Colors\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm text-gray-600 mb-1\",children:\"Primary Color\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"color\",value:companySettings.primaryColor,onChange:e=>setCompanySettings(_objectSpread(_objectSpread({},companySettings),{},{primaryColor:e.target.value})),className:\"w-10 h-10 rounded cursor-pointer\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:companySettings.primaryColor,onChange:e=>setCompanySettings(_objectSpread(_objectSpread({},companySettings),{},{primaryColor:e.target.value})),className:\"w-24 px-2 py-1 border rounded text-sm\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm text-gray-600 mb-1\",children:\"Accent Color\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"color\",value:companySettings.accentColor,onChange:e=>setCompanySettings(_objectSpread(_objectSpread({},companySettings),{},{accentColor:e.target.value})),className:\"w-10 h-10 rounded cursor-pointer\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:companySettings.accentColor,onChange:e=>setCompanySettings(_objectSpread(_objectSpread({},companySettings),{},{accentColor:e.target.value})),className:\"w-24 px-2 py-1 border rounded text-sm\"})]})]})]})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>saveCompanySettings(companySettings),className:\"mt-4 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700\",children:\"Save Company Settings\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-xl p-6 shadow-lg\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-bold text-gray-800 mb-4\",children:\"\\uD83D\\uDCE7 Email Templates\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-500 mb-4\",children:\"Customize the emails sent to your customers. Use merge tags to personalize content.\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-blue-50 p-4 rounded-lg mb-6\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"font-medium text-blue-800 mb-2\",children:\"Available Merge Tags\"}),/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-2 md:grid-cols-4 gap-2 text-sm\",children:['{{company_name}}','{{owner_name}}','{{company_phone}}','{{company_email}}','{{customer_name}}','{{customer_email}}','{{service_date}}','{{month}}','{{total}}','{{subtotal}}','{{chemical_total}}','{{chemicals_used}}','{{service_summary}}','{{payment_link}}','{{quote_number}}','{{line_items}}'].map(tag=>/*#__PURE__*/_jsx(\"code\",{className:\"bg-white px-2 py-1 rounded text-blue-700 text-xs\",children:tag},tag))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"border rounded-lg p-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-start mb-3\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-bold text-gray-800\",children:\"\\uD83D\\uDCC5 Weekly Service Update\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-500\",children:\"Sent after completing weekly service\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-2\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setPreviewTemplate('weeklyUpdate'),className:\"px-3 py-1 bg-gray-100 text-gray-700 rounded hover:bg-gray-200 text-sm\",children:\"Preview\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setEditingTemplate('weeklyUpdate'),className:\"px-3 py-1 bg-blue-600 text-white rounded hover:bg-blue-700 text-sm\",children:\"Edit\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-gray-50 p-3 rounded\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm text-gray-600\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Subject:\"}),\" \",emailTemplates.weeklyUpdate.subject]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"border rounded-lg p-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-start mb-3\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-bold text-gray-800\",children:\"\\uD83D\\uDCC4 Monthly Invoice\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-500\",children:\"Sent with monthly billing\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-2\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setPreviewTemplate('monthlyInvoice'),className:\"px-3 py-1 bg-gray-100 text-gray-700 rounded hover:bg-gray-200 text-sm\",children:\"Preview\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setEditingTemplate('monthlyInvoice'),className:\"px-3 py-1 bg-blue-600 text-white rounded hover:bg-blue-700 text-sm\",children:\"Edit\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-gray-50 p-3 rounded\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm text-gray-600\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Subject:\"}),\" \",emailTemplates.monthlyInvoice.subject]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"border rounded-lg p-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-start mb-3\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-bold text-gray-800\",children:\"\\uD83D\\uDCB0 Quote\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-500\",children:\"Sent when creating quotes for customers\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-2\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setPreviewTemplate('quote'),className:\"px-3 py-1 bg-gray-100 text-gray-700 rounded hover:bg-gray-200 text-sm\",children:\"Preview\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setEditingTemplate('quote'),className:\"px-3 py-1 bg-blue-600 text-white rounded hover:bg-blue-700 text-sm\",children:\"Edit\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-gray-50 p-3 rounded\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm text-gray-600\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Subject:\"}),\" \",emailTemplates.quote.subject]})})]})]})]}),editingTemplate&&/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-xl p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-4\",children:[/*#__PURE__*/_jsxs(\"h3\",{className:\"text-xl font-bold text-gray-800\",children:[\"Edit \",editingTemplate==='weeklyUpdate'?'Weekly Update':editingTemplate==='monthlyInvoice'?'Monthly Invoice':'Quote',\" Template\"]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setEditingTemplate(null),className:\"text-gray-500 hover:text-gray-700\",children:/*#__PURE__*/_jsx(Icons.X,{})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Email Subject\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:emailTemplates[editingTemplate].subject,onChange:e=>setEmailTemplates(_objectSpread(_objectSpread({},emailTemplates),{},{[editingTemplate]:_objectSpread(_objectSpread({},emailTemplates[editingTemplate]),{},{subject:e.target.value})})),className:\"w-full px-4 py-2 border rounded-lg\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Email Body\"}),/*#__PURE__*/_jsx(\"textarea\",{value:emailTemplates[editingTemplate].body,onChange:e=>setEmailTemplates(_objectSpread(_objectSpread({},emailTemplates),{},{[editingTemplate]:_objectSpread(_objectSpread({},emailTemplates[editingTemplate]),{},{body:e.target.value})})),className:\"w-full px-4 py-2 border rounded-lg font-mono text-sm\",rows:\"15\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-amber-50 p-3 rounded-lg\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"font-medium text-amber-800 mb-2\",children:\"\\uD83D\\uDCA1 Tips\"}),/*#__PURE__*/_jsxs(\"ul\",{className:\"text-sm text-amber-700 space-y-1\",children:[/*#__PURE__*/_jsx(\"li\",{children:\"\\u2022 Use **text** for bold formatting\"}),/*#__PURE__*/_jsxs(\"li\",{children:[\"\\u2022 Use merge tags like \",'{{customer_name}}',\" for personalization\"]}),/*#__PURE__*/_jsxs(\"li\",{children:[\"\\u2022 Use \",'{{#if condition}}...{{/if}}',\" for conditional content\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-3\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setEditingTemplate(null),className:\"flex-1 py-2 border-2 border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50\",children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{saveEmailTemplates(emailTemplates);setEditingTemplate(null);},className:\"flex-1 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700\",children:\"Save Template\"})]})]})]})}),previewTemplate&&/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-xl p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-4\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-bold text-gray-800\",children:\"Email Preview\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setPreviewTemplate(null),className:\"text-gray-500 hover:text-gray-700\",children:/*#__PURE__*/_jsx(Icons.X,{})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"border rounded-lg overflow-hidden\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"bg-gray-100 px-4 py-2 border-b\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Subject:\"}),\" \",emailTemplates[previewTemplate].subject.replace('{{company_name}}',companySettings.companyName||'Your Company').replace('{{month}}','January 2025').replace('{{quote_number}}','Q-001')]})}),/*#__PURE__*/_jsx(\"div\",{className:\"p-4 bg-white\",children:/*#__PURE__*/_jsx(\"pre\",{className:\"whitespace-pre-wrap font-sans text-sm text-gray-700\",children:emailTemplates[previewTemplate].body.replace(/\\{\\{company_name\\}\\}/g,companySettings.companyName||'Your Company').replace(/\\{\\{owner_name\\}\\}/g,companySettings.ownerName||'Owner Name').replace(/\\{\\{company_phone\\}\\}/g,companySettings.phone||'(555) 123-4567').replace(/\\{\\{company_email\\}\\}/g,companySettings.email||'info@company.com').replace(/\\{\\{customer_name\\}\\}/g,'John Smith').replace(/\\{\\{service_date\\}\\}/g,new Date().toLocaleDateString()).replace(/\\{\\{month\\}\\}/g,'January 2025').replace(/\\{\\{total\\}\\}/g,'450.00').replace(/\\{\\{subtotal\\}\\}/g,'400.00').replace(/\\{\\{chemical_total\\}\\}/g,'50.00').replace(/\\{\\{chemicals_used\\}\\}/g,' Chlorine: 2 lbs ($15.00)\\n Shock: 1 lb ($12.00)').replace(/\\{\\{service_summary\\}\\}/g,'4 weekly services @ $100.00 each').replace(/\\{\\{payment_link\\}\\}/g,'https://pay.stripe.com/example').replace(/\\{\\{quote_number\\}\\}/g,'Q-001').replace(/\\{\\{quote_date\\}\\}/g,new Date().toLocaleDateString()).replace(/\\{\\{valid_days\\}\\}/g,'30').replace(/\\{\\{line_items\\}\\}/g,' Pool Opening - $250.00\\n Filter Cleaning - $75.00').replace(/\\*\\*(.*?)\\*\\*/g,'$1')})})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setPreviewTemplate(null),className:\"mt-4 w-full py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300\",children:\"Close Preview\"})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-xl p-6 shadow-lg\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-bold text-gray-800 mb-4\",children:\"\\uD83D\\uDDA5\\uFE0F Server Configuration\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-500 mb-4\",children:\"Configure your email and payment server settings.\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-amber-50 border border-amber-200 rounded-lg p-4 mb-4\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"font-medium text-amber-800 mb-2\",children:\"\\u26A0\\uFE0F Server Required\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-amber-700\",children:\"To send emails and process payments, you need to deploy the Pool Authority server. This handles Gmail SMTP and Stripe integration securely.\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-4\",children:/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Server URL\"}),/*#__PURE__*/_jsx(\"input\",{type:\"url\",placeholder:\"https://your-app.railway.app\",className:\"w-full px-4 py-2 border rounded-lg\",defaultValue:\"http://localhost:3001\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-500 mt-1\",children:\"Your Railway deployment URL (or localhost for testing)\"})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-6 p-4 bg-gray-50 rounded-lg\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"font-medium text-gray-800 mb-2\",children:\"\\uD83D\\uDE80 Deploy to Railway\"}),/*#__PURE__*/_jsxs(\"ol\",{className:\"text-sm text-gray-600 space-y-2\",children:[/*#__PURE__*/_jsxs(\"li\",{children:[\"1. Create a free account at \",/*#__PURE__*/_jsx(\"a\",{href:\"https://railway.app\",target:\"_blank\",className:\"text-blue-600 hover:underline\",children:\"railway.app\"})]}),/*#__PURE__*/_jsx(\"li\",{children:\"2. Connect your GitHub repository with the server code\"}),/*#__PURE__*/_jsx(\"li\",{children:\"3. Add environment variables (STRIPE_SECRET_KEY, GMAIL_USER, GMAIL_APP_PASSWORD)\"}),/*#__PURE__*/_jsx(\"li\",{children:\"4. Deploy and copy your server URL above\"})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-xl p-6 shadow-lg\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-4\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-bold text-gray-800\",children:\"\\uD83D\\uDCEC Email History\"}),emailLog.length>0&&/*#__PURE__*/_jsx(\"button\",{onClick:()=>{if(window.confirm('Clear all email history?')){saveEmailLog([]);}},className:\"text-sm text-red-600 hover:text-red-800\",children:\"Clear History\"})]}),emailLog.length>0?/*#__PURE__*/_jsx(\"div\",{className:\"space-y-2 max-h-96 overflow-y-auto\",children:emailLog.slice(0,50).map(log=>/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between p-3 bg-gray-50 rounded-lg\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-lg \".concat(log.status==='sent'?'text-green-500':'text-red-500'),children:log.status==='sent'?'':''}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"font-medium text-gray-800\",children:log.customerName}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-gray-500\",children:log.subject}),/*#__PURE__*/_jsx(\"div\",{className:\"text-xs text-gray-400\",children:log.to})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-right\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-xs text-gray-500\",children:new Date(log.sentDate).toLocaleDateString()}),/*#__PURE__*/_jsx(\"div\",{className:\"text-xs text-gray-400\",children:new Date(log.sentDate).toLocaleTimeString()}),/*#__PURE__*/_jsx(\"span\",{className:\"text-xs px-2 py-0.5 rounded \".concat(log.type==='invoice'?'bg-blue-100 text-blue-700':log.type==='weekly-update'?'bg-green-100 text-green-700':'bg-purple-100 text-purple-700'),children:log.type})]})]},log.id))}):/*#__PURE__*/_jsxs(\"div\",{className:\"text-center py-8 text-gray-500\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-4xl mb-2\",children:\"\\uD83D\\uDCED\"}),/*#__PURE__*/_jsx(\"p\",{children:\"No emails sent yet\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm\",children:\"Emails will appear here when you send invoices, quotes, or updates\"})]})]})]})]}),showInvoiceTermsModal&&invoiceTermsAction&&/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-xl p-6 w-full max-w-md\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-4\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-bold\",children:invoiceTermsAction.type==='reminder'?'Send Payment Reminder':'Invoice Options'}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowInvoiceTermsModal(false),className:\"text-gray-500 hover:text-gray-700\",children:/*#__PURE__*/_jsx(Icons.X,{})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4 p-3 rounded-lg \".concat(invoiceTermsAction.type==='reminder'?'bg-red-50':'bg-gray-50'),children:[/*#__PURE__*/_jsx(\"div\",{className:\"font-medium\",children:invoiceTermsAction.customer.name}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-gray-500\",children:new Date(invoiceMonth+'-01').toLocaleDateString('en-US',{month:'long',year:'numeric'})}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-lg font-bold text-green-600 mt-1\",children:[\"$\",invoiceTermsAction.total.toFixed(2)]}),invoiceTermsAction.type==='reminder'&&invoiceTermsAction.daysPastDue&&/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm text-red-600 mt-1\",children:[\"\\u26A0\\uFE0F \",invoiceTermsAction.daysPastDue,\" days past due\"]})]}),invoiceTermsAction.type!=='reminder'&&/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-2\",children:\"Payment Terms\"}),/*#__PURE__*/_jsxs(\"select\",{value:selectedInvoiceTerms,onChange:e=>setSelectedInvoiceTerms(e.target.value),className:\"w-full px-4 py-2 border rounded-lg\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"due_receipt\",children:\"Due on Receipt\"}),/*#__PURE__*/_jsx(\"option\",{value:\"net7\",children:\"Net 7\"}),/*#__PURE__*/_jsx(\"option\",{value:\"net15\",children:\"Net 15\"}),/*#__PURE__*/_jsx(\"option\",{value:\"net30\",children:\"Net 30\"}),/*#__PURE__*/_jsx(\"option\",{value:\"net45\",children:\"Net 45\"}),/*#__PURE__*/_jsx(\"option\",{value:\"net60\",children:\"Net 60\"})]})]}),invoiceTermsAction.type==='reminder'&&/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4 p-3 bg-amber-50 rounded-lg text-sm text-amber-800\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Note:\"}),\" This will send a friendly payment reminder email with a new payment link attached.\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-3\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowInvoiceTermsModal(false),className:\"flex-1 py-2 border-2 border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50\",children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{onClick:async()=>{const{type,customer,services,serviceTotal,chemicalTotal,total,daysPastDue}=invoiceTermsAction;const monthName=new Date(invoiceMonth+'-01').toLocaleDateString('en-US',{month:'long',year:'numeric'});if(type==='pdf'){downloadInvoice(customer,invoiceMonth,selectedInvoiceTerms);}else if(type==='email'){const serviceSummary=\"\".concat(services.length,\" service\").concat(services.length!==1?'s':'',\" @ $\").concat(customer.weeklyRate,\"/visit\");let paymentLink=null;if(total>0){const invoiceNumber=\"INV-\".concat(Date.now().toString().slice(-8));const stripeResult=await createStripeCheckout(customer,total,\"Pool Service - \".concat(monthName),invoiceNumber);if(stripeResult!==null&&stripeResult!==void 0&&stripeResult.paymentUrl){paymentLink=stripeResult.paymentUrl;}}await sendInvoiceEmail(customer,{month:monthName,serviceSummary,services,subtotal:serviceTotal,chemicalTotal,total,paymentTerms:selectedInvoiceTerms,billingMonth:invoiceMonth},paymentLink);}else if(type==='reminder'){const serviceSummary=\"\".concat(services.length,\" service\").concat(services.length!==1?'s':'',\" @ $\").concat(customer.weeklyRate,\"/visit\");// Create new payment link for reminder\nlet paymentLink=null;if(total>0){const invoiceNumber=\"REM-\".concat(Date.now().toString().slice(-8));const stripeResult=await createStripeCheckout(customer,total,\"Pool Service - \".concat(monthName,\" (Overdue)\"),invoiceNumber);if(stripeResult!==null&&stripeResult!==void 0&&stripeResult.paymentUrl){paymentLink=stripeResult.paymentUrl;}}await sendPaymentReminder(customer,{month:monthName,serviceSummary,total,daysPastDue},paymentLink);}setShowInvoiceTermsModal(false);},disabled:isSendingEmail,className:\"flex-1 py-2 text-white rounded-lg disabled:opacity-50 \".concat(invoiceTermsAction.type==='reminder'?'bg-red-600 hover:bg-red-700':'bg-blue-600 hover:bg-blue-700'),children:isSendingEmail?' Sending...':invoiceTermsAction.type==='pdf'?' Generate PDF':invoiceTermsAction.type==='reminder'?' Send Reminder':' Send Invoice'})]})]})}),showEmployeeManager&&/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-xl p-6 w-full max-w-lg max-h-[90vh] overflow-y-auto\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-4\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-bold text-indigo-700\",children:\"\\uD83D\\uDC65 Manage Employees\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowEmployeeManager(false),className:\"text-gray-500 hover:text-gray-700\",children:/*#__PURE__*/_jsx(Icons.X,{})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-indigo-50 p-4 rounded-lg mb-4\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"font-medium text-indigo-800 mb-3\",children:\"Add New Employee\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-3\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Employee Name\",value:newEmployee.name,onChange:e=>setNewEmployee(_objectSpread(_objectSpread({},newEmployee),{},{name:e.target.value})),className:\"w-full px-3 py-2 border rounded-lg\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 gap-3\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"tel\",placeholder:\"Phone (optional)\",value:newEmployee.phone,onChange:e=>setNewEmployee(_objectSpread(_objectSpread({},newEmployee),{},{phone:e.target.value})),className:\"px-3 py-2 border rounded-lg\"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",placeholder:\"Email (optional)\",value:newEmployee.email,onChange:e=>setNewEmployee(_objectSpread(_objectSpread({},newEmployee),{},{email:e.target.value})),className:\"px-3 py-2 border rounded-lg\"})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{if(newEmployee.name.trim()){const colorIndex=employees.length%employeeColors.length;saveEmployees([...employees,_objectSpread(_objectSpread({},newEmployee),{},{id:Date.now(),colorIndex})]);setNewEmployee({name:'',phone:'',email:''});}},disabled:!newEmployee.name.trim(),className:\"w-full py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 disabled:bg-gray-300\",children:\"Add Employee\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2\",children:[/*#__PURE__*/_jsxs(\"h4\",{className:\"font-medium text-gray-700\",children:[\"Current Employees (\",employees.length,\")\"]}),employees.length>0?employees.map((emp,idx)=>{const color=employeeColors[idx%employeeColors.length];const assignedRecurring=recurringServices.filter(r=>r.employeeId===emp.id&&r.active).length;const assignedJobs=oneTimeJobs.filter(j=>j.employeeId===emp.id).length;return/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between p-3 bg-gray-50 rounded-lg\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-10 h-10 rounded-full flex items-center justify-center text-white font-bold\",style:{backgroundColor:color.bg},children:emp.name.charAt(0).toUpperCase()}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"font-medium\",children:emp.name}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-xs text-gray-500\",children:[emp.phone&&/*#__PURE__*/_jsx(\"span\",{className:\"mr-2\",children:emp.phone}),emp.email&&/*#__PURE__*/_jsx(\"span\",{children:emp.email})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-xs text-indigo-600\",children:[assignedRecurring,\" recurring \\u2022 \",assignedJobs,\" jobs\"]})]})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{if(confirm(\"Remove \".concat(emp.name,\"? Their assignments will become unassigned.\"))){// Remove employee and clear their assignments\nsaveEmployees(employees.filter(e=>e.id!==emp.id));saveRecurring(recurringServices.map(r=>r.employeeId===emp.id?_objectSpread(_objectSpread({},r),{},{employeeId:null}):r));saveJobs(oneTimeJobs.map(j=>j.employeeId===emp.id?_objectSpread(_objectSpread({},j),{},{employeeId:null}):j));}},className:\"text-red-500 hover:text-red-700 p-2\",children:/*#__PURE__*/_jsx(Icons.Trash,{})})]},emp.id);}):/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500 text-center py-4\",children:\"No employees yet. Add your first employee above!\"})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowEmployeeManager(false),className:\"w-full mt-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300\",children:\"Done\"})]})}),showScheduleQuoteJob&&quoteToSchedule&&/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-xl p-6 w-full max-w-md\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-4\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-bold text-purple-700\",children:\"\\uD83D\\uDCC5 Schedule Job\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setShowScheduleQuoteJob(false);setQuoteToSchedule(null);},className:\"text-gray-500 hover:text-gray-700\",children:/*#__PURE__*/_jsx(Icons.X,{})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-purple-50 p-4 rounded-lg mb-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"font-bold text-lg\",children:quoteToSchedule.customerName}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm text-gray-600\",children:[\"Quote #\",quoteToSchedule.quoteNumber]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-xl font-bold text-purple-700 mt-2\",children:[\"$\",quoteToSchedule.total.toFixed(2)]}),/*#__PURE__*/_jsx(\"div\",{className:\"text-xs text-gray-500 mt-2\",children:quoteToSchedule.items.map(i=>i.description).join(', ')})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-2\",children:\"Select Date for Job\"}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",value:quoteJobDate,onChange:e=>setQuoteJobDate(e.target.value),min:getLocalDateString(),className:\"w-full px-4 py-3 border-2 border-purple-200 rounded-lg text-lg focus:border-purple-500 focus:outline-none\"}),quoteJobDate&&/*#__PURE__*/_jsx(\"div\",{className:\"mt-2 text-center text-purple-700 font-medium\",children:(()=>{const[y,m,d]=quoteJobDate.split('-').map(Number);return new Date(y,m-1,d).toLocaleDateString('en-US',{weekday:'long',month:'long',day:'numeric',year:'numeric'});})()})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-xs text-gray-500 mb-2\",children:\"Quick Select\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-4 gap-2\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setQuoteJobDate(getLocalDateString()),className:\"py-2 px-3 rounded-lg text-sm font-medium \".concat(quoteJobDate===getLocalDateString()?'bg-purple-600 text-white':'bg-gray-100 hover:bg-gray-200'),children:\"Today\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{const tomorrow=new Date();tomorrow.setDate(tomorrow.getDate()+1);setQuoteJobDate(getLocalDateString(tomorrow));},className:\"py-2 px-3 rounded-lg text-sm font-medium \".concat((()=>{const tomorrow=new Date();tomorrow.setDate(tomorrow.getDate()+1);return quoteJobDate===getLocalDateString(tomorrow);})()?'bg-purple-600 text-white':'bg-gray-100 hover:bg-gray-200'),children:\"Tomorrow\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{const nextWeek=new Date();nextWeek.setDate(nextWeek.getDate()+7);setQuoteJobDate(getLocalDateString(nextWeek));},className:\"py-2 px-3 rounded-lg text-sm font-medium bg-gray-100 hover:bg-gray-200\",children:\"+1 Week\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{const nextMonth=new Date();nextMonth.setDate(nextMonth.getDate()+30);setQuoteJobDate(getLocalDateString(nextMonth));},className:\"py-2 px-3 rounded-lg text-sm font-medium bg-gray-100 hover:bg-gray-200\",children:\"+1 Month\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-3\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setShowScheduleQuoteJob(false);setQuoteToSchedule(null);},className:\"flex-1 py-3 border-2 border-gray-300 text-gray-700 rounded-lg font-medium hover:bg-gray-50\",children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{onClick:confirmQuoteToJob,disabled:!quoteJobDate,className:\"flex-1 py-3 bg-purple-600 text-white rounded-lg font-medium hover:bg-purple-700 disabled:bg-gray-300\",children:\"\\u2713 Schedule Job\"})]})]})}),showCompleteJobModal&&jobToComplete&&/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-xl p-6 w-full max-w-lg max-h-[90vh] overflow-y-auto\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-4\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-bold text-green-700\",children:\"\\u2713 Complete Job\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setShowCompleteJobModal(false);setJobToComplete(null);setJobCompletionItems([]);setJobChemicals([]);},className:\"text-gray-500 hover:text-gray-700\",children:/*#__PURE__*/_jsx(Icons.X,{})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gray-50 p-4 rounded-lg mb-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"font-bold text-lg\",children:jobToComplete.customerName}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-gray-600 capitalize\",children:((_jobToComplete$jobTyp=jobToComplete.jobType)===null||_jobToComplete$jobTyp===void 0?void 0:_jobToComplete$jobTyp.replace('-',' '))||'Service'}),jobToComplete.notes&&/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-gray-500 mt-1\",children:jobToComplete.notes})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center p-3 bg-purple-50 rounded-lg mb-4\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:\"Job Price:\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-xl font-bold text-purple-700\",children:[\"$\",((_jobToComplete$price=jobToComplete.price)===null||_jobToComplete$price===void 0?void 0:_jobToComplete$price.toFixed(2))||'0.00']})]}),wearItems.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"font-bold text-gray-700 mb-2\",children:\"Quick Add Wear Items\"}),/*#__PURE__*/_jsx(\"div\",{className:\"flex flex-wrap gap-2\",children:wearItems.map(item=>/*#__PURE__*/_jsxs(\"button\",{onClick:()=>addWearItemToJob(item),className:\"px-3 py-1.5 bg-gray-100 hover:bg-gray-200 rounded-lg text-sm flex items-center gap-1\",children:[/*#__PURE__*/_jsx(\"span\",{children:item.name}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-green-600 font-medium\",children:[\"$\",item.price.toFixed(2)]})]},item.id))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4 bg-gray-50 p-3 rounded-lg\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"font-medium text-gray-700 mb-2\",children:\"Add Custom Item\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-2\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Item name\",className:\"flex-1 px-3 py-2 border rounded-lg text-sm\",id:\"globalCustomJobItemName\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",step:\"0.01\",placeholder:\"Price\",className:\"w-24 px-3 py-2 border rounded-lg text-sm\",id:\"globalCustomJobItemPrice\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{const name=document.getElementById('globalCustomJobItemName').value;const price=parseFloat(document.getElementById('globalCustomJobItemPrice').value)||0;if(name&&price>0){addCustomItemToJob(name,price);document.getElementById('globalCustomJobItemName').value='';document.getElementById('globalCustomJobItemPrice').value='';}},className:\"px-3 py-2 bg-purple-600 text-white rounded-lg text-sm hover:bg-purple-700\",children:\"Add\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"font-bold text-gray-700 mb-2\",children:\"Add Chemicals Used\"}),chemicalInventory.length>0?/*#__PURE__*/_jsx(\"div\",{className:\"space-y-2\",children:chemicalInventory.map(chem=>/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3 p-3 bg-teal-50 rounded-lg\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"font-medium text-gray-800\",children:chem.name}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-xs text-gray-500\",children:[\"$\",chem.costPerUnit.toFixed(2),\"/\",chem.unit,\" \\u2022 \",chem.quantity,\" \",chem.unit,\" in stock\"]})]}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",min:\"0\",max:chem.quantity,step:\"0.1\",placeholder:\"Qty\",className:\"w-20 px-2 py-1 border rounded text-center\",id:\"global-job-chem-qty-\".concat(chem.id)}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{const input=document.getElementById(\"global-job-chem-qty-\".concat(chem.id));const qty=parseFloat(input.value)||0;if(qty>0&&qty<=chem.quantity){addChemicalToJob(chem,qty);input.value='';}},className:\"px-3 py-1 bg-teal-600 text-white rounded hover:bg-teal-700 text-sm\",children:\"Add\"})]},chem.id))}):/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500 text-sm p-3 bg-gray-50 rounded-lg\",children:\"No chemicals in inventory. Add chemicals in the Chemicals tab.\"})]}),jobChemicals.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"font-bold text-gray-700 mb-2\",children:\"Chemicals for This Job\"}),/*#__PURE__*/_jsx(\"div\",{className:\"border rounded-lg overflow-hidden\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"w-full\",children:[/*#__PURE__*/_jsx(\"thead\",{className:\"bg-teal-50\",children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{className:\"px-3 py-2 text-left text-sm\",children:\"Chemical\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-3 py-2 text-left text-sm\",children:\"Qty\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-3 py-2 text-left text-sm\",children:\"Cost\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-3 py-2\"})]})}),/*#__PURE__*/_jsxs(\"tbody\",{children:[jobChemicals.map(chem=>/*#__PURE__*/_jsxs(\"tr\",{className:\"border-t\",children:[/*#__PURE__*/_jsx(\"td\",{className:\"px-3 py-2 text-sm\",children:chem.name}),/*#__PURE__*/_jsxs(\"td\",{className:\"px-3 py-2 text-sm\",children:[chem.quantityUsed,\" \",chem.unit]}),/*#__PURE__*/_jsxs(\"td\",{className:\"px-3 py-2 text-sm font-medium\",children:[\"$\",(chem.quantityUsed*chem.costPerUnit).toFixed(2)]}),/*#__PURE__*/_jsx(\"td\",{className:\"px-3 py-2\",children:/*#__PURE__*/_jsx(\"button\",{onClick:()=>removeChemicalFromJob(chem.id),className:\"text-red-500 hover:text-red-700\",children:/*#__PURE__*/_jsx(Icons.X,{})})})]},chem.id)),/*#__PURE__*/_jsxs(\"tr\",{className:\"border-t bg-teal-50\",children:[/*#__PURE__*/_jsx(\"td\",{colSpan:\"2\",className:\"px-3 py-2 font-bold text-right\",children:\"Chemical Total:\"}),/*#__PURE__*/_jsxs(\"td\",{colSpan:\"2\",className:\"px-3 py-2 font-bold text-teal-700\",children:[\"$\",jobChemicals.reduce((sum,c)=>sum+c.quantityUsed*c.costPerUnit,0).toFixed(2)]})]})]})]})})]}),jobCompletionItems.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"font-bold text-gray-700 mb-2\",children:\"Additional Items\"}),/*#__PURE__*/_jsx(\"div\",{className:\"border rounded-lg overflow-hidden\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"w-full\",children:[/*#__PURE__*/_jsx(\"thead\",{className:\"bg-purple-50\",children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{className:\"px-3 py-2 text-left text-sm\",children:\"Item\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-3 py-2 text-left text-sm\",children:\"Qty\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-3 py-2 text-left text-sm\",children:\"Total\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-3 py-2\"})]})}),/*#__PURE__*/_jsxs(\"tbody\",{children:[jobCompletionItems.map(item=>/*#__PURE__*/_jsxs(\"tr\",{className:\"border-t\",children:[/*#__PURE__*/_jsx(\"td\",{className:\"px-3 py-2 text-sm\",children:item.name}),/*#__PURE__*/_jsx(\"td\",{className:\"px-3 py-2 text-sm\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-1\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>{if(item.quantity>1){setJobCompletionItems(jobCompletionItems.map(i=>i.id===item.id?_objectSpread(_objectSpread({},i),{},{quantity:i.quantity-1}):i));}},className:\"w-6 h-6 bg-gray-200 rounded text-sm hover:bg-gray-300\",children:\"-\"}),/*#__PURE__*/_jsx(\"span\",{className:\"w-6 text-center\",children:item.quantity}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setJobCompletionItems(jobCompletionItems.map(i=>i.id===item.id?_objectSpread(_objectSpread({},i),{},{quantity:i.quantity+1}):i));},className:\"w-6 h-6 bg-gray-200 rounded text-sm hover:bg-gray-300\",children:\"+\"})]})}),/*#__PURE__*/_jsxs(\"td\",{className:\"px-3 py-2 text-sm font-medium\",children:[\"$\",(item.price*item.quantity).toFixed(2)]}),/*#__PURE__*/_jsx(\"td\",{className:\"px-3 py-2\",children:/*#__PURE__*/_jsx(\"button\",{onClick:()=>removeItemFromJob(item.id),className:\"text-red-500 hover:text-red-700\",children:/*#__PURE__*/_jsx(Icons.X,{})})})]},item.id)),/*#__PURE__*/_jsxs(\"tr\",{className:\"border-t bg-purple-50\",children:[/*#__PURE__*/_jsx(\"td\",{colSpan:\"2\",className:\"px-3 py-2 font-bold text-right\",children:\"Items Total:\"}),/*#__PURE__*/_jsxs(\"td\",{colSpan:\"2\",className:\"px-3 py-2 font-bold text-purple-700\",children:[\"$\",jobCompletionItems.reduce((sum,i)=>sum+i.price*i.quantity,0).toFixed(2)]})]})]})]})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-green-50 p-4 rounded-lg mb-4 border-2 border-green-200\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-gray-600\",children:\"Job Price\"}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-gray-600\",children:\"Additional Items\"}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-gray-600\",children:\"Chemicals\"}),/*#__PURE__*/_jsx(\"div\",{className:\"font-bold text-lg mt-1\",children:\"Grand Total\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-right\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm\",children:[\"$\",((_jobToComplete$price2=jobToComplete.price)===null||_jobToComplete$price2===void 0?void 0:_jobToComplete$price2.toFixed(2))||'0.00']}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm\",children:[\"$\",jobCompletionItems.reduce((sum,i)=>sum+i.price*i.quantity,0).toFixed(2)]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm\",children:[\"$\",jobChemicals.reduce((sum,c)=>sum+c.quantityUsed*c.costPerUnit,0).toFixed(2)]}),/*#__PURE__*/_jsxs(\"div\",{className:\"font-bold text-xl text-green-700\",children:[\"$\",((jobToComplete.price||0)+jobCompletionItems.reduce((sum,i)=>sum+i.price*i.quantity,0)+jobChemicals.reduce((sum,c)=>sum+c.quantityUsed*c.costPerUnit,0)).toFixed(2)]})]})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"font-bold text-gray-700 mb-2\",children:\"\\uD83D\\uDCDD Technician Notes (sent to customer)\"}),/*#__PURE__*/_jsx(\"textarea\",{value:jobCompletionNotes,onChange:e=>setJobCompletionNotes(e.target.value),placeholder:\"Any notes for the customer about the work performed, issues found, recommendations...\",className:\"w-full px-3 py-2 border rounded-lg text-sm\",rows:\"3\"})]}),(()=>{const customer=customers.find(c=>c.id===parseInt(jobToComplete.customerId));return customer!==null&&customer!==void 0&&customer.email?/*#__PURE__*/_jsx(\"div\",{className:\"mb-4 p-3 bg-green-50 rounded-lg\",children:/*#__PURE__*/_jsxs(\"label\",{className:\"flex items-center gap-3 cursor-pointer\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:sendJobEmailOnComplete,onChange:e=>setSendJobEmailOnComplete(e.target.checked),className:\"w-5 h-5 text-green-600 rounded\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-medium text-green-800\",children:\"\\uD83D\\uDCE7 Send job completion email\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-xs text-green-600\",children:[\"Will send to: \",customer.email]})]})]})}):/*#__PURE__*/_jsx(\"div\",{className:\"mb-4 p-3 bg-amber-50 rounded-lg text-sm text-amber-700\",children:\"\\u26A0\\uFE0F No email on file for this customer. Add their email in the Customers tab to enable job completion emails.\"});})(),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-3\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setShowCompleteJobModal(false);setJobToComplete(null);setJobCompletionItems([]);setJobChemicals([]);setJobCompletionNotes('');},className:\"flex-1 py-3 border-2 border-gray-300 text-gray-700 rounded-lg font-medium hover:bg-gray-50\",children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{onClick:completeJobWithItems,disabled:isSendingEmail,className:\"flex-1 py-3 bg-green-600 text-white rounded-lg font-medium hover:bg-green-700 disabled:bg-green-400\",children:isSendingEmail?' Sending...':' Complete Job'})]})]})}),showPaymentMethodModal&&paymentToMark&&/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-xl p-6 w-full max-w-md\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-4\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-bold\",children:\"Mark Payment Received\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowPaymentMethodModal(false),className:\"text-gray-500 hover:text-gray-700\",children:/*#__PURE__*/_jsx(Icons.X,{})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4 p-3 bg-gray-50 rounded-lg\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"font-medium\",children:paymentToMark.customerName}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-lg font-bold text-green-600\",children:[\"$\",paymentToMark.amount.toFixed(2)]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-2\",children:\"Payment Method\"}),/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-3 gap-2\",children:['cash','check','electronic'].map(method=>/*#__PURE__*/_jsx(\"button\",{onClick:()=>setPaymentMethod(_objectSpread(_objectSpread({},paymentMethod),{},{method})),className:\"py-2 px-3 rounded-lg border-2 capitalize \".concat(paymentMethod.method===method?'border-blue-500 bg-blue-50 text-blue-700':'border-gray-200 hover:border-gray-300'),children:method==='electronic'?' Card':method==='check'?' Check':' Cash'},method))})]}),paymentMethod.method==='check'&&/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Check Number\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:paymentMethod.checkNumber,onChange:e=>setPaymentMethod(_objectSpread(_objectSpread({},paymentMethod),{},{checkNumber:e.target.value})),placeholder:\"Enter check number\",className:\"w-full px-4 py-2 border rounded-lg\"})]}),paymentMethod.method==='electronic'&&/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Payment Source\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:paymentMethod.source,onChange:e=>setPaymentMethod(_objectSpread(_objectSpread({},paymentMethod),{},{source:e.target.value})),placeholder:\"e.g., Stripe, Venmo, Zelle, Credit Card\",className:\"w-full px-4 py-2 border rounded-lg\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-3\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowPaymentMethodModal(false),className:\"flex-1 py-2 border-2 border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50\",children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{const newPaidInvoices=_objectSpread(_objectSpread({},paidInvoices),{},{[paymentToMark.invoiceKey]:{paid:true,method:paymentMethod.method,checkNumber:paymentMethod.checkNumber,source:paymentMethod.source,paidDate:new Date().toISOString(),amount:paymentToMark.amount}});savePaidInvoices(newPaidInvoices);setShowPaymentMethodModal(false);showEmailNotification('success',\"Payment marked as received from \".concat(paymentToMark.customerName));},className:\"flex-1 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700\",children:\"\\u2713 Confirm Payment\"})]})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"fixed bottom-2 right-2 text-xs text-gray-400 bg-white/80 px-2 py-1 rounded\",children:\"v2.4.0\"})]});}","map":{"version":3,"names":["React","useState","useEffect","LineChart","Line","AreaChart","Area","BarChart","Bar","XAxis","YAxis","CartesianGrid","Tooltip","ResponsiveContainer","Legend","PieChart","Pie","Cell","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","GOOGLE_MAPS_KEY","STRIPE_PUBLISHABLE_KEY","PAYMENT_SERVER_URL","Icons","Users","xmlns","width","height","viewBox","fill","stroke","strokeWidth","strokeLinecap","strokeLinejoin","children","d","cx","cy","r","Clock","points","MapPin","Plus","x1","y1","x2","y2","X","Navigation","Download","Calendar","x","y","rx","ry","History","DollarSign","Edit","Trash","Check","Map","Beaker","Wrench","Home","ChevronLeft","ChevronRight","FileText","CreditCard","Receipt","Settings","Menu","Phone","getLocalDateString","date","arguments","length","undefined","Date","year","getFullYear","month","String","getMonth","padStart","day","getDate","concat","getLocalMonthString","getPriorMonthString","setMonth","getPaymentTermsDays","terms","getPaymentTermsText","employeeColors","bg","text","name","PoolAuthority","_jobToComplete$jobTyp","_jobToComplete$price","_jobToComplete$price2","customers","setCustomers","serviceHistory","setServiceHistory","recurringServices","setRecurringServices","chemicalInventory","setChemicalInventory","oneTimeJobs","setOneTimeJobs","invoices","setInvoices","activeTab","setActiveTab","showMobileMenu","setShowMobileMenu","showAddCustomer","setShowAddCustomer","showAddChemical","setShowAddChemical","showAddJob","setShowAddJob","editingCustomer","setEditingCustomer","routeCustomers","setRouteCustomers","showMap","setShowMap","routeDate","setRouteDate","selectedDate","setSelectedDate","calendarDate","setCalendarDate","invoiceMonth","setInvoiceMonth","defaultPaymentTerms","setDefaultPaymentTerms","showCustomInvoice","setShowCustomInvoice","showCreateQuote","setShowCreateQuote","quotes","setQuotes","customInvoice","setCustomInvoice","customerId","items","notes","employees","setEmployees","showEmployeeManager","setShowEmployeeManager","newEmployee","setNewEmployee","phone","email","editingEmployee","setEditingEmployee","selectedRouteEmployee","setSelectedRouteEmployee","currentQuote","setCurrentQuote","validDays","editingQuoteId","setEditingQuoteId","newLineItem","setNewLineItem","type","description","modelNumber","quantity","price","savedQuoteItems","setSavedQuoteItems","showSavedItems","setShowSavedItems","showScheduleQuoteJob","setShowScheduleQuoteJob","quoteToSchedule","setQuoteToSchedule","quoteJobDate","setQuoteJobDate","showPaymentModal","setShowPaymentModal","paymentDetails","setPaymentDetails","amount","invoiceId","showCompleteServiceModal","setShowCompleteServiceModal","serviceToComplete","setServiceToComplete","serviceChemicals","setServiceChemicals","serviceWaterTest","setServiceWaterTest","chlorine","ph","alkalinity","cya","hardness","phosphates","sendEmailOnComplete","setSendEmailOnComplete","editingService","setEditingService","showEditServiceModal","setShowEditServiceModal","selectedCustomerBilling","setSelectedCustomerBilling","billingAdjustments","setBillingAdjustments","editingChemical","setEditingChemical","chemicalChartScale","setChemicalChartScale","wearItems","setWearItems","showWearItemsSettings","setShowWearItemsSettings","newWearItem","setNewWearItem","showCompleteJobModal","setShowCompleteJobModal","jobToComplete","setJobToComplete","jobCompletionItems","setJobCompletionItems","jobChemicals","setJobChemicals","jobCompletionNotes","setJobCompletionNotes","sendJobEmailOnComplete","setSendJobEmailOnComplete","billingSearch","setBillingSearch","billingDateFilter","setBillingDateFilter","jobsSearch","setJobsSearch","jobsDateFilter","setJobsDateFilter","historySearch","setHistorySearch","historyDateFilter","setHistoryDateFilter","emailLog","setEmailLog","billedCustomers","setBilledCustomers","emailNotification","setEmailNotification","isSendingEmail","setIsSendingEmail","showPaymentMethodModal","setShowPaymentMethodModal","paymentToMark","setPaymentToMark","paymentMethod","setPaymentMethod","method","checkNumber","source","paidInvoices","setPaidInvoices","showInvoiceTermsModal","setShowInvoiceTermsModal","invoiceTermsAction","setInvoiceTermsAction","selectedInvoiceTerms","setSelectedInvoiceTerms","companySettings","setCompanySettings","companyName","ownerName","address","website","logoUrl","primaryColor","accentColor","emailTemplates","setEmailTemplates","weeklyUpdate","subject","body","monthlyInvoice","quote","paymentReminder","editingTemplate","setEditingTemplate","previewTemplate","setPreviewTemplate","newCustomer","setNewCustomer","poolType","weeklyRate","gateCode","dogName","newChemical","setNewChemical","unit","costPerUnit","newJob","setNewJob","jobType","loadData","keys","setters","i","result","localStorage","getItem","prev","_objectSpread","JSON","parse","e","console","log","saveData","key","data","setter","setItem","stringify","error","saveCustomers","saveHistory","saveRecurring","saveChemicals","saveJobs","saveInvoices","saveQuotes","saveWearItems","saveCompanySettings","saveEmailTemplates","saveEmailLog","savePaidInvoices","saveBilledCustomers","saveSavedQuoteItems","saveEmployees","CustomerSelect","_ref","value","onChange","placeholder","className","search","setSearch","isOpen","setIsOpen","selectedCustomer","find","c","id","parseInt","filteredCustomers","filter","toLowerCase","includes","target","onFocus","onClick","map","toString","addCustomer","customer","now","createdDate","toISOString","updateCustomer","deleteCustomer","confirm","toggleRouteCustomer","exists","moveInRoute","index","direction","newRoute","newIndex","getGoogleMapsRouteUrl","addresses","encodeURIComponent","origin","destination","waypoints","slice","join","getEmbedMapUrl","openCompleteServiceModal","addChemicalToService","chemical","existingIndex","findIndex","updated","quantityUsed","removeChemicalFromService","chemicalId","completeServiceWithChemicals","chemicalCost","reduce","sum","chemicalsUsed","totalCost","hasWaterTest","service","customerName","isOneTimeJob","jobPrice","totalAmount","waterTest","serviceNotes","updatedChemicals","chem","used","Math","max","sendWeeklyUpdateEmail","completeService","getMonthServices","custId","yearMonth","s","startsWith","isJobService","getMonthJobServices","getAllMonthJobServices","getMonthTotal","getDaysInMonth","firstDay","getDay","daysInMonth","getEventsForDate","dateStr","jobs","j","recurring","serviceDate","startDate","dayOfWeek","scheduledDay","frequency","weeksDiff","floor","completed","getScheduledCustomersForDate","employeeFilter","scheduledCustomers","active","forEach","employeeId","isScheduled","recurringId","push","scheduledTime","job","jobId","jobData","sort","a","b","localeCompare","scheduled","changeRouteDate","days","current","setDate","formatRouteDate","split","Number","today","tomorrow","tomorrowStr","yesterday","yesterdayStr","toLocaleDateString","weekday","monthNames","selectedYear","setSelectedYear","getAvailableYears","years","Set","add","Array","from","getMonthlyRevenueData","months","monthRevenue","revenue","fullMonth","getYearlyRevenueData","currentYear","yearRevenue","getYearTotal","getAccountsReceivable","totalServices","totalPaid","inv","paid","balance","getWeeklyRevenueData","weeks","weekStart","weekEnd","weekRevenue","week","getChemicalUsageData","timeScale","chemicalNames","chemicals","weekData","period","fullPeriod","chemName","totalUsage","monthDate","monthData","yearData","getChemicalUsageSummary","currentMonth","lastMonth","summary","thisMonth","total","Object","values","chemicalColors","markInvoicePaid","newInvoice","paidDate","addRecurringService","deleteRecurringService","updateRecurringService","updates","updateJob","addLineItem","targetState","setTargetState","removeLineItem","itemId","generateCustomInvoice","item","invoiceNumber","html","toUpperCase","toFixed","blob","Blob","document","createElement","href","URL","createObjectURL","download","replace","click","invoiceItems","window","open","generateQuote","validUntil","updatedQuotes","q","customerEmail","updatedDate","showEmailNotification","quoteNumber","status","pdfHtml","isProcessingPayment","setIsProcessingPayment","paymentError","setPaymentError","createStripeCheckout","response","fetch","headers","successUrl","location","cancelUrl","json","success","paymentUrl","Error","message","openPaymentRequest","sendPaymentRequest","stripeResult","stripeSessionId","sessionId","openNow","navigator","clipboard","writeText","then","alert","catch","prompt","fallbackConfirm","createOfflinePaymentRequest","offline","checkPaymentStatus","refreshPaymentStatuses","pendingPayments","payment","markPaymentReceived","setTimeout","sendInvoiceEmail","invoiceData","paymentLink","itemizedServices","services","termsDays","paymentTerms","dueDate","dueDateStr","termsText","to","template","customer_name","service_summary","serviceSummary","itemized_services","subtotal","chemical_total","chemicalTotal","payment_terms","due_date","logEntry","sentDate","billingMonth","newBilledCustomers","billed","billedDate","serviceData","_serviceData$chemical","waterTestResults","wt","results","service_date","chemicals_used","water_test","service_notes","downloadQuotePdf","sendQuoteEmail","lineItems","quote_number","quote_date","valid_days","line_items","sendJobCompletionEmail","_jobData$additionalIt","_jobData$chemicalsUse","itemsList","additionalItems","paymentSection","jobTemplate","basePrice","sendPaymentReminder","reminderData","days_past_due","daysPastDue","updateQuoteStatus","quoteId","convertQuoteToJob","confirmQuoteToJob","quoteItems","convertQuoteToInvoice","downloadInvoice","totalChemicals","monthName","downloadJobInvoice","techNotes","addChemical","updateChemical","deleteChemical","openEditServiceModal","updateService","_editingService$chemi","updatedService","deleteService","serviceId","addChemicalToEditingService","newChemicalCost","removeChemicalFromEditingService","openCustomerBillingDetail","addBillingAdjustment","removeBillingAdjustment","addJob","openCompleteJobModal","addWearItemToJob","addCustomItemToJob","isCustom","removeItemFromJob","addChemicalToJob","removeChemicalFromJob","completeJobWithItems","additionalCost","itemsUsed","additionalItemsCost","jobNotes","completeJob","addWearItem","deleteWearItem","w","totalRevenue","thisMonthRevenue","todayServices","tabs","label","icon","style","background","borderColor","opacity","color","_ref2","Icon","_ref3","t","_ref4","TabIcon","strokeDasharray","dataKey","fontSize","tickFormatter","v","formatter","contentStyle","borderRadius","border","radius","offset","stopColor","stopOpacity","labelFormatter","payload","_payload$","_payload$$payload","_payload$2","_payload$2$payload","fillOpacity","account","invoiceKey","m","events","isToday","isSelected","hasEvents","hasAny","emp","_routeCustomers$find","some","isInRoute","checked","disabled","rel","src","allowFullScreen","loading","referrerPolicy","idx","employee","employeeColor","indexOf","backgroundColor","newEmployeeId","title","preventDefault","stopPropagation","rows","defaultValue","getElementById","dayNames","val","_","min","step","parseFloat","itemToSave","colSpan","ceil","desc","input","qty","scale","charAt","content","_ref5","_payload$3","_payload$3$payload","entry","_serviceHistory$find","_serviceHistory$find$","_serviceHistory$find$2","_s$chemicalsUsed","trend","trendUp","trendDown","abs","_paidInvoices$invoice","serviceTotal","isPaid","isBilled","billedInfo","paymentInfo","isOverdue","rowClass","adj","chemId","_paidInvoices$jobInvo","jobInvoiceKey","isJobPaid","jobPaymentInfo","isJobBilled","h","tag","toLocaleTimeString","trim","colorIndex","assignedRecurring","assignedJobs","nextWeek","nextMonth","newPaidInvoices"],"sources":["C:/Users/somme/Downloads/pool-authority-app/pool-authority-app/src/App.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { LineChart, Line, AreaChart, Area, BarChart, Bar, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer, Legend, PieChart, Pie, Cell } from 'recharts';\n\nconst GOOGLE_MAPS_KEY = 'AIzaSyDnhsQnmylUDFWgbiMF-Etktm-9ZY6Aaw8';\nconst STRIPE_PUBLISHABLE_KEY = 'pk_test_51SpDftDHbtPuLg7A3guJcp7uNOUYPzADC1Uk0qqlXBvudJB6TwozWNqaCutnDcTXF0VzZWeqDVoWs4YY4ooBDwSl00W4DbIbcf';\nconst PAYMENT_SERVER_URL = 'https://pool-authority-server.onrender.com';\n\n// Icons as simple SVG components\nconst Icons = {\n  Users: () => <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"><path d=\"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2\"/><circle cx=\"9\" cy=\"7\" r=\"4\"/><path d=\"M22 21v-2a4 4 0 0 0-3-3.87\"/><path d=\"M16 3.13a4 4 0 0 1 0 7.75\"/></svg>,\n  Clock: () => <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"><circle cx=\"12\" cy=\"12\" r=\"10\"/><polyline points=\"12 6 12 12 16 14\"/></svg>,\n  MapPin: () => <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"><path d=\"M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z\"/><circle cx=\"12\" cy=\"10\" r=\"3\"/></svg>,\n  Plus: () => <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"><line x1=\"12\" y1=\"5\" x2=\"12\" y2=\"19\"/><line x1=\"5\" y1=\"12\" x2=\"19\" y2=\"12\"/></svg>,\n  X: () => <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"><line x1=\"18\" y1=\"6\" x2=\"6\" y2=\"18\"/><line x1=\"6\" y1=\"6\" x2=\"18\" y2=\"18\"/></svg>,\n  Navigation: () => <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"><polygon points=\"3 11 22 2 13 21 11 13 3 11\"/></svg>,\n  Download: () => <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"><path d=\"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4\"/><polyline points=\"7 10 12 15 17 10\"/><line x1=\"12\" y1=\"15\" x2=\"12\" y2=\"3\"/></svg>,\n  Calendar: () => <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"><rect x=\"3\" y=\"4\" width=\"18\" height=\"18\" rx=\"2\" ry=\"2\"/><line x1=\"16\" y1=\"2\" x2=\"16\" y2=\"6\"/><line x1=\"8\" y1=\"2\" x2=\"8\" y2=\"6\"/><line x1=\"3\" y1=\"10\" x2=\"21\" y2=\"10\"/></svg>,\n  History: () => <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"><path d=\"M3 3v5h5\"/><path d=\"M3.05 13A9 9 0 1 0 6 5.3L3 8\"/><path d=\"M12 7v5l4 2\"/></svg>,\n  DollarSign: () => <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"><line x1=\"12\" y1=\"1\" x2=\"12\" y2=\"23\"/><path d=\"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6\"/></svg>,\n  Edit: () => <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"><path d=\"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7\"/><path d=\"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z\"/></svg>,\n  Trash: () => <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"><polyline points=\"3 6 5 6 21 6\"/><path d=\"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2\"/></svg>,\n  Check: () => <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"><polyline points=\"20 6 9 17 4 12\"/></svg>,\n  Map: () => <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"><polygon points=\"1 6 1 22 8 18 16 22 23 18 23 2 16 6 8 2 1 6\"/><line x1=\"8\" y1=\"2\" x2=\"8\" y2=\"18\"/><line x1=\"16\" y1=\"6\" x2=\"16\" y2=\"22\"/></svg>,\n  Beaker: () => <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"><path d=\"M4.5 3h15\"/><path d=\"M6 3v16a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V3\"/><path d=\"M6 14h12\"/></svg>,\n  Wrench: () => <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"><path d=\"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z\"/></svg>,\n  Home: () => <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"><path d=\"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z\"/><polyline points=\"9 22 9 12 15 12 15 22\"/></svg>,\n  ChevronLeft: () => <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"><polyline points=\"15 18 9 12 15 6\"/></svg>,\n  ChevronRight: () => <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"><polyline points=\"9 18 15 12 9 6\"/></svg>,\n  FileText: () => <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"><path d=\"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z\"/><polyline points=\"14 2 14 8 20 8\"/><line x1=\"16\" y1=\"13\" x2=\"8\" y2=\"13\"/><line x1=\"16\" y1=\"17\" x2=\"8\" y2=\"17\"/><polyline points=\"10 9 9 9 8 9\"/></svg>,\n  CreditCard: () => <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"><rect x=\"1\" y=\"4\" width=\"22\" height=\"16\" rx=\"2\" ry=\"2\"/><line x1=\"1\" y1=\"10\" x2=\"23\" y2=\"10\"/></svg>,\n  Receipt: () => <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"><path d=\"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1-2-1z\"/><path d=\"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8\"/><path d=\"M12 17V7\"/></svg>,\n  Settings: () => <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"><circle cx=\"12\" cy=\"12\" r=\"3\"/><path d=\"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z\"/></svg>,\n  Menu: () => <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"><line x1=\"3\" y1=\"12\" x2=\"21\" y2=\"12\"/><line x1=\"3\" y1=\"6\" x2=\"21\" y2=\"6\"/><line x1=\"3\" y1=\"18\" x2=\"21\" y2=\"18\"/></svg>,\n  Phone: () => <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"><path d=\"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z\"/></svg>,\n};\n\n// Helper to get local date string (YYYY-MM-DD) without timezone issues\nconst getLocalDateString = (date = new Date()) => {\n  const year = date.getFullYear();\n  const month = String(date.getMonth() + 1).padStart(2, '0');\n  const day = String(date.getDate()).padStart(2, '0');\n  return `${year}-${month}-${day}`;\n};\n\nconst getLocalMonthString = (date = new Date()) => {\n  const year = date.getFullYear();\n  const month = String(date.getMonth() + 1).padStart(2, '0');\n  return `${year}-${month}`;\n};\n\n// Get prior month for billing (services performed last month)\nconst getPriorMonthString = () => {\n  const date = new Date();\n  date.setMonth(date.getMonth() - 1);\n  const year = date.getFullYear();\n  const month = String(date.getMonth() + 1).padStart(2, '0');\n  return `${year}-${month}`;\n};\n\n// Payment terms helper\nconst getPaymentTermsDays = (terms) => {\n  switch(terms) {\n    case 'due_receipt': return 0;\n    case 'net7': return 7;\n    case 'net15': return 15;\n    case 'net30': return 30;\n    case 'net45': return 45;\n    case 'net60': return 60;\n    default: return 15;\n  }\n};\n\nconst getPaymentTermsText = (terms) => {\n  switch(terms) {\n    case 'due_receipt': return 'Due Upon Receipt';\n    case 'net7': return 'Net 7';\n    case 'net15': return 'Net 15';\n    case 'net30': return 'Net 30';\n    case 'net45': return 'Net 45';\n    case 'net60': return 'Net 60';\n    default: return 'Net 15';\n  }\n};\n\n// Employee colors for visual identification\nconst employeeColors = [\n  { bg: '#3b82f6', text: '#ffffff', name: 'Blue' },\n  { bg: '#10b981', text: '#ffffff', name: 'Green' },\n  { bg: '#f59e0b', text: '#000000', name: 'Amber' },\n  { bg: '#ef4444', text: '#ffffff', name: 'Red' },\n  { bg: '#8b5cf6', text: '#ffffff', name: 'Purple' },\n  { bg: '#ec4899', text: '#ffffff', name: 'Pink' },\n  { bg: '#06b6d4', text: '#ffffff', name: 'Cyan' },\n  { bg: '#84cc16', text: '#000000', name: 'Lime' },\n];\n\nexport default function PoolAuthority() {\n  // State\n  const [customers, setCustomers] = useState([]);\n  const [serviceHistory, setServiceHistory] = useState([]);\n  const [recurringServices, setRecurringServices] = useState([]);\n  const [chemicalInventory, setChemicalInventory] = useState([]);\n  const [oneTimeJobs, setOneTimeJobs] = useState([]);\n  const [invoices, setInvoices] = useState([]);\n  const [activeTab, setActiveTab] = useState('home');\n  const [showMobileMenu, setShowMobileMenu] = useState(false); // Mobile navigation menu\n  const [showAddCustomer, setShowAddCustomer] = useState(false);\n  const [showAddChemical, setShowAddChemical] = useState(false);\n  const [showAddJob, setShowAddJob] = useState(false);\n  const [editingCustomer, setEditingCustomer] = useState(null);\n  const [routeCustomers, setRouteCustomers] = useState([]);\n  const [showMap, setShowMap] = useState(false);\n  const [routeDate, setRouteDate] = useState(getLocalDateString());\n  const [selectedDate, setSelectedDate] = useState(getLocalDateString());\n  const [calendarDate, setCalendarDate] = useState(new Date());\n  const [invoiceMonth, setInvoiceMonth] = useState(getPriorMonthString());\n  const [defaultPaymentTerms, setDefaultPaymentTerms] = useState('net15');\n  const [showCustomInvoice, setShowCustomInvoice] = useState(false);\n  const [showCreateQuote, setShowCreateQuote] = useState(false);\n  const [quotes, setQuotes] = useState([]);\n  const [customInvoice, setCustomInvoice] = useState({ customerId: '', items: [], notes: '' });\n  \n  // Employee management\n  const [employees, setEmployees] = useState([]);\n  const [showEmployeeManager, setShowEmployeeManager] = useState(false);\n  const [newEmployee, setNewEmployee] = useState({ name: '', phone: '', email: '' });\n  const [editingEmployee, setEditingEmployee] = useState(null);\n  const [selectedRouteEmployee, setSelectedRouteEmployee] = useState('all'); // Filter routes by employee\n  const [currentQuote, setCurrentQuote] = useState({ customerId: '', items: [], notes: '', validDays: 30 });\n  const [editingQuoteId, setEditingQuoteId] = useState(null); // Track if editing existing quote\n  const [newLineItem, setNewLineItem] = useState({ type: 'labor', description: '', modelNumber: '', quantity: 1, price: 0 });\n  const [savedQuoteItems, setSavedQuoteItems] = useState([]); // Saved items for reuse in quotes\n  const [showSavedItems, setShowSavedItems] = useState(false);\n  const [showScheduleQuoteJob, setShowScheduleQuoteJob] = useState(false); // Modal for scheduling quote as job\n  const [quoteToSchedule, setQuoteToSchedule] = useState(null); // Quote being scheduled as job\n  const [quoteJobDate, setQuoteJobDate] = useState(''); // Selected date for the job\n  const [showPaymentModal, setShowPaymentModal] = useState(false);\n  const [paymentDetails, setPaymentDetails] = useState({ customerId: '', amount: 0, description: '', invoiceId: '' });\n  const [showCompleteServiceModal, setShowCompleteServiceModal] = useState(false);\n  const [serviceToComplete, setServiceToComplete] = useState(null);\n  const [serviceChemicals, setServiceChemicals] = useState([]);\n  const [serviceWaterTest, setServiceWaterTest] = useState({ chlorine: '', ph: '', alkalinity: '', cya: '', hardness: '', phosphates: '', notes: '' });\n  const [sendEmailOnComplete, setSendEmailOnComplete] = useState(true);\n  const [editingService, setEditingService] = useState(null);\n  const [showEditServiceModal, setShowEditServiceModal] = useState(false);\n  const [selectedCustomerBilling, setSelectedCustomerBilling] = useState(null);\n  const [billingAdjustments, setBillingAdjustments] = useState([]);\n  const [editingChemical, setEditingChemical] = useState(null);\n  const [chemicalChartScale, setChemicalChartScale] = useState('monthly');\n  const [wearItems, setWearItems] = useState([]);\n  const [showWearItemsSettings, setShowWearItemsSettings] = useState(false);\n  const [newWearItem, setNewWearItem] = useState({ name: '', price: 0, description: '' });\n  const [showCompleteJobModal, setShowCompleteJobModal] = useState(false);\n  const [jobToComplete, setJobToComplete] = useState(null);\n  const [jobCompletionItems, setJobCompletionItems] = useState([]);\n  const [jobChemicals, setJobChemicals] = useState([]);\n  const [jobCompletionNotes, setJobCompletionNotes] = useState('');\n  const [sendJobEmailOnComplete, setSendJobEmailOnComplete] = useState(true);\n  \n  // Search state for billing and history\n  const [billingSearch, setBillingSearch] = useState('');\n  const [billingDateFilter, setBillingDateFilter] = useState('');\n  const [jobsSearch, setJobsSearch] = useState('');\n  const [jobsDateFilter, setJobsDateFilter] = useState('');\n  const [historySearch, setHistorySearch] = useState('');\n  const [historyDateFilter, setHistoryDateFilter] = useState('');\n  \n  // Email state\n  const [emailLog, setEmailLog] = useState([]);\n  const [billedCustomers, setBilledCustomers] = useState({}); // Track customers billed this month: { 'customerId-YYYY-MM': true }\n  const [emailNotification, setEmailNotification] = useState(null);\n  const [isSendingEmail, setIsSendingEmail] = useState(false);\n  \n  // Payment tracking state\n  const [showPaymentMethodModal, setShowPaymentMethodModal] = useState(false);\n  const [paymentToMark, setPaymentToMark] = useState(null); // { invoiceId, customerId, amount }\n  const [paymentMethod, setPaymentMethod] = useState({ method: 'electronic', checkNumber: '', source: '' });\n  const [paidInvoices, setPaidInvoices] = useState({}); // { 'customerId-YYYY-MM': { paid: true, method: 'check', checkNumber: '123', paidDate: '...' } }\n  \n  // Invoice terms modal state\n  const [showInvoiceTermsModal, setShowInvoiceTermsModal] = useState(false);\n  const [invoiceTermsAction, setInvoiceTermsAction] = useState(null); // { type: 'pdf' | 'email', customer, services, totals }\n  const [selectedInvoiceTerms, setSelectedInvoiceTerms] = useState('net15');\n\n  // Company Settings & Email Templates\n  const [companySettings, setCompanySettings] = useState({\n    companyName: 'Pool Authority',\n    ownerName: '',\n    phone: '',\n    email: '',\n    address: '',\n    website: '',\n    logoUrl: '',\n    primaryColor: '#1e3a5f',\n    accentColor: '#5bb4d8'\n  });\n  \n  const [emailTemplates, setEmailTemplates] = useState({\n    weeklyUpdate: {\n      subject: 'Weekly Pool Service Update - {{company_name}}',\n      body: `Hi {{customer_name}},\n\nHere's your weekly pool service update from {{company_name}}.\n\n**Service Date:** {{service_date}}\n**Services Performed:** Weekly maintenance, chemical balancing, skimming, vacuuming\n\n{{#if water_test}}\n**Water Test Results:** {{water_test}}\n{{/if}}\n\n{{#if chemicals_used}}\n**Chemicals Applied:**\n{{chemicals_used}}\n{{/if}}\n\n{{#if service_notes}}\n**Notes:** {{service_notes}}\n{{/if}}\n\n**Pool Status:** Your pool is looking great! \n\nIf you have any questions, feel free to reach out.\n\nBest regards,\n{{owner_name}}\n{{company_name}}\n{{company_phone}}`\n    },\n    monthlyInvoice: {\n      subject: 'Invoice for {{month}} - {{company_name}}',\n      body: `Hi {{customer_name}},\n\nPlease find your invoice for pool services in {{month}}.\n\n**Invoice Summary:**\n{{service_summary}}\n\n{{#if itemized_services}}\n**Service Details:**\n{{itemized_services}}\n{{/if}}\n\n**Subtotal:** \\${{subtotal}}\n**Chemicals:** \\${{chemical_total}}\n**Total Due:** \\${{total}}\n\n**Payment Terms:** {{payment_terms}}\n**Due Date:** {{due_date}}\n\n{{#if payment_link}}\n**Pay Online:** {{payment_link}}\n{{/if}}\n\nThank you for your business!\n\nBest regards,\n{{owner_name}}\n{{company_name}}\n{{company_phone}}\n{{company_email}}`\n    },\n    quote: {\n      subject: 'Quote #{{quote_number}} from {{company_name}}',\n      body: `Hi {{customer_name}},\n\nThank you for your interest in our services! Here's your quote:\n\n**Quote #:** {{quote_number}}\n**Date:** {{quote_date}}\n**Valid For:** {{valid_days}} days\n\n**Services:**\n{{line_items}}\n\n**Total:** \\${{total}}\n\nTo accept this quote, simply reply to this email or give us a call.\n\nBest regards,\n{{owner_name}}\n{{company_name}}\n{{company_phone}}\n{{company_email}}`\n    },\n    paymentReminder: {\n      subject: 'Friendly Reminder: Invoice for {{month}} - {{company_name}}',\n      body: `Hi {{customer_name}},\n\nWe hope this message finds you well! This is a friendly reminder that your invoice for pool services in {{month}} is now past due.\n\n**Invoice Details:**\n{{service_summary}}\n\n**Amount Due:** \\${{total}}\n**Days Past Due:** {{days_past_due}}\n\nWe understand that things can slip through the cracks, so we wanted to reach out. If you've already sent payment, please disregard this reminder and thank you!\n\n{{#if payment_link}}\n**Pay Online:** {{payment_link}}\n{{/if}}\n\nIf you have any questions about this invoice or would like to discuss payment options, please don't hesitate to reach out.\n\nThank you for your continued business!\n\nBest regards,\n{{owner_name}}\n{{company_name}}\n{{company_phone}}\n{{company_email}}`\n    }\n  });\n  \n  const [editingTemplate, setEditingTemplate] = useState(null);\n  const [previewTemplate, setPreviewTemplate] = useState(null);\n\n  const [newCustomer, setNewCustomer] = useState({\n    name: '', address: '', poolType: 'inground', phone: '', email: '',\n    weeklyRate: 100, gateCode: '', dogName: '', notes: ''\n  });\n\n  const [newChemical, setNewChemical] = useState({\n    name: '', quantity: 0, unit: 'lbs', costPerUnit: 0\n  });\n\n  const [newJob, setNewJob] = useState({\n    customerId: '', jobType: 'opening', date: '', price: 250, notes: ''\n  });\n\n  // Load data from storage\n  useEffect(() => {\n    const loadData = () => {\n      try {\n        const keys = ['pool-customers', 'pool-history', 'pool-recurring', 'pool-chemicals', 'pool-jobs', 'pool-invoices', 'pool-quotes', 'pool-wear-items', 'pool-company-settings', 'pool-email-templates', 'pool-email-log', 'pool-paid-invoices', 'pool-billed-customers', 'pool-saved-quote-items', 'pool-employees'];\n        const setters = [setCustomers, setServiceHistory, setRecurringServices, setChemicalInventory, setOneTimeJobs, setInvoices, setQuotes, setWearItems, setCompanySettings, setEmailTemplates, setEmailLog, setPaidInvoices, setBilledCustomers, setSavedQuoteItems, setEmployees];\n        for (let i = 0; i < keys.length; i++) {\n          const result = localStorage.getItem(keys[i]);\n          if (result) {\n            // Merge with defaults for settings/templates to preserve new fields\n            if (keys[i] === 'pool-company-settings') {\n              setters[i](prev => ({ ...prev, ...JSON.parse(result) }));\n            } else if (keys[i] === 'pool-email-templates') {\n              setters[i](prev => ({ ...prev, ...JSON.parse(result) }));\n            } else {\n              setters[i](JSON.parse(result));\n            }\n          }\n        }\n      } catch (e) { console.log('No existing data'); }\n    };\n    loadData();\n  }, []);\n\n  // Save helpers\n  const saveData = (key, data, setter) => {\n    setter(data);\n    try { localStorage.setItem(key, JSON.stringify(data)); } \n    catch (e) { console.error('Save error:', e); }\n  };\n\n  const saveCustomers = (data) => saveData('pool-customers', data, setCustomers);\n  const saveHistory = (data) => saveData('pool-history', data, setServiceHistory);\n  const saveRecurring = (data) => saveData('pool-recurring', data, setRecurringServices);\n  const saveChemicals = (data) => saveData('pool-chemicals', data, setChemicalInventory);\n  const saveJobs = (data) => saveData('pool-jobs', data, setOneTimeJobs);\n  const saveInvoices = (data) => saveData('pool-invoices', data, setInvoices);\n  const saveQuotes = (data) => saveData('pool-quotes', data, setQuotes);\n  const saveWearItems = (data) => saveData('pool-wear-items', data, setWearItems);\n  const saveCompanySettings = (data) => saveData('pool-company-settings', data, setCompanySettings);\n  const saveEmailTemplates = (data) => saveData('pool-email-templates', data, setEmailTemplates);\n  const saveEmailLog = (data) => saveData('pool-email-log', data, setEmailLog);\n  const savePaidInvoices = (data) => saveData('pool-paid-invoices', data, setPaidInvoices);\n  const saveBilledCustomers = (data) => saveData('pool-billed-customers', data, setBilledCustomers);\n  const saveSavedQuoteItems = (data) => saveData('pool-saved-quote-items', data, setSavedQuoteItems);\n  const saveEmployees = (data) => saveData('pool-employees', data, setEmployees);\n\n  // Searchable Customer Select Component\n  const CustomerSelect = ({ value, onChange, placeholder = \"Search or select customer...\", className = \"\" }) => {\n    const [search, setSearch] = useState('');\n    const [isOpen, setIsOpen] = useState(false);\n    const selectedCustomer = customers.find(c => c.id === parseInt(value));\n    \n    const filteredCustomers = customers.filter(c => \n      c.name.toLowerCase().includes(search.toLowerCase()) ||\n      c.address.toLowerCase().includes(search.toLowerCase())\n    );\n    \n    return (\n      <div className={`relative ${className}`}>\n        <input\n          type=\"text\"\n          value={isOpen ? search : (selectedCustomer?.name || '')}\n          onChange={e => { setSearch(e.target.value); setIsOpen(true); }}\n          onFocus={() => setIsOpen(true)}\n          placeholder={placeholder}\n          className=\"w-full px-4 py-2 border rounded-lg\"\n        />\n        {isOpen && (\n          <>\n            <div className=\"fixed inset-0 z-40\" onClick={() => setIsOpen(false)} />\n            <div className=\"absolute z-50 w-full mt-1 bg-white border rounded-lg shadow-lg max-h-60 overflow-y-auto\">\n              {filteredCustomers.length > 0 ? filteredCustomers.map(c => (\n                <div\n                  key={c.id}\n                  onClick={() => { onChange(c.id.toString()); setSearch(''); setIsOpen(false); }}\n                  className={`px-4 py-2 cursor-pointer hover:bg-blue-50 ${parseInt(value) === c.id ? 'bg-blue-100' : ''}`}\n                >\n                  <div className=\"font-medium\">{c.name}</div>\n                  <div className=\"text-xs text-gray-500\">{c.address}</div>\n                </div>\n              )) : (\n                <div className=\"px-4 py-2 text-gray-500\">No customers found</div>\n              )}\n            </div>\n          </>\n        )}\n      </div>\n    );\n  };\n\n  // Customer functions\n  const addCustomer = () => {\n    if (newCustomer.name && newCustomer.address) {\n      const customer = { ...newCustomer, id: Date.now(), createdDate: new Date().toISOString() };\n      saveCustomers([...customers, customer]);\n      setNewCustomer({ name: '', address: '', poolType: 'inground', phone: '', email: '', weeklyRate: 100, gateCode: '', dogName: '', notes: '' });\n      setShowAddCustomer(false);\n    }\n  };\n\n  const updateCustomer = () => {\n    if (editingCustomer) {\n      saveCustomers(customers.map(c => c.id === editingCustomer.id ? editingCustomer : c));\n      setEditingCustomer(null);\n    }\n  };\n\n  const deleteCustomer = (id) => {\n    if (confirm('Delete this customer?')) {\n      saveCustomers(customers.filter(c => c.id !== id));\n      setRouteCustomers(routeCustomers.filter(c => c.id !== id));\n    }\n  };\n\n  // Route functions\n  const toggleRouteCustomer = (customer) => {\n    const exists = routeCustomers.find(c => c.id === customer.id);\n    if (exists) {\n      setRouteCustomers(routeCustomers.filter(c => c.id !== customer.id));\n    } else {\n      setRouteCustomers([...routeCustomers, customer]);\n    }\n  };\n\n  const moveInRoute = (index, direction) => {\n    const newRoute = [...routeCustomers];\n    const newIndex = index + direction;\n    if (newIndex < 0 || newIndex >= newRoute.length) return;\n    [newRoute[index], newRoute[newIndex]] = [newRoute[newIndex], newRoute[index]];\n    setRouteCustomers(newRoute);\n  };\n\n  const getGoogleMapsRouteUrl = () => {\n    if (routeCustomers.length === 0) return '';\n    const addresses = routeCustomers.map(c => encodeURIComponent(c.address));\n    if (addresses.length === 1) return `https://www.google.com/maps/search/?api=1&query=${addresses[0]}`;\n    const origin = addresses[0];\n    const destination = addresses[addresses.length - 1];\n    const waypoints = addresses.slice(1, -1).join('|');\n    return `https://www.google.com/maps/dir/?api=1&origin=${origin}&destination=${destination}${waypoints ? '&waypoints=' + waypoints : ''}&mode=driving`;\n  };\n\n  const getEmbedMapUrl = () => {\n    if (routeCustomers.length === 0) return '';\n    if (routeCustomers.length === 1) return `https://www.google.com/maps/embed/v1/place?key=${GOOGLE_MAPS_KEY}&q=${encodeURIComponent(routeCustomers[0].address)}`;\n    const origin = encodeURIComponent(routeCustomers[0].address);\n    const destination = encodeURIComponent(routeCustomers[routeCustomers.length - 1].address);\n    const waypoints = routeCustomers.slice(1, -1).map(c => encodeURIComponent(c.address)).join('|');\n    return `https://www.google.com/maps/embed/v1/directions?key=${GOOGLE_MAPS_KEY}&origin=${origin}&destination=${destination}${waypoints ? '&waypoints=' + waypoints : ''}&mode=driving`;\n  };\n\n  // Service functions\n  // Open service completion modal\n  const openCompleteServiceModal = (customer) => {\n    setServiceToComplete(customer);\n    setServiceChemicals([]);\n    setServiceWaterTest({ chlorine: '', ph: '', alkalinity: '', cya: '', hardness: '', phosphates: '', notes: '' });\n    setShowCompleteServiceModal(true);\n  };\n\n  // Add chemical to current service\n  const addChemicalToService = (chemical, quantity) => {\n    if (quantity <= 0) return;\n    const existingIndex = serviceChemicals.findIndex(c => c.id === chemical.id);\n    if (existingIndex >= 0) {\n      const updated = [...serviceChemicals];\n      updated[existingIndex].quantity += quantity;\n      setServiceChemicals(updated);\n    } else {\n      setServiceChemicals([...serviceChemicals, { ...chemical, quantityUsed: quantity }]);\n    }\n  };\n\n  // Remove chemical from current service\n  const removeChemicalFromService = (chemicalId) => {\n    setServiceChemicals(serviceChemicals.filter(c => c.id !== chemicalId));\n  };\n\n  // Complete the service with chemicals\n  const completeServiceWithChemicals = async () => {\n    if (!serviceToComplete) return;\n    \n    const chemicalCost = serviceChemicals.reduce((sum, c) => sum + (c.quantityUsed * c.costPerUnit), 0);\n    const chemicalsUsed = serviceChemicals.map(c => ({\n      id: c.id,\n      name: c.name,\n      quantity: c.quantityUsed,\n      unit: c.unit,\n      costPerUnit: c.costPerUnit,\n      totalCost: c.quantityUsed * c.costPerUnit\n    }));\n    \n    // Only include water test if any values were entered\n    const hasWaterTest = serviceWaterTest.chlorine || serviceWaterTest.ph || serviceWaterTest.alkalinity || serviceWaterTest.cya || serviceWaterTest.hardness || serviceWaterTest.phosphates;\n    \n    const service = {\n      id: Date.now(),\n      customerId: serviceToComplete.id,\n      customerName: serviceToComplete.name,\n      date: new Date().toISOString(),\n      weeklyRate: serviceToComplete.isOneTimeJob ? serviceToComplete.jobPrice : serviceToComplete.weeklyRate,\n      chemicalCost,\n      chemicalsUsed,\n      totalAmount: (serviceToComplete.isOneTimeJob ? serviceToComplete.jobPrice : serviceToComplete.weeklyRate) + chemicalCost,\n      poolType: serviceToComplete.poolType || serviceToComplete.jobType || 'service',\n      waterTest: hasWaterTest ? { ...serviceWaterTest } : null,\n      serviceNotes: serviceWaterTest.notes || ''\n    };\n    saveHistory([service, ...serviceHistory]);\n    \n    // Update chemical inventory (reduce quantities)\n    const updatedChemicals = chemicalInventory.map(chem => {\n      const used = serviceChemicals.find(c => c.id === chem.id);\n      if (used) {\n        return { ...chem, quantity: Math.max(0, chem.quantity - used.quantityUsed) };\n      }\n      return chem;\n    });\n    saveChemicals(updatedChemicals);\n    \n    // Auto-send weekly update email if enabled and customer has email\n    if (sendEmailOnComplete && serviceToComplete.email) {\n      await sendWeeklyUpdateEmail(serviceToComplete, {\n        date: service.date,\n        chemicalsUsed: chemicalsUsed,\n        waterTest: hasWaterTest ? serviceWaterTest : null,\n        notes: serviceWaterTest.notes\n      });\n    }\n    \n    setShowCompleteServiceModal(false);\n    setServiceToComplete(null);\n    setServiceChemicals([]);\n    setServiceWaterTest({ chlorine: '', ph: '', alkalinity: '', cya: '', hardness: '', phosphates: '', notes: '' });\n  };\n\n  // Quick complete without chemicals (legacy support)\n  const completeService = (customer, chemicalCost = 0) => {\n    openCompleteServiceModal(customer);\n  };\n\n  // Get recurring services for a month (excludes one-time jobs)\n  const getMonthServices = (custId, yearMonth) => \n    serviceHistory.filter(s => s.customerId === custId && s.date.startsWith(yearMonth) && !s.isJobService);\n\n  // Get job/service call completions for a month\n  const getMonthJobServices = (custId, yearMonth) => \n    serviceHistory.filter(s => s.customerId === custId && s.date.startsWith(yearMonth) && s.isJobService);\n\n  // Get all job services for a month (across all customers)\n  const getAllMonthJobServices = (yearMonth) => \n    serviceHistory.filter(s => s.date.startsWith(yearMonth) && s.isJobService);\n\n  const getMonthTotal = (custId, yearMonth) => \n    getMonthServices(custId, yearMonth).reduce((sum, s) => sum + s.totalAmount, 0);\n\n  // Calendar helpers\n  const getDaysInMonth = (date) => {\n    const year = date.getFullYear();\n    const month = date.getMonth();\n    const firstDay = new Date(year, month, 1).getDay();\n    const daysInMonth = new Date(year, month + 1, 0).getDate();\n    return { year, month, firstDay, daysInMonth };\n  };\n\n  const getEventsForDate = (dateStr) => {\n    const jobs = oneTimeJobs.filter(j => j.date === dateStr);\n    const recurring = recurringServices.filter(r => {\n      const customer = customers.find(c => c.id === r.customerId);\n      if (!customer) return false;\n      const serviceDate = new Date(dateStr);\n      const startDate = new Date(r.startDate || customer.createdDate);\n      if (serviceDate < startDate) return false;\n      const dayOfWeek = serviceDate.getDay();\n      const scheduledDay = r.dayOfWeek || 1; // Default Monday\n      if (r.frequency === 'weekly') return dayOfWeek === scheduledDay;\n      if (r.frequency === 'biweekly') {\n        const weeksDiff = Math.floor((serviceDate - startDate) / (7 * 24 * 60 * 60 * 1000));\n        return dayOfWeek === scheduledDay && weeksDiff % 2 === 0;\n      }\n      if (r.frequency === 'monthly') {\n        return serviceDate.getDate() === startDate.getDate();\n      }\n      return false;\n    });\n    const completed = serviceHistory.filter(s => s.date.startsWith(dateStr));\n    return { jobs, recurring, completed };\n  };\n\n  // Get customers scheduled for a specific date (from recurring services)\n  const getScheduledCustomersForDate = (dateStr, employeeFilter = 'all') => {\n    let scheduledCustomers = [];\n    \n    // Get customers from recurring services\n    recurringServices.filter(r => r.active).forEach(r => {\n      const customer = customers.find(c => c.id === r.customerId);\n      if (!customer) return;\n      \n      // Filter by employee if specified\n      if (employeeFilter !== 'all' && r.employeeId !== employeeFilter) return;\n      \n      const serviceDate = new Date(dateStr + 'T12:00:00');\n      const startDate = new Date(r.startDate || customer.createdDate);\n      if (serviceDate < startDate) return;\n      \n      const dayOfWeek = serviceDate.getDay();\n      const scheduledDay = r.dayOfWeek || 1;\n      \n      let isScheduled = false;\n      if (r.frequency === 'weekly') {\n        isScheduled = dayOfWeek === scheduledDay;\n      } else if (r.frequency === 'biweekly') {\n        const weeksDiff = Math.floor((serviceDate - startDate) / (7 * 24 * 60 * 60 * 1000));\n        isScheduled = dayOfWeek === scheduledDay && weeksDiff % 2 === 0;\n      } else if (r.frequency === 'monthly') {\n        isScheduled = serviceDate.getDate() === startDate.getDate();\n      }\n      \n      if (isScheduled && !scheduledCustomers.find(c => c.id === customer.id && c.recurringId === r.id)) {\n        scheduledCustomers.push({ \n          ...customer, \n          recurringId: r.id, \n          frequency: r.frequency,\n          scheduledTime: r.scheduledTime || null, // Add time\n          employeeId: r.employeeId || null // Add employee\n        });\n      }\n    });\n    \n    // Also add customers from one-time jobs scheduled for this date\n    oneTimeJobs.filter(j => j.date === dateStr).forEach(job => {\n      // Filter by employee if specified\n      if (employeeFilter !== 'all' && job.employeeId !== employeeFilter) return;\n      \n      const customer = customers.find(c => c.id === parseInt(job.customerId));\n      if (customer && !scheduledCustomers.find(c => c.id === customer.id && c.isOneTimeJob && c.jobId === job.id)) {\n        scheduledCustomers.push({ \n          ...customer, \n          isOneTimeJob: true, \n          jobType: job.jobType, \n          jobPrice: job.price,\n          jobId: job.id,\n          jobData: job,\n          scheduledTime: job.scheduledTime || null, // Add time\n          employeeId: job.employeeId || null // Add employee\n        });\n      }\n    });\n    \n    // Sort: timed appointments first (by time), then untimed\n    scheduledCustomers.sort((a, b) => {\n      // Both have times - sort by time\n      if (a.scheduledTime && b.scheduledTime) {\n        return a.scheduledTime.localeCompare(b.scheduledTime);\n      }\n      // Only a has time - a comes first\n      if (a.scheduledTime && !b.scheduledTime) return -1;\n      // Only b has time - b comes first\n      if (!a.scheduledTime && b.scheduledTime) return 1;\n      // Neither has time - keep original order (could add distance sorting here later)\n      return 0;\n    });\n    \n    return scheduledCustomers;\n  };\n\n  // Update route when date changes or employee filter changes\n  useEffect(() => {\n    const scheduled = getScheduledCustomersForDate(routeDate, selectedRouteEmployee);\n    setRouteCustomers(scheduled);\n  }, [routeDate, recurringServices, oneTimeJobs, customers, selectedRouteEmployee, employees]);\n\n  // Helper to change route date\n  const changeRouteDate = (days) => {\n    const current = new Date(routeDate + 'T12:00:00'); // Add time to avoid timezone issues\n    current.setDate(current.getDate() + days);\n    setRouteDate(getLocalDateString(current));\n  };\n\n  const formatRouteDate = (dateStr) => {\n    // Parse the date string as local time, not UTC\n    const [year, month, day] = dateStr.split('-').map(Number);\n    const date = new Date(year, month - 1, day);\n    \n    const today = getLocalDateString();\n    const tomorrow = new Date();\n    tomorrow.setDate(tomorrow.getDate() + 1);\n    const tomorrowStr = getLocalDateString(tomorrow);\n    const yesterday = new Date();\n    yesterday.setDate(yesterday.getDate() - 1);\n    const yesterdayStr = getLocalDateString(yesterday);\n    \n    if (dateStr === today) return 'Today';\n    if (dateStr === tomorrowStr) return 'Tomorrow';\n    if (dateStr === yesterdayStr) return 'Yesterday';\n    return date.toLocaleDateString('en-US', { weekday: 'long', month: 'short', day: 'numeric' });\n  };\n\n  const monthNames = ['January', 'February', 'March', 'April', 'May', 'June', \n                      'July', 'August', 'September', 'October', 'November', 'December'];\n\n  // Revenue data for charts\n  const [selectedYear, setSelectedYear] = useState(new Date().getFullYear());\n  \n  const getAvailableYears = () => {\n    const years = new Set();\n    years.add(new Date().getFullYear()); // Always include current year\n    serviceHistory.forEach(s => {\n      const year = new Date(s.date).getFullYear();\n      years.add(year);\n    });\n    return Array.from(years).sort((a, b) => b - a); // Descending order\n  };\n\n  const getMonthlyRevenueData = () => {\n    const months = [];\n    for (let i = 0; i < 12; i++) {\n      const date = new Date(selectedYear, i, 1);\n      const yearMonth = date.toISOString().slice(0, 7);\n      const monthRevenue = serviceHistory\n        .filter(s => s.date.startsWith(yearMonth))\n        .reduce((sum, s) => sum + s.totalAmount, 0);\n      months.push({\n        month: monthNames[i].slice(0, 3),\n        revenue: monthRevenue,\n        fullMonth: monthNames[i],\n        year: selectedYear\n      });\n    }\n    return months;\n  };\n\n  const getYearlyRevenueData = () => {\n    const years = [];\n    const currentYear = new Date().getFullYear();\n    for (let i = 4; i >= 0; i--) {\n      const year = currentYear - i;\n      const yearRevenue = serviceHistory\n        .filter(s => new Date(s.date).getFullYear() === year)\n        .reduce((sum, s) => sum + s.totalAmount, 0);\n      years.push({\n        year: year.toString(),\n        revenue: yearRevenue\n      });\n    }\n    return years;\n  };\n\n  const getYearTotal = (year) => {\n    return serviceHistory\n      .filter(s => new Date(s.date).getFullYear() === year)\n      .reduce((sum, s) => sum + s.totalAmount, 0);\n  };\n\n  const getAccountsReceivable = () => {\n    // Calculate what's owed by each customer (services - payments)\n    return customers.map(customer => {\n      const totalServices = serviceHistory\n        .filter(s => s.customerId === customer.id)\n        .reduce((sum, s) => sum + s.totalAmount, 0);\n      const totalPaid = invoices\n        .filter(inv => inv.customerId === customer.id && inv.paid)\n        .reduce((sum, inv) => sum + inv.amount, 0);\n      const balance = totalServices - totalPaid;\n      return {\n        id: customer.id,\n        name: customer.name,\n        totalServices,\n        totalPaid,\n        balance: Math.max(0, balance)\n      };\n    }).filter(c => c.balance > 0);\n  };\n\n  const getWeeklyRevenueData = () => {\n    const weeks = [];\n    const now = new Date();\n    for (let i = 7; i >= 0; i--) {\n      const weekStart = new Date(now);\n      weekStart.setDate(now.getDate() - (i * 7));\n      const weekEnd = new Date(weekStart);\n      weekEnd.setDate(weekStart.getDate() + 6);\n      \n      const weekRevenue = serviceHistory.filter(s => {\n        const serviceDate = new Date(s.date);\n        return serviceDate >= weekStart && serviceDate <= weekEnd;\n      }).reduce((sum, s) => sum + s.totalAmount, 0);\n      \n      weeks.push({\n        week: `${weekStart.getMonth() + 1}/${weekStart.getDate()}`,\n        revenue: weekRevenue\n      });\n    }\n    return weeks;\n  };\n\n  // Chemical usage tracking functions\n  const getChemicalUsageData = (timeScale) => {\n    // Get all unique chemicals used\n    const chemicalNames = new Set();\n    serviceHistory.forEach(s => {\n      if (s.chemicalsUsed) {\n        s.chemicalsUsed.forEach(c => chemicalNames.add(c.name));\n      }\n    });\n    const chemicals = Array.from(chemicalNames);\n\n    if (timeScale === 'weekly') {\n      // Last 8 weeks\n      const weeks = [];\n      const now = new Date();\n      for (let i = 7; i >= 0; i--) {\n        const weekStart = new Date(now);\n        weekStart.setDate(now.getDate() - (i * 7));\n        const weekEnd = new Date(weekStart);\n        weekEnd.setDate(weekStart.getDate() + 6);\n        \n        const weekData = {\n          period: `${weekStart.getMonth() + 1}/${weekStart.getDate()}`,\n          fullPeriod: `Week of ${weekStart.toLocaleDateString()}`\n        };\n        \n        // Calculate usage for each chemical\n        chemicals.forEach(chemName => {\n          let totalUsage = 0;\n          serviceHistory.forEach(s => {\n            const serviceDate = new Date(s.date);\n            if (serviceDate >= weekStart && serviceDate <= weekEnd && s.chemicalsUsed) {\n              const chem = s.chemicalsUsed.find(c => c.name === chemName);\n              if (chem) totalUsage += chem.quantity;\n            }\n          });\n          weekData[chemName] = totalUsage;\n        });\n        \n        weeks.push(weekData);\n      }\n      return { data: weeks, chemicals };\n    } else if (timeScale === 'monthly') {\n      // Last 12 months\n      const months = [];\n      const now = new Date();\n      for (let i = 11; i >= 0; i--) {\n        const monthDate = new Date(now.getFullYear(), now.getMonth() - i, 1);\n        const yearMonth = monthDate.toISOString().slice(0, 7);\n        \n        const monthData = {\n          period: monthNames[monthDate.getMonth()].slice(0, 3),\n          fullPeriod: `${monthNames[monthDate.getMonth()]} ${monthDate.getFullYear()}`\n        };\n        \n        chemicals.forEach(chemName => {\n          let totalUsage = 0;\n          serviceHistory.forEach(s => {\n            if (s.date.startsWith(yearMonth) && s.chemicalsUsed) {\n              const chem = s.chemicalsUsed.find(c => c.name === chemName);\n              if (chem) totalUsage += chem.quantity;\n            }\n          });\n          monthData[chemName] = totalUsage;\n        });\n        \n        months.push(monthData);\n      }\n      return { data: months, chemicals };\n    } else {\n      // Annual - last 5 years\n      const years = [];\n      const currentYear = new Date().getFullYear();\n      for (let i = 4; i >= 0; i--) {\n        const year = currentYear - i;\n        \n        const yearData = {\n          period: year.toString(),\n          fullPeriod: year.toString()\n        };\n        \n        chemicals.forEach(chemName => {\n          let totalUsage = 0;\n          serviceHistory.forEach(s => {\n            if (new Date(s.date).getFullYear() === year && s.chemicalsUsed) {\n              const chem = s.chemicalsUsed.find(c => c.name === chemName);\n              if (chem) totalUsage += chem.quantity;\n            }\n          });\n          yearData[chemName] = totalUsage;\n        });\n        \n        years.push(yearData);\n      }\n      return { data: years, chemicals };\n    }\n  };\n\n  // Get chemical usage summary for current period\n  const getChemicalUsageSummary = () => {\n    const now = new Date();\n    const currentMonth = now.toISOString().slice(0, 7);\n    const lastMonth = new Date(now.getFullYear(), now.getMonth() - 1, 1).toISOString().slice(0, 7);\n    \n    const summary = {};\n    \n    serviceHistory.forEach(s => {\n      if (s.chemicalsUsed) {\n        s.chemicalsUsed.forEach(chem => {\n          if (!summary[chem.name]) {\n            summary[chem.name] = { name: chem.name, unit: chem.unit, thisMonth: 0, lastMonth: 0, total: 0 };\n          }\n          summary[chem.name].total += chem.quantity;\n          if (s.date.startsWith(currentMonth)) {\n            summary[chem.name].thisMonth += chem.quantity;\n          } else if (s.date.startsWith(lastMonth)) {\n            summary[chem.name].lastMonth += chem.quantity;\n          }\n        });\n      }\n    });\n    \n    return Object.values(summary);\n  };\n\n  // Colors for different chemicals in chart\n  const chemicalColors = ['#0d9488', '#0ea5e9', '#8b5cf6', '#f59e0b', '#ef4444', '#22c55e', '#ec4899', '#6366f1'];\n\n  // Mark invoice as paid\n  const markInvoicePaid = (customerId, amount) => {\n    const newInvoice = {\n      id: Date.now(),\n      customerId,\n      amount,\n      paid: true,\n      paidDate: new Date().toISOString()\n    };\n    saveInvoices([...invoices, newInvoice]);\n  };\n\n  // Recurring service functions\n  const addRecurringService = (customerId, frequency, dayOfWeek, startDate, scheduledTime = null, employeeId = null) => {\n    const customer = customers.find(c => c.id === customerId);\n    if (!customer) return;\n    const recurring = {\n      id: Date.now(),\n      customerId,\n      customerName: customer.name,\n      frequency,\n      dayOfWeek: parseInt(dayOfWeek),\n      startDate,\n      scheduledTime, // Optional time for appointment\n      employeeId: employeeId ? parseInt(employeeId) : null, // Optional employee assignment\n      active: true\n    };\n    saveRecurring([...recurringServices, recurring]);\n  };\n\n  const deleteRecurringService = (id) => {\n    saveRecurring(recurringServices.filter(r => r.id !== id));\n  };\n\n  // Update recurring service (for editing time/employee)\n  const updateRecurringService = (id, updates) => {\n    saveRecurring(recurringServices.map(r => r.id === id ? { ...r, ...updates } : r));\n  };\n\n  // Update job (for editing time/employee)\n  const updateJob = (id, updates) => {\n    saveJobs(oneTimeJobs.map(j => j.id === id ? { ...j, ...updates } : j));\n  };\n\n  // Custom invoice functions\n  const addLineItem = (targetState, setTargetState) => {\n    if (newLineItem.description && newLineItem.price > 0) {\n      setTargetState({\n        ...targetState,\n        items: [...targetState.items, { ...newLineItem, id: Date.now() }]\n      });\n      setNewLineItem({ type: 'labor', description: '', modelNumber: '', quantity: 1, price: 0 });\n    }\n  };\n\n  const removeLineItem = (targetState, setTargetState, itemId) => {\n    setTargetState({\n      ...targetState,\n      items: targetState.items.filter(i => i.id !== itemId)\n    });\n  };\n\n  const generateCustomInvoice = () => {\n    const customer = customers.find(c => c.id === parseInt(customInvoice.customerId));\n    if (!customer || customInvoice.items.length === 0) return;\n\n    const total = customInvoice.items.reduce((sum, item) => sum + (item.quantity * item.price), 0);\n    const invoiceNumber = `INV-${Date.now().toString().slice(-8)}`;\n\n    const html = `<!DOCTYPE html>\n<html><head><style>\n  body { font-family: 'Segoe UI', Arial, sans-serif; max-width: 800px; margin: 40px auto; padding: 20px; color: #1e3a5f; }\n  .header { background: linear-gradient(135deg, #1e3a5f 0%, #2d5a87 100%); color: white; padding: 30px; border-radius: 12px; margin-bottom: 30px; }\n  .header h1 { margin: 0 0 5px 0; font-size: 28px; }\n  .info-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 30px; margin-bottom: 30px; }\n  .info-box h3 { margin: 0 0 10px 0; color: #1e3a5f; font-size: 14px; text-transform: uppercase; }\n  table { width: 100%; border-collapse: collapse; margin: 20px 0; }\n  th { background: #1e3a5f; color: white; padding: 12px; text-align: left; }\n  td { padding: 12px; border-bottom: 1px solid #e2e8f0; }\n  .item-type { font-size: 11px; background: #e2e8f0; padding: 2px 8px; border-radius: 4px; margin-right: 8px; }\n  .model-num { font-size: 12px; color: #666; margin-top: 4px; }\n  .total-row { background: #f1f5f9; font-weight: bold; font-size: 18px; }\n  .notes { background: #fef3c7; padding: 15px; border-radius: 8px; margin: 20px 0; }\n  .total-box { background: linear-gradient(135deg, #1e3a5f 0%, #2d5a87 100%); color: white; padding: 20px 30px; border-radius: 12px; text-align: right; }\n</style></head>\n<body>\n  <div class=\"header\"><h1> POOL AUTHORITY</h1><p>Service Invoice</p></div>\n  <div class=\"info-grid\">\n    <div class=\"info-box\"><h3>Invoice Details</h3><p><strong>Invoice #:</strong> ${invoiceNumber}</p><p><strong>Date:</strong> ${new Date().toLocaleDateString()}</p></div>\n    <div class=\"info-box\"><h3>Bill To</h3><p><strong>${customer.name}</strong></p><p>${customer.address}</p><p>${customer.phone || ''}</p><p>${customer.email || ''}</p></div>\n  </div>\n  <table>\n    <tr><th>Description</th><th>Qty</th><th>Price</th><th>Total</th></tr>\n    ${customInvoice.items.map(item => `\n      <tr>\n        <td>\n          <span class=\"item-type\">${item.type.toUpperCase()}</span>${item.description}\n          ${item.modelNumber ? `<div class=\"model-num\">Model/Part #: ${item.modelNumber}</div>` : ''}\n        </td>\n        <td>${item.quantity}</td>\n        <td>$${item.price.toFixed(2)}</td>\n        <td>$${(item.quantity * item.price).toFixed(2)}</td>\n      </tr>\n    `).join('')}\n    <tr class=\"total-row\"><td colspan=\"3\">Total Due</td><td>$${total.toFixed(2)}</td></tr>\n  </table>\n  ${customInvoice.notes ? `<div class=\"notes\"><strong>Notes:</strong> ${customInvoice.notes}</div>` : ''}\n  <div class=\"total-box\"><span>Amount Due</span><div style=\"font-size:32px;font-weight:bold;margin-top:5px;\">$${total.toFixed(2)}</div></div>\n</body></html>`;\n\n    const blob = new Blob([html], { type: 'text/html' });\n    const a = document.createElement('a');\n    a.href = URL.createObjectURL(blob);\n    a.download = `PoolAuthority-Invoice-${customer.name.replace(/\\s+/g, '-')}-${invoiceNumber}.html`;\n    a.click();\n\n    // Save to history\n    const service = {\n      id: Date.now(),\n      customerId: customer.id,\n      customerName: customer.name,\n      date: new Date().toISOString(),\n      invoiceNumber,\n      invoiceItems: customInvoice.items,\n      totalAmount: total,\n      notes: customInvoice.notes,\n      type: 'custom-invoice'\n    };\n    saveHistory([service, ...serviceHistory]);\n\n    // Email\n    if (customer.email) {\n      const subject = `Invoice ${invoiceNumber} from Pool Authority`;\n      const body = `Hi ${customer.name},\\n\\nPlease find attached your invoice ${invoiceNumber} for $${total.toFixed(2)}.\\n\\nItems:\\n${customInvoice.items.map(i => `- ${i.description}: $${(i.quantity * i.price).toFixed(2)}`).join('\\n')}\\n\\nTotal: $${total.toFixed(2)}\\n\\nThank you for your business!\\n\\nPool Authority`;\n      window.open(`mailto:${customer.email}?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`);\n    }\n\n    setCustomInvoice({ customerId: '', items: [], notes: '' });\n    setShowCustomInvoice(false);\n  };\n\n  // Quote functions\n  const generateQuote = () => {\n    const customer = customers.find(c => c.id === parseInt(currentQuote.customerId));\n    if (!customer || currentQuote.items.length === 0) return;\n\n    const total = currentQuote.items.reduce((sum, item) => sum + (item.quantity * item.price), 0);\n    const validUntil = new Date();\n    validUntil.setDate(validUntil.getDate() + currentQuote.validDays);\n\n    if (editingQuoteId) {\n      // Update existing quote\n      const updatedQuotes = quotes.map(q => {\n        if (q.id === editingQuoteId) {\n          return {\n            ...q,\n            customerId: customer.id,\n            customerName: customer.name,\n            customerEmail: customer.email,\n            items: currentQuote.items,\n            notes: currentQuote.notes,\n            total,\n            validUntil: validUntil.toISOString(),\n            validDays: currentQuote.validDays,\n            updatedDate: new Date().toISOString()\n          };\n        }\n        return q;\n      });\n      saveQuotes(updatedQuotes);\n      setEditingQuoteId(null);\n      setCurrentQuote({ customerId: '', items: [], notes: '', validDays: 30 });\n      setShowCreateQuote(false);\n      showEmailNotification('success', 'Quote updated successfully');\n      return;\n    }\n\n    // Create new quote\n    const quoteNumber = `QT-${Date.now().toString().slice(-8)}`;\n\n    const quote = {\n      id: Date.now(),\n      quoteNumber,\n      customerId: customer.id,\n      customerName: customer.name,\n      customerEmail: customer.email,\n      items: currentQuote.items,\n      notes: currentQuote.notes,\n      total,\n      validDays: currentQuote.validDays,\n      validUntil: validUntil.toISOString(),\n      status: 'pending',\n      date: new Date().toISOString(),\n      createdDate: new Date().toISOString()\n    };\n    saveQuotes([quote, ...quotes]);\n\n    const html = `<!DOCTYPE html>\n<html><head><style>\n  body { font-family: 'Segoe UI', Arial, sans-serif; max-width: 800px; margin: 40px auto; padding: 20px; color: #1e3a5f; }\n  .header { background: linear-gradient(135deg, #7c3aed 0%, #a855f7 100%); color: white; padding: 30px; border-radius: 12px; margin-bottom: 30px; }\n  .header h1 { margin: 0 0 5px 0; font-size: 28px; }\n  .validity { background: #fef3c7; padding: 15px; border-radius: 8px; margin-bottom: 20px; text-align: center; }\n  .info-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 30px; margin-bottom: 30px; }\n  .info-box h3 { margin: 0 0 10px 0; color: #1e3a5f; font-size: 14px; text-transform: uppercase; }\n  table { width: 100%; border-collapse: collapse; margin: 20px 0; }\n  th { background: #7c3aed; color: white; padding: 12px; text-align: left; }\n  td { padding: 12px; border-bottom: 1px solid #e2e8f0; }\n  .item-type { font-size: 11px; background: #e2e8f0; padding: 2px 8px; border-radius: 4px; margin-right: 8px; }\n  .model-num { font-size: 12px; color: #666; margin-top: 4px; }\n  .total-row { background: #f1f5f9; font-weight: bold; font-size: 18px; }\n  .notes { background: #f3e8ff; padding: 15px; border-radius: 8px; margin: 20px 0; }\n  .total-box { background: linear-gradient(135deg, #7c3aed 0%, #a855f7 100%); color: white; padding: 20px 30px; border-radius: 12px; text-align: right; }\n  .approve-box { background: #d1fae5; padding: 20px; border-radius: 8px; text-align: center; margin-top: 20px; }\n  .approve-btn { display: inline-block; background: #059669; color: white; padding: 15px 40px; border-radius: 8px; text-decoration: none; font-weight: bold; font-size: 18px; }\n</style></head>\n<body>\n  <div class=\"header\"><h1> POOL AUTHORITY</h1><p>Service Quote</p></div>\n  <div class=\"validity\"> This quote is valid until <strong>${validUntil.toLocaleDateString()}</strong></div>\n  <div class=\"info-grid\">\n    <div class=\"info-box\"><h3>Quote Details</h3><p><strong>Quote #:</strong> ${quoteNumber}</p><p><strong>Date:</strong> ${new Date().toLocaleDateString()}</p></div>\n    <div class=\"info-box\"><h3>Prepared For</h3><p><strong>${customer.name}</strong></p><p>${customer.address}</p><p>${customer.phone || ''}</p></div>\n  </div>\n  <table>\n    <tr><th>Description</th><th>Qty</th><th>Price</th><th>Total</th></tr>\n    ${currentQuote.items.map(item => `\n      <tr>\n        <td>\n          <span class=\"item-type\">${item.type.toUpperCase()}</span>${item.description}\n          ${item.modelNumber ? `<div class=\"model-num\">Model/Part #: ${item.modelNumber}</div>` : ''}\n        </td>\n        <td>${item.quantity}</td>\n        <td>$${item.price.toFixed(2)}</td>\n        <td>$${(item.quantity * item.price).toFixed(2)}</td>\n      </tr>\n    `).join('')}\n    <tr class=\"total-row\"><td colspan=\"3\">Quoted Total</td><td>$${total.toFixed(2)}</td></tr>\n  </table>\n  ${currentQuote.notes ? `<div class=\"notes\"><strong>Notes:</strong> ${currentQuote.notes}</div>` : ''}\n  <div class=\"total-box\"><span>Quoted Price</span><div style=\"font-size:32px;font-weight:bold;margin-top:5px;\">$${total.toFixed(2)}</div></div>\n  <div class=\"approve-box\">\n    <p><strong>Ready to proceed?</strong></p>\n    <p>Reply to this email or call us to approve this quote!</p>\n  </div>\n</body></html>`;\n\n    // Store the HTML in the quote for later PDF download (don't auto-download)\n    quote.pdfHtml = html;\n    saveQuotes([quote, ...quotes]);\n\n    setCurrentQuote({ customerId: '', items: [], notes: '', validDays: 30 });\n    setShowCreateQuote(false);\n    showEmailNotification('success', `Quote ${quoteNumber} created! Use PDF or Email buttons to send to customer.`);\n  };\n\n  // Stripe Payment Functions\n  const [isProcessingPayment, setIsProcessingPayment] = useState(false);\n  const [paymentError, setPaymentError] = useState('');\n\n  const createStripeCheckout = async (customer, amount, description, invoiceNumber) => {\n    setIsProcessingPayment(true);\n    setPaymentError('');\n    \n    try {\n      const response = await fetch(`${PAYMENT_SERVER_URL}/api/create-checkout-session`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({\n          customerName: customer.name,\n          customerEmail: customer.email,\n          amount: amount,\n          description: description,\n          invoiceNumber: invoiceNumber,\n          customerId: customer.id.toString(),\n          successUrl: window.location.origin + '/payment-success',\n          cancelUrl: window.location.origin + '/payment-cancelled'\n        }),\n      });\n\n      const data = await response.json();\n      \n      if (data.success && data.paymentUrl) {\n        return data;\n      } else {\n        throw new Error(data.error || 'Failed to create payment session');\n      }\n    } catch (error) {\n      console.error('Stripe checkout error:', error);\n      setPaymentError(error.message);\n      return null;\n    } finally {\n      setIsProcessingPayment(false);\n    }\n  };\n\n  const openPaymentRequest = (customerId, amount, description = '', invoiceId = '') => {\n    setPaymentDetails({ customerId, amount, description, invoiceId });\n    setPaymentError('');\n    setShowPaymentModal(true);\n  };\n\n  const sendPaymentRequest = async () => {\n    const customer = customers.find(c => c.id === parseInt(paymentDetails.customerId));\n    if (!customer) {\n      setPaymentError('Please select a customer');\n      return;\n    }\n\n    if (paymentDetails.amount <= 0) {\n      setPaymentError('Please enter a valid amount');\n      return;\n    }\n\n    const invoiceNumber = paymentDetails.invoiceId || `PAY-${Date.now().toString().slice(-8)}`;\n    \n    // Try to create real Stripe Checkout\n    const stripeResult = await createStripeCheckout(\n      customer, \n      paymentDetails.amount, \n      paymentDetails.description || `Pool Authority - Invoice ${invoiceNumber}`,\n      invoiceNumber\n    );\n\n    if (stripeResult && stripeResult.paymentUrl) {\n      // Save payment request to track it\n      const newInvoice = {\n        id: Date.now(),\n        customerId: customer.id,\n        customerName: customer.name,\n        customerEmail: customer.email,\n        amount: paymentDetails.amount,\n        description: paymentDetails.description,\n        invoiceNumber,\n        stripeSessionId: stripeResult.sessionId,\n        paymentUrl: stripeResult.paymentUrl,\n        status: 'pending',\n        paid: false,\n        createdDate: new Date().toISOString(),\n        type: 'payment-request'\n      };\n      saveInvoices([newInvoice, ...invoices]);\n\n      setShowPaymentModal(false);\n      setPaymentDetails({ customerId: '', amount: 0, description: '', invoiceId: '' });\n      \n      // Ask if they want to open the payment link or copy it\n      const openNow = window.confirm(\n        ` Payment link created!\\n\\n` +\n        `Customer: ${customer.name}\\n` +\n        `Amount: $${paymentDetails.amount.toFixed(2)}\\n` +\n        `Invoice #: ${invoiceNumber}\\n\\n` +\n        `Click OK to open the payment page now, or Cancel to copy the link.`\n      );\n\n      if (openNow) {\n        window.open(stripeResult.paymentUrl, '_blank');\n      } else {\n        // Copy to clipboard\n        navigator.clipboard.writeText(stripeResult.paymentUrl).then(() => {\n          alert('Payment link copied to clipboard!\\n\\nSend this link to your customer.');\n        }).catch(() => {\n          // Fallback - show the URL\n          prompt('Copy this payment link:', stripeResult.paymentUrl);\n        });\n      }\n    } else {\n      // Fallback to offline mode if server not available\n      const fallbackConfirm = window.confirm(\n        ` Could not connect to payment server.\\n\\n` +\n        `Error: ${paymentError || 'Server unavailable'}\\n\\n` +\n        `Would you like to create an offline payment request instead?`\n      );\n\n      if (fallbackConfirm) {\n        createOfflinePaymentRequest(customer, paymentDetails.amount, paymentDetails.description, invoiceNumber);\n      }\n    }\n  };\n\n  const createOfflinePaymentRequest = (customer, amount, description, invoiceNumber) => {\n    // Fallback HTML payment request for when server is not available\n    const html = `<!DOCTYPE html>\n<html><head><style>\n  body { font-family: 'Segoe UI', Arial, sans-serif; max-width: 600px; margin: 40px auto; padding: 20px; color: #1e3a5f; }\n  .header { background: linear-gradient(135deg, #1e3a5f 0%, #2d5a87 100%); color: white; padding: 30px; border-radius: 12px; margin-bottom: 30px; text-align: center; }\n  .amount-box { background: #f8fafc; border: 2px solid #e2e8f0; border-radius: 12px; padding: 30px; text-align: center; margin: 20px 0; }\n  .amount { font-size: 48px; font-weight: bold; color: #1e3a5f; }\n  .details { background: #f1f5f9; padding: 20px; border-radius: 8px; margin: 20px 0; }\n  .note { background: #fef3c7; padding: 15px; border-radius: 8px; margin-top: 20px; }\n</style></head>\n<body>\n  <div class=\"header\">\n    <h1> POOL AUTHORITY</h1>\n    <p>Payment Request</p>\n  </div>\n  <p>Hi ${customer.name},</p>\n  <p>${description || 'Please find your payment request below.'}</p>\n  <div class=\"amount-box\">\n    <div style=\"color:#666;font-size:14px;margin-bottom:10px;\">Amount Due</div>\n    <div class=\"amount\">$${amount.toFixed(2)}</div>\n  </div>\n  <div class=\"details\">\n    <strong>Payment Details:</strong><br>\n    Invoice #: ${invoiceNumber}<br>\n    Date: ${new Date().toLocaleDateString()}<br>\n    ${description ? `Description: ${description}` : ''}\n  </div>\n  <div class=\"note\">\n    <strong>How to Pay:</strong><br>\n    Please contact Pool Authority to arrange payment via credit card, check, or bank transfer.\n  </div>\n</body></html>`;\n\n    const blob = new Blob([html], { type: 'text/html' });\n    const a = document.createElement('a');\n    a.href = URL.createObjectURL(blob);\n    a.download = `PoolAuthority-PaymentRequest-${customer.name.replace(/\\s+/g, '-')}-${invoiceNumber}.html`;\n    a.click();\n\n    // Save payment request\n    const newInvoice = {\n      id: Date.now(),\n      customerId: customer.id,\n      customerName: customer.name,\n      amount: amount,\n      description: description,\n      invoiceNumber,\n      status: 'pending',\n      paid: false,\n      createdDate: new Date().toISOString(),\n      type: 'payment-request',\n      offline: true\n    };\n    saveInvoices([newInvoice, ...invoices]);\n\n    setShowPaymentModal(false);\n    setPaymentDetails({ customerId: '', amount: 0, description: '', invoiceId: '' });\n  };\n\n  const checkPaymentStatus = async (sessionId) => {\n    try {\n      const response = await fetch(`${PAYMENT_SERVER_URL}/api/payment-status/${sessionId}`);\n      const data = await response.json();\n      return data;\n    } catch (error) {\n      console.error('Error checking payment status:', error);\n      return null;\n    }\n  };\n\n  const refreshPaymentStatuses = async () => {\n    const pendingPayments = invoices.filter(i => i.stripeSessionId && !i.paid);\n    \n    for (const payment of pendingPayments) {\n      const status = await checkPaymentStatus(payment.stripeSessionId);\n      if (status && status.status === 'paid') {\n        saveInvoices(invoices.map(inv => \n          inv.id === payment.id \n            ? { ...inv, status: 'paid', paid: true, paidDate: new Date().toISOString() }\n            : inv\n        ));\n      }\n    }\n  };\n\n  const markPaymentReceived = (invoiceId) => {\n    saveInvoices(invoices.map(inv => \n      inv.id === invoiceId ? { ...inv, status: 'paid', paid: true, paidDate: new Date().toISOString() } : inv\n    ));\n  };\n\n  // Email Functions\n  const showEmailNotification = (type, message) => {\n    setEmailNotification({ type, message });\n    setTimeout(() => setEmailNotification(null), 4000);\n  };\n\n  const sendInvoiceEmail = async (customer, invoiceData, paymentLink = null) => {\n    if (!customer.email) {\n      showEmailNotification('error', 'Customer has no email address');\n      return false;\n    }\n\n    setIsSendingEmail(true);\n    try {\n      // Build itemized service list\n      let itemizedServices = '';\n      if (invoiceData.services && invoiceData.services.length > 0) {\n        itemizedServices = invoiceData.services.map(s => \n          ` ${new Date(s.date).toLocaleDateString()} - $${s.totalAmount.toFixed(2)}`\n        ).join('\\n');\n      }\n      \n      // Calculate due date based on payment terms\n      const termsDays = invoiceData.paymentTerms === 'due_receipt' ? 0 : \n                        invoiceData.paymentTerms === 'net15' ? 15 :\n                        invoiceData.paymentTerms === 'net30' ? 30 : 15;\n      const dueDate = new Date();\n      dueDate.setDate(dueDate.getDate() + termsDays);\n      const dueDateStr = dueDate.toLocaleDateString();\n      const termsText = invoiceData.paymentTerms === 'due_receipt' ? 'Due Upon Receipt' :\n                        invoiceData.paymentTerms === 'net15' ? 'Net 15' :\n                        invoiceData.paymentTerms === 'net30' ? 'Net 30' : 'Net 15';\n\n      const response = await fetch(`${PAYMENT_SERVER_URL}/send-invoice`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({\n          to: customer.email,\n          template: emailTemplates.monthlyInvoice,\n          data: {\n            customer_name: customer.name,\n            month: invoiceData.month,\n            service_summary: invoiceData.serviceSummary,\n            itemized_services: itemizedServices,\n            subtotal: invoiceData.subtotal.toFixed(2),\n            chemical_total: invoiceData.chemicalTotal.toFixed(2),\n            total: invoiceData.total.toFixed(2),\n            payment_terms: termsText,\n            due_date: dueDateStr\n          },\n          companySettings,\n          paymentLink\n        })\n      });\n\n      const result = await response.json();\n      \n      if (result.success) {\n        // Log the email\n        const logEntry = {\n          id: Date.now(),\n          type: 'invoice',\n          to: customer.email,\n          customerName: customer.name,\n          subject: `Invoice for ${invoiceData.month}`,\n          sentDate: new Date().toISOString(),\n          status: 'sent'\n        };\n        saveEmailLog([logEntry, ...emailLog]);\n        // Mark customer as billed for this month (persisted with date and terms)\n        if (invoiceData.billingMonth) {\n          const newBilledCustomers = { \n            ...billedCustomers, \n            [`${customer.id}-${invoiceData.billingMonth}`]: {\n              billed: true,\n              billedDate: new Date().toISOString(),\n              terms: invoiceData.paymentTerms || 'net15',\n              amount: invoiceData.total\n            }\n          };\n          saveBilledCustomers(newBilledCustomers);\n        }\n        showEmailNotification('success', `Invoice sent to ${customer.email}`);\n        return true;\n      } else {\n        throw new Error(result.error || 'Failed to send email');\n      }\n    } catch (error) {\n      console.error('Email error:', error);\n      showEmailNotification('error', `Failed to send email: ${error.message}`);\n      return false;\n    } finally {\n      setIsSendingEmail(false);\n    }\n  };\n\n  const sendWeeklyUpdateEmail = async (customer, serviceData) => {\n    if (!customer.email) {\n      showEmailNotification('error', 'Customer has no email address');\n      return false;\n    }\n\n    setIsSendingEmail(true);\n    try {\n      const chemicalsUsed = serviceData.chemicalsUsed?.length > 0\n        ? serviceData.chemicalsUsed.map(c => ` ${c.name}: ${c.quantity} ${c.unit}`).join('\\n')\n        : '';\n      \n      // Format water test results if available\n      let waterTestResults = '';\n      if (serviceData.waterTest) {\n        const wt = serviceData.waterTest;\n        const results = [];\n        if (wt.chlorine) results.push(`Chlorine: ${wt.chlorine} ppm`);\n        if (wt.ph) results.push(`pH: ${wt.ph}`);\n        if (wt.alkalinity) results.push(`Alkalinity: ${wt.alkalinity}`);\n        if (wt.cya) results.push(`CYA: ${wt.cya}`);\n        if (wt.hardness) results.push(`Hardness: ${wt.hardness}`);\n        if (wt.phosphates) results.push(`Phosphates: ${wt.phosphates} ppb`);\n        if (results.length > 0) {\n          waterTestResults = results.join(' | ');\n        }\n      }\n\n      const response = await fetch(`${PAYMENT_SERVER_URL}/send-weekly-update`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({\n          to: customer.email,\n          template: emailTemplates.weeklyUpdate,\n          data: {\n            customer_name: customer.name,\n            service_date: new Date(serviceData.date).toLocaleDateString(),\n            chemicals_used: chemicalsUsed,\n            water_test: waterTestResults,\n            service_notes: serviceData.notes || ''\n          },\n          companySettings\n        })\n      });\n\n      const result = await response.json();\n      \n      if (result.success) {\n        const logEntry = {\n          id: Date.now(),\n          type: 'weekly-update',\n          to: customer.email,\n          customerName: customer.name,\n          subject: 'Weekly Pool Service Update',\n          sentDate: new Date().toISOString(),\n          status: 'sent'\n        };\n        saveEmailLog([logEntry, ...emailLog]);\n        showEmailNotification('success', `Weekly update sent to ${customer.email}`);\n        return true;\n      } else {\n        throw new Error(result.error || 'Failed to send email');\n      }\n    } catch (error) {\n      console.error('Email error:', error);\n      showEmailNotification('error', `Failed to send email: ${error.message}`);\n      return false;\n    } finally {\n      setIsSendingEmail(false);\n    }\n  };\n\n  // Download Quote as PDF/HTML\n  const downloadQuotePdf = (quote) => {\n    const customer = customers.find(c => c.id === quote.customerId);\n    const validUntil = new Date(quote.validUntil).toLocaleDateString();\n    \n    const html = `<!DOCTYPE html>\n<html><head><style>\n  body { font-family: 'Segoe UI', Arial, sans-serif; max-width: 800px; margin: 40px auto; padding: 20px; color: #1e3a5f; }\n  .header { background: linear-gradient(135deg, #7c3aed 0%, #9333ea 100%); color: white; padding: 30px; border-radius: 12px; margin-bottom: 30px; display: flex; align-items: center; gap: 20px; }\n  .header h1 { margin: 0 0 5px 0; font-size: 28px; }\n  .logo { width: 60px; height: 60px; }\n  .info-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 30px; margin-bottom: 30px; }\n  .info-box h3 { margin: 0 0 10px 0; color: #1e3a5f; font-size: 14px; text-transform: uppercase; letter-spacing: 1px; }\n  .info-box p { margin: 5px 0; color: #4a5568; }\n  table { width: 100%; border-collapse: collapse; margin: 20px 0; }\n  th { background: #7c3aed; color: white; padding: 12px; text-align: left; }\n  td { padding: 12px; border-bottom: 1px solid #e2e8f0; }\n  .total-box { background: linear-gradient(135deg, #7c3aed 0%, #9333ea 100%); color: white; padding: 20px 30px; border-radius: 12px; text-align: right; }\n  .total-box span { font-size: 14px; opacity: 0.9; }\n  .total-box div { font-size: 32px; font-weight: bold; margin-top: 5px; }\n  .validity { background: #fef3c7; padding: 15px; border-radius: 8px; margin-bottom: 20px; text-align: center; }\n</style></head>\n<body>\n  <div class=\"header\">\n    <svg viewBox=\"0 0 100 110\" class=\"logo\">\n      <path d=\"M50 5 L90 25 L90 70 Q90 95 50 105 Q10 95 10 70 L10 25 Z\" fill=\"#a855f7\"/>\n      <path d=\"M50 12 L83 28 L83 68 Q83 88 50 98 Q17 88 17 68 L17 28 Z\" fill=\"white\" opacity=\"0.3\"/>\n      <path d=\"M20 35 Q35 40 50 35 Q65 30 80 35\" stroke=\"white\" stroke-width=\"2\" fill=\"none\" opacity=\"0.8\"/>\n      <path d=\"M20 48 Q35 53 50 48 Q65 43 80 48\" stroke=\"white\" stroke-width=\"2\" fill=\"none\" opacity=\"0.8\"/>\n      <path d=\"M20 61 Q35 66 50 61 Q65 56 80 61\" stroke=\"white\" stroke-width=\"2\" fill=\"none\" opacity=\"0.8\"/>\n    </svg>\n    <div>\n      <h1>POOL AUTHORITY</h1>\n      <p style=\"margin:0;opacity:0.9;\">Quote</p>\n    </div>\n  </div>\n  <h2 style=\"color:#7c3aed;\">${quote.quoteNumber}</h2>\n  <div class=\"validity\"> This quote is valid until <strong>${validUntil}</strong></div>\n  <div class=\"info-grid\">\n    <div class=\"info-box\">\n      <h3>Quote For</h3>\n      <p><strong>${customer?.name || quote.customerName}</strong></p>\n      <p>${customer?.address || ''}</p>\n      ${customer?.phone ? `<p>${customer.phone}</p>` : ''}\n      ${customer?.email ? `<p>${customer.email}</p>` : ''}\n    </div>\n    <div class=\"info-box\">\n      <h3>Quote Details</h3>\n      <p><strong>Quote #:</strong> ${quote.quoteNumber}</p>\n      <p><strong>Date:</strong> ${new Date(quote.date).toLocaleDateString()}</p>\n      <p><strong>Valid Until:</strong> ${validUntil}</p>\n    </div>\n  </div>\n  <table>\n    <thead>\n      <tr>\n        <th>Description</th>\n        <th>Type</th>\n        <th>Qty</th>\n        <th>Price</th>\n        <th>Total</th>\n      </tr>\n    </thead>\n    <tbody>\n      ${quote.items.map(item => `\n        <tr>\n          <td>${item.description}${item.modelNumber ? `<br><small style=\"color:#666;\">Part #: ${item.modelNumber}</small>` : ''}</td>\n          <td><span style=\"background:#f3e8ff;padding:2px 8px;border-radius:4px;font-size:12px;\">${item.type}</span></td>\n          <td>${item.quantity}</td>\n          <td>$${item.price.toFixed(2)}</td>\n          <td><strong>$${(item.quantity * item.price).toFixed(2)}</strong></td>\n        </tr>\n      `).join('')}\n    </tbody>\n  </table>\n  <div class=\"total-box\">\n    <span>Quote Total</span>\n    <div>$${quote.total.toFixed(2)}</div>\n  </div>\n  ${quote.notes ? `<div style=\"margin-top:20px;padding:15px;background:#f8fafc;border-radius:8px;\"><strong>Notes:</strong><br>${quote.notes}</div>` : ''}\n  <p style=\"text-align:center;margin-top:30px;color:#666;\">To accept this quote, please contact us. Thank you for choosing Pool Authority!</p>\n</body></html>`;\n\n    const blob = new Blob([html], { type: 'text/html' });\n    const a = document.createElement('a');\n    a.href = URL.createObjectURL(blob);\n    a.download = `PoolAuthority-Quote-${quote.quoteNumber}.html`;\n    a.click();\n  };\n\n  const sendQuoteEmail = async (quote, customer) => {\n    if (!customer.email) {\n      showEmailNotification('error', 'Customer has no email address');\n      return false;\n    }\n\n    setIsSendingEmail(true);\n    try {\n      const lineItems = quote.items.map(i => ` ${i.description}${i.modelNumber ? ` (${i.modelNumber})` : ''} x${i.quantity} - $${(i.quantity * i.price).toFixed(2)}`).join('\\n');\n\n      const response = await fetch(`${PAYMENT_SERVER_URL}/send-quote`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({\n          to: customer.email,\n          template: emailTemplates.quote,\n          data: {\n            customer_name: customer.name,\n            quote_number: quote.quoteNumber,\n            quote_date: new Date(quote.date).toLocaleDateString(),\n            valid_days: quote.validDays || '30',\n            line_items: lineItems,\n            total: quote.total.toFixed(2)\n          },\n          companySettings\n        })\n      });\n\n      const result = await response.json();\n      \n      if (result.success) {\n        const logEntry = {\n          id: Date.now(),\n          type: 'quote',\n          to: customer.email,\n          customerName: customer.name,\n          subject: `Quote #${quote.quoteNumber}`,\n          sentDate: new Date().toISOString(),\n          status: 'sent'\n        };\n        saveEmailLog([logEntry, ...emailLog]);\n        showEmailNotification('success', `Quote sent to ${customer.email}`);\n        return true;\n      } else {\n        throw new Error(result.error || 'Failed to send email');\n      }\n    } catch (error) {\n      console.error('Email error:', error);\n      showEmailNotification('error', `Failed to send email: ${error.message}`);\n      return false;\n    } finally {\n      setIsSendingEmail(false);\n    }\n  };\n\n  const sendJobCompletionEmail = async (customer, jobData, paymentLink = null) => {\n    if (!customer.email) {\n      showEmailNotification('error', 'Customer has no email address');\n      return false;\n    }\n\n    setIsSendingEmail(true);\n    try {\n      // Build itemized list\n      let itemsList = '';\n      if (jobData.additionalItems?.length > 0) {\n        itemsList = jobData.additionalItems.map(i => ` ${i.name} x${i.quantity} - $${i.totalCost.toFixed(2)}`).join('\\n');\n      }\n      \n      const chemicalsUsed = jobData.chemicalsUsed?.length > 0\n        ? jobData.chemicalsUsed.map(c => ` ${c.name}: ${c.quantity} ${c.unit}`).join('\\n')\n        : '';\n\n      const paymentSection = paymentLink \n        ? `\\n**Pay Online:** ${paymentLink}\\n`\n        : '';\n\n      const jobTemplate = {\n        subject: `Service Invoice - ${jobData.jobType} - {{company_name}}`,\n        body: `Hi {{customer_name}},\n\nWe've completed the following work at your property:\n\n**Job Type:** ${jobData.jobType}\n**Date:** {{service_date}}\n\n**Invoice Details:**\n\nLabor/Service: $${jobData.basePrice.toFixed(2)}\n${itemsList ? `\\n**Parts & Materials:**\\n${itemsList}\\n` : ''}${chemicalsUsed ? `\\n**Chemicals Applied:**\\n${chemicalsUsed}\\n` : ''}\n\n**Total Due:** $${jobData.total.toFixed(2)}\n${paymentSection}\n${jobData.notes ? `**Technician Notes:**\\n${jobData.notes}\\n` : ''}\nThank you for your business!\n\nBest regards,\n{{owner_name}}\n{{company_name}}\n{{company_phone}}`\n      };\n\n      const response = await fetch(`${PAYMENT_SERVER_URL}/send-weekly-update`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({\n          to: customer.email,\n          template: jobTemplate,\n          data: {\n            customer_name: customer.name,\n            service_date: new Date().toLocaleDateString()\n          },\n          companySettings,\n          paymentLink\n        })\n      });\n\n      const result = await response.json();\n      \n      if (result.success) {\n        const logEntry = {\n          id: Date.now(),\n          type: 'job-invoice',\n          to: customer.email,\n          customerName: customer.name,\n          subject: `Service Invoice - ${jobData.jobType}`,\n          sentDate: new Date().toISOString(),\n          status: 'sent'\n        };\n        saveEmailLog([logEntry, ...emailLog]);\n        showEmailNotification('success', `Job invoice email sent to ${customer.email}`);\n        return true;\n      } else {\n        throw new Error(result.error || 'Failed to send email');\n      }\n    } catch (error) {\n      console.error('Email error:', error);\n      showEmailNotification('error', `Failed to send email: ${error.message}`);\n      return false;\n    } finally {\n      setIsSendingEmail(false);\n    }\n  };\n\n  const sendPaymentReminder = async (customer, reminderData, paymentLink = null) => {\n    if (!customer.email) {\n      showEmailNotification('error', 'Customer has no email address');\n      return false;\n    }\n\n    setIsSendingEmail(true);\n    try {\n      const response = await fetch(`${PAYMENT_SERVER_URL}/send-invoice`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({\n          to: customer.email,\n          template: emailTemplates.paymentReminder,\n          data: {\n            customer_name: customer.name,\n            month: reminderData.month,\n            service_summary: reminderData.serviceSummary,\n            total: reminderData.total.toFixed(2),\n            days_past_due: reminderData.daysPastDue\n          },\n          companySettings,\n          paymentLink\n        })\n      });\n\n      const result = await response.json();\n      \n      if (result.success) {\n        const logEntry = {\n          id: Date.now(),\n          type: 'payment-reminder',\n          to: customer.email,\n          customerName: customer.name,\n          subject: `Payment Reminder for ${reminderData.month}`,\n          sentDate: new Date().toISOString(),\n          status: 'sent'\n        };\n        saveEmailLog([logEntry, ...emailLog]);\n        showEmailNotification('success', `Payment reminder sent to ${customer.email}`);\n        return true;\n      } else {\n        throw new Error(result.error || 'Failed to send email');\n      }\n    } catch (error) {\n      console.error('Email error:', error);\n      showEmailNotification('error', `Failed to send email: ${error.message}`);\n      return false;\n    } finally {\n      setIsSendingEmail(false);\n    }\n  };\n\n  const updateQuoteStatus = (quoteId, status) => {\n    saveQuotes(quotes.map(q => q.id === quoteId ? { ...q, status } : q));\n  };\n\n  // Open modal to schedule quote as job\n  const convertQuoteToJob = (quote) => {\n    setQuoteToSchedule(quote);\n    setQuoteJobDate(getLocalDateString()); // Default to today\n    setShowScheduleQuoteJob(true);\n  };\n\n  // Actually create the job with selected date\n  const confirmQuoteToJob = () => {\n    if (!quoteToSchedule || !quoteJobDate) return;\n    \n    const customer = customers.find(c => c.id === quoteToSchedule.customerId);\n    if (!customer) return;\n    \n    const job = {\n      id: Date.now(),\n      customerId: quoteToSchedule.customerId,\n      customerName: quoteToSchedule.customerName,\n      jobType: 'quoted-work',\n      date: quoteJobDate,\n      price: quoteToSchedule.total,\n      notes: `From Quote ${quoteToSchedule.quoteNumber}: ${quoteToSchedule.items.map(i => i.description).join(', ')}`,\n      quoteId: quoteToSchedule.id,\n      quoteItems: quoteToSchedule.items // Store quote items for reference\n    };\n    saveJobs([...oneTimeJobs, job]);\n    updateQuoteStatus(quoteToSchedule.id, 'approved');\n    \n    // Close modal and reset\n    setShowScheduleQuoteJob(false);\n    setQuoteToSchedule(null);\n    setQuoteJobDate('');\n    \n    showEmailNotification('success', `Job scheduled for ${new Date(quoteJobDate + 'T12:00:00').toLocaleDateString('en-US', { weekday: 'long', month: 'short', day: 'numeric' })}`);\n  };\n\n  // Convert approved quote directly to invoice\n  const convertQuoteToInvoice = (quote) => {\n    const customer = customers.find(c => c.id === quote.customerId);\n    if (!customer) return;\n\n    const invoiceNumber = `INV-${Date.now().toString().slice(-8)}`;\n    const total = quote.total;\n\n    const html = `<!DOCTYPE html>\n<html><head><style>\n  body { font-family: 'Segoe UI', Arial, sans-serif; max-width: 800px; margin: 40px auto; padding: 20px; color: #1e3a5f; }\n  .header { background: linear-gradient(135deg, #1e3a5f 0%, #2d5a87 100%); color: white; padding: 30px; border-radius: 12px; margin-bottom: 30px; display: flex; align-items: center; gap: 20px; }\n  .header h1 { margin: 0 0 5px 0; font-size: 28px; }\n  .logo { width: 60px; height: 60px; }\n  .info-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 30px; margin-bottom: 30px; }\n  .info-box h3 { margin: 0 0 10px 0; color: #1e3a5f; font-size: 14px; text-transform: uppercase; }\n  table { width: 100%; border-collapse: collapse; margin: 20px 0; }\n  th { background: #1e3a5f; color: white; padding: 12px; text-align: left; }\n  td { padding: 12px; border-bottom: 1px solid #e2e8f0; }\n  .item-type { font-size: 11px; background: #e2e8f0; padding: 2px 8px; border-radius: 4px; margin-right: 8px; }\n  .model-num { font-size: 12px; color: #666; margin-top: 4px; }\n  .total-row { background: #f1f5f9; font-weight: bold; font-size: 18px; }\n  .quote-ref { background: #fef3c7; padding: 10px 15px; border-radius: 8px; margin-bottom: 20px; font-size: 14px; }\n  .total-box { background: linear-gradient(135deg, #1e3a5f 0%, #2d5a87 100%); color: white; padding: 20px 30px; border-radius: 12px; text-align: right; }\n</style></head>\n<body>\n  <div class=\"header\">\n    <svg viewBox=\"0 0 100 110\" class=\"logo\">\n      <path d=\"M50 5 L90 25 L90 70 Q90 95 50 105 Q10 95 10 70 L10 25 Z\" fill=\"#5bb4d8\"/>\n      <path d=\"M50 12 L83 28 L83 68 Q83 88 50 98 Q17 88 17 68 L17 28 Z\" fill=\"white\" opacity=\"0.3\"/>\n      <path d=\"M20 35 Q35 40 50 35 Q65 30 80 35\" stroke=\"white\" stroke-width=\"2\" fill=\"none\" opacity=\"0.8\"/>\n      <path d=\"M20 48 Q35 53 50 48 Q65 43 80 48\" stroke=\"white\" stroke-width=\"2\" fill=\"none\" opacity=\"0.8\"/>\n      <path d=\"M20 61 Q35 66 50 61 Q65 56 80 61\" stroke=\"white\" stroke-width=\"2\" fill=\"none\" opacity=\"0.8\"/>\n    </svg>\n    <div>\n      <h1>POOL AUTHORITY</h1>\n      <p style=\"margin:0;opacity:0.9;\">Service Invoice</p>\n    </div>\n  </div>\n  <div class=\"quote-ref\"> Based on approved Quote: <strong>${quote.quoteNumber}</strong></div>\n  <div class=\"info-grid\">\n    <div class=\"info-box\"><h3>Invoice Details</h3><p><strong>Invoice #:</strong> ${invoiceNumber}</p><p><strong>Date:</strong> ${new Date().toLocaleDateString()}</p></div>\n    <div class=\"info-box\"><h3>Bill To</h3><p><strong>${customer.name}</strong></p><p>${customer.address}</p><p>${customer.phone || ''}</p><p>${customer.email || ''}</p></div>\n  </div>\n  <table>\n    <tr><th>Description</th><th>Qty</th><th>Price</th><th>Total</th></tr>\n    ${quote.items.map(item => `\n      <tr>\n        <td>\n          <span class=\"item-type\">${item.type.toUpperCase()}</span>${item.description}\n          ${item.modelNumber ? `<div class=\"model-num\">Model/Part #: ${item.modelNumber}</div>` : ''}\n        </td>\n        <td>${item.quantity}</td>\n        <td>$${item.price.toFixed(2)}</td>\n        <td>$${(item.quantity * item.price).toFixed(2)}</td>\n      </tr>\n    `).join('')}\n    <tr class=\"total-row\"><td colspan=\"3\">Total Due</td><td>$${total.toFixed(2)}</td></tr>\n  </table>\n  ${quote.notes ? `<div style=\"background:#f3e8ff;padding:15px;border-radius:8px;margin:20px 0;\"><strong>Notes:</strong> ${quote.notes}</div>` : ''}\n  <div class=\"total-box\"><span>Amount Due</span><div style=\"font-size:32px;font-weight:bold;margin-top:5px;\">$${total.toFixed(2)}</div></div>\n</body></html>`;\n\n    const blob = new Blob([html], { type: 'text/html' });\n    const a = document.createElement('a');\n    a.href = URL.createObjectURL(blob);\n    a.download = `PoolAuthority-Invoice-${customer.name.replace(/\\s+/g, '-')}-${invoiceNumber}.html`;\n    a.click();\n\n    // Save to history\n    const service = {\n      id: Date.now(),\n      customerId: customer.id,\n      customerName: customer.name,\n      date: new Date().toISOString(),\n      invoiceNumber,\n      invoiceItems: quote.items,\n      totalAmount: total,\n      notes: `Converted from Quote ${quote.quoteNumber}`,\n      type: 'custom-invoice',\n      quoteNumber: quote.quoteNumber\n    };\n    saveHistory([service, ...serviceHistory]);\n    updateQuoteStatus(quote.id, 'invoiced');\n\n    // Email\n    if (customer.email) {\n      const subject = `Invoice ${invoiceNumber} from Pool Authority`;\n      const body = `Hi ${customer.name},\\n\\nThank you for approving Quote ${quote.quoteNumber}!\\n\\nPlease find attached your invoice ${invoiceNumber} for $${total.toFixed(2)}.\\n\\nItems:\\n${quote.items.map(i => `- ${i.description}: $${(i.quantity * i.price).toFixed(2)}`).join('\\n')}\\n\\nTotal: $${total.toFixed(2)}\\n\\nThank you for your business!\\n\\nPool Authority`;\n      window.open(`mailto:${customer.email}?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`);\n    }\n  };\n\n  // Invoice generation\n  const downloadInvoice = (customer, yearMonth, paymentTerms = 'net15') => {\n    const services = getMonthServices(customer.id, yearMonth);\n    const total = services.reduce((sum, s) => sum + s.totalAmount, 0);\n    const totalChemicals = services.reduce((sum, s) => sum + (s.chemicalCost || 0), 0);\n    const monthName = new Date(yearMonth + '-01').toLocaleDateString('en-US', { month: 'long', year: 'numeric' });\n    \n    // Calculate due date\n    const termsDays = paymentTerms === 'due_receipt' ? 0 : paymentTerms === 'net15' ? 15 : 30;\n    const dueDate = new Date();\n    dueDate.setDate(dueDate.getDate() + termsDays);\n    const dueDateStr = dueDate.toLocaleDateString();\n    const termsText = paymentTerms === 'due_receipt' ? 'Due Upon Receipt' : paymentTerms === 'net15' ? 'Net 15' : 'Net 30';\n    \n    const html = `<!DOCTYPE html>\n<html><head><style>\n  body { font-family: 'Segoe UI', Arial, sans-serif; max-width: 800px; margin: 40px auto; padding: 20px; color: #1e3a5f; }\n  .header { background: linear-gradient(135deg, #1e3a5f 0%, #2d5a87 100%); color: white; padding: 30px; border-radius: 12px; margin-bottom: 30px; display: flex; align-items: center; gap: 20px; }\n  .header h1 { margin: 0 0 5px 0; font-size: 28px; }\n  .logo { width: 60px; height: 60px; }\n  .info-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 30px; margin-bottom: 30px; }\n  .info-box h3 { margin: 0 0 10px 0; color: #1e3a5f; font-size: 14px; text-transform: uppercase; letter-spacing: 1px; }\n  .info-box p { margin: 5px 0; color: #4a5568; }\n  table { width: 100%; border-collapse: collapse; margin: 20px 0; }\n  th { background: #1e3a5f; color: white; padding: 12px; text-align: left; }\n  td { padding: 12px; border-bottom: 1px solid #e2e8f0; }\n  .chemicals-detail { font-size: 12px; color: #0d9488; margin-top: 4px; }\n  .chemical-item { background: #f0fdfa; padding: 2px 6px; border-radius: 4px; margin-right: 4px; display: inline-block; margin-top: 2px; }\n  .subtotal-row { background: #f8fafc; }\n  .total-box { background: linear-gradient(135deg, #1e3a5f 0%, #2d5a87 100%); color: white; padding: 20px 30px; border-radius: 12px; text-align: right; }\n  .total-box span { font-size: 14px; opacity: 0.9; }\n  .total-box div { font-size: 32px; font-weight: bold; margin-top: 5px; }\n  .summary-box { background: #f0f9ff; padding: 15px; border-radius: 8px; margin-bottom: 20px; }\n  .terms-box { background: #fef3c7; padding: 15px; border-radius: 8px; margin-bottom: 20px; }\n</style></head>\n<body>\n  <div class=\"header\">\n    <svg viewBox=\"0 0 100 110\" class=\"logo\">\n      <path d=\"M50 5 L90 25 L90 70 Q90 95 50 105 Q10 95 10 70 L10 25 Z\" fill=\"#5bb4d8\"/>\n      <path d=\"M50 12 L83 28 L83 68 Q83 88 50 98 Q17 88 17 68 L17 28 Z\" fill=\"white\" opacity=\"0.3\"/>\n      <path d=\"M20 35 Q35 40 50 35 Q65 30 80 35\" stroke=\"white\" stroke-width=\"2\" fill=\"none\" opacity=\"0.8\"/>\n      <path d=\"M20 48 Q35 53 50 48 Q65 43 80 48\" stroke=\"white\" stroke-width=\"2\" fill=\"none\" opacity=\"0.8\"/>\n      <path d=\"M20 61 Q35 66 50 61 Q65 56 80 61\" stroke=\"white\" stroke-width=\"2\" fill=\"none\" opacity=\"0.8\"/>\n    </svg>\n    <div>\n      <h1>POOL AUTHORITY</h1>\n      <p style=\"margin:0;opacity:0.9;\">Monthly Service Invoice</p>\n    </div>\n  </div>\n  <h2 style=\"color:#1e3a5f;\">Invoice - ${monthName}</h2>\n  <div class=\"terms-box\">\n    <strong>Payment Terms:</strong> ${termsText} | <strong>Due Date:</strong> ${dueDateStr}\n  </div>\n  <div class=\"info-grid\">\n    <div class=\"info-box\">\n      <h3>Bill To</h3>\n      <p><strong>${customer.name}</strong></p>\n      <p>${customer.address}</p>\n      ${customer.phone ? `<p>${customer.phone}</p>` : ''}\n      ${customer.email ? `<p>${customer.email}</p>` : ''}\n    </div>\n    <div class=\"info-box\">\n      <h3>Service Details</h3>\n      <p>Pool Type: ${customer.poolType}</p>\n      <p>Weekly Rate: $${customer.weeklyRate}</p>\n      <p>Services This Month: ${services.length}</p>\n    </div>\n  </div>\n  <table>\n    <tr><th>Date</th><th>Service</th><th>Chemicals</th><th>Total</th></tr>\n    ${services.map(s => `\n      <tr>\n        <td>${new Date(s.date).toLocaleDateString()}</td>\n        <td>\n          Weekly Service - $${s.weeklyRate.toFixed(2)}\n        </td>\n        <td>\n          $${(s.chemicalCost || 0).toFixed(2)}\n          ${s.chemicalsUsed && s.chemicalsUsed.length > 0 ? `\n            <div class=\"chemicals-detail\">\n              ${s.chemicalsUsed.map(c => `<span class=\"chemical-item\">${c.name}: ${c.quantity} ${c.unit}</span>`).join('')}\n            </div>\n          ` : ''}\n        </td>\n        <td><strong>$${s.totalAmount.toFixed(2)}</strong></td>\n      </tr>\n    `).join('')}\n    <tr class=\"subtotal-row\">\n      <td colspan=\"2\" style=\"text-align:right;\"><strong>Service Subtotal:</strong></td>\n      <td colspan=\"2\"><strong>$${services.reduce((sum, s) => sum + s.weeklyRate, 0).toFixed(2)}</strong></td>\n    </tr>\n    <tr class=\"subtotal-row\">\n      <td colspan=\"2\" style=\"text-align:right;\"><strong>Chemicals Subtotal:</strong></td>\n      <td colspan=\"2\"><strong>$${totalChemicals.toFixed(2)}</strong></td>\n    </tr>\n  </table>\n  <div class=\"total-box\">\n    <span>Amount Due</span>\n    <div>$${total.toFixed(2)}</div>\n  </div>\n  <p style=\"text-align:center;margin-top:30px;color:#666;\">Thank you for choosing Pool Authority!</p>\n</body></html>`;\n\n    const blob = new Blob([html], { type: 'text/html' });\n    const a = document.createElement('a');\n    a.href = URL.createObjectURL(blob);\n    a.download = `PoolAuthority-Invoice-${customer.name.replace(/\\s+/g, '-')}-${yearMonth}.html`;\n    a.click();\n  };\n\n  // Generate PDF for job/service call invoice\n  const downloadJobInvoice = (service, paymentTerms = 'net15') => {\n    const customer = customers.find(c => c.id === service.customerId);\n    if (!customer) return;\n    \n    const invoiceNumber = `JOB-${service.id.toString().slice(-8)}`;\n    const serviceDate = new Date(service.date).toLocaleDateString();\n    \n    // Calculate due date\n    const termsDays = paymentTerms === 'due_receipt' ? 0 : \n                      paymentTerms === 'net7' ? 7 :\n                      paymentTerms === 'net15' ? 15 : \n                      paymentTerms === 'net30' ? 30 :\n                      paymentTerms === 'net45' ? 45 :\n                      paymentTerms === 'net60' ? 60 : 15;\n    const dueDate = new Date(service.date);\n    dueDate.setDate(dueDate.getDate() + termsDays);\n    const dueDateStr = dueDate.toLocaleDateString();\n    const termsText = paymentTerms === 'due_receipt' ? 'Due Upon Receipt' : \n                      `Net ${termsDays}`;\n\n    const html = `<!DOCTYPE html>\n<html><head><style>\n  body { font-family: 'Segoe UI', Arial, sans-serif; max-width: 800px; margin: 40px auto; padding: 20px; color: #1e3a5f; }\n  .header { background: linear-gradient(135deg, #7c3aed 0%, #a855f7 100%); color: white; padding: 30px; border-radius: 12px; margin-bottom: 30px; display: flex; align-items: center; gap: 20px; }\n  .header h1 { margin: 0 0 5px 0; font-size: 28px; }\n  .logo { width: 60px; height: 60px; }\n  .info-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 30px; margin-bottom: 30px; }\n  .info-box h3 { margin: 0 0 10px 0; color: #1e3a5f; font-size: 14px; text-transform: uppercase; letter-spacing: 1px; }\n  .info-box p { margin: 5px 0; color: #4a5568; }\n  table { width: 100%; border-collapse: collapse; margin: 20px 0; }\n  th { background: #7c3aed; color: white; padding: 12px; text-align: left; }\n  td { padding: 12px; border-bottom: 1px solid #e2e8f0; }\n  .total-box { background: linear-gradient(135deg, #7c3aed 0%, #a855f7 100%); color: white; padding: 20px 30px; border-radius: 12px; text-align: right; }\n  .total-box span { font-size: 14px; opacity: 0.9; }\n  .total-box div { font-size: 32px; font-weight: bold; margin-top: 5px; }\n  .terms-box { background: #fef3c7; padding: 15px; border-radius: 8px; margin-bottom: 20px; }\n  .notes-box { background: #f0fdf4; padding: 15px; border-radius: 8px; margin-top: 20px; }\n</style></head>\n<body>\n  <div class=\"header\">\n    <svg viewBox=\"0 0 100 110\" class=\"logo\">\n      <path d=\"M50 5 L90 25 L90 70 Q90 95 50 105 Q10 95 10 70 L10 25 Z\" fill=\"#a855f7\"/>\n      <path d=\"M50 12 L83 28 L83 68 Q83 88 50 98 Q17 88 17 68 L17 28 Z\" fill=\"white\" opacity=\"0.3\"/>\n      <path d=\"M35 45 L45 55 L65 35\" stroke=\"white\" stroke-width=\"6\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"/>\n    </svg>\n    <div>\n      <h1>POOL AUTHORITY</h1>\n      <p style=\"margin:0;opacity:0.9;\">Service Call Invoice</p>\n    </div>\n  </div>\n  <h2 style=\"color:#7c3aed;\">Invoice #${invoiceNumber}</h2>\n  <div class=\"terms-box\">\n    <strong>Payment Terms:</strong> ${termsText} | <strong>Due Date:</strong> ${dueDateStr}\n  </div>\n  <div class=\"info-grid\">\n    <div class=\"info-box\">\n      <h3>Bill To</h3>\n      <p><strong>${customer.name}</strong></p>\n      <p>${customer.address}</p>\n      ${customer.phone ? `<p>${customer.phone}</p>` : ''}\n      ${customer.email ? `<p>${customer.email}</p>` : ''}\n    </div>\n    <div class=\"info-box\">\n      <h3>Service Details</h3>\n      <p><strong>Job Type:</strong> ${service.jobType || service.poolType}</p>\n      <p><strong>Service Date:</strong> ${serviceDate}</p>\n      <p><strong>Invoice Date:</strong> ${new Date().toLocaleDateString()}</p>\n    </div>\n  </div>\n  \n  <table>\n    <thead>\n      <tr>\n        <th>Description</th>\n        <th style=\"text-align:right;\">Amount</th>\n      </tr>\n    </thead>\n    <tbody>\n      <tr>\n        <td><strong>${service.jobType || service.poolType}</strong> - Labor</td>\n        <td style=\"text-align:right;\">$${service.weeklyRate.toFixed(2)}</td>\n      </tr>\n      ${(service.additionalItems || []).map(item => `\n      <tr>\n        <td>${item.name} (x${item.quantity})</td>\n        <td style=\"text-align:right;\">$${item.totalCost.toFixed(2)}</td>\n      </tr>`).join('')}\n      ${(service.chemicalsUsed || []).map(chem => `\n      <tr>\n        <td>${chem.name} (${chem.quantity} ${chem.unit})</td>\n        <td style=\"text-align:right;\">$${chem.totalCost.toFixed(2)}</td>\n      </tr>`).join('')}\n    </tbody>\n  </table>\n  \n  <div class=\"total-box\">\n    <span>Total Due</span>\n    <div>$${service.totalAmount.toFixed(2)}</div>\n  </div>\n  \n  ${service.techNotes ? `<div class=\"notes-box\"><strong>Service Notes:</strong><br>${service.techNotes}</div>` : ''}\n  \n  <div style=\"margin-top: 40px; text-align: center; color: #718096; font-size: 14px;\">\n    <p>Thank you for your business!</p>\n    <p>${companySettings.companyName || 'Pool Authority'} | ${companySettings.phone || ''} | ${companySettings.email || ''}</p>\n  </div>\n</body></html>`;\n\n    const blob = new Blob([html], { type: 'text/html' });\n    const a = document.createElement('a');\n    a.href = URL.createObjectURL(blob);\n    a.download = `PoolAuthority-Job-${invoiceNumber}-${customer.name.replace(/\\s+/g, '-')}.html`;\n    a.click();\n  };\n\n  // Chemical functions\n  const addChemical = () => {\n    if (newChemical.name) {\n      saveChemicals([...chemicalInventory, { ...newChemical, id: Date.now() }]);\n      setNewChemical({ name: '', quantity: 0, unit: 'lbs', costPerUnit: 0 });\n      setShowAddChemical(false);\n    }\n  };\n\n  // Edit chemical in inventory\n  const updateChemical = () => {\n    if (editingChemical) {\n      saveChemicals(chemicalInventory.map(c => c.id === editingChemical.id ? editingChemical : c));\n      setEditingChemical(null);\n    }\n  };\n\n  const deleteChemical = (id) => {\n    if (confirm('Delete this chemical from inventory?')) {\n      saveChemicals(chemicalInventory.filter(c => c.id !== id));\n    }\n  };\n\n  // Edit service history entry\n  const openEditServiceModal = (service) => {\n    setEditingService({ ...service });\n    setShowEditServiceModal(true);\n  };\n\n  const updateService = () => {\n    if (editingService) {\n      // Recalculate total\n      const chemicalCost = editingService.chemicalsUsed?.reduce((sum, c) => sum + (c.quantity * c.costPerUnit), 0) || editingService.chemicalCost || 0;\n      const updatedService = {\n        ...editingService,\n        chemicalCost,\n        totalAmount: editingService.weeklyRate + chemicalCost\n      };\n      saveHistory(serviceHistory.map(s => s.id === editingService.id ? updatedService : s));\n      setShowEditServiceModal(false);\n      setEditingService(null);\n    }\n  };\n\n  const deleteService = (serviceId) => {\n    if (confirm('Delete this service record? This cannot be undone.')) {\n      saveHistory(serviceHistory.filter(s => s.id !== serviceId));\n    }\n  };\n\n  // Add/edit chemical in a service record\n  const addChemicalToEditingService = (chemical, quantity) => {\n    if (!editingService || quantity <= 0) return;\n    const chemicalsUsed = editingService.chemicalsUsed || [];\n    const existingIndex = chemicalsUsed.findIndex(c => c.id === chemical.id);\n    \n    let updatedChemicals;\n    if (existingIndex >= 0) {\n      updatedChemicals = chemicalsUsed.map((c, i) => \n        i === existingIndex ? { ...c, quantity: c.quantity + quantity, totalCost: (c.quantity + quantity) * c.costPerUnit } : c\n      );\n    } else {\n      updatedChemicals = [...chemicalsUsed, {\n        id: chemical.id,\n        name: chemical.name,\n        quantity: quantity,\n        unit: chemical.unit,\n        costPerUnit: chemical.costPerUnit,\n        totalCost: quantity * chemical.costPerUnit\n      }];\n    }\n    \n    const newChemicalCost = updatedChemicals.reduce((sum, c) => sum + c.totalCost, 0);\n    setEditingService({\n      ...editingService,\n      chemicalsUsed: updatedChemicals,\n      chemicalCost: newChemicalCost,\n      totalAmount: editingService.weeklyRate + newChemicalCost\n    });\n  };\n\n  const removeChemicalFromEditingService = (chemicalId) => {\n    if (!editingService) return;\n    const updatedChemicals = (editingService.chemicalsUsed || []).filter(c => c.id !== chemicalId);\n    const newChemicalCost = updatedChemicals.reduce((sum, c) => sum + c.totalCost, 0);\n    setEditingService({\n      ...editingService,\n      chemicalsUsed: updatedChemicals,\n      chemicalCost: newChemicalCost,\n      totalAmount: editingService.weeklyRate + newChemicalCost\n    });\n  };\n\n  // Open customer billing detail view\n  const openCustomerBillingDetail = (customer) => {\n    const services = getMonthServices(customer.id, invoiceMonth);\n    setSelectedCustomerBilling({ customer, services });\n    setBillingAdjustments([]);\n  };\n\n  // Add manual adjustment to bill\n  const addBillingAdjustment = (description, amount) => {\n    if (description && amount !== 0) {\n      setBillingAdjustments([...billingAdjustments, { id: Date.now(), description, amount }]);\n    }\n  };\n\n  const removeBillingAdjustment = (id) => {\n    setBillingAdjustments(billingAdjustments.filter(a => a.id !== id));\n  };\n\n  // Job functions\n  const addJob = () => {\n    if (newJob.customerId && newJob.date) {\n      const customer = customers.find(c => c.id === parseInt(newJob.customerId));\n      saveJobs([...oneTimeJobs, { \n        ...newJob, \n        id: Date.now(), \n        customerName: customer?.name || 'Unknown',\n        scheduledTime: newJob.scheduledTime || null,\n        employeeId: newJob.employeeId || null\n      }]);\n      setNewJob({ customerId: '', jobType: 'opening', date: '', price: 250, notes: '', scheduledTime: null, employeeId: null });\n      setShowAddJob(false);\n    }\n  };\n\n  // Open job completion modal\n  const openCompleteJobModal = (job) => {\n    setJobToComplete(job);\n    setJobCompletionItems([]);\n    setJobChemicals([]);\n    setJobCompletionNotes('');\n    setShowCompleteJobModal(true);\n  };\n\n  // Add wear item to job completion\n  const addWearItemToJob = (item, quantity = 1) => {\n    const existingIndex = jobCompletionItems.findIndex(i => i.id === item.id);\n    if (existingIndex >= 0) {\n      const updated = [...jobCompletionItems];\n      updated[existingIndex].quantity += quantity;\n      setJobCompletionItems(updated);\n    } else {\n      setJobCompletionItems([...jobCompletionItems, { ...item, quantity }]);\n    }\n  };\n\n  // Add custom item to job completion\n  const addCustomItemToJob = (name, price) => {\n    if (name && price > 0) {\n      setJobCompletionItems([...jobCompletionItems, { id: Date.now(), name, price, quantity: 1, isCustom: true }]);\n    }\n  };\n\n  // Remove item from job completion\n  const removeItemFromJob = (itemId) => {\n    setJobCompletionItems(jobCompletionItems.filter(i => i.id !== itemId));\n  };\n\n  // Add chemical to job completion\n  const addChemicalToJob = (chemical, quantity) => {\n    if (quantity <= 0) return;\n    const existingIndex = jobChemicals.findIndex(c => c.id === chemical.id);\n    if (existingIndex >= 0) {\n      const updated = [...jobChemicals];\n      updated[existingIndex].quantityUsed += quantity;\n      setJobChemicals(updated);\n    } else {\n      setJobChemicals([...jobChemicals, { ...chemical, quantityUsed: quantity }]);\n    }\n  };\n\n  // Remove chemical from job completion\n  const removeChemicalFromJob = (chemicalId) => {\n    setJobChemicals(jobChemicals.filter(c => c.id !== chemicalId));\n  };\n\n  // Complete job with additional items and chemicals\n  const completeJobWithItems = async () => {\n    if (!jobToComplete) return;\n    \n    const additionalCost = jobCompletionItems.reduce((sum, i) => sum + (i.price * i.quantity), 0);\n    const chemicalCost = jobChemicals.reduce((sum, c) => sum + (c.quantityUsed * c.costPerUnit), 0);\n    const totalAmount = jobToComplete.price + additionalCost + chemicalCost;\n    \n    const itemsUsed = jobCompletionItems.map(i => ({\n      id: i.id,\n      name: i.name,\n      price: i.price,\n      quantity: i.quantity,\n      totalCost: i.price * i.quantity\n    }));\n    \n    const chemicalsUsed = jobChemicals.map(c => ({\n      id: c.id,\n      name: c.name,\n      quantity: c.quantityUsed,\n      unit: c.unit,\n      costPerUnit: c.costPerUnit,\n      totalCost: c.quantityUsed * c.costPerUnit\n    }));\n    \n    const service = {\n      id: Date.now(),\n      customerId: parseInt(jobToComplete.customerId),\n      customerName: jobToComplete.customerName,\n      date: new Date().toISOString(),\n      weeklyRate: jobToComplete.price,\n      chemicalCost: chemicalCost,\n      chemicalsUsed: chemicalsUsed,\n      additionalItemsCost: additionalCost,\n      additionalItems: itemsUsed,\n      totalAmount: totalAmount,\n      poolType: jobToComplete.jobType,\n      jobNotes: jobToComplete.notes,\n      techNotes: jobCompletionNotes,\n      isJobService: true,  // Flag to distinguish from recurring services\n      jobType: jobToComplete.jobType\n    };\n    saveHistory([service, ...serviceHistory]);\n    saveJobs(oneTimeJobs.filter(j => j.id !== jobToComplete.id));\n    \n    // Update chemical inventory\n    const updatedChemicals = chemicalInventory.map(chem => {\n      const used = jobChemicals.find(c => c.id === chem.id);\n      if (used) {\n        return { ...chem, quantity: Math.max(0, chem.quantity - used.quantityUsed) };\n      }\n      return chem;\n    });\n    saveChemicals(updatedChemicals);\n    \n    // Send job completion email if enabled\n    const customer = customers.find(c => c.id === parseInt(jobToComplete.customerId));\n    if (sendJobEmailOnComplete && customer?.email) {\n      await sendJobCompletionEmail(customer, {\n        jobType: jobToComplete.jobType,\n        basePrice: jobToComplete.price,\n        additionalItems: itemsUsed,\n        chemicalsUsed: chemicalsUsed,\n        total: totalAmount,\n        notes: jobCompletionNotes\n      });\n    }\n    \n    setShowCompleteJobModal(false);\n    setJobToComplete(null);\n    setJobCompletionItems([]);\n    setJobChemicals([]);\n    setJobCompletionNotes('');\n  };\n\n  // Legacy completeJob - now opens modal\n  const completeJob = (job) => {\n    openCompleteJobModal(job);\n  };\n\n  // Wear item management\n  const addWearItem = () => {\n    if (newWearItem.name && newWearItem.price > 0) {\n      saveWearItems([...wearItems, { ...newWearItem, id: Date.now() }]);\n      setNewWearItem({ name: '', price: 0, description: '' });\n    }\n  };\n\n  const deleteWearItem = (id) => {\n    saveWearItems(wearItems.filter(w => w.id !== id));\n  };\n\n  // Stats\n  const totalRevenue = serviceHistory.reduce((sum, s) => sum + s.totalAmount, 0);\n  const thisMonthRevenue = serviceHistory\n    .filter(s => s.date.startsWith(new Date().toISOString().slice(0, 7)))\n    .reduce((sum, s) => sum + s.totalAmount, 0);\n  const todayServices = serviceHistory.filter(s => s.date.startsWith(selectedDate)).length;\n\n  // Tab config\n  const tabs = [\n    { key: 'home', label: 'Home', icon: Icons.Home },\n    { key: 'calendar', label: 'Calendar', icon: Icons.Calendar },\n    { key: 'routes', label: 'Routes', icon: Icons.Map },\n    { key: 'customers', label: 'Customers', icon: Icons.Users },\n    { key: 'recurring', label: 'Recurring', icon: Icons.History },\n    { key: 'jobs', label: 'Jobs', icon: Icons.Wrench },\n    { key: 'quotes', label: 'Quotes', icon: Icons.FileText },\n    { key: 'billing', label: 'Billing', icon: Icons.Receipt },\n    { key: 'payments', label: 'Payments', icon: Icons.CreditCard },\n    { key: 'chemicals', label: 'Chemicals', icon: Icons.Beaker },\n    { key: 'history', label: 'History', icon: Icons.DollarSign },\n    { key: 'settings', label: 'Settings', icon: Icons.Settings },\n  ];\n\n  return (\n    <div className=\"min-h-screen pb-20 md:pb-8\" style={{ background: 'linear-gradient(180deg, #f0f9ff 0%, #e0f2fe 100%)' }}>\n      {/* Email Notification Popup */}\n      {emailNotification && (\n        <div className={`fixed top-4 left-4 right-4 md:left-auto md:right-4 md:w-auto z-50 p-4 rounded-lg shadow-lg flex items-center gap-3 animate-pulse ${\n          emailNotification.type === 'success' ? 'bg-green-500 text-white' : 'bg-red-500 text-white'\n        }`}>\n          <span className=\"text-xl\">{emailNotification.type === 'success' ? '' : ''}</span>\n          <span>{emailNotification.message}</span>\n        </div>\n      )}\n\n      {/* Header */}\n      <div className=\"bg-white shadow-lg border-b-4 sticky top-0 z-40\" style={{ borderColor: '#5bb4d8' }}>\n        <div className=\"max-w-6xl mx-auto px-3 md:px-4 py-3 md:py-4 flex items-center gap-3 md:gap-4\">\n          {/* Pool Authority Shield Logo */}\n          <svg viewBox=\"0 0 100 110\" className=\"w-10 h-10 md:w-14 md:h-14 flex-shrink-0\">\n            <path d=\"M50 5 L90 25 L90 70 Q90 95 50 105 Q10 95 10 70 L10 25 Z\" fill=\"#1e3a5f\" stroke=\"#1e3a5f\" strokeWidth=\"2\"/>\n            <path d=\"M50 12 L83 28 L83 68 Q83 88 50 98 Q17 88 17 68 L17 28 Z\" fill=\"#5bb4d8\"/>\n            <path d=\"M20 35 Q35 40 50 35 Q65 30 80 35\" stroke=\"white\" strokeWidth=\"2.5\" fill=\"none\" opacity=\"0.7\"/>\n            <path d=\"M20 48 Q35 53 50 48 Q65 43 80 48\" stroke=\"white\" strokeWidth=\"2.5\" fill=\"none\" opacity=\"0.7\"/>\n            <path d=\"M20 61 Q35 66 50 61 Q65 56 80 61\" stroke=\"white\" strokeWidth=\"2.5\" fill=\"none\" opacity=\"0.7\"/>\n            <path d=\"M25 74 Q40 79 55 74 Q70 69 78 74\" stroke=\"white\" strokeWidth=\"2.5\" fill=\"none\" opacity=\"0.7\"/>\n            <path d=\"M35 85 Q45 88 55 85 Q65 82 70 85\" stroke=\"white\" strokeWidth=\"2\" fill=\"none\" opacity=\"0.6\"/>\n          </svg>\n          <div className=\"flex-1 min-w-0\">\n            <h1 className=\"text-lg md:text-2xl font-black tracking-tight truncate\">\n              <span style={{ color: '#1e3a5f' }}>POOL</span>\n              <span style={{ color: '#9b3544' }}> AUTHORITY</span>\n            </h1>\n            <p className=\"text-xs md:text-sm text-gray-500 hidden sm:block\">Professional Pool Service Management</p>\n          </div>\n          <span className=\"text-xs text-gray-400 hidden md:block\">v2.4.0</span>\n        </div>\n      </div>\n\n      {/* Desktop Navigation - Hidden on mobile */}\n      <div className=\"max-w-6xl mx-auto px-4 py-4 hidden md:block\">\n        <div className=\"flex gap-1 bg-white rounded-xl p-1.5 shadow-md overflow-x-auto\">\n          {tabs.map(({ key, label, icon: Icon }) => (\n            <button\n              key={key}\n              onClick={() => setActiveTab(key)}\n              className={`flex items-center gap-2 px-4 py-2.5 rounded-lg text-sm font-medium transition-all whitespace-nowrap ${\n                activeTab === key\n                  ? 'text-white shadow-md'\n                  : 'text-gray-600 hover:bg-gray-100'\n              }`}\n              style={activeTab === key ? { background: 'linear-gradient(135deg, #1e3a5f 0%, #0ea5e9 100%)' } : {}}\n            >\n              <Icon />\n              {label}\n            </button>\n          ))}\n        </div>\n      </div>\n\n      {/* Mobile Bottom Navigation */}\n      <div className=\"md:hidden fixed bottom-0 left-0 right-0 bg-white border-t shadow-lg z-50 safe-area-bottom\">\n        <div className=\"flex justify-around items-center py-2 px-1\">\n          {[\n            { key: 'home', label: 'Home', icon: Icons.Home },\n            { key: 'routes', label: 'Routes', icon: Icons.Map },\n            { key: 'customers', label: 'Customers', icon: Icons.Users },\n            { key: 'jobs', label: 'Jobs', icon: Icons.Wrench },\n            { key: 'more', label: 'More', icon: Icons.Menu },\n          ].map(({ key, label, icon: Icon }) => (\n            key === 'more' ? (\n              <div key={key} className=\"relative\">\n                <button\n                  onClick={() => setShowMobileMenu(!showMobileMenu)}\n                  className={`flex flex-col items-center px-3 py-1 rounded-lg ${\n                    showMobileMenu ? 'text-blue-600' : 'text-gray-600'\n                  }`}\n                >\n                  <Icon />\n                  <span className=\"text-xs mt-1\">{label}</span>\n                </button>\n                \n                {/* More Menu Popup */}\n                {showMobileMenu && (\n                  <div className=\"absolute bottom-full right-0 mb-2 bg-white rounded-xl shadow-2xl border p-2 min-w-48\">\n                    {tabs.filter(t => !['home', 'routes', 'customers', 'jobs'].includes(t.key)).map(({ key, label, icon: TabIcon }) => (\n                      <button\n                        key={key}\n                        onClick={() => {\n                          setActiveTab(key);\n                          setShowMobileMenu(false);\n                        }}\n                        className={`w-full flex items-center gap-3 px-4 py-3 rounded-lg text-left ${\n                          activeTab === key ? 'bg-blue-50 text-blue-700' : 'text-gray-700 hover:bg-gray-50'\n                        }`}\n                      >\n                        <TabIcon />\n                        <span className=\"font-medium\">{label}</span>\n                      </button>\n                    ))}\n                  </div>\n                )}\n              </div>\n            ) : (\n              <button\n                key={key}\n                onClick={() => {\n                  setActiveTab(key);\n                  setShowMobileMenu(false);\n                }}\n                className={`flex flex-col items-center px-3 py-1 rounded-lg transition-all ${\n                  activeTab === key\n                    ? 'text-blue-600'\n                    : 'text-gray-600'\n                }`}\n              >\n                <div className={`p-1.5 rounded-lg ${activeTab === key ? 'bg-blue-100' : ''}`}>\n                  <Icon />\n                </div>\n                <span className=\"text-xs mt-1 font-medium\">{label}</span>\n              </button>\n            )\n          ))}\n        </div>\n      </div>\n\n      {/* Click outside to close mobile menu */}\n      {showMobileMenu && (\n        <div \n          className=\"md:hidden fixed inset-0 z-40\" \n          onClick={() => setShowMobileMenu(false)}\n        />\n      )}\n\n      {/* Content */}\n      <div className=\"max-w-6xl mx-auto px-3 md:px-4 pb-8 md:pt-0 pt-2\">\n        \n        {/* HOME TAB */}\n        {activeTab === 'home' && (\n          <div className=\"space-y-6\">\n            {/* Stats Cards */}\n            <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\n              <div className=\"bg-white rounded-xl p-6 shadow-lg border-l-4\" style={{ borderColor: '#22c55e' }}>\n                <div className=\"text-sm text-gray-500 font-medium\">Total Revenue</div>\n                <div className=\"text-3xl font-black text-gray-800\">${totalRevenue.toFixed(2)}</div>\n              </div>\n              <div className=\"bg-white rounded-xl p-6 shadow-lg border-l-4\" style={{ borderColor: '#0ea5e9' }}>\n                <div className=\"text-sm text-gray-500 font-medium\">This Month</div>\n                <div className=\"text-3xl font-black text-gray-800\">${thisMonthRevenue.toFixed(2)}</div>\n              </div>\n              <div className=\"bg-white rounded-xl p-6 shadow-lg border-l-4\" style={{ borderColor: '#8b5cf6' }}>\n                <div className=\"text-sm text-gray-500 font-medium\">{selectedYear} Total</div>\n                <div className=\"text-3xl font-black text-gray-800\">${getYearTotal(selectedYear).toFixed(2)}</div>\n              </div>\n              <div className=\"bg-white rounded-xl p-6 shadow-lg border-l-4\" style={{ borderColor: '#f59e0b' }}>\n                <div className=\"text-sm text-gray-500 font-medium\">Accounts Receivable</div>\n                <div className=\"text-3xl font-black text-gray-800\">\n                  ${getAccountsReceivable().reduce((sum, c) => sum + c.balance, 0).toFixed(2)}\n                </div>\n              </div>\n            </div>\n\n            {/* Yearly Revenue Chart */}\n            <div className=\"bg-white rounded-xl p-6 shadow-lg\">\n              <h2 className=\"text-xl font-bold text-gray-800 mb-4\">Yearly Revenue (5 Year History)</h2>\n              <ResponsiveContainer width=\"100%\" height={200}>\n                <BarChart data={getYearlyRevenueData()}>\n                  <CartesianGrid strokeDasharray=\"3 3\" stroke=\"#e5e7eb\" />\n                  <XAxis dataKey=\"year\" stroke=\"#6b7280\" fontSize={12} />\n                  <YAxis stroke=\"#6b7280\" fontSize={12} tickFormatter={(v) => `$${v >= 1000 ? (v/1000).toFixed(0) + 'k' : v}`} />\n                  <Tooltip \n                    formatter={(value) => [`$${value.toFixed(2)}`, 'Revenue']}\n                    contentStyle={{ borderRadius: '8px', border: '1px solid #e5e7eb' }}\n                  />\n                  <Bar dataKey=\"revenue\" fill=\"#1e3a5f\" radius={[4, 4, 0, 0]} />\n                </BarChart>\n              </ResponsiveContainer>\n            </div>\n\n            {/* Monthly Revenue Chart with Year Selector */}\n            <div className=\"bg-white rounded-xl p-6 shadow-lg\">\n              <div className=\"flex justify-between items-center mb-4\">\n                <h2 className=\"text-xl font-bold text-gray-800\">Monthly Revenue</h2>\n                <select\n                  value={selectedYear}\n                  onChange={(e) => setSelectedYear(parseInt(e.target.value))}\n                  className=\"px-4 py-2 border rounded-lg font-medium\"\n                  style={{ borderColor: '#1e3a5f', color: '#1e3a5f' }}\n                >\n                  {getAvailableYears().map(year => (\n                    <option key={year} value={year}>{year}</option>\n                  ))}\n                </select>\n              </div>\n              <ResponsiveContainer width=\"100%\" height={250}>\n                <AreaChart data={getMonthlyRevenueData()}>\n                  <defs>\n                    <linearGradient id=\"colorRevenue\" x1=\"0\" y1=\"0\" x2=\"0\" y2=\"1\">\n                      <stop offset=\"5%\" stopColor=\"#5bb4d8\" stopOpacity={0.8}/>\n                      <stop offset=\"95%\" stopColor=\"#5bb4d8\" stopOpacity={0.1}/>\n                    </linearGradient>\n                  </defs>\n                  <CartesianGrid strokeDasharray=\"3 3\" stroke=\"#e5e7eb\" />\n                  <XAxis dataKey=\"month\" stroke=\"#6b7280\" fontSize={12} />\n                  <YAxis stroke=\"#6b7280\" fontSize={12} tickFormatter={(v) => `$${v}`} />\n                  <Tooltip \n                    formatter={(value) => [`$${value.toFixed(2)}`, 'Revenue']}\n                    labelFormatter={(label, payload) => payload[0]?.payload?.fullMonth + ' ' + payload[0]?.payload?.year}\n                    contentStyle={{ borderRadius: '8px', border: '1px solid #e5e7eb' }}\n                  />\n                  <Area type=\"monotone\" dataKey=\"revenue\" stroke=\"#1e3a5f\" fillOpacity={1} fill=\"url(#colorRevenue)\" strokeWidth={2} />\n                </AreaChart>\n              </ResponsiveContainer>\n            </div>\n\n            {/* Weekly Revenue Chart */}\n            <div className=\"bg-white rounded-xl p-6 shadow-lg\">\n              <h2 className=\"text-xl font-bold text-gray-800 mb-4\">Weekly Revenue (Last 8 Weeks)</h2>\n              <ResponsiveContainer width=\"100%\" height={200}>\n                <BarChart data={getWeeklyRevenueData()}>\n                  <CartesianGrid strokeDasharray=\"3 3\" stroke=\"#e5e7eb\" />\n                  <XAxis dataKey=\"week\" stroke=\"#6b7280\" fontSize={12} />\n                  <YAxis stroke=\"#6b7280\" fontSize={12} tickFormatter={(v) => `$${v}`} />\n                  <Tooltip \n                    formatter={(value) => [`$${value.toFixed(2)}`, 'Revenue']}\n                    contentStyle={{ borderRadius: '8px', border: '1px solid #e5e7eb' }}\n                  />\n                  <Bar dataKey=\"revenue\" fill=\"#22c55e\" radius={[4, 4, 0, 0]} />\n                </BarChart>\n              </ResponsiveContainer>\n            </div>\n\n            {/* Accounts Receivable Section */}\n            <div className=\"bg-white rounded-xl p-6 shadow-lg\">\n              <h2 className=\"text-xl font-bold text-gray-800 mb-4\">Accounts Receivable</h2>\n              {getAccountsReceivable().length > 0 ? (\n                <div className=\"space-y-3\">\n                  {getAccountsReceivable().map(account => (\n                    <div key={account.id} className=\"flex items-center justify-between p-4 bg-amber-50 rounded-lg border-l-4 border-amber-500\">\n                      <div>\n                        <div className=\"font-bold text-gray-800\">{account.name}</div>\n                        <div className=\"text-sm text-gray-500\">\n                          Services: ${account.totalServices.toFixed(2)} | Paid: ${account.totalPaid.toFixed(2)}\n                        </div>\n                      </div>\n                      <div className=\"flex items-center gap-3\">\n                        <div className=\"text-xl font-bold text-amber-600\">${account.balance.toFixed(2)}</div>\n                        <button\n                          onClick={() => {\n                            setPaymentToMark({ \n                              invoiceKey: `ar-${account.id}`, \n                              customerId: account.id, \n                              customerName: account.name, \n                              amount: account.balance \n                            });\n                            setPaymentMethod({ method: 'electronic', checkNumber: '', source: '' });\n                            setShowPaymentMethodModal(true);\n                          }}\n                          className=\"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 text-sm\"\n                        >\n                          Mark Paid\n                        </button>\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              ) : (\n                <p className=\"text-gray-500 text-center py-8\">No outstanding balances! </p>\n              )}\n            </div>\n\n            {/* Quick Actions */}\n            <div className=\"bg-white rounded-xl p-6 shadow-lg\">\n              <h2 className=\"text-xl font-bold text-gray-800 mb-4\">Quick Actions</h2>\n              <div className=\"grid grid-cols-2 md:grid-cols-4 gap-3\">\n                <button onClick={() => { setActiveTab('customers'); setShowAddCustomer(true); }} className=\"p-4 bg-blue-50 rounded-xl hover:bg-blue-100 transition-all text-center\">\n                  <Icons.Plus />\n                  <div className=\"text-sm font-medium text-gray-700 mt-2\">Add Customer</div>\n                </button>\n                <button onClick={() => setActiveTab('routes')} className=\"p-4 bg-green-50 rounded-xl hover:bg-green-100 transition-all text-center\">\n                  <Icons.Map />\n                  <div className=\"text-sm font-medium text-gray-700 mt-2\">Plan Route</div>\n                </button>\n                <button onClick={() => { setActiveTab('jobs'); setShowAddJob(true); }} className=\"p-4 bg-purple-50 rounded-xl hover:bg-purple-100 transition-all text-center\">\n                  <Icons.Wrench />\n                  <div className=\"text-sm font-medium text-gray-700 mt-2\">Add Job</div>\n                </button>\n                <button onClick={() => setActiveTab('calendar')} className=\"p-4 bg-cyan-50 rounded-xl hover:bg-cyan-100 transition-all text-center\">\n                  <Icons.Calendar />\n                  <div className=\"text-sm font-medium text-gray-700 mt-2\">Calendar</div>\n                </button>\n              </div>\n            </div>\n\n            {/* Upcoming Jobs */}\n            <div className=\"bg-white rounded-xl p-6 shadow-lg\">\n              <h2 className=\"text-xl font-bold text-gray-800 mb-4\">Upcoming Jobs</h2>\n              {oneTimeJobs.length > 0 ? (\n                <div className=\"space-y-3\">\n                  {oneTimeJobs.slice(0, 5).map(job => (\n                    <div key={job.id} className=\"flex items-center justify-between p-4 bg-gray-50 rounded-lg\">\n                      <div>\n                        <div className=\"font-bold\">{job.customerName}</div>\n                        <div className=\"text-sm text-gray-500\">{job.jobType}  {(() => {\n                          const [y, m, d] = job.date.split('-').map(Number);\n                          return new Date(y, m - 1, d).toLocaleDateString();\n                        })()}</div>\n                      </div>\n                      <div className=\"font-bold text-green-600\">${job.price}</div>\n                    </div>\n                  ))}\n                </div>\n              ) : (\n                <p className=\"text-gray-500 text-center py-8\">No upcoming jobs scheduled</p>\n              )}\n            </div>\n          </div>\n        )}\n\n        {/* CALENDAR TAB */}\n        {activeTab === 'calendar' && (\n          <div className=\"space-y-6\">\n            <div className=\"bg-white rounded-xl p-6 shadow-lg\">\n              {/* Calendar Header */}\n              <div className=\"flex items-center justify-between mb-6\">\n                <button\n                  onClick={() => setCalendarDate(new Date(calendarDate.getFullYear(), calendarDate.getMonth() - 1))}\n                  className=\"p-2 hover:bg-gray-100 rounded-lg\"\n                >\n                  <Icons.ChevronLeft />\n                </button>\n                <h2 className=\"text-2xl font-bold text-gray-800\">\n                  {monthNames[calendarDate.getMonth()]} {calendarDate.getFullYear()}\n                </h2>\n                <button\n                  onClick={() => setCalendarDate(new Date(calendarDate.getFullYear(), calendarDate.getMonth() + 1))}\n                  className=\"p-2 hover:bg-gray-100 rounded-lg\"\n                >\n                  <Icons.ChevronRight />\n                </button>\n              </div>\n\n              {/* Calendar Grid */}\n              <div className=\"grid grid-cols-7 gap-1\">\n                {['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'].map(day => (\n                  <div key={day} className=\"p-2 text-center text-sm font-bold text-gray-500\">\n                    {day}\n                  </div>\n                ))}\n                {(() => {\n                  const { year, month, firstDay, daysInMonth } = getDaysInMonth(calendarDate);\n                  const days = [];\n                  \n                  // Empty cells for days before the 1st\n                  for (let i = 0; i < firstDay; i++) {\n                    days.push(<div key={`empty-${i}`} className=\"p-2 h-24\" />);\n                  }\n                  \n                  // Days of the month\n                  for (let day = 1; day <= daysInMonth; day++) {\n                    const dateStr = `${year}-${String(month + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;\n                    const events = getEventsForDate(dateStr);\n                    const isToday = dateStr === getLocalDateString();\n                    const isSelected = dateStr === selectedDate;\n                    const hasEvents = events.jobs.length > 0 || events.recurring.length > 0 || events.completed.length > 0;\n                    \n                    days.push(\n                      <div\n                        key={day}\n                        onClick={() => setSelectedDate(dateStr)}\n                        className={`p-2 h-24 border rounded-lg cursor-pointer transition-all overflow-hidden ${\n                          isSelected ? 'border-blue-500 bg-blue-50' : 'border-gray-200 hover:border-blue-300'\n                        } ${isToday ? 'bg-cyan-50' : ''}`}\n                      >\n                        <div className={`text-sm font-bold mb-1 ${isToday ? 'text-cyan-600' : 'text-gray-700'}`}>\n                          {day}\n                        </div>\n                        <div className=\"space-y-0.5\">\n                          {events.jobs.slice(0, 2).map(job => (\n                            <div key={job.id} className=\"text-xs bg-purple-100 text-purple-700 px-1 rounded truncate\">\n                              {job.jobType}\n                            </div>\n                          ))}\n                          {events.recurring.slice(0, 2).map(r => {\n                            const customer = customers.find(c => c.id === r.customerId);\n                            return customer ? (\n                              <div key={r.id} className=\"text-xs bg-blue-100 text-blue-700 px-1 rounded truncate\">\n                                {customer.name}\n                              </div>\n                            ) : null;\n                          })}\n                          {events.completed.length > 0 && (\n                            <div className=\"text-xs bg-green-100 text-green-700 px-1 rounded\">\n                               {events.completed.length} done\n                            </div>\n                          )}\n                          {hasEvents && (events.jobs.length + events.recurring.length) > 2 && (\n                            <div className=\"text-xs text-gray-500\">\n                              +{(events.jobs.length + events.recurring.length) - 2} more\n                            </div>\n                          )}\n                        </div>\n                      </div>\n                    );\n                  }\n                  \n                  return days;\n                })()}\n              </div>\n            </div>\n\n            {/* Selected Day Details */}\n            <div className=\"bg-white rounded-xl p-6 shadow-lg\">\n              <h3 className=\"text-xl font-bold text-gray-800 mb-4\">\n                {new Date(selectedDate).toLocaleDateString('en-US', { weekday: 'long', month: 'long', day: 'numeric', year: 'numeric' })}\n              </h3>\n              {(() => {\n                const events = getEventsForDate(selectedDate);\n                const hasAny = events.jobs.length > 0 || events.recurring.length > 0 || events.completed.length > 0;\n                \n                if (!hasAny) {\n                  return <p className=\"text-gray-500 text-center py-8\">No events scheduled for this day</p>;\n                }\n                \n                return (\n                  <div className=\"space-y-4\">\n                    {events.jobs.length > 0 && (\n                      <div>\n                        <h4 className=\"text-sm font-bold text-purple-700 mb-2\">ONE-TIME JOBS</h4>\n                        <div className=\"space-y-2\">\n                          {events.jobs.map(job => (\n                            <div key={job.id} className=\"flex items-center justify-between p-3 bg-purple-50 rounded-lg\">\n                              <div>\n                                <span className=\"text-xs font-bold text-purple-700 bg-purple-200 px-2 py-0.5 rounded mr-2\">\n                                  {job.jobType.toUpperCase()}\n                                </span>\n                                <span className=\"font-medium\">{job.customerName}</span>\n                              </div>\n                              <div className=\"flex items-center gap-3\">\n                                <span className=\"font-bold text-green-600\">${job.price}</span>\n                                <button\n                                  onClick={() => completeJob(job)}\n                                  className=\"px-3 py-1 bg-green-600 text-white rounded text-sm hover:bg-green-700\"\n                                >\n                                  Complete\n                                </button>\n                              </div>\n                            </div>\n                          ))}\n                        </div>\n                      </div>\n                    )}\n                    \n                    {events.recurring.length > 0 && (\n                      <div>\n                        <h4 className=\"text-sm font-bold text-blue-700 mb-2\">RECURRING SERVICES</h4>\n                        <div className=\"space-y-2\">\n                          {events.recurring.map(r => {\n                            const customer = customers.find(c => c.id === r.customerId);\n                            if (!customer) return null;\n                            return (\n                              <div key={r.id} className=\"flex items-center justify-between p-3 bg-blue-50 rounded-lg\">\n                                <div>\n                                  <span className=\"text-xs font-bold text-blue-700 bg-blue-200 px-2 py-0.5 rounded mr-2\">\n                                    {r.frequency.toUpperCase()}\n                                  </span>\n                                  <span className=\"font-medium\">{customer.name}</span>\n                                  <span className=\"text-sm text-gray-500 ml-2\">{customer.address}</span>\n                                </div>\n                                <div className=\"flex items-center gap-3\">\n                                  <span className=\"font-bold text-green-600\">${customer.weeklyRate}</span>\n                                  <button\n                                    onClick={() => completeService(customer)}\n                                    className=\"px-3 py-1 bg-green-600 text-white rounded text-sm hover:bg-green-700\"\n                                  >\n                                    Complete\n                                  </button>\n                                </div>\n                              </div>\n                            );\n                          })}\n                        </div>\n                      </div>\n                    )}\n                    \n                    {events.completed.length > 0 && (\n                      <div>\n                        <h4 className=\"text-sm font-bold text-green-700 mb-2\">COMPLETED</h4>\n                        <div className=\"space-y-2\">\n                          {events.completed.map(s => (\n                            <div key={s.id} className=\"flex items-center justify-between p-3 bg-green-50 rounded-lg\">\n                              <div>\n                                <span className=\"text-xs font-bold text-green-700 bg-green-200 px-2 py-0.5 rounded mr-2\">\n                                   DONE\n                                </span>\n                                <span className=\"font-medium\">{s.customerName}</span>\n                              </div>\n                              <span className=\"font-bold text-green-600\">${s.totalAmount.toFixed(2)}</span>\n                            </div>\n                          ))}\n                        </div>\n                      </div>\n                    )}\n                  </div>\n                );\n              })()}\n            </div>\n          </div>\n        )}\n\n        {/* ROUTES TAB */}\n        {activeTab === 'routes' && (\n          <div className=\"space-y-6\">\n            {/* Date Navigation & Employee Filter */}\n            <div className=\"bg-white rounded-xl p-4 shadow-lg\">\n              <div className=\"flex items-center justify-between\">\n                <button\n                  onClick={() => changeRouteDate(-1)}\n                  className=\"flex items-center gap-2 px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg transition-all\"\n                >\n                  <Icons.ChevronLeft />\n                  Previous Day\n                </button>\n                <div className=\"text-center\">\n                  <div className=\"text-2xl font-bold text-gray-800\">{formatRouteDate(routeDate)}</div>\n                  <div className=\"text-sm text-gray-500\">\n                    {(() => {\n                      const [y, m, d] = routeDate.split('-').map(Number);\n                      return new Date(y, m - 1, d).toLocaleDateString('en-US', { weekday: 'long', month: 'long', day: 'numeric', year: 'numeric' });\n                    })()}\n                  </div>\n                  <input\n                    type=\"date\"\n                    value={routeDate}\n                    onChange={(e) => setRouteDate(e.target.value)}\n                    className=\"mt-2 px-3 py-1 border rounded-lg text-sm\"\n                  />\n                </div>\n                <button\n                  onClick={() => changeRouteDate(1)}\n                  className=\"flex items-center gap-2 px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg transition-all\"\n                >\n                  Next Day\n                  <Icons.ChevronRight />\n                </button>\n              </div>\n              \n              {/* Employee Filter & Management */}\n              <div className=\"mt-4 pt-4 border-t flex items-center justify-between flex-wrap gap-3\">\n                <div className=\"flex items-center gap-3\">\n                  <label className=\"text-sm font-medium text-gray-700\">Filter by Employee:</label>\n                  <select\n                    value={selectedRouteEmployee}\n                    onChange={(e) => setSelectedRouteEmployee(e.target.value)}\n                    className=\"px-3 py-2 border rounded-lg text-sm\"\n                  >\n                    <option value=\"all\">All Employees</option>\n                    <option value=\"\">Unassigned</option>\n                    {employees.map(emp => (\n                      <option key={emp.id} value={emp.id}>{emp.name}</option>\n                    ))}\n                  </select>\n                  {selectedRouteEmployee !== 'all' && (\n                    <button\n                      onClick={() => setSelectedRouteEmployee('all')}\n                      className=\"text-sm text-blue-600 hover:underline\"\n                    >\n                      Show All\n                    </button>\n                  )}\n                </div>\n                <button\n                  onClick={() => setShowEmployeeManager(true)}\n                  className=\"flex items-center gap-2 px-4 py-2 bg-indigo-100 text-indigo-700 rounded-lg hover:bg-indigo-200 transition-all\"\n                >\n                  <Icons.Users />\n                  Manage Employees\n                </button>\n              </div>\n\n              {routeDate !== getLocalDateString() && (\n                <div className=\"mt-3 text-center\">\n                  <button\n                    onClick={() => setRouteDate(getLocalDateString())}\n                    className=\"text-sm text-blue-600 hover:text-blue-800 underline\"\n                  >\n                    Jump to Today\n                  </button>\n                </div>\n              )}\n            </div>\n\n            <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n              {/* Customer Selection */}\n              <div className=\"bg-white rounded-xl p-6 shadow-lg\">\n                <h2 className=\"text-xl font-bold text-gray-800 mb-2\">Add Extra Customers</h2>\n                <p className=\"text-sm text-gray-500 mb-4\">Recurring customers are auto-added. Check others to add to today's route.</p>\n                <div className=\"space-y-2 max-h-96 overflow-y-auto\">\n                  {customers.map(customer => {\n                    const isScheduled = routeCustomers.some(c => c.id === customer.id && (c.recurringId || c.isOneTimeJob));\n                    const isInRoute = routeCustomers.some(c => c.id === customer.id);\n                    return (\n                      <label key={customer.id} className={`flex items-center gap-3 p-3 rounded-lg cursor-pointer transition-all ${isScheduled ? 'bg-blue-50 border-l-4 border-blue-500' : 'hover:bg-gray-50'}`}>\n                        <input\n                          type=\"checkbox\"\n                          checked={isInRoute}\n                          onChange={() => toggleRouteCustomer(customer)}\n                          className=\"w-5 h-5 rounded\"\n                          disabled={isScheduled}\n                        />\n                        <div className=\"flex-1\">\n                          <div className=\"font-medium flex items-center gap-2\">\n                            {customer.name}\n                            {isScheduled && (\n                              <span className=\"text-xs bg-blue-200 text-blue-800 px-2 py-0.5 rounded\">\n                                {routeCustomers.find(c => c.id === customer.id)?.isOneTimeJob ? 'Job Scheduled' : 'Recurring'}\n                              </span>\n                            )}\n                          </div>\n                          <div className=\"text-sm text-gray-500\">{customer.address}</div>\n                          {customer.gateCode && <div className=\"text-xs text-blue-600\">Gate: {customer.gateCode}</div>}\n                          {customer.dogName && <div className=\"text-xs text-amber-600\"> {customer.dogName}</div>}\n                        </div>\n                        <div className=\"font-bold text-green-600\">${customer.weeklyRate}</div>\n                      </label>\n                    );\n                  })}\n                  {customers.length === 0 && (\n                    <p className=\"text-gray-500 text-center py-8\">No customers yet. Add some first!</p>\n                  )}\n                </div>\n              </div>\n\n              {/* Route Order */}\n              <div className=\"bg-white rounded-xl p-6 shadow-lg\">\n                <div className=\"flex items-center justify-between mb-4\">\n                  <div>\n                    <h2 className=\"text-xl font-bold text-gray-800\">Route for {formatRouteDate(routeDate)}</h2>\n                    <p className=\"text-sm text-gray-500\">{routeCustomers.length} stops</p>\n                  </div>\n                  {routeCustomers.length > 0 && (\n                    <div className=\"flex gap-2\">\n                      <button\n                        onClick={() => setShowMap(!showMap)}\n                        className=\"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-all\"\n                      >\n                        <Icons.Map />\n                        {showMap ? 'Hide Map' : 'Show Map'}\n                      </button>\n                      <a\n                        href={getGoogleMapsRouteUrl()}\n                        target=\"_blank\"\n                        rel=\"noopener noreferrer\"\n                        className=\"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-all\"\n                      >\n                        <Icons.Navigation />\n                        Navigate\n                      </a>\n                    </div>\n                  )}\n                </div>\n\n                {showMap && routeCustomers.length > 0 && (\n                  <div className=\"mb-4 rounded-lg overflow-hidden border-2 border-gray-200\">\n                    <iframe\n                      src={getEmbedMapUrl()}\n                      width=\"100%\"\n                      height=\"300\"\n                      style={{ border: 0 }}\n                      allowFullScreen\n                      loading=\"lazy\"\n                      referrerPolicy=\"no-referrer-when-downgrade\"\n                    />\n                  </div>\n                )}\n\n                {routeCustomers.length > 0 ? (\n                  <div className=\"space-y-2\">\n                    {routeCustomers.map((customer, idx) => {\n                      const employee = customer.employeeId ? employees.find(e => e.id === customer.employeeId) : null;\n                      const employeeColor = employee ? employeeColors[employees.indexOf(employee) % employeeColors.length] : null;\n                      \n                      return (\n                        <div key={`${customer.id}-${customer.isOneTimeJob ? 'job' : 'recurring'}-${idx}`} className={`flex items-center gap-3 p-3 rounded-lg ${customer.recurringId ? 'bg-blue-50' : customer.isOneTimeJob ? 'bg-purple-50' : 'bg-gray-50'}`}>\n                          <div className=\"flex flex-col gap-1\">\n                            <button onClick={() => moveInRoute(idx, -1)} disabled={idx === 0} className=\"text-gray-400 hover:text-gray-600 disabled:opacity-30\"></button>\n                            <button onClick={() => moveInRoute(idx, 1)} disabled={idx === routeCustomers.length - 1} className=\"text-gray-400 hover:text-gray-600 disabled:opacity-30\"></button>\n                          </div>\n                          <div className=\"w-8 h-8 rounded-full flex items-center justify-center text-white font-bold\" style={{ background: customer.isOneTimeJob ? '#7c3aed' : '#1e3a5f' }}>\n                            {idx + 1}\n                          </div>\n                          <div className=\"flex-1\">\n                            <div className=\"font-medium flex items-center gap-2 flex-wrap\">\n                              {customer.name}\n                              {customer.scheduledTime && (\n                                <span className=\"text-xs bg-amber-100 text-amber-800 px-2 py-0.5 rounded font-bold\">\n                                   {customer.scheduledTime}\n                                </span>\n                              )}\n                              {customer.recurringId && (\n                                <span className=\"text-xs bg-blue-200 text-blue-800 px-2 py-0.5 rounded capitalize\">{customer.frequency}</span>\n                              )}\n                              {customer.isOneTimeJob && (\n                                <span className=\"text-xs bg-purple-200 text-purple-800 px-2 py-0.5 rounded\">{customer.jobType}</span>\n                              )}\n                              {employee && (\n                                <span \n                                  className=\"text-xs px-2 py-0.5 rounded\"\n                                  style={{ backgroundColor: employeeColor?.bg, color: employeeColor?.text }}\n                                >\n                                  {employee.name}\n                                </span>\n                              )}\n                            </div>\n                            <div className=\"text-sm text-gray-500\">{customer.address}</div>\n                            <div className=\"flex items-center gap-2 mt-1 flex-wrap\">\n                              {customer.gateCode && <span className=\"text-xs text-blue-600\">Gate: {customer.gateCode}</span>}\n                              {customer.dogName && <span className=\"text-xs text-amber-600\"> {customer.dogName}</span>}\n                              {/* Quick Reassign Dropdown */}\n                              {(customer.recurringId || customer.isOneTimeJob) && employees.length > 0 && (\n                                <select\n                                  value={customer.employeeId || ''}\n                                  onChange={(e) => {\n                                    const newEmployeeId = e.target.value ? parseInt(e.target.value) : null;\n                                    if (customer.isOneTimeJob) {\n                                      updateJob(customer.jobId, { employeeId: newEmployeeId });\n                                    } else if (customer.recurringId) {\n                                      updateRecurringService(customer.recurringId, { employeeId: newEmployeeId });\n                                    }\n                                  }}\n                                  className=\"text-xs px-2 py-1 border rounded bg-white\"\n                                  title=\"Assign to employee\"\n                                >\n                                  <option value=\"\">Unassigned</option>\n                                  {employees.map(emp => (\n                                    <option key={emp.id} value={emp.id}>{emp.name}</option>\n                                  ))}\n                                </select>\n                              )}\n                            </div>\n                          </div>\n                          <div className=\"font-bold text-green-600\">${customer.isOneTimeJob ? customer.jobPrice : customer.weeklyRate}</div>\n                          {customer.isOneTimeJob ? (\n                            <button\n                              type=\"button\"\n                              onClick={(e) => {\n                                e.preventDefault();\n                                e.stopPropagation();\n                                console.log('JOB Complete clicked', customer);\n                                const job = customer.jobData || \n                                            oneTimeJobs.find(j => j.id === customer.jobId) ||\n                                            oneTimeJobs.find(j => String(j.customerId) === String(customer.id) && j.date === routeDate);\n                                console.log('Found job:', job);\n                                if (job) {\n                                  setJobToComplete(job);\n                                  setJobCompletionItems([]);\n                                  setJobChemicals([]);\n                                  setJobCompletionNotes('');\n                                  setShowCompleteJobModal(true);\n                                } else {\n                                  alert('Job not found. oneTimeJobs count: ' + oneTimeJobs.length);\n                                }\n                              }}\n                              className=\"px-3 py-1 bg-purple-600 text-white text-sm rounded-lg hover:bg-purple-700\"\n                            >\n                              Complete Job\n                            </button>\n                          ) : (\n                            <button\n                              type=\"button\"\n                              onClick={(e) => {\n                                e.preventDefault();\n                                e.stopPropagation();\n                                console.log('SERVICE Complete clicked', customer);\n                                completeService(customer);\n                              }}\n                              className=\"px-3 py-1 bg-green-600 text-white text-sm rounded-lg hover:bg-green-700\"\n                            >\n                              Complete\n                            </button>\n                          )}\n                          {!customer.recurringId && !customer.isOneTimeJob && (\n                            <button onClick={() => toggleRouteCustomer(customer)} className=\"text-red-500 hover:text-red-700\">\n                              <Icons.X />\n                            </button>\n                          )}\n                        </div>\n                      );\n                    })}\n                    <div className=\"mt-4 p-4 bg-blue-50 rounded-lg border-2 border-blue-200\">\n                      <div className=\"flex justify-between items-center\">\n                        <div className=\"text-lg font-bold text-gray-800\">\n                          Route Total: ${routeCustomers.reduce((sum, c) => sum + (c.isOneTimeJob ? c.jobPrice : c.weeklyRate), 0)}\n                        </div>\n                        <div className=\"text-sm text-gray-600\">\n                          {routeCustomers.filter(c => c.recurringId).length} recurring  {routeCustomers.filter(c => c.isOneTimeJob).length} jobs  {routeCustomers.filter(c => !c.recurringId && !c.isOneTimeJob).length} extra\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n                ) : (\n                  <div className=\"text-center py-8\">\n                    <p className=\"text-gray-500 mb-2\">No customers scheduled for {formatRouteDate(routeDate)}</p>\n                    <p className=\"text-sm text-gray-400\">Add recurring services or one-time jobs to populate routes automatically</p>\n                  </div>\n                )}\n              </div>\n            </div>\n          </div>\n        )}\n\n        {/* CUSTOMERS TAB */}\n        {activeTab === 'customers' && (\n          <div className=\"space-y-4\">\n            <div className=\"flex justify-between items-center\">\n              <h2 className=\"text-xl font-bold text-gray-800\">Customers ({customers.length})</h2>\n              <button\n                onClick={() => setShowAddCustomer(true)}\n                className=\"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-all\"\n              >\n                <Icons.Plus />\n                Add Customer\n              </button>\n            </div>\n\n            {/* Add Customer Modal */}\n            {showAddCustomer && (\n              <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\">\n                <div className=\"bg-white rounded-xl p-6 w-full max-w-lg max-h-[90vh] overflow-y-auto\">\n                  <div className=\"flex justify-between items-center mb-4\">\n                    <h3 className=\"text-xl font-bold\">Add New Customer</h3>\n                    <button onClick={() => setShowAddCustomer(false)} className=\"text-gray-500 hover:text-gray-700\">\n                      <Icons.X />\n                    </button>\n                  </div>\n                  <div className=\"space-y-4\">\n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700 mb-1\">Name *</label>\n                      <input\n                        type=\"text\"\n                        value={newCustomer.name}\n                        onChange={e => setNewCustomer({ ...newCustomer, name: e.target.value })}\n                        className=\"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n                        placeholder=\"John Smith\"\n                      />\n                    </div>\n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700 mb-1\">Address *</label>\n                      <input\n                        type=\"text\"\n                        value={newCustomer.address}\n                        onChange={e => setNewCustomer({ ...newCustomer, address: e.target.value })}\n                        className=\"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n                        placeholder=\"123 Main St, City, State\"\n                      />\n                    </div>\n                    <div className=\"grid grid-cols-2 gap-4\">\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 mb-1\">Phone</label>\n                        <input\n                          type=\"tel\"\n                          value={newCustomer.phone}\n                          onChange={e => setNewCustomer({ ...newCustomer, phone: e.target.value })}\n                          className=\"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n                          placeholder=\"(555) 123-4567\"\n                        />\n                      </div>\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 mb-1\">Email</label>\n                        <input\n                          type=\"email\"\n                          value={newCustomer.email}\n                          onChange={e => setNewCustomer({ ...newCustomer, email: e.target.value })}\n                          className=\"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n                          placeholder=\"john@email.com\"\n                        />\n                      </div>\n                    </div>\n                    <div className=\"grid grid-cols-2 gap-4\">\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 mb-1\">Pool Type</label>\n                        <select\n                          value={newCustomer.poolType}\n                          onChange={e => setNewCustomer({ ...newCustomer, poolType: e.target.value })}\n                          className=\"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n                        >\n                          <option value=\"inground\">Inground</option>\n                          <option value=\"above-ground\">Above Ground</option>\n                          <option value=\"saltwater\">Saltwater</option>\n                          <option value=\"hot-tub\">Hot Tub</option>\n                        </select>\n                      </div>\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 mb-1\">Weekly Rate ($)</label>\n                        <input\n                          type=\"number\"\n                          value={newCustomer.weeklyRate}\n                          onChange={e => setNewCustomer({ ...newCustomer, weeklyRate: parseInt(e.target.value) || 0 })}\n                          className=\"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n                        />\n                      </div>\n                    </div>\n                    <div className=\"grid grid-cols-2 gap-4\">\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 mb-1\">Gate Code</label>\n                        <input\n                          type=\"text\"\n                          value={newCustomer.gateCode}\n                          onChange={e => setNewCustomer({ ...newCustomer, gateCode: e.target.value })}\n                          className=\"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n                          placeholder=\"#1234\"\n                        />\n                      </div>\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 mb-1\">Dog's Name</label>\n                        <input\n                          type=\"text\"\n                          value={newCustomer.dogName}\n                          onChange={e => setNewCustomer({ ...newCustomer, dogName: e.target.value })}\n                          className=\"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n                          placeholder=\"Buddy\"\n                        />\n                      </div>\n                    </div>\n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700 mb-1\">Notes</label>\n                      <textarea\n                        value={newCustomer.notes}\n                        onChange={e => setNewCustomer({ ...newCustomer, notes: e.target.value })}\n                        className=\"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n                        rows=\"2\"\n                        placeholder=\"Any special instructions...\"\n                      />\n                    </div>\n                    <button\n                      onClick={addCustomer}\n                      className=\"w-full py-3 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition-all\"\n                    >\n                      Add Customer\n                    </button>\n                  </div>\n                </div>\n              </div>\n            )}\n\n            {/* Edit Customer Modal */}\n            {editingCustomer && (\n              <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\">\n                <div className=\"bg-white rounded-xl p-6 w-full max-w-lg max-h-[90vh] overflow-y-auto\">\n                  <div className=\"flex justify-between items-center mb-4\">\n                    <h3 className=\"text-xl font-bold\">Edit Customer</h3>\n                    <button onClick={() => setEditingCustomer(null)} className=\"text-gray-500 hover:text-gray-700\">\n                      <Icons.X />\n                    </button>\n                  </div>\n                  <div className=\"space-y-4\">\n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700 mb-1\">Name</label>\n                      <input\n                        type=\"text\"\n                        value={editingCustomer.name}\n                        onChange={e => setEditingCustomer({ ...editingCustomer, name: e.target.value })}\n                        className=\"w-full px-4 py-2 border rounded-lg\"\n                      />\n                    </div>\n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700 mb-1\">Address</label>\n                      <input\n                        type=\"text\"\n                        value={editingCustomer.address}\n                        onChange={e => setEditingCustomer({ ...editingCustomer, address: e.target.value })}\n                        className=\"w-full px-4 py-2 border rounded-lg\"\n                      />\n                    </div>\n                    <div className=\"grid grid-cols-2 gap-4\">\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 mb-1\">Phone</label>\n                        <input\n                          type=\"tel\"\n                          value={editingCustomer.phone || ''}\n                          onChange={e => setEditingCustomer({ ...editingCustomer, phone: e.target.value })}\n                          className=\"w-full px-4 py-2 border rounded-lg\"\n                        />\n                      </div>\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 mb-1\">Email</label>\n                        <input\n                          type=\"email\"\n                          value={editingCustomer.email || ''}\n                          onChange={e => setEditingCustomer({ ...editingCustomer, email: e.target.value })}\n                          className=\"w-full px-4 py-2 border rounded-lg\"\n                        />\n                      </div>\n                    </div>\n                    <div className=\"grid grid-cols-2 gap-4\">\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 mb-1\">Pool Type</label>\n                        <select\n                          value={editingCustomer.poolType}\n                          onChange={e => setEditingCustomer({ ...editingCustomer, poolType: e.target.value })}\n                          className=\"w-full px-4 py-2 border rounded-lg\"\n                        >\n                          <option value=\"inground\">Inground</option>\n                          <option value=\"above-ground\">Above Ground</option>\n                          <option value=\"saltwater\">Saltwater</option>\n                          <option value=\"hot-tub\">Hot Tub</option>\n                        </select>\n                      </div>\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 mb-1\">Weekly Rate ($)</label>\n                        <input\n                          type=\"number\"\n                          value={editingCustomer.weeklyRate}\n                          onChange={e => setEditingCustomer({ ...editingCustomer, weeklyRate: parseInt(e.target.value) || 0 })}\n                          className=\"w-full px-4 py-2 border rounded-lg\"\n                        />\n                      </div>\n                    </div>\n                    <div className=\"grid grid-cols-2 gap-4\">\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 mb-1\">Gate Code</label>\n                        <input\n                          type=\"text\"\n                          value={editingCustomer.gateCode || ''}\n                          onChange={e => setEditingCustomer({ ...editingCustomer, gateCode: e.target.value })}\n                          className=\"w-full px-4 py-2 border rounded-lg\"\n                        />\n                      </div>\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 mb-1\">Dog's Name</label>\n                        <input\n                          type=\"text\"\n                          value={editingCustomer.dogName || ''}\n                          onChange={e => setEditingCustomer({ ...editingCustomer, dogName: e.target.value })}\n                          className=\"w-full px-4 py-2 border rounded-lg\"\n                        />\n                      </div>\n                    </div>\n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700 mb-1\">Notes</label>\n                      <textarea\n                        value={editingCustomer.notes || ''}\n                        onChange={e => setEditingCustomer({ ...editingCustomer, notes: e.target.value })}\n                        className=\"w-full px-4 py-2 border rounded-lg\"\n                        rows=\"2\"\n                      />\n                    </div>\n                    <button\n                      onClick={updateCustomer}\n                      className=\"w-full py-3 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700\"\n                    >\n                      Update Customer\n                    </button>\n                  </div>\n                </div>\n              </div>\n            )}\n\n            {/* Customer Cards */}\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n              {customers.map(customer => (\n                <div key={customer.id} className=\"bg-white rounded-xl p-5 shadow-lg border-l-4\" style={{ borderColor: '#0ea5e9' }}>\n                  <div className=\"flex justify-between items-start mb-3\">\n                    <div>\n                      <h3 className=\"text-lg font-bold text-gray-800\">{customer.name}</h3>\n                      <p className=\"text-sm text-gray-500 flex items-center gap-1\">\n                        <Icons.MapPin />\n                        {customer.address}\n                      </p>\n                    </div>\n                    <div className=\"text-xl font-black text-green-600\">${customer.weeklyRate}/wk</div>\n                  </div>\n                  <div className=\"grid grid-cols-2 gap-2 text-sm mb-3\">\n                    <div><span className=\"text-gray-500\">Pool:</span> {customer.poolType}</div>\n                    {customer.phone && <div><span className=\"text-gray-500\">Phone:</span> {customer.phone}</div>}\n                    {customer.gateCode && <div className=\"text-blue-600\"> Gate: {customer.gateCode}</div>}\n                    {customer.dogName && <div className=\"text-amber-600\"> {customer.dogName}</div>}\n                  </div>\n                  {customer.notes && <p className=\"text-sm text-gray-600 italic mb-3\">{customer.notes}</p>}\n                  <div className=\"flex gap-2\">\n                    <button\n                      onClick={() => setEditingCustomer(customer)}\n                      className=\"flex-1 py-2 bg-blue-100 text-blue-700 rounded-lg hover:bg-blue-200 transition-all text-sm font-medium\"\n                    >\n                      Edit\n                    </button>\n                    <button\n                      onClick={() => completeService(customer)}\n                      className=\"flex-1 py-2 bg-green-100 text-green-700 rounded-lg hover:bg-green-200 transition-all text-sm font-medium\"\n                    >\n                      Log Service\n                    </button>\n                    <button\n                      onClick={() => deleteCustomer(customer.id)}\n                      className=\"px-3 py-2 bg-red-100 text-red-700 rounded-lg hover:bg-red-200 transition-all\"\n                    >\n                      <Icons.Trash />\n                    </button>\n                  </div>\n                </div>\n              ))}\n            </div>\n\n            {customers.length === 0 && (\n              <div className=\"bg-white rounded-xl p-12 shadow-lg text-center\">\n                <div className=\"text-6xl mb-4\"></div>\n                <h3 className=\"text-xl font-bold text-gray-800 mb-2\">No customers yet</h3>\n                <p className=\"text-gray-500 mb-4\">Add your first customer to get started!</p>\n                <button\n                  onClick={() => setShowAddCustomer(true)}\n                  className=\"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-all\"\n                >\n                  Add First Customer\n                </button>\n              </div>\n            )}\n          </div>\n        )}\n\n        {/* RECURRING TAB */}\n        {activeTab === 'recurring' && (\n          <div className=\"space-y-6\">\n            {/* Add Recurring Service */}\n            <div className=\"bg-white rounded-xl p-6 shadow-lg\">\n              <h2 className=\"text-xl font-bold text-gray-800 mb-4\">Set Up Recurring Service</h2>\n              <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4 items-end\">\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">Customer</label>\n                  <select\n                    id=\"recurringCustomer\"\n                    className=\"w-full px-4 py-2 border rounded-lg\"\n                  >\n                    <option value=\"\">Select customer...</option>\n                    {customers.filter(c => !recurringServices.find(r => r.customerId === c.id && r.active)).map(c => (\n                      <option key={c.id} value={c.id}>{c.name}</option>\n                    ))}\n                  </select>\n                </div>\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">Frequency</label>\n                  <select id=\"recurringFrequency\" className=\"w-full px-4 py-2 border rounded-lg\">\n                    <option value=\"weekly\">Weekly</option>\n                    <option value=\"biweekly\">Bi-Weekly</option>\n                    <option value=\"monthly\">Monthly</option>\n                  </select>\n                </div>\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">Day of Week</label>\n                  <select id=\"recurringDay\" className=\"w-full px-4 py-2 border rounded-lg\">\n                    <option value=\"1\">Monday</option>\n                    <option value=\"2\">Tuesday</option>\n                    <option value=\"3\">Wednesday</option>\n                    <option value=\"4\">Thursday</option>\n                    <option value=\"5\">Friday</option>\n                    <option value=\"6\">Saturday</option>\n                    <option value=\"0\">Sunday</option>\n                  </select>\n                </div>\n              </div>\n              <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4 items-end mt-4\">\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">Start Date</label>\n                  <input\n                    type=\"date\"\n                    id=\"recurringStart\"\n                    defaultValue={getLocalDateString()}\n                    className=\"w-full px-4 py-2 border rounded-lg\"\n                  />\n                </div>\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                    Scheduled Time <span className=\"text-gray-400 font-normal\">(optional)</span>\n                  </label>\n                  <input\n                    type=\"time\"\n                    id=\"recurringTime\"\n                    className=\"w-full px-4 py-2 border rounded-lg\"\n                  />\n                </div>\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                    Assign To <span className=\"text-gray-400 font-normal\">(optional)</span>\n                  </label>\n                  <select id=\"recurringEmployee\" className=\"w-full px-4 py-2 border rounded-lg\">\n                    <option value=\"\">Unassigned</option>\n                    {employees.map(emp => (\n                      <option key={emp.id} value={emp.id}>{emp.name}</option>\n                    ))}\n                  </select>\n                </div>\n              </div>\n              <button\n                onClick={() => {\n                  const customerId = parseInt(document.getElementById('recurringCustomer').value);\n                  const frequency = document.getElementById('recurringFrequency').value;\n                  const dayOfWeek = document.getElementById('recurringDay').value;\n                  const startDate = document.getElementById('recurringStart').value;\n                  const scheduledTime = document.getElementById('recurringTime').value || null;\n                  const employeeId = document.getElementById('recurringEmployee').value || null;\n                  if (customerId) {\n                    addRecurringService(customerId, frequency, dayOfWeek, startDate, scheduledTime, employeeId);\n                    document.getElementById('recurringCustomer').value = '';\n                    document.getElementById('recurringTime').value = '';\n                    document.getElementById('recurringEmployee').value = '';\n                  }\n                }}\n                className=\"mt-4 px-6 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700\"\n              >\n                Add Recurring Service\n              </button>\n            </div>\n\n            {/* Active Recurring Services */}\n            <div className=\"bg-white rounded-xl p-6 shadow-lg\">\n              <h2 className=\"text-xl font-bold text-gray-800 mb-4\">Active Recurring Schedules</h2>\n              {recurringServices.filter(r => r.active).length > 0 ? (\n                <div className=\"space-y-3\">\n                  {recurringServices.filter(r => r.active).map(recurring => {\n                    const customer = customers.find(c => c.id === recurring.customerId);\n                    const employee = recurring.employeeId ? employees.find(e => e.id === recurring.employeeId) : null;\n                    const employeeColor = employee ? employeeColors[employees.indexOf(employee) % employeeColors.length] : null;\n                    const dayNames = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];\n                    return (\n                      <div key={recurring.id} className=\"flex items-center justify-between p-4 bg-purple-50 rounded-lg border-l-4 border-purple-500\">\n                        <div className=\"flex-1\">\n                          <div className=\"font-bold text-gray-800 flex items-center gap-2 flex-wrap\">\n                            {recurring.customerName}\n                            {recurring.scheduledTime && (\n                              <span className=\"text-xs bg-amber-100 text-amber-800 px-2 py-0.5 rounded font-bold\">\n                                 {recurring.scheduledTime}\n                              </span>\n                            )}\n                            {employee && (\n                              <span \n                                className=\"text-xs px-2 py-0.5 rounded\"\n                                style={{ backgroundColor: employeeColor?.bg, color: employeeColor?.text }}\n                              >\n                                {employee.name}\n                              </span>\n                            )}\n                          </div>\n                          <div className=\"text-sm text-gray-600\">\n                            <span className=\"font-medium text-purple-700 capitalize\">{recurring.frequency}</span>\n                            {' on '}{dayNames[recurring.dayOfWeek || 1]}\n                            <span className=\"mx-2\"></span>\n                            Started: {new Date(recurring.startDate).toLocaleDateString()}\n                          </div>\n                          {customer && (\n                            <div className=\"text-sm text-green-600 font-medium\">${customer.weeklyRate}/visit</div>\n                          )}\n                          {/* Quick edit controls */}\n                          <div className=\"flex items-center gap-2 mt-2 flex-wrap\">\n                            <input\n                              type=\"time\"\n                              value={recurring.scheduledTime || ''}\n                              onChange={(e) => updateRecurringService(recurring.id, { scheduledTime: e.target.value || null })}\n                              className=\"text-xs px-2 py-1 border rounded\"\n                              title=\"Set appointment time\"\n                            />\n                            <select\n                              value={recurring.employeeId || ''}\n                              onChange={(e) => updateRecurringService(recurring.id, { employeeId: e.target.value ? parseInt(e.target.value) : null })}\n                              className=\"text-xs px-2 py-1 border rounded bg-white\"\n                              title=\"Assign to employee\"\n                            >\n                              <option value=\"\">Unassigned</option>\n                              {employees.map(emp => (\n                                <option key={emp.id} value={emp.id}>{emp.name}</option>\n                              ))}\n                            </select>\n                          </div>\n                        </div>\n                        <button\n                          onClick={() => deleteRecurringService(recurring.id)}\n                          className=\"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 ml-3\"\n                        >\n                          Cancel\n                        </button>\n                      </div>\n                    );\n                  })}\n                </div>\n              ) : (\n                <div className=\"text-center py-12 text-gray-500\">\n                  <Icons.Calendar />\n                  <p className=\"mt-2\">No recurring services set up yet</p>\n                  <p className=\"text-sm\">Add customers to recurring schedules above</p>\n                </div>\n              )}\n            </div>\n          </div>\n        )}\n\n        {/* QUOTES TAB */}\n        {activeTab === 'quotes' && (\n          <div className=\"space-y-6\">\n            <div className=\"flex justify-between items-center\">\n              <h2 className=\"text-xl font-bold text-gray-800\">Quotes</h2>\n              <button\n                onClick={() => setShowCreateQuote(true)}\n                className=\"flex items-center gap-2 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700\"\n              >\n                <Icons.Plus />\n                Create Quote\n              </button>\n            </div>\n\n            {/* Create Quote Modal */}\n            {showCreateQuote && (\n              <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\">\n                <div className=\"bg-white rounded-xl p-6 w-full max-w-4xl max-h-[90vh] overflow-y-auto\">\n                  <div className=\"flex justify-between items-center mb-4\">\n                    <h3 className=\"text-xl font-bold\">{editingQuoteId ? 'Edit Quote' : 'Create Quote'}</h3>\n                    <button onClick={() => { \n                      setShowCreateQuote(false); \n                      setEditingQuoteId(null);\n                      setCurrentQuote({ customerId: '', items: [], notes: '', validDays: 30 });\n                    }} className=\"text-gray-500 hover:text-gray-700\">\n                      <Icons.X />\n                    </button>\n                  </div>\n\n                  <div className=\"space-y-4\">\n                    <div className=\"grid grid-cols-2 gap-4\">\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 mb-1\">Customer</label>\n                        <CustomerSelect\n                          value={currentQuote.customerId}\n                          onChange={val => setCurrentQuote({ ...currentQuote, customerId: val })}\n                          placeholder=\"Search customer...\"\n                        />\n                      </div>\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 mb-1\">Valid For (Days)</label>\n                        <input\n                          type=\"number\"\n                          value={currentQuote.validDays}\n                          onChange={e => setCurrentQuote({ ...currentQuote, validDays: parseInt(e.target.value) || 30 })}\n                          className=\"w-full px-4 py-2 border rounded-lg\"\n                        />\n                      </div>\n                    </div>\n\n                    {/* Saved Items Quick Add */}\n                    {savedQuoteItems.length > 0 && (\n                      <div className=\"bg-purple-50 p-4 rounded-lg\">\n                        <div className=\"flex justify-between items-center mb-2\">\n                          <h4 className=\"font-medium text-purple-800\"> Saved Items (click to add to quote)</h4>\n                          <div className=\"flex gap-2\">\n                            <button\n                              onClick={() => setShowSavedItems(!showSavedItems)}\n                              className=\"text-sm text-purple-600 hover:underline\"\n                            >\n                              {showSavedItems ? 'Hide' : 'Show'} ({savedQuoteItems.length})\n                            </button>\n                          </div>\n                        </div>\n                        {showSavedItems && (\n                          <div className=\"space-y-2 mt-2\">\n                            {savedQuoteItems.map((item, idx) => (\n                              <div key={idx} className=\"flex items-center justify-between bg-white p-2 rounded-lg border border-purple-200\">\n                                <button\n                                  onClick={() => {\n                                    setCurrentQuote({\n                                      ...currentQuote,\n                                      items: [...currentQuote.items, { ...item, id: Date.now() }]\n                                    });\n                                  }}\n                                  className=\"flex-1 text-left hover:text-purple-700\"\n                                  title=\"Click to add to quote\"\n                                >\n                                  <span className=\"text-xs bg-purple-100 px-2 py-0.5 rounded mr-2\">{item.type}</span>\n                                  <span className=\"font-medium\">{item.description}</span>\n                                  {item.modelNumber && <span className=\"text-xs text-gray-500 ml-2\">#{item.modelNumber}</span>}\n                                  <span className=\"text-green-600 ml-2\">${item.price}</span>\n                                </button>\n                                <button\n                                  onClick={() => {\n                                    if (confirm(`Remove \"${item.description}\" from saved items?`)) {\n                                      saveSavedQuoteItems(savedQuoteItems.filter((_, i) => i !== idx));\n                                    }\n                                  }}\n                                  className=\"text-red-500 hover:text-red-700 p-1 ml-2\"\n                                  title=\"Remove saved item\"\n                                >\n                                  <Icons.X />\n                                </button>\n                              </div>\n                            ))}\n                          </div>\n                        )}\n                      </div>\n                    )}\n\n                    {/* Add Line Item */}\n                    <div className=\"bg-gray-50 p-4 rounded-lg\">\n                      <h4 className=\"font-medium mb-3\">Add New Line Item</h4>\n                      <div className=\"grid grid-cols-6 gap-3\">\n                        <div>\n                          <label className=\"block text-xs text-gray-500 mb-1\">Type</label>\n                          <select\n                            value={newLineItem.type}\n                            onChange={e => setNewLineItem({ ...newLineItem, type: e.target.value })}\n                            className=\"w-full px-3 py-2 border rounded-lg\"\n                          >\n                            <option value=\"labor\">Labor</option>\n                            <option value=\"part\">Part/Equipment</option>\n                            <option value=\"chemical\">Chemical</option>\n                            <option value=\"other\">Other</option>\n                          </select>\n                        </div>\n                        <div className=\"col-span-2\">\n                          <label className=\"block text-xs text-gray-500 mb-1\">Description</label>\n                          <input\n                            type=\"text\"\n                            placeholder=\"e.g., Pool Pump Installation\"\n                            value={newLineItem.description}\n                            onChange={e => setNewLineItem({ ...newLineItem, description: e.target.value })}\n                            className=\"w-full px-3 py-2 border rounded-lg\"\n                          />\n                        </div>\n                        <div>\n                          <label className=\"block text-xs text-gray-500 mb-1\">Model/Part #</label>\n                          <input\n                            type=\"text\"\n                            placeholder=\"e.g., SP2610X15\"\n                            value={newLineItem.modelNumber}\n                            onChange={e => setNewLineItem({ ...newLineItem, modelNumber: e.target.value })}\n                            className=\"w-full px-3 py-2 border rounded-lg\"\n                          />\n                        </div>\n                        <div>\n                          <label className=\"block text-xs text-gray-500 mb-1\">Qty</label>\n                          <input\n                            type=\"number\"\n                            min=\"1\"\n                            value={newLineItem.quantity}\n                            onChange={e => setNewLineItem({ ...newLineItem, quantity: parseInt(e.target.value) || 1 })}\n                            className=\"w-full px-3 py-2 border rounded-lg\"\n                          />\n                        </div>\n                        <div>\n                          <label className=\"block text-xs text-gray-500 mb-1\">Price ($)</label>\n                          <input\n                            type=\"number\"\n                            min=\"0\"\n                            step=\"0.01\"\n                            value={newLineItem.price}\n                            onChange={e => setNewLineItem({ ...newLineItem, price: parseFloat(e.target.value) || 0 })}\n                            className=\"w-full px-3 py-2 border rounded-lg\"\n                          />\n                        </div>\n                      </div>\n                      <div className=\"flex gap-2 mt-3\">\n                        <button\n                          onClick={() => addLineItem(currentQuote, setCurrentQuote)}\n                          disabled={!newLineItem.description || newLineItem.price <= 0}\n                          className=\"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-300\"\n                        >\n                          Add to Quote\n                        </button>\n                        <button\n                          onClick={() => {\n                            if (newLineItem.description && newLineItem.price > 0) {\n                              const itemToSave = { ...newLineItem };\n                              if (!savedQuoteItems.find(i => i.description === itemToSave.description && i.modelNumber === itemToSave.modelNumber)) {\n                                saveSavedQuoteItems([...savedQuoteItems, itemToSave]);\n                                showEmailNotification('success', 'Item saved for future quotes');\n                              }\n                            }\n                          }}\n                          disabled={!newLineItem.description || newLineItem.price <= 0}\n                          className=\"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:bg-gray-300\"\n                        >\n                           Save Item\n                        </button>\n                      </div>\n                    </div>\n\n                    {/* Line Items List */}\n                    {currentQuote.items.length > 0 && (\n                      <div className=\"border rounded-lg overflow-hidden\">\n                        <table className=\"w-full\">\n                          <thead className=\"bg-gray-50\">\n                            <tr>\n                              <th className=\"px-4 py-2 text-left text-sm font-medium\">Description</th>\n                              <th className=\"px-4 py-2 text-left text-sm font-medium\">Qty</th>\n                              <th className=\"px-4 py-2 text-left text-sm font-medium\">Price</th>\n                              <th className=\"px-4 py-2 text-left text-sm font-medium\">Total</th>\n                              <th className=\"px-4 py-2\"></th>\n                            </tr>\n                          </thead>\n                          <tbody>\n                            {currentQuote.items.map(item => (\n                              <tr key={item.id} className=\"border-t\">\n                                <td className=\"px-4 py-2\">\n                                  <span className=\"text-xs bg-gray-200 px-2 py-0.5 rounded mr-2\">{item.type}</span>\n                                  {item.description}\n                                  {item.modelNumber && <div className=\"text-xs text-gray-500\">Part #: {item.modelNumber}</div>}\n                                </td>\n                                <td className=\"px-4 py-2\">{item.quantity}</td>\n                                <td className=\"px-4 py-2\">${item.price.toFixed(2)}</td>\n                                <td className=\"px-4 py-2 font-medium\">${(item.quantity * item.price).toFixed(2)}</td>\n                                <td className=\"px-4 py-2\">\n                                  <button\n                                    onClick={() => removeLineItem(currentQuote, setCurrentQuote, item.id)}\n                                    className=\"text-red-500 hover:text-red-700\"\n                                  >\n                                    <Icons.X />\n                                  </button>\n                                </td>\n                              </tr>\n                            ))}\n                            <tr className=\"border-t bg-purple-50\">\n                              <td colSpan=\"3\" className=\"px-4 py-2 font-bold text-right\">Quote Total:</td>\n                              <td colSpan=\"2\" className=\"px-4 py-2 font-bold text-purple-700\">\n                                ${currentQuote.items.reduce((sum, i) => sum + (i.quantity * i.price), 0).toFixed(2)}\n                              </td>\n                            </tr>\n                          </tbody>\n                        </table>\n                      </div>\n                    )}\n\n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700 mb-1\">Notes</label>\n                      <textarea\n                        value={currentQuote.notes}\n                        onChange={e => setCurrentQuote({ ...currentQuote, notes: e.target.value })}\n                        className=\"w-full px-4 py-2 border rounded-lg\"\n                        rows=\"2\"\n                        placeholder=\"Any additional notes for the customer...\"\n                      />\n                    </div>\n\n                    <button\n                      onClick={generateQuote}\n                      disabled={!currentQuote.customerId || currentQuote.items.length === 0}\n                      className=\"w-full py-3 bg-purple-600 text-white rounded-lg font-medium hover:bg-purple-700 disabled:bg-gray-300\"\n                    >\n                      {editingQuoteId ? ' Update Quote' : ' Generate Quote'}\n                    </button>\n                  </div>\n                </div>\n              </div>\n            )}\n\n            {/* Quotes List */}\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n              {/* Pending Quotes */}\n              <div className=\"bg-white rounded-xl p-6 shadow-lg\">\n                <h3 className=\"text-lg font-bold text-gray-800 mb-4\">Pending Quotes</h3>\n                {quotes.filter(q => q.status === 'pending').length > 0 ? (\n                  <div className=\"space-y-3\">\n                    {quotes.filter(q => q.status === 'pending').map(quote => {\n                      const customer = customers.find(c => c.id === quote.customerId);\n                      return (\n                        <div key={quote.id} className=\"p-4 bg-amber-50 rounded-lg border-l-4 border-amber-500\">\n                          <div className=\"flex justify-between items-start\">\n                            <div>\n                              <div className=\"font-bold\">{quote.customerName}</div>\n                              <div className=\"text-sm text-gray-500\">{quote.quoteNumber}</div>\n                              <div className=\"text-xs text-gray-400\">\n                                Valid until: {new Date(quote.validUntil).toLocaleDateString()}\n                              </div>\n                            </div>\n                            <div className=\"text-xl font-bold text-amber-600\">${quote.total.toFixed(2)}</div>\n                          </div>\n                          {/* Action buttons row 1 - PDF, Email, Edit */}\n                          <div className=\"flex gap-2 mt-3\">\n                            <button\n                              onClick={() => downloadQuotePdf(quote)}\n                              className=\"flex-1 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 text-sm\"\n                            >\n                               PDF\n                            </button>\n                            <button\n                              onClick={() => {\n                                if (customer?.email) {\n                                  sendQuoteEmail(quote, customer);\n                                } else {\n                                  alert('Customer has no email address');\n                                }\n                              }}\n                              disabled={!customer?.email || isSendingEmail}\n                              className=\"flex-1 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 text-sm disabled:bg-gray-300\"\n                            >\n                              {isSendingEmail ? '' : ''} Email\n                            </button>\n                            <button\n                              onClick={() => {\n                                setCurrentQuote({\n                                  ...quote,\n                                  customerId: quote.customerId,\n                                  validDays: Math.ceil((new Date(quote.validUntil) - new Date()) / (1000 * 60 * 60 * 24))\n                                });\n                                setEditingQuoteId(quote.id);\n                                setShowCreateQuote(true);\n                              }}\n                              className=\"flex-1 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 text-sm\"\n                            >\n                               Edit\n                            </button>\n                          </div>\n                          {/* Action buttons row 2 - Approve/Decline */}\n                          <div className=\"flex gap-2 mt-2\">\n                            <button\n                              onClick={() => convertQuoteToJob(quote)}\n                              className=\"flex-1 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 text-sm\"\n                            >\n                               Approve  Job\n                            </button>\n                            <button\n                              onClick={() => convertQuoteToInvoice(quote)}\n                              className=\"flex-1 py-2 text-white rounded-lg hover:opacity-90 text-sm\"\n                              style={{ backgroundColor: '#1e3a5f' }}\n                            >\n                               Approve  Invoice\n                            </button>\n                            <button\n                              onClick={() => {\n                                if (confirm('Delete this quote?')) {\n                                  saveQuotes(quotes.filter(q => q.id !== quote.id));\n                                }\n                              }}\n                              className=\"px-3 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 text-sm\"\n                            >\n                              \n                            </button>\n                          </div>\n                        </div>\n                      );\n                    })}\n                  </div>\n                ) : (\n                  <p className=\"text-gray-500 text-center py-8\">No pending quotes</p>\n                )}\n              </div>\n\n              {/* Quote History */}\n              <div className=\"bg-white rounded-xl p-6 shadow-lg\">\n                <h3 className=\"text-lg font-bold text-gray-800 mb-4\">Quote History</h3>\n                {quotes.filter(q => q.status !== 'pending').length > 0 ? (\n                  <div className=\"space-y-3\">\n                    {quotes.filter(q => q.status !== 'pending').map(quote => (\n                      <div key={quote.id} className={`p-4 rounded-lg border-l-4 ${\n                        quote.status === 'approved' ? 'bg-green-50 border-green-500' : \n                        quote.status === 'invoiced' ? 'bg-blue-50 border-blue-500' :\n                        'bg-red-50 border-red-500'\n                      }`}>\n                        <div className=\"flex justify-between items-start\">\n                          <div>\n                            <div className=\"font-bold\">{quote.customerName}</div>\n                            <div className=\"text-sm text-gray-500\">{quote.quoteNumber}</div>\n                            <span className={`text-xs px-2 py-0.5 rounded ${\n                              quote.status === 'approved' ? 'bg-green-200 text-green-800' : \n                              quote.status === 'invoiced' ? 'bg-blue-200 text-blue-800' :\n                              'bg-red-200 text-red-800'\n                            }`}>\n                              {quote.status.toUpperCase()}\n                            </span>\n                          </div>\n                          <div className=\"text-lg font-bold text-gray-600\">${quote.total.toFixed(2)}</div>\n                        </div>\n                        {quote.status === 'approved' && (\n                          <button\n                            onClick={() => convertQuoteToInvoice(quote)}\n                            className=\"mt-3 w-full py-2 text-white rounded-lg text-sm\"\n                            style={{ backgroundColor: '#1e3a5f' }}\n                          >\n                            Convert to Invoice\n                          </button>\n                        )}\n                      </div>\n                    ))}\n                  </div>\n                ) : (\n                  <p className=\"text-gray-500 text-center py-8\">No quote history</p>\n                )}\n              </div>\n            </div>\n          </div>\n        )}\n\n        {/* JOBS TAB */}\n        {activeTab === 'jobs' && (\n          <div className=\"space-y-4\">\n            <div className=\"flex justify-between items-center\">\n              <h2 className=\"text-xl font-bold text-gray-800\">One-Time Jobs</h2>\n              <div className=\"flex gap-2\">\n                <button\n                  onClick={() => setShowWearItemsSettings(true)}\n                  className=\"flex items-center gap-2 px-4 py-2 bg-amber-100 text-amber-800 rounded-lg hover:bg-amber-200 transition-all border border-amber-300\"\n                >\n                  <Icons.Wrench />\n                  Quick Add Items\n                </button>\n                <button\n                  onClick={() => setShowAddJob(true)}\n                  className=\"flex items-center gap-2 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-all\"\n                >\n                  <Icons.Plus />\n                  Add Job\n                </button>\n              </div>\n            </div>\n\n            {/* Wear Items Settings Modal */}\n            {showWearItemsSettings && (\n              <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\">\n                <div className=\"bg-white rounded-xl p-6 w-full max-w-lg max-h-[90vh] overflow-y-auto\">\n                  <div className=\"flex justify-between items-center mb-4\">\n                    <h3 className=\"text-xl font-bold text-gray-800\"> Common Wear Items</h3>\n                    <button onClick={() => setShowWearItemsSettings(false)} className=\"text-gray-500 hover:text-gray-700\">\n                      <Icons.X />\n                    </button>\n                  </div>\n                  \n                  <p className=\"text-sm text-gray-600 mb-4\">\n                    Save common parts and wear items here. They'll be available to quickly add when completing jobs.\n                  </p>\n\n                  {/* Add New Wear Item */}\n                  <div className=\"bg-gray-50 p-4 rounded-lg mb-4\">\n                    <h4 className=\"font-medium text-gray-700 mb-3\">Add New Item</h4>\n                    <div className=\"space-y-3\">\n                      <div className=\"grid grid-cols-2 gap-3\">\n                        <input\n                          type=\"text\"\n                          placeholder=\"Item name (e.g., O-ring)\"\n                          value={newWearItem.name}\n                          onChange={e => setNewWearItem({ ...newWearItem, name: e.target.value })}\n                          className=\"px-3 py-2 border rounded-lg\"\n                        />\n                        <input\n                          type=\"number\"\n                          step=\"0.01\"\n                          placeholder=\"Price ($)\"\n                          value={newWearItem.price || ''}\n                          onChange={e => setNewWearItem({ ...newWearItem, price: parseFloat(e.target.value) || 0 })}\n                          className=\"px-3 py-2 border rounded-lg\"\n                        />\n                      </div>\n                      <input\n                        type=\"text\"\n                        placeholder=\"Description (optional)\"\n                        value={newWearItem.description}\n                        onChange={e => setNewWearItem({ ...newWearItem, description: e.target.value })}\n                        className=\"w-full px-3 py-2 border rounded-lg\"\n                      />\n                      <button\n                        onClick={addWearItem}\n                        disabled={!newWearItem.name || newWearItem.price <= 0}\n                        className=\"w-full py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:bg-gray-300\"\n                      >\n                        Add Item\n                      </button>\n                    </div>\n                  </div>\n\n                  {/* Existing Wear Items */}\n                  <div>\n                    <h4 className=\"font-medium text-gray-700 mb-3\">Saved Items ({wearItems.length})</h4>\n                    {wearItems.length > 0 ? (\n                      <div className=\"space-y-2\">\n                        {wearItems.map(item => (\n                          <div key={item.id} className=\"flex items-center justify-between p-3 bg-white border rounded-lg\">\n                            <div>\n                              <div className=\"font-medium text-gray-800\">{item.name}</div>\n                              {item.description && <div className=\"text-xs text-gray-500\">{item.description}</div>}\n                            </div>\n                            <div className=\"flex items-center gap-3\">\n                              <span className=\"font-bold text-green-600\">${item.price.toFixed(2)}</span>\n                              <button\n                                onClick={() => deleteWearItem(item.id)}\n                                className=\"text-red-500 hover:text-red-700\"\n                              >\n                                <Icons.Trash />\n                              </button>\n                            </div>\n                          </div>\n                        ))}\n                      </div>\n                    ) : (\n                      <p className=\"text-center text-gray-500 py-4\">No wear items saved yet</p>\n                    )}\n                  </div>\n\n                  <button\n                    onClick={() => setShowWearItemsSettings(false)}\n                    className=\"w-full mt-4 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300\"\n                  >\n                    Done\n                  </button>\n                </div>\n              </div>\n            )}\n\n            {showAddJob && (\n              <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\">\n                <div className=\"bg-white rounded-xl p-6 w-full max-w-md\">\n                  <div className=\"flex justify-between items-center mb-4\">\n                    <h3 className=\"text-xl font-bold\">Schedule Job</h3>\n                    <button onClick={() => setShowAddJob(false)} className=\"text-gray-500 hover:text-gray-700\">\n                      <Icons.X />\n                    </button>\n                  </div>\n                  <div className=\"space-y-4\">\n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700 mb-1\">Customer</label>\n                      <CustomerSelect\n                        value={newJob.customerId}\n                        onChange={val => setNewJob({ ...newJob, customerId: val })}\n                        placeholder=\"Search customer...\"\n                      />\n                    </div>\n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700 mb-1\">Job Type</label>\n                      <select\n                        value={newJob.jobType}\n                        onChange={e => setNewJob({ ...newJob, jobType: e.target.value })}\n                        className=\"w-full px-4 py-2 border rounded-lg\"\n                      >\n                        <option value=\"opening\">Pool Opening</option>\n                        <option value=\"closing\">Pool Closing</option>\n                        <option value=\"repair\">Repair</option>\n                        <option value=\"green-to-clean\">Green to Clean</option>\n                        <option value=\"equipment\">Equipment Install</option>\n                        <option value=\"other\">Other</option>\n                      </select>\n                    </div>\n                    <div className=\"grid grid-cols-2 gap-4\">\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 mb-1\">Date</label>\n                        <input\n                          type=\"date\"\n                          value={newJob.date}\n                          onChange={e => setNewJob({ ...newJob, date: e.target.value })}\n                          className=\"w-full px-4 py-2 border rounded-lg\"\n                        />\n                      </div>\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                          Time <span className=\"text-gray-400 font-normal\">(optional)</span>\n                        </label>\n                        <input\n                          type=\"time\"\n                          value={newJob.scheduledTime || ''}\n                          onChange={e => setNewJob({ ...newJob, scheduledTime: e.target.value || null })}\n                          className=\"w-full px-4 py-2 border rounded-lg\"\n                        />\n                      </div>\n                    </div>\n                    <div className=\"grid grid-cols-2 gap-4\">\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 mb-1\">Price ($)</label>\n                        <input\n                          type=\"number\"\n                          value={newJob.price}\n                          onChange={e => setNewJob({ ...newJob, price: parseInt(e.target.value) || 0 })}\n                          className=\"w-full px-4 py-2 border rounded-lg\"\n                        />\n                      </div>\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                          Assign To <span className=\"text-gray-400 font-normal\">(optional)</span>\n                        </label>\n                        <select\n                          value={newJob.employeeId || ''}\n                          onChange={e => setNewJob({ ...newJob, employeeId: e.target.value ? parseInt(e.target.value) : null })}\n                          className=\"w-full px-4 py-2 border rounded-lg\"\n                        >\n                          <option value=\"\">Unassigned</option>\n                          {employees.map(emp => (\n                            <option key={emp.id} value={emp.id}>{emp.name}</option>\n                          ))}\n                        </select>\n                      </div>\n                    </div>\n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700 mb-1\">Notes</label>\n                      <textarea\n                        value={newJob.notes}\n                        onChange={e => setNewJob({ ...newJob, notes: e.target.value })}\n                        className=\"w-full px-4 py-2 border rounded-lg\"\n                        rows=\"2\"\n                      />\n                    </div>\n                    <button\n                      onClick={addJob}\n                      className=\"w-full py-3 bg-purple-600 text-white rounded-lg font-medium hover:bg-purple-700\"\n                    >\n                      Schedule Job\n                    </button>\n                  </div>\n                </div>\n              </div>\n            )}\n\n            {oneTimeJobs.length > 0 ? (\n              <div className=\"space-y-3\">\n                {oneTimeJobs.map(job => (\n                  <div key={job.id} className=\"bg-white rounded-xl p-5 shadow-lg flex items-center justify-between\">\n                    <div>\n                      <div className=\"font-bold text-gray-800\">{job.customerName}</div>\n                      <div className=\"text-sm text-gray-500\">\n                        {job.jobType}  {(() => {\n                          const [y, m, d] = job.date.split('-').map(Number);\n                          return new Date(y, m - 1, d).toLocaleDateString();\n                        })()}\n                      </div>\n                      {job.notes && <div className=\"text-sm text-gray-600 italic mt-1\">{job.notes}</div>}\n                    </div>\n                    <div className=\"flex items-center gap-3\">\n                      <div className=\"text-xl font-bold text-green-600\">${job.price}</div>\n                      <button\n                        onClick={() => completeJob(job)}\n                        className=\"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700\"\n                      >\n                        Complete\n                      </button>\n                      <button\n                        onClick={() => saveJobs(oneTimeJobs.filter(j => j.id !== job.id))}\n                        className=\"p-2 text-red-500 hover:text-red-700\"\n                      >\n                        <Icons.Trash />\n                      </button>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            ) : (\n              <div className=\"bg-white rounded-xl p-12 shadow-lg text-center\">\n                <div className=\"text-6xl mb-4\"></div>\n                <h3 className=\"text-xl font-bold text-gray-800 mb-2\">No jobs scheduled</h3>\n                <p className=\"text-gray-500\">Schedule openings, closings, repairs, and more.</p>\n              </div>\n            )}\n          </div>\n        )}\n\n        {/* PAYMENTS TAB */}\n        {activeTab === 'payments' && (\n          <div className=\"space-y-6\">\n            {/* Stripe Connection Status */}\n            <div className=\"bg-white rounded-xl p-6 shadow-lg border-l-4\" style={{ borderColor: '#635bff' }}>\n              <div className=\"flex items-center justify-between\">\n                <div className=\"flex items-center gap-4\">\n                  <div className=\"w-12 h-12 rounded-lg flex items-center justify-center\" style={{ backgroundColor: '#635bff' }}>\n                    <span className=\"text-white text-2xl\"></span>\n                  </div>\n                  <div>\n                    <h3 className=\"font-bold text-gray-800\">Stripe Payments</h3>\n                    <p className=\"text-sm text-green-600\"> Connected (Test Mode)</p>\n                    <p className=\"text-xs text-gray-500\">Server: {PAYMENT_SERVER_URL}</p>\n                  </div>\n                </div>\n                <div className=\"flex gap-2\">\n                  <button\n                    onClick={refreshPaymentStatuses}\n                    className=\"px-4 py-2 border rounded-lg hover:bg-gray-50 text-sm\"\n                  >\n                     Refresh Status\n                  </button>\n                  <button\n                    onClick={() => setShowPaymentModal(true)}\n                    className=\"px-6 py-3 text-white rounded-lg font-medium hover:opacity-90\"\n                    style={{ backgroundColor: '#635bff' }}\n                  >\n                    + Request Payment\n                  </button>\n                </div>\n              </div>\n            </div>\n\n            {/* Quick Payment Request */}\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n              {/* Request Payment Card */}\n              <div className=\"bg-white rounded-xl p-6 shadow-lg\">\n                <h3 className=\"text-lg font-bold text-gray-800 mb-4\">Quick Payment Request</h3>\n                <p className=\"text-gray-600 mb-4\">Send a Stripe payment link to any customer.</p>\n                <div className=\"space-y-3\">\n                  <select\n                    id=\"quickPayCustomer\"\n                    className=\"w-full px-4 py-2 border rounded-lg\"\n                  >\n                    <option value=\"\">Select customer...</option>\n                    {customers.map(c => <option key={c.id} value={c.id}>{c.name}</option>)}\n                  </select>\n                  <input\n                    type=\"number\"\n                    id=\"quickPayAmount\"\n                    placeholder=\"Amount ($)\"\n                    className=\"w-full px-4 py-2 border rounded-lg\"\n                  />\n                  <input\n                    type=\"text\"\n                    id=\"quickPayDesc\"\n                    placeholder=\"Description (optional)\"\n                    className=\"w-full px-4 py-2 border rounded-lg\"\n                  />\n                  <button\n                    onClick={() => {\n                      const customerId = document.getElementById('quickPayCustomer').value;\n                      const amount = parseFloat(document.getElementById('quickPayAmount').value) || 0;\n                      const desc = document.getElementById('quickPayDesc').value;\n                      if (customerId && amount > 0) {\n                        openPaymentRequest(customerId, amount, desc);\n                      }\n                    }}\n                    className=\"w-full py-3 text-white rounded-lg font-medium\"\n                    style={{ backgroundColor: '#635bff' }}\n                  >\n                    Generate Stripe Link\n                  </button>\n                </div>\n              </div>\n\n              {/* Payment Stats */}\n              <div className=\"bg-white rounded-xl p-6 shadow-lg\">\n                <h3 className=\"text-lg font-bold text-gray-800 mb-4\">Payment Overview</h3>\n                <div className=\"space-y-4\">\n                  <div className=\"flex justify-between items-center p-3 bg-green-50 rounded-lg\">\n                    <span className=\"text-gray-600\">Paid</span>\n                    <span className=\"text-xl font-bold text-green-600\">\n                      ${invoices.filter(i => i.paid).reduce((sum, i) => sum + (i.amount || 0), 0).toFixed(2)}\n                    </span>\n                  </div>\n                  <div className=\"flex justify-between items-center p-3 bg-amber-50 rounded-lg\">\n                    <span className=\"text-gray-600\">Pending</span>\n                    <span className=\"text-xl font-bold text-amber-600\">\n                      ${invoices.filter(i => !i.paid && i.type === 'payment-request').reduce((sum, i) => sum + (i.amount || 0), 0).toFixed(2)}\n                    </span>\n                  </div>\n                  <div className=\"flex justify-between items-center p-3 bg-gray-50 rounded-lg\">\n                    <span className=\"text-gray-600\">Total Requests</span>\n                    <span className=\"text-xl font-bold text-gray-800\">\n                      {invoices.filter(i => i.type === 'payment-request').length}\n                    </span>\n                  </div>\n                </div>\n              </div>\n            </div>\n\n            {/* Pending Payment Requests */}\n            <div className=\"bg-white rounded-xl p-6 shadow-lg\">\n              <h3 className=\"text-lg font-bold text-gray-800 mb-4\">Pending Payment Requests</h3>\n              {invoices.filter(i => i.type === 'payment-request' && !i.paid).length > 0 ? (\n                <div className=\"space-y-3\">\n                  {invoices.filter(i => i.type === 'payment-request' && !i.paid).map(inv => (\n                    <div key={inv.id} className=\"p-4 bg-amber-50 rounded-lg border-l-4 border-amber-500\">\n                      <div className=\"flex items-center justify-between mb-2\">\n                        <div>\n                          <div className=\"font-bold text-gray-800\">{inv.customerName}</div>\n                          <div className=\"text-sm text-gray-500\">\n                            {inv.invoiceNumber}  {new Date(inv.createdDate).toLocaleDateString()}\n                          </div>\n                          {inv.description && <div className=\"text-sm text-gray-600\">{inv.description}</div>}\n                        </div>\n                        <div className=\"text-xl font-bold text-amber-600\">${inv.amount.toFixed(2)}</div>\n                      </div>\n                      <div className=\"flex gap-2 mt-3\">\n                        {inv.paymentUrl && (\n                          <>\n                            <button\n                              onClick={() => window.open(inv.paymentUrl, '_blank')}\n                              className=\"flex-1 py-2 text-white rounded-lg text-sm\"\n                              style={{ backgroundColor: '#635bff' }}\n                            >\n                              Open Payment Link\n                            </button>\n                            <button\n                              onClick={() => {\n                                navigator.clipboard.writeText(inv.paymentUrl);\n                                alert('Payment link copied!');\n                              }}\n                              className=\"px-4 py-2 border rounded-lg text-sm hover:bg-gray-50\"\n                            >\n                               Copy\n                            </button>\n                          </>\n                        )}\n                        <button\n                          onClick={() => markPaymentReceived(inv.id)}\n                          className=\"px-4 py-2 bg-green-600 text-white rounded-lg text-sm hover:bg-green-700\"\n                        >\n                           Mark Paid\n                        </button>\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              ) : (\n                <p className=\"text-gray-500 text-center py-8\">No pending payment requests</p>\n              )}\n            </div>\n\n            {/* Payment History */}\n            <div className=\"bg-white rounded-xl p-6 shadow-lg\">\n              <h3 className=\"text-lg font-bold text-gray-800 mb-4\">Payment History</h3>\n              {invoices.filter(i => i.type === 'payment-request' && i.paid).length > 0 ? (\n                <div className=\"space-y-3\">\n                  {invoices.filter(i => i.type === 'payment-request' && i.paid).map(inv => (\n                    <div key={inv.id} className=\"flex items-center justify-between p-4 bg-green-50 rounded-lg border-l-4 border-green-500\">\n                      <div>\n                        <div className=\"font-bold text-gray-800\">{inv.customerName}</div>\n                        <div className=\"text-sm text-gray-500\">\n                          {inv.invoiceNumber}  Paid {new Date(inv.paidDate).toLocaleDateString()}\n                        </div>\n                      </div>\n                      <div className=\"text-xl font-bold text-green-600\">${inv.amount.toFixed(2)}</div>\n                    </div>\n                  ))}\n                </div>\n              ) : (\n                <p className=\"text-gray-500 text-center py-8\">No payment history yet</p>\n              )}\n            </div>\n          </div>\n        )}\n\n        {/* Payment Request Modal */}\n        {showPaymentModal && (\n          <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\">\n            <div className=\"bg-white rounded-xl p-6 w-full max-w-md\">\n              <div className=\"flex justify-between items-center mb-4\">\n                <h3 className=\"text-xl font-bold\" style={{ color: '#635bff' }}> Request Payment</h3>\n                <button onClick={() => { setShowPaymentModal(false); setPaymentError(''); }} className=\"text-gray-500 hover:text-gray-700\">\n                  <Icons.X />\n                </button>\n              </div>\n              \n              {paymentError && (\n                <div className=\"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm\">\n                   {paymentError}\n                </div>\n              )}\n              \n              <div className=\"space-y-4\">\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">Customer</label>\n                  <select\n                    value={paymentDetails.customerId}\n                    onChange={e => setPaymentDetails({ ...paymentDetails, customerId: e.target.value })}\n                    className=\"w-full px-4 py-2 border rounded-lg\"\n                    disabled={isProcessingPayment}\n                  >\n                    <option value=\"\">Select customer...</option>\n                    {customers.map(c => <option key={c.id} value={c.id}>{c.name} {c.email ? `(${c.email})` : ''}</option>)}\n                  </select>\n                </div>\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">Amount ($)</label>\n                  <input\n                    type=\"number\"\n                    step=\"0.01\"\n                    value={paymentDetails.amount || ''}\n                    onChange={e => setPaymentDetails({ ...paymentDetails, amount: parseFloat(e.target.value) || 0 })}\n                    className=\"w-full px-4 py-3 border-2 rounded-lg text-2xl font-bold text-center\"\n                    style={{ borderColor: '#635bff' }}\n                    placeholder=\"0.00\"\n                    disabled={isProcessingPayment}\n                  />\n                </div>\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">Description (optional)</label>\n                  <input\n                    type=\"text\"\n                    value={paymentDetails.description}\n                    onChange={e => setPaymentDetails({ ...paymentDetails, description: e.target.value })}\n                    className=\"w-full px-4 py-2 border rounded-lg\"\n                    placeholder=\"e.g., Monthly pool service - January\"\n                    disabled={isProcessingPayment}\n                  />\n                </div>\n                <div className=\"bg-gray-50 p-4 rounded-lg\">\n                  <div className=\"text-sm text-gray-600 mb-2\">Payment will be processed via:</div>\n                  <div className=\"flex items-center gap-2\">\n                    <span className=\"text-2xl\"></span>\n                    <span className=\"font-bold\" style={{ color: '#635bff' }}>Stripe Checkout</span>\n                    <span className=\"text-xs bg-green-100 text-green-700 px-2 py-0.5 rounded\">Secure</span>\n                  </div>\n                  <div className=\"text-xs text-gray-500 mt-2\">\n                    Creates a real Stripe payment link your customer can use to pay instantly.\n                  </div>\n                </div>\n                <button\n                  onClick={sendPaymentRequest}\n                  disabled={!paymentDetails.customerId || paymentDetails.amount <= 0 || isProcessingPayment}\n                  className=\"w-full py-3 text-white rounded-lg font-medium disabled:bg-gray-300 flex items-center justify-center gap-2\"\n                  style={{ backgroundColor: paymentDetails.customerId && paymentDetails.amount > 0 && !isProcessingPayment ? '#635bff' : undefined }}\n                >\n                  {isProcessingPayment ? (\n                    <>\n                      <svg className=\"animate-spin h-5 w-5 text-white\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\">\n                        <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\"></circle>\n                        <path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"></path>\n                      </svg>\n                      Creating Payment Link...\n                    </>\n                  ) : (\n                    'Generate Stripe Payment Link'\n                  )}\n                </button>\n                <p className=\"text-xs text-gray-500 text-center\">\n                  A real Stripe Checkout link will be created. You can open it or copy it to send to your customer.\n                </p>\n              </div>\n            </div>\n          </div>\n        )}\n\n        {/* Service Completion Modal */}\n        {showCompleteServiceModal && serviceToComplete && (\n          <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\">\n            <div className=\"bg-white rounded-xl p-6 w-full max-w-lg max-h-[90vh] overflow-y-auto\">\n              <div className=\"flex justify-between items-center mb-4\">\n                <h3 className=\"text-xl font-bold text-green-700\"> Complete Service</h3>\n                <button onClick={() => { setShowCompleteServiceModal(false); setServiceToComplete(null); setServiceChemicals([]); setServiceWaterTest({ chlorine: '', ph: '', alkalinity: '', cya: '', hardness: '', phosphates: '', notes: '' }); }} className=\"text-gray-500 hover:text-gray-700\">\n                  <Icons.X />\n                </button>\n              </div>\n              \n              {/* Customer Info */}\n              <div className=\"bg-gray-50 p-4 rounded-lg mb-4\">\n                <div className=\"font-bold text-lg\">{serviceToComplete.name}</div>\n                <div className=\"text-sm text-gray-500\">{serviceToComplete.address}</div>\n                <div className=\"text-sm text-gray-600 mt-1\">\n                  {serviceToComplete.poolType && <span className=\"capitalize\">{serviceToComplete.poolType} Pool</span>}\n                </div>\n              </div>\n\n              {/* Service Cost */}\n              <div className=\"flex justify-between items-center p-3 bg-blue-50 rounded-lg mb-4\">\n                <span className=\"font-medium\">Service Rate:</span>\n                <span className=\"text-xl font-bold text-blue-700\">\n                  ${(serviceToComplete.isOneTimeJob ? serviceToComplete.jobPrice : serviceToComplete.weeklyRate).toFixed(2)}\n                </span>\n              </div>\n\n              {/* Water Test Results */}\n              <div className=\"mb-4\">\n                <h4 className=\"font-bold text-gray-700 mb-2\"> Water Test Results</h4>\n                <div className=\"bg-cyan-50 p-3 rounded-lg\">\n                  <div className=\"grid grid-cols-3 gap-3 mb-3\">\n                    <div>\n                      <label className=\"block text-xs text-gray-600 mb-1\">Chlorine (ppm)</label>\n                      <input\n                        type=\"number\"\n                        step=\"0.1\"\n                        placeholder=\"0-10\"\n                        value={serviceWaterTest.chlorine}\n                        onChange={e => setServiceWaterTest({ ...serviceWaterTest, chlorine: e.target.value })}\n                        className=\"w-full px-2 py-1 border rounded text-center text-sm\"\n                      />\n                    </div>\n                    <div>\n                      <label className=\"block text-xs text-gray-600 mb-1\">pH</label>\n                      <input\n                        type=\"number\"\n                        step=\"0.1\"\n                        placeholder=\"6.8-8.0\"\n                        value={serviceWaterTest.ph}\n                        onChange={e => setServiceWaterTest({ ...serviceWaterTest, ph: e.target.value })}\n                        className=\"w-full px-2 py-1 border rounded text-center text-sm\"\n                      />\n                    </div>\n                    <div>\n                      <label className=\"block text-xs text-gray-600 mb-1\">Alkalinity</label>\n                      <input\n                        type=\"number\"\n                        placeholder=\"80-120\"\n                        value={serviceWaterTest.alkalinity}\n                        onChange={e => setServiceWaterTest({ ...serviceWaterTest, alkalinity: e.target.value })}\n                        className=\"w-full px-2 py-1 border rounded text-center text-sm\"\n                      />\n                    </div>\n                    <div>\n                      <label className=\"block text-xs text-gray-600 mb-1\">CYA</label>\n                      <input\n                        type=\"number\"\n                        placeholder=\"30-50\"\n                        value={serviceWaterTest.cya}\n                        onChange={e => setServiceWaterTest({ ...serviceWaterTest, cya: e.target.value })}\n                        className=\"w-full px-2 py-1 border rounded text-center text-sm\"\n                      />\n                    </div>\n                    <div>\n                      <label className=\"block text-xs text-gray-600 mb-1\">Hardness</label>\n                      <input\n                        type=\"number\"\n                        placeholder=\"200-400\"\n                        value={serviceWaterTest.hardness}\n                        onChange={e => setServiceWaterTest({ ...serviceWaterTest, hardness: e.target.value })}\n                        className=\"w-full px-2 py-1 border rounded text-center text-sm\"\n                      />\n                    </div>\n                    <div>\n                      <label className=\"block text-xs text-gray-600 mb-1\">Phosphates (ppb)</label>\n                      <input\n                        type=\"number\"\n                        placeholder=\"0-500\"\n                        value={serviceWaterTest.phosphates}\n                        onChange={e => setServiceWaterTest({ ...serviceWaterTest, phosphates: e.target.value })}\n                        className=\"w-full px-2 py-1 border rounded text-center text-sm\"\n                      />\n                    </div>\n                  </div>\n                  <div>\n                    <label className=\"block text-xs text-gray-600 mb-1\">Service Notes</label>\n                    <textarea\n                      placeholder=\"Pool condition, issues noticed, work performed...\"\n                      value={serviceWaterTest.notes}\n                      onChange={e => setServiceWaterTest({ ...serviceWaterTest, notes: e.target.value })}\n                      className=\"w-full px-2 py-1 border rounded text-sm\"\n                      rows=\"2\"\n                    />\n                  </div>\n                </div>\n              </div>\n\n              {/* Add Chemicals */}\n              <div className=\"mb-4\">\n                <h4 className=\"font-bold text-gray-700 mb-2\">Add Chemicals Used</h4>\n                {chemicalInventory.length > 0 ? (\n                  <div className=\"space-y-2\">\n                    {chemicalInventory.map(chem => (\n                      <div key={chem.id} className=\"flex items-center gap-3 p-3 bg-gray-50 rounded-lg\">\n                        <div className=\"flex-1\">\n                          <div className=\"font-medium\">{chem.name}</div>\n                          <div className=\"text-xs text-gray-500\">\n                            ${chem.costPerUnit.toFixed(2)}/{chem.unit}  {chem.quantity} {chem.unit} in stock\n                          </div>\n                        </div>\n                        <input\n                          type=\"number\"\n                          min=\"0\"\n                          max={chem.quantity}\n                          step=\"0.1\"\n                          placeholder=\"Qty\"\n                          className=\"w-20 px-2 py-1 border rounded text-center\"\n                          id={`chem-qty-${chem.id}`}\n                        />\n                        <button\n                          onClick={() => {\n                            const input = document.getElementById(`chem-qty-${chem.id}`);\n                            const qty = parseFloat(input.value) || 0;\n                            if (qty > 0 && qty <= chem.quantity) {\n                              addChemicalToService(chem, qty);\n                              input.value = '';\n                            }\n                          }}\n                          className=\"px-3 py-1 bg-teal-600 text-white rounded hover:bg-teal-700 text-sm\"\n                        >\n                          Add\n                        </button>\n                      </div>\n                    ))}\n                  </div>\n                ) : (\n                  <p className=\"text-gray-500 text-sm p-3 bg-gray-50 rounded-lg\">\n                    No chemicals in inventory. Add chemicals in the Chemicals tab.\n                  </p>\n                )}\n              </div>\n\n              {/* Chemicals Added */}\n              {serviceChemicals.length > 0 && (\n                <div className=\"mb-4\">\n                  <h4 className=\"font-bold text-gray-700 mb-2\">Chemicals for This Service</h4>\n                  <div className=\"border rounded-lg overflow-hidden\">\n                    <table className=\"w-full\">\n                      <thead className=\"bg-teal-50\">\n                        <tr>\n                          <th className=\"px-3 py-2 text-left text-sm\">Chemical</th>\n                          <th className=\"px-3 py-2 text-left text-sm\">Qty</th>\n                          <th className=\"px-3 py-2 text-left text-sm\">Cost</th>\n                          <th className=\"px-3 py-2\"></th>\n                        </tr>\n                      </thead>\n                      <tbody>\n                        {serviceChemicals.map(chem => (\n                          <tr key={chem.id} className=\"border-t\">\n                            <td className=\"px-3 py-2 text-sm\">{chem.name}</td>\n                            <td className=\"px-3 py-2 text-sm\">{chem.quantityUsed} {chem.unit}</td>\n                            <td className=\"px-3 py-2 text-sm font-medium\">${(chem.quantityUsed * chem.costPerUnit).toFixed(2)}</td>\n                            <td className=\"px-3 py-2\">\n                              <button \n                                onClick={() => removeChemicalFromService(chem.id)}\n                                className=\"text-red-500 hover:text-red-700\"\n                              >\n                                <Icons.X />\n                              </button>\n                            </td>\n                          </tr>\n                        ))}\n                        <tr className=\"border-t bg-teal-50\">\n                          <td colSpan=\"2\" className=\"px-3 py-2 font-bold text-right\">Chemical Total:</td>\n                          <td colSpan=\"2\" className=\"px-3 py-2 font-bold text-teal-700\">\n                            ${serviceChemicals.reduce((sum, c) => sum + (c.quantityUsed * c.costPerUnit), 0).toFixed(2)}\n                          </td>\n                        </tr>\n                      </tbody>\n                    </table>\n                  </div>\n                </div>\n              )}\n\n              {/* Total */}\n              <div className=\"bg-green-50 p-4 rounded-lg mb-4 border-2 border-green-200\">\n                <div className=\"flex justify-between items-center\">\n                  <div>\n                    <div className=\"text-sm text-gray-600\">Service Rate</div>\n                    <div className=\"text-sm text-gray-600\">Chemicals</div>\n                    <div className=\"font-bold text-lg mt-1\">Total</div>\n                  </div>\n                  <div className=\"text-right\">\n                    <div className=\"text-sm\">${(serviceToComplete.isOneTimeJob ? serviceToComplete.jobPrice : serviceToComplete.weeklyRate).toFixed(2)}</div>\n                    <div className=\"text-sm\">${serviceChemicals.reduce((sum, c) => sum + (c.quantityUsed * c.costPerUnit), 0).toFixed(2)}</div>\n                    <div className=\"font-bold text-xl text-green-700\">\n                      ${((serviceToComplete.isOneTimeJob ? serviceToComplete.jobPrice : serviceToComplete.weeklyRate) + serviceChemicals.reduce((sum, c) => sum + (c.quantityUsed * c.costPerUnit), 0)).toFixed(2)}\n                    </div>\n                  </div>\n                </div>\n              </div>\n\n              {/* Send Email Checkbox */}\n              {serviceToComplete?.email && (\n                <div className=\"mb-4 p-3 bg-green-50 rounded-lg\">\n                  <label className=\"flex items-center gap-3 cursor-pointer\">\n                    <input\n                      type=\"checkbox\"\n                      checked={sendEmailOnComplete}\n                      onChange={e => setSendEmailOnComplete(e.target.checked)}\n                      className=\"w-5 h-5 text-green-600 rounded\"\n                    />\n                    <div>\n                      <span className=\"font-medium text-green-800\"> Send service report email</span>\n                      <div className=\"text-xs text-green-600\">Will send to: {serviceToComplete.email}</div>\n                    </div>\n                  </label>\n                </div>\n              )}\n              {serviceToComplete && !serviceToComplete.email && (\n                <div className=\"mb-4 p-3 bg-amber-50 rounded-lg text-sm text-amber-700\">\n                   No email on file for this customer. Add their email in the Customers tab to enable service reports.\n                </div>\n              )}\n\n              {/* Complete Button */}\n              <div className=\"flex gap-3\">\n                <button\n                  onClick={() => { setShowCompleteServiceModal(false); setServiceToComplete(null); setServiceChemicals([]); setServiceWaterTest({ chlorine: '', ph: '', alkalinity: '', cya: '', hardness: '', phosphates: '', notes: '' }); }}\n                  className=\"flex-1 py-3 border-2 border-gray-300 text-gray-700 rounded-lg font-medium hover:bg-gray-50\"\n                >\n                  Cancel\n                </button>\n                <button\n                  onClick={completeServiceWithChemicals}\n                  disabled={isSendingEmail}\n                  className=\"flex-1 py-3 bg-green-600 text-white rounded-lg font-medium hover:bg-green-700 disabled:bg-green-400\"\n                >\n                  {isSendingEmail ? ' Sending...' : ' Complete Service'}\n                </button>\n              </div>\n            </div>\n          </div>\n        )}\n\n        {/* CHEMICALS TAB */}\n        {activeTab === 'chemicals' && (\n          <div className=\"space-y-6\">\n            {/* Chemical Usage Chart */}\n            <div className=\"bg-white rounded-xl p-6 shadow-lg\">\n              <div className=\"flex justify-between items-center mb-4\">\n                <h2 className=\"text-xl font-bold text-gray-800\">Chemical Usage Tracking</h2>\n                <div className=\"flex bg-gray-100 rounded-lg p-1\">\n                  {['weekly', 'monthly', 'annual'].map(scale => (\n                    <button\n                      key={scale}\n                      onClick={() => setChemicalChartScale(scale)}\n                      className={`px-4 py-2 rounded-lg text-sm font-medium transition-all ${\n                        chemicalChartScale === scale \n                          ? 'bg-teal-600 text-white shadow' \n                          : 'text-gray-600 hover:bg-gray-200'\n                      }`}\n                    >\n                      {scale.charAt(0).toUpperCase() + scale.slice(1)}\n                    </button>\n                  ))}\n                </div>\n              </div>\n              \n              {(() => {\n                const { data, chemicals } = getChemicalUsageData(chemicalChartScale);\n                if (chemicals.length === 0) {\n                  return (\n                    <div className=\"text-center py-12 text-gray-500\">\n                      <div className=\"text-4xl mb-3\"></div>\n                      <p>No chemical usage data yet.</p>\n                      <p className=\"text-sm\">Complete services with chemicals to see usage trends.</p>\n                    </div>\n                  );\n                }\n                return (\n                  <div>\n                    <ResponsiveContainer width=\"100%\" height={300}>\n                      <BarChart data={data}>\n                        <CartesianGrid strokeDasharray=\"3 3\" stroke=\"#e5e7eb\" />\n                        <XAxis dataKey=\"period\" stroke=\"#6b7280\" fontSize={12} />\n                        <YAxis stroke=\"#6b7280\" fontSize={12} />\n                        <Tooltip \n                          content={({ active, payload, label }) => {\n                            if (active && payload && payload.length) {\n                              return (\n                                <div className=\"bg-white p-3 rounded-lg shadow-lg border\">\n                                  <p className=\"font-bold text-gray-800 mb-2\">{payload[0]?.payload?.fullPeriod || label}</p>\n                                  {payload.map((entry, idx) => (\n                                    <p key={idx} style={{ color: entry.color }} className=\"text-sm\">\n                                      {entry.name}: {entry.value.toFixed(1)} {serviceHistory.find(s => s.chemicalsUsed?.find(c => c.name === entry.name))?.chemicalsUsed?.find(c => c.name === entry.name)?.unit || 'units'}\n                                    </p>\n                                  ))}\n                                </div>\n                              );\n                            }\n                            return null;\n                          }}\n                        />\n                        {chemicals.map((chem, idx) => (\n                          <Bar \n                            key={chem} \n                            dataKey={chem} \n                            fill={chemicalColors[idx % chemicalColors.length]} \n                            name={chem}\n                            radius={[4, 4, 0, 0]}\n                          />\n                        ))}\n                      </BarChart>\n                    </ResponsiveContainer>\n                    \n                    {/* Legend */}\n                    <div className=\"flex flex-wrap gap-4 justify-center mt-4\">\n                      {chemicals.map((chem, idx) => (\n                        <div key={chem} className=\"flex items-center gap-2\">\n                          <div \n                            className=\"w-4 h-4 rounded\" \n                            style={{ backgroundColor: chemicalColors[idx % chemicalColors.length] }}\n                          />\n                          <span className=\"text-sm text-gray-700\">{chem}</span>\n                        </div>\n                      ))}\n                    </div>\n                  </div>\n                );\n              })()}\n            </div>\n\n            {/* Chemical Usage Summary */}\n            {getChemicalUsageSummary().length > 0 && (\n              <div className=\"bg-white rounded-xl p-6 shadow-lg\">\n                <h3 className=\"text-lg font-bold text-gray-800 mb-4\">Monthly Usage Summary</h3>\n                <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n                  {getChemicalUsageSummary().map(chem => {\n                    const trend = chem.lastMonth > 0 \n                      ? ((chem.thisMonth - chem.lastMonth) / chem.lastMonth * 100).toFixed(0)\n                      : chem.thisMonth > 0 ? '+100' : '0';\n                    const trendUp = parseFloat(trend) > 0;\n                    const trendDown = parseFloat(trend) < 0;\n                    return (\n                      <div key={chem.name} className=\"bg-gray-50 p-4 rounded-lg\">\n                        <div className=\"font-bold text-gray-800 mb-2\">{chem.name}</div>\n                        <div className=\"grid grid-cols-2 gap-2 text-sm\">\n                          <div>\n                            <div className=\"text-gray-500\">This Month</div>\n                            <div className=\"text-lg font-bold text-teal-600\">{chem.thisMonth.toFixed(1)} {chem.unit}</div>\n                          </div>\n                          <div>\n                            <div className=\"text-gray-500\">Last Month</div>\n                            <div className=\"text-lg font-bold text-gray-600\">{chem.lastMonth.toFixed(1)} {chem.unit}</div>\n                          </div>\n                        </div>\n                        <div className={`mt-2 text-sm font-medium ${trendUp ? 'text-amber-600' : trendDown ? 'text-green-600' : 'text-gray-500'}`}>\n                          {trendUp ? '' : trendDown ? '' : ''} {Math.abs(parseFloat(trend))}% vs last month\n                        </div>\n                        <div className=\"text-xs text-gray-400 mt-1\">All-time: {chem.total.toFixed(1)} {chem.unit}</div>\n                      </div>\n                    );\n                  })}\n                </div>\n              </div>\n            )}\n\n            {/* Inventory Section */}\n            <div className=\"flex justify-between items-center\">\n              <h2 className=\"text-xl font-bold text-gray-800\">Chemical Inventory</h2>\n              <button\n                onClick={() => setShowAddChemical(true)}\n                className=\"flex items-center gap-2 px-4 py-2 bg-teal-600 text-white rounded-lg hover:bg-teal-700 transition-all\"\n              >\n                <Icons.Plus />\n                Add Chemical\n              </button>\n            </div>\n\n            {showAddChemical && (\n              <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\">\n                <div className=\"bg-white rounded-xl p-6 w-full max-w-md\">\n                  <div className=\"flex justify-between items-center mb-4\">\n                    <h3 className=\"text-xl font-bold\">Add Chemical</h3>\n                    <button onClick={() => setShowAddChemical(false)} className=\"text-gray-500 hover:text-gray-700\">\n                      <Icons.X />\n                    </button>\n                  </div>\n                  <div className=\"space-y-4\">\n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700 mb-1\">Chemical Name</label>\n                      <input\n                        type=\"text\"\n                        value={newChemical.name}\n                        onChange={e => setNewChemical({ ...newChemical, name: e.target.value })}\n                        className=\"w-full px-4 py-2 border rounded-lg\"\n                        placeholder=\"Chlorine tablets\"\n                      />\n                    </div>\n                    <div className=\"grid grid-cols-3 gap-4\">\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 mb-1\">Quantity</label>\n                        <input\n                          type=\"number\"\n                          value={newChemical.quantity}\n                          onChange={e => setNewChemical({ ...newChemical, quantity: parseFloat(e.target.value) || 0 })}\n                          className=\"w-full px-4 py-2 border rounded-lg\"\n                        />\n                      </div>\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 mb-1\">Unit</label>\n                        <select\n                          value={newChemical.unit}\n                          onChange={e => setNewChemical({ ...newChemical, unit: e.target.value })}\n                          className=\"w-full px-4 py-2 border rounded-lg\"\n                        >\n                          <option value=\"lbs\">lbs</option>\n                          <option value=\"gal\">gallons</option>\n                          <option value=\"oz\">oz</option>\n                          <option value=\"tablets\">tablets</option>\n                        </select>\n                      </div>\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 mb-1\">$/Unit</label>\n                        <input\n                          type=\"number\"\n                          step=\"0.01\"\n                          value={newChemical.costPerUnit}\n                          onChange={e => setNewChemical({ ...newChemical, costPerUnit: parseFloat(e.target.value) || 0 })}\n                          className=\"w-full px-4 py-2 border rounded-lg\"\n                        />\n                      </div>\n                    </div>\n                    <button\n                      onClick={addChemical}\n                      className=\"w-full py-3 bg-teal-600 text-white rounded-lg font-medium hover:bg-teal-700\"\n                    >\n                      Add Chemical\n                    </button>\n                  </div>\n                </div>\n              </div>\n            )}\n\n            {chemicalInventory.length > 0 ? (\n              <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n                {chemicalInventory.map(chem => (\n                  <div key={chem.id} className=\"bg-white rounded-xl p-5 shadow-lg\">\n                    <div className=\"flex justify-between items-start mb-2\">\n                      <h3 className=\"font-bold text-gray-800\">{chem.name}</h3>\n                      <div className=\"flex gap-1\">\n                        <button\n                          onClick={() => setEditingChemical({ ...chem })}\n                          className=\"text-blue-500 hover:text-blue-700 p-1\"\n                        >\n                          <Icons.Edit />\n                        </button>\n                        <button\n                          onClick={() => deleteChemical(chem.id)}\n                          className=\"text-red-500 hover:text-red-700 p-1\"\n                        >\n                          <Icons.Trash />\n                        </button>\n                      </div>\n                    </div>\n                    <div className={`text-2xl font-black mb-1 ${chem.quantity <= 5 ? 'text-red-600' : chem.quantity <= 10 ? 'text-amber-600' : 'text-teal-600'}`}>\n                      {chem.quantity} {chem.unit}\n                      {chem.quantity <= 5 && <span className=\"text-sm ml-2\"> Low!</span>}\n                    </div>\n                    <div className=\"text-sm text-gray-500\">\n                      ${chem.costPerUnit.toFixed(2)}/{chem.unit}  Value: ${(chem.quantity * chem.costPerUnit).toFixed(2)}\n                    </div>\n                  </div>\n                ))}\n              </div>\n            ) : (\n              <div className=\"bg-white rounded-xl p-12 shadow-lg text-center\">\n                <div className=\"text-6xl mb-4\"></div>\n                <h3 className=\"text-xl font-bold text-gray-800 mb-2\">No chemicals tracked</h3>\n                <p className=\"text-gray-500\">Track your chemical inventory and costs.</p>\n              </div>\n            )}\n\n            {/* Edit Chemical Modal */}\n            {editingChemical && (\n              <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\">\n                <div className=\"bg-white rounded-xl p-6 w-full max-w-md\">\n                  <div className=\"flex justify-between items-center mb-4\">\n                    <h3 className=\"text-xl font-bold\">Edit Chemical</h3>\n                    <button onClick={() => setEditingChemical(null)} className=\"text-gray-500 hover:text-gray-700\">\n                      <Icons.X />\n                    </button>\n                  </div>\n                  <div className=\"space-y-4\">\n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700 mb-1\">Chemical Name</label>\n                      <input\n                        type=\"text\"\n                        value={editingChemical.name}\n                        onChange={e => setEditingChemical({ ...editingChemical, name: e.target.value })}\n                        className=\"w-full px-4 py-2 border rounded-lg\"\n                      />\n                    </div>\n                    <div className=\"grid grid-cols-3 gap-4\">\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 mb-1\">Quantity</label>\n                        <input\n                          type=\"number\"\n                          step=\"0.1\"\n                          value={editingChemical.quantity}\n                          onChange={e => setEditingChemical({ ...editingChemical, quantity: parseFloat(e.target.value) || 0 })}\n                          className=\"w-full px-4 py-2 border rounded-lg\"\n                        />\n                      </div>\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 mb-1\">Unit</label>\n                        <select\n                          value={editingChemical.unit}\n                          onChange={e => setEditingChemical({ ...editingChemical, unit: e.target.value })}\n                          className=\"w-full px-4 py-2 border rounded-lg\"\n                        >\n                          <option value=\"lbs\">lbs</option>\n                          <option value=\"gal\">gallons</option>\n                          <option value=\"oz\">oz</option>\n                          <option value=\"tablets\">tablets</option>\n                        </select>\n                      </div>\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 mb-1\">$/Unit</label>\n                        <input\n                          type=\"number\"\n                          step=\"0.01\"\n                          value={editingChemical.costPerUnit}\n                          onChange={e => setEditingChemical({ ...editingChemical, costPerUnit: parseFloat(e.target.value) || 0 })}\n                          className=\"w-full px-4 py-2 border rounded-lg\"\n                        />\n                      </div>\n                    </div>\n                    <div className=\"bg-teal-50 p-3 rounded-lg\">\n                      <div className=\"text-sm text-gray-600\">Inventory Value:</div>\n                      <div className=\"text-xl font-bold text-teal-700\">\n                        ${(editingChemical.quantity * editingChemical.costPerUnit).toFixed(2)}\n                      </div>\n                    </div>\n                    <div className=\"flex gap-3\">\n                      <button\n                        onClick={() => setEditingChemical(null)}\n                        className=\"flex-1 py-3 border-2 border-gray-300 text-gray-700 rounded-lg font-medium hover:bg-gray-50\"\n                      >\n                        Cancel\n                      </button>\n                      <button\n                        onClick={updateChemical}\n                        className=\"flex-1 py-3 bg-teal-600 text-white rounded-lg font-medium hover:bg-teal-700\"\n                      >\n                        Save Changes\n                      </button>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            )}\n          </div>\n        )}\n\n        {/* BILLING TAB */}\n        {activeTab === 'billing' && (\n          <div className=\"space-y-6\">\n            {/* Custom Invoice Section */}\n            <div className=\"bg-white rounded-xl p-6 shadow-lg\">\n              <div className=\"flex justify-between items-center mb-4\">\n                <h2 className=\"text-xl font-bold text-gray-800\">Custom / Ad-Hoc Invoice</h2>\n                <button\n                  onClick={() => setShowCustomInvoice(true)}\n                  className=\"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700\"\n                >\n                  <Icons.Plus />\n                  Create Custom Invoice\n                </button>\n              </div>\n              <p className=\"text-gray-600\">Create one-off invoices for repairs, equipment, or special services not included in monthly billing.</p>\n            </div>\n\n            {/* Custom Invoice Modal */}\n            {showCustomInvoice && (\n              <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\">\n                <div className=\"bg-white rounded-xl p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto\">\n                  <div className=\"flex justify-between items-center mb-4\">\n                    <h3 className=\"text-xl font-bold\">Create Service Invoice</h3>\n                    <button onClick={() => setShowCustomInvoice(false)} className=\"text-gray-500 hover:text-gray-700\">\n                      <Icons.X />\n                    </button>\n                  </div>\n\n                  <div className=\"space-y-4\">\n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700 mb-1\">Customer</label>\n                      <CustomerSelect\n                        value={customInvoice.customerId}\n                        onChange={val => setCustomInvoice({ ...customInvoice, customerId: val })}\n                        placeholder=\"Search customer...\"\n                      />\n                    </div>\n\n                    {/* Add Line Item */}\n                    <div className=\"bg-gray-50 p-4 rounded-lg\">\n                      <h4 className=\"font-medium mb-3\">Add Parts & Labor</h4>\n                      <div className=\"space-y-3\">\n                        <div className=\"grid grid-cols-2 md:grid-cols-4 gap-3\">\n                          <select\n                            value={newLineItem.type}\n                            onChange={e => setNewLineItem({ ...newLineItem, type: e.target.value })}\n                            className=\"px-3 py-2 border rounded-lg\"\n                          >\n                            <option value=\"labor\">Labor</option>\n                            <option value=\"part\">Part/Equipment</option>\n                            <option value=\"chemical\">Chemical</option>\n                            <option value=\"other\">Other</option>\n                          </select>\n                          <input\n                            type=\"number\"\n                            placeholder=\"Qty\"\n                            value={newLineItem.quantity}\n                            onChange={e => setNewLineItem({ ...newLineItem, quantity: parseInt(e.target.value) || 1 })}\n                            className=\"px-3 py-2 border rounded-lg\"\n                          />\n                          <input\n                            type=\"number\"\n                            placeholder=\"Price ($)\"\n                            value={newLineItem.price || ''}\n                            onChange={e => setNewLineItem({ ...newLineItem, price: parseFloat(e.target.value) || 0 })}\n                            className=\"px-3 py-2 border rounded-lg\"\n                          />\n                          <input\n                            type=\"text\"\n                            placeholder=\"Model/Part # (optional)\"\n                            value={newLineItem.modelNumber}\n                            onChange={e => setNewLineItem({ ...newLineItem, modelNumber: e.target.value })}\n                            className=\"px-3 py-2 border rounded-lg\"\n                          />\n                        </div>\n                        <input\n                          type=\"text\"\n                          placeholder=\"Description (e.g., 'Replaced pool pump motor - Pentair WhisperFlo 1.5HP')\"\n                          value={newLineItem.description}\n                          onChange={e => setNewLineItem({ ...newLineItem, description: e.target.value })}\n                          className=\"w-full px-3 py-2 border rounded-lg\"\n                        />\n                        <button\n                          onClick={() => addLineItem(customInvoice, setCustomInvoice)}\n                          className=\"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700\"\n                        >\n                          Add Item\n                        </button>\n                      </div>\n                    </div>\n\n                    {/* Line Items List */}\n                    {customInvoice.items.length > 0 && (\n                      <div className=\"border rounded-lg overflow-hidden\">\n                        <table className=\"w-full\">\n                          <thead className=\"bg-gray-50\">\n                            <tr>\n                              <th className=\"px-4 py-2 text-left text-sm font-medium\">Description</th>\n                              <th className=\"px-4 py-2 text-left text-sm font-medium\">Qty</th>\n                              <th className=\"px-4 py-2 text-left text-sm font-medium\">Price</th>\n                              <th className=\"px-4 py-2 text-left text-sm font-medium\">Total</th>\n                              <th className=\"px-4 py-2\"></th>\n                            </tr>\n                          </thead>\n                          <tbody>\n                            {customInvoice.items.map(item => (\n                              <tr key={item.id} className=\"border-t\">\n                                <td className=\"px-4 py-2\">\n                                  <span className={`text-xs px-2 py-0.5 rounded mr-2 ${\n                                    item.type === 'labor' ? 'bg-blue-200 text-blue-800' :\n                                    item.type === 'part' ? 'bg-orange-200 text-orange-800' :\n                                    item.type === 'chemical' ? 'bg-green-200 text-green-800' :\n                                    'bg-gray-200 text-gray-800'\n                                  }`}>{item.type.toUpperCase()}</span>\n                                  {item.description}\n                                  {item.modelNumber && <div className=\"text-xs text-gray-500 mt-1\">Model/Part #: {item.modelNumber}</div>}\n                                </td>\n                                <td className=\"px-4 py-2\">{item.quantity}</td>\n                                <td className=\"px-4 py-2\">${item.price.toFixed(2)}</td>\n                                <td className=\"px-4 py-2 font-medium\">${(item.quantity * item.price).toFixed(2)}</td>\n                                <td className=\"px-4 py-2\">\n                                  <button\n                                    onClick={() => removeLineItem(customInvoice, setCustomInvoice, item.id)}\n                                    className=\"text-red-500 hover:text-red-700\"\n                                  >\n                                    <Icons.X />\n                                  </button>\n                                </td>\n                              </tr>\n                            ))}\n                            <tr className=\"border-t bg-green-50\">\n                              <td colSpan=\"3\" className=\"px-4 py-3 font-bold text-right\">Invoice Total:</td>\n                              <td colSpan=\"2\" className=\"px-4 py-3 font-bold text-green-700 text-xl\">\n                                ${customInvoice.items.reduce((sum, i) => sum + (i.quantity * i.price), 0).toFixed(2)}\n                              </td>\n                            </tr>\n                          </tbody>\n                        </table>\n                      </div>\n                    )}\n\n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700 mb-1\">Notes for Customer</label>\n                      <textarea\n                        value={customInvoice.notes}\n                        onChange={e => setCustomInvoice({ ...customInvoice, notes: e.target.value })}\n                        className=\"w-full px-4 py-2 border rounded-lg\"\n                        rows=\"2\"\n                        placeholder=\"Any additional notes (warranty info, maintenance tips, etc.)\"\n                      />\n                    </div>\n\n                    <button\n                      onClick={generateCustomInvoice}\n                      disabled={!customInvoice.customerId || customInvoice.items.length === 0}\n                      className=\"w-full py-3 bg-green-600 text-white rounded-lg font-medium hover:bg-green-700 disabled:bg-gray-300\"\n                    >\n                      Generate & Email Invoice\n                    </button>\n                  </div>\n                </div>\n              </div>\n            )}\n\n            {/* Monthly Invoices Section */}\n            <div className=\"bg-white rounded-xl p-6 shadow-lg\">\n              <div className=\"flex justify-between items-center mb-4 flex-wrap gap-3\">\n                <h2 className=\"text-xl font-bold text-gray-800\">Monthly Service Invoices</h2>\n                <div className=\"flex gap-3 items-center flex-wrap\">\n                  {/* Search */}\n                  <div>\n                    <label className=\"text-xs text-gray-500 block\">Search Customer</label>\n                    <input\n                      type=\"text\"\n                      placeholder=\" Customer name...\"\n                      value={billingSearch}\n                      onChange={e => setBillingSearch(e.target.value)}\n                      className=\"px-3 py-2 border rounded-lg text-sm w-40\"\n                    />\n                  </div>\n                  <div>\n                    <label className=\"text-xs text-gray-500 block\">Payment Terms</label>\n                    <select\n                      value={defaultPaymentTerms}\n                      onChange={e => setDefaultPaymentTerms(e.target.value)}\n                      className=\"px-3 py-2 border rounded-lg text-sm\"\n                    >\n                      <option value=\"due_receipt\">Due on Receipt</option>\n                      <option value=\"net7\">Net 7</option>\n                      <option value=\"net15\">Net 15</option>\n                      <option value=\"net30\">Net 30</option>\n                      <option value=\"net45\">Net 45</option>\n                      <option value=\"net60\">Net 60</option>\n                    </select>\n                  </div>\n                  <div>\n                    <label className=\"text-xs text-gray-500 block\">Year</label>\n                    <select\n                      value={invoiceMonth.split('-')[0]}\n                      onChange={e => setInvoiceMonth(`${e.target.value}-${invoiceMonth.split('-')[1]}`)}\n                      className=\"px-3 py-2 border rounded-lg text-sm\"\n                    >\n                      {[...Array(5)].map((_, i) => {\n                        const year = new Date().getFullYear() - 2 + i;\n                        return <option key={year} value={year}>{year}</option>;\n                      })}\n                    </select>\n                  </div>\n                  <div>\n                    <label className=\"text-xs text-gray-500 block\">Month</label>\n                    <select\n                      value={invoiceMonth.split('-')[1]}\n                      onChange={e => setInvoiceMonth(`${invoiceMonth.split('-')[0]}-${e.target.value}`)}\n                      className=\"px-3 py-2 border rounded-lg text-sm\"\n                    >\n                      <option value=\"01\">January</option>\n                      <option value=\"02\">February</option>\n                      <option value=\"03\">March</option>\n                      <option value=\"04\">April</option>\n                      <option value=\"05\">May</option>\n                      <option value=\"06\">June</option>\n                      <option value=\"07\">July</option>\n                      <option value=\"08\">August</option>\n                      <option value=\"09\">September</option>\n                      <option value=\"10\">October</option>\n                      <option value=\"11\">November</option>\n                      <option value=\"12\">December</option>\n                    </select>\n                  </div>\n                </div>\n              </div>\n\n              <table className=\"w-full\">\n                <thead className=\"bg-gray-50\">\n                  <tr>\n                    <th className=\"px-4 py-3 text-left text-sm font-medium text-gray-500\">Customer</th>\n                    <th className=\"px-4 py-3 text-left text-sm font-medium text-gray-500\">Services</th>\n                    <th className=\"px-4 py-3 text-left text-sm font-medium text-gray-500\">Service $</th>\n                    <th className=\"px-4 py-3 text-left text-sm font-medium text-gray-500\">Chemicals $</th>\n                    <th className=\"px-4 py-3 text-left text-sm font-medium text-gray-500\">Total</th>\n                    <th className=\"px-4 py-3 text-right text-sm font-medium text-gray-500\">Actions</th>\n                  </tr>\n                </thead>\n                <tbody className=\"divide-y divide-gray-200\">\n                  {customers\n                    .filter(customer => !billingSearch || customer.name.toLowerCase().includes(billingSearch.toLowerCase()))\n                    .map(customer => {\n                    const services = getMonthServices(customer.id, invoiceMonth);\n                    const serviceTotal = services.reduce((sum, s) => sum + s.weeklyRate, 0);\n                    const chemicalTotal = services.reduce((sum, s) => sum + (s.chemicalCost || 0), 0);\n                    const total = services.reduce((sum, s) => sum + s.totalAmount, 0);\n                    const invoiceKey = `${customer.id}-${invoiceMonth}`;\n                    const isPaid = paidInvoices[invoiceKey]?.paid;\n                    const isBilled = billedCustomers[invoiceKey];\n                    const billedInfo = billedCustomers[invoiceKey];\n                    const paymentInfo = paidInvoices[invoiceKey];\n                    \n                    // Check if overdue (billed more than 30 days ago and not paid)\n                    let isOverdue = false;\n                    let daysPastDue = 0;\n                    if (isBilled && !isPaid && billedInfo?.billedDate) {\n                      const billedDate = new Date(billedInfo.billedDate);\n                      const termsDays = billedInfo.terms === 'due_receipt' ? 0 : billedInfo.terms === 'net15' ? 15 : 30;\n                      const dueDate = new Date(billedDate);\n                      dueDate.setDate(dueDate.getDate() + termsDays);\n                      const today = new Date();\n                      if (today > dueDate) {\n                        isOverdue = true;\n                        daysPastDue = Math.floor((today - dueDate) / (1000 * 60 * 60 * 24));\n                      }\n                    }\n                    \n                    // Determine row color based on status\n                    let rowClass = 'hover:bg-gray-50';\n                    if (isPaid) {\n                      rowClass = 'bg-blue-50 hover:bg-blue-100';\n                    } else if (isOverdue) {\n                      rowClass = 'bg-red-50 hover:bg-red-100';\n                    } else if (isBilled) {\n                      rowClass = 'bg-green-50 hover:bg-green-100';\n                    }\n                    \n                    return (\n                      <tr key={customer.id} className={rowClass}>\n                        <td className=\"px-4 py-4\">\n                          <div className=\"flex items-center gap-2 flex-wrap\">\n                            <div className=\"font-medium text-gray-800\">{customer.name}</div>\n                            {isPaid && (\n                              <span className=\"text-xs bg-blue-500 text-white px-2 py-0.5 rounded\">\n                                 Paid {paymentInfo?.method === 'check' ? `(Check #${paymentInfo.checkNumber})` : \n                                        paymentInfo?.method === 'cash' ? '(Cash)' : \n                                        paymentInfo?.method === 'electronic' ? `(${paymentInfo.source || 'Card'})` : ''}\n                              </span>\n                            )}\n                            {isOverdue && (\n                              <span className=\"text-xs bg-red-500 text-white px-2 py-0.5 rounded\">\n                                 Overdue ({daysPastDue} days)\n                              </span>\n                            )}\n                            {!isPaid && !isOverdue && isBilled && <span className=\"text-xs bg-green-500 text-white px-2 py-0.5 rounded\"> Billed</span>}\n                          </div>\n                          <div className=\"text-sm text-gray-500\">{customer.address}</div>\n                        </td>\n                        <td className=\"px-4 py-4 text-gray-600\">{services.length}</td>\n                        <td className=\"px-4 py-4 text-gray-600\">${serviceTotal.toFixed(2)}</td>\n                        <td className=\"px-4 py-4 text-teal-600\">${chemicalTotal.toFixed(2)}</td>\n                        <td className=\"px-4 py-4 font-bold text-green-600\">${total.toFixed(2)}</td>\n                        <td className=\"px-4 py-4 text-right\">\n                          <div className=\"flex gap-1 justify-end flex-wrap\">\n                            <button\n                              onClick={() => openCustomerBillingDetail(customer)}\n                              disabled={services.length === 0}\n                              className=\"px-2 py-1 bg-gray-100 text-gray-700 rounded hover:bg-gray-200 disabled:opacity-50 text-xs\"\n                            >\n                              View\n                            </button>\n                            <button\n                              onClick={() => {\n                                setInvoiceTermsAction({ type: 'pdf', customer, services, serviceTotal, chemicalTotal, total });\n                                setShowInvoiceTermsModal(true);\n                              }}\n                              disabled={services.length === 0}\n                              className=\"px-2 py-1 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:bg-gray-300 text-xs\"\n                            >\n                              PDF\n                            </button>\n                            <button\n                              onClick={() => {\n                                setInvoiceTermsAction({ type: 'email', customer, services, serviceTotal, chemicalTotal, total });\n                                setShowInvoiceTermsModal(true);\n                              }}\n                              disabled={services.length === 0 || !customer.email || isSendingEmail}\n                              className=\"px-2 py-1 bg-green-600 text-white rounded hover:bg-green-700 disabled:bg-gray-300 text-xs\"\n                              title={!customer.email ? 'Customer has no email' : 'Send invoice with payment link'}\n                            >\n                              {isSendingEmail ? '' : ''} Email\n                            </button>\n                            {isOverdue && customer.email && (\n                              <button\n                                onClick={() => {\n                                  setInvoiceTermsAction({ type: 'reminder', customer, services, serviceTotal, chemicalTotal, total, daysPastDue });\n                                  setShowInvoiceTermsModal(true);\n                                }}\n                                disabled={isSendingEmail}\n                                className=\"px-2 py-1 bg-red-600 text-white rounded hover:bg-red-700 text-xs\"\n                              >\n                                 Reminder\n                              </button>\n                            )}\n                            {!isPaid && services.length > 0 && total > 0 && (\n                              <button\n                                onClick={() => {\n                                  setPaymentToMark({ invoiceKey, customerId: customer.id, customerName: customer.name, amount: total });\n                                  setPaymentMethod({ method: 'electronic', checkNumber: '', source: '' });\n                                  setShowPaymentMethodModal(true);\n                                }}\n                                className=\"px-2 py-1 bg-purple-600 text-white rounded hover:bg-purple-700 text-xs\"\n                              >\n                                Mark Paid\n                              </button>\n                            )}\n                          </div>\n                        </td>\n                      </tr>\n                    );\n                  })}\n                </tbody>\n              </table>\n              {customers.length === 0 && (\n                <div className=\"p-12 text-center text-gray-500\">No customers to invoice</div>\n              )}\n            </div>\n\n            {/* Customer Billing Detail Modal */}\n            {selectedCustomerBilling && (\n              <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\">\n                <div className=\"bg-white rounded-xl p-6 w-full max-w-4xl max-h-[90vh] overflow-y-auto\">\n                  <div className=\"flex justify-between items-center mb-4\">\n                    <div>\n                      <h3 className=\"text-xl font-bold text-gray-800\">{selectedCustomerBilling.customer.name}</h3>\n                      <p className=\"text-sm text-gray-500\">\n                        Billing Detail - {new Date(invoiceMonth + '-01').toLocaleDateString('en-US', { month: 'long', year: 'numeric' })}\n                      </p>\n                    </div>\n                    <button onClick={() => setSelectedCustomerBilling(null)} className=\"text-gray-500 hover:text-gray-700\">\n                      <Icons.X />\n                    </button>\n                  </div>\n\n                  {/* Services List with Edit */}\n                  <div className=\"mb-6\">\n                    <h4 className=\"font-bold text-gray-700 mb-3\">Services This Month</h4>\n                    {selectedCustomerBilling.services.length > 0 ? (\n                      <div className=\"space-y-3\">\n                        {selectedCustomerBilling.services.map(service => (\n                          <div key={service.id} className=\"border rounded-lg p-4\">\n                            <div className=\"flex justify-between items-start mb-2\">\n                              <div>\n                                <div className=\"font-medium\">{new Date(service.date).toLocaleDateString()}</div>\n                                <div className=\"text-sm text-gray-500\">{service.poolType}</div>\n                              </div>\n                              <div className=\"text-right\">\n                                <div className=\"font-bold text-green-600\">${service.totalAmount.toFixed(2)}</div>\n                                <button\n                                  onClick={() => openEditServiceModal(service)}\n                                  className=\"text-xs text-blue-600 hover:text-blue-800\"\n                                >\n                                  Edit\n                                </button>\n                              </div>\n                            </div>\n                            <div className=\"grid grid-cols-2 gap-4 text-sm\">\n                              <div>\n                                <span className=\"text-gray-500\">Service Rate:</span> ${service.weeklyRate.toFixed(2)}\n                              </div>\n                              <div>\n                                <span className=\"text-gray-500\">Chemicals:</span> ${(service.chemicalCost || 0).toFixed(2)}\n                              </div>\n                            </div>\n                            {service.chemicalsUsed && service.chemicalsUsed.length > 0 && (\n                              <div className=\"mt-2 pt-2 border-t\">\n                                <div className=\"text-xs text-gray-500 mb-1\">Chemicals Used:</div>\n                                <div className=\"flex flex-wrap gap-1\">\n                                  {service.chemicalsUsed.map((chem, idx) => (\n                                    <span key={idx} className=\"text-xs bg-teal-50 text-teal-700 px-2 py-0.5 rounded\">\n                                      {chem.name}: {chem.quantity} {chem.unit} (${chem.totalCost.toFixed(2)})\n                                    </span>\n                                  ))}\n                                </div>\n                              </div>\n                            )}\n                          </div>\n                        ))}\n                      </div>\n                    ) : (\n                      <p className=\"text-gray-500 text-center py-4\">No services this month</p>\n                    )}\n                  </div>\n\n                  {/* Manual Adjustments */}\n                  <div className=\"mb-6 bg-amber-50 p-4 rounded-lg\">\n                    <h4 className=\"font-bold text-gray-700 mb-3\">Manual Adjustments</h4>\n                    <div className=\"flex gap-2 mb-3\">\n                      <input\n                        type=\"text\"\n                        placeholder=\"Description (e.g., Discount, Extra charge)\"\n                        className=\"flex-1 px-3 py-2 border rounded-lg text-sm\"\n                        id=\"adjustmentDesc\"\n                      />\n                      <input\n                        type=\"number\"\n                        placeholder=\"Amount\"\n                        className=\"w-24 px-3 py-2 border rounded-lg text-sm\"\n                        id=\"adjustmentAmount\"\n                      />\n                      <button\n                        onClick={() => {\n                          const desc = document.getElementById('adjustmentDesc').value;\n                          const amount = parseFloat(document.getElementById('adjustmentAmount').value) || 0;\n                          if (desc && amount !== 0) {\n                            addBillingAdjustment(desc, amount);\n                            document.getElementById('adjustmentDesc').value = '';\n                            document.getElementById('adjustmentAmount').value = '';\n                          }\n                        }}\n                        className=\"px-4 py-2 bg-amber-600 text-white rounded-lg hover:bg-amber-700 text-sm\"\n                      >\n                        Add\n                      </button>\n                    </div>\n                    <p className=\"text-xs text-gray-500 mb-2\">Use negative amounts for discounts, positive for extra charges</p>\n                    {billingAdjustments.length > 0 && (\n                      <div className=\"space-y-2\">\n                        {billingAdjustments.map(adj => (\n                          <div key={adj.id} className=\"flex justify-between items-center bg-white p-2 rounded\">\n                            <span className=\"text-sm\">{adj.description}</span>\n                            <div className=\"flex items-center gap-2\">\n                              <span className={`font-medium ${adj.amount < 0 ? 'text-red-600' : 'text-green-600'}`}>\n                                {adj.amount < 0 ? '-' : '+'}${Math.abs(adj.amount).toFixed(2)}\n                              </span>\n                              <button onClick={() => removeBillingAdjustment(adj.id)} className=\"text-red-500 hover:text-red-700\">\n                                <Icons.X />\n                              </button>\n                            </div>\n                          </div>\n                        ))}\n                      </div>\n                    )}\n                  </div>\n\n                  {/* Invoice Summary */}\n                  <div className=\"bg-gray-50 p-4 rounded-lg mb-4\">\n                    <h4 className=\"font-bold text-gray-700 mb-3\">Invoice Summary</h4>\n                    <div className=\"space-y-2\">\n                      <div className=\"flex justify-between\">\n                        <span>Service Charges ({selectedCustomerBilling.services.length} services)</span>\n                        <span>${selectedCustomerBilling.services.reduce((sum, s) => sum + s.weeklyRate, 0).toFixed(2)}</span>\n                      </div>\n                      <div className=\"flex justify-between\">\n                        <span>Chemical Charges</span>\n                        <span className=\"text-teal-600\">${selectedCustomerBilling.services.reduce((sum, s) => sum + (s.chemicalCost || 0), 0).toFixed(2)}</span>\n                      </div>\n                      {billingAdjustments.map(adj => (\n                        <div key={adj.id} className=\"flex justify-between text-amber-700\">\n                          <span>{adj.description}</span>\n                          <span>{adj.amount < 0 ? '-' : '+'}${Math.abs(adj.amount).toFixed(2)}</span>\n                        </div>\n                      ))}\n                      <div className=\"flex justify-between pt-2 border-t-2 border-gray-300 font-bold text-lg\">\n                        <span>Total Due</span>\n                        <span className=\"text-green-600\">\n                          ${(selectedCustomerBilling.services.reduce((sum, s) => sum + s.totalAmount, 0) + billingAdjustments.reduce((sum, a) => sum + a.amount, 0)).toFixed(2)}\n                        </span>\n                      </div>\n                    </div>\n                  </div>\n\n                  {/* Actions */}\n                  <div className=\"flex gap-3\">\n                    <button\n                      onClick={() => setSelectedCustomerBilling(null)}\n                      className=\"flex-1 py-3 border-2 border-gray-300 text-gray-700 rounded-lg font-medium hover:bg-gray-50\"\n                    >\n                      Close\n                    </button>\n                    <button\n                      onClick={() => {\n                        downloadInvoice(selectedCustomerBilling.customer, invoiceMonth);\n                        setSelectedCustomerBilling(null);\n                      }}\n                      className=\"flex-1 py-3 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700\"\n                    >\n                      Download Invoice\n                    </button>\n                    <button\n                      onClick={() => {\n                        const total = selectedCustomerBilling.services.reduce((sum, s) => sum + s.totalAmount, 0) + billingAdjustments.reduce((sum, a) => sum + a.amount, 0);\n                        openPaymentRequest(selectedCustomerBilling.customer.id, total, `Monthly service - ${new Date(invoiceMonth + '-01').toLocaleDateString('en-US', { month: 'long', year: 'numeric' })}`);\n                        setSelectedCustomerBilling(null);\n                      }}\n                      className=\"flex-1 py-3 text-white rounded-lg font-medium\"\n                      style={{ backgroundColor: '#635bff' }}\n                    >\n                       Request Payment\n                    </button>\n                  </div>\n                </div>\n              </div>\n            )}\n\n            {/* Edit Service Modal */}\n            {showEditServiceModal && editingService && (\n              <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\">\n                <div className=\"bg-white rounded-xl p-6 w-full max-w-lg max-h-[90vh] overflow-y-auto\">\n                  <div className=\"flex justify-between items-center mb-4\">\n                    <h3 className=\"text-xl font-bold text-gray-800\">Edit Service Record</h3>\n                    <button onClick={() => { setShowEditServiceModal(false); setEditingService(null); }} className=\"text-gray-500 hover:text-gray-700\">\n                      <Icons.X />\n                    </button>\n                  </div>\n\n                  <div className=\"space-y-4\">\n                    <div className=\"bg-gray-50 p-3 rounded-lg\">\n                      <div className=\"font-medium\">{editingService.customerName}</div>\n                      <div className=\"text-sm text-gray-500\">{new Date(editingService.date).toLocaleDateString()}</div>\n                    </div>\n\n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700 mb-1\">Service Rate ($)</label>\n                      <input\n                        type=\"number\"\n                        value={editingService.weeklyRate}\n                        onChange={e => setEditingService({ \n                          ...editingService, \n                          weeklyRate: parseFloat(e.target.value) || 0,\n                          totalAmount: (parseFloat(e.target.value) || 0) + (editingService.chemicalCost || 0)\n                        })}\n                        className=\"w-full px-4 py-2 border rounded-lg\"\n                      />\n                    </div>\n\n                    {/* Edit Chemicals */}\n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700 mb-2\">Chemicals Used</label>\n                      {editingService.chemicalsUsed && editingService.chemicalsUsed.length > 0 ? (\n                        <div className=\"space-y-2 mb-3\">\n                          {editingService.chemicalsUsed.map(chem => (\n                            <div key={chem.id} className=\"flex items-center justify-between bg-teal-50 p-2 rounded\">\n                              <span className=\"text-sm\">{chem.name}: {chem.quantity} {chem.unit}</span>\n                              <div className=\"flex items-center gap-2\">\n                                <span className=\"font-medium text-teal-700\">${chem.totalCost.toFixed(2)}</span>\n                                <button \n                                  onClick={() => removeChemicalFromEditingService(chem.id)}\n                                  className=\"text-red-500 hover:text-red-700\"\n                                >\n                                  <Icons.X />\n                                </button>\n                              </div>\n                            </div>\n                          ))}\n                        </div>\n                      ) : (\n                        <p className=\"text-sm text-gray-500 mb-3\">No chemicals recorded</p>\n                      )}\n\n                      {/* Add Chemical to Service */}\n                      {chemicalInventory.length > 0 && (\n                        <div className=\"bg-gray-50 p-3 rounded-lg\">\n                          <div className=\"text-sm font-medium mb-2\">Add Chemical:</div>\n                          <div className=\"flex gap-2\">\n                            <select id=\"editServiceChemical\" className=\"flex-1 px-3 py-2 border rounded-lg text-sm\">\n                              <option value=\"\">Select chemical...</option>\n                              {chemicalInventory.map(c => (\n                                <option key={c.id} value={c.id}>{c.name} (${c.costPerUnit}/{c.unit})</option>\n                              ))}\n                            </select>\n                            <input\n                              type=\"number\"\n                              step=\"0.1\"\n                              placeholder=\"Qty\"\n                              className=\"w-20 px-3 py-2 border rounded-lg text-sm\"\n                              id=\"editServiceChemicalQty\"\n                            />\n                            <button\n                              onClick={() => {\n                                const chemId = parseInt(document.getElementById('editServiceChemical').value);\n                                const qty = parseFloat(document.getElementById('editServiceChemicalQty').value) || 0;\n                                const chem = chemicalInventory.find(c => c.id === chemId);\n                                if (chem && qty > 0) {\n                                  addChemicalToEditingService(chem, qty);\n                                  document.getElementById('editServiceChemical').value = '';\n                                  document.getElementById('editServiceChemicalQty').value = '';\n                                }\n                              }}\n                              className=\"px-3 py-2 bg-teal-600 text-white rounded-lg text-sm hover:bg-teal-700\"\n                            >\n                              Add\n                            </button>\n                          </div>\n                        </div>\n                      )}\n                    </div>\n\n                    {/* Summary */}\n                    <div className=\"bg-green-50 p-4 rounded-lg border-2 border-green-200\">\n                      <div className=\"flex justify-between mb-1\">\n                        <span>Service Rate:</span>\n                        <span>${editingService.weeklyRate.toFixed(2)}</span>\n                      </div>\n                      <div className=\"flex justify-between mb-1\">\n                        <span>Chemical Cost:</span>\n                        <span>${(editingService.chemicalCost || 0).toFixed(2)}</span>\n                      </div>\n                      <div className=\"flex justify-between font-bold text-lg pt-2 border-t border-green-300\">\n                        <span>Total:</span>\n                        <span className=\"text-green-700\">${editingService.totalAmount.toFixed(2)}</span>\n                      </div>\n                    </div>\n\n                    <div className=\"flex gap-3\">\n                      <button\n                        onClick={() => deleteService(editingService.id)}\n                        className=\"px-4 py-3 bg-red-100 text-red-700 rounded-lg font-medium hover:bg-red-200\"\n                      >\n                        Delete\n                      </button>\n                      <button\n                        onClick={() => { setShowEditServiceModal(false); setEditingService(null); }}\n                        className=\"flex-1 py-3 border-2 border-gray-300 text-gray-700 rounded-lg font-medium hover:bg-gray-50\"\n                      >\n                        Cancel\n                      </button>\n                      <button\n                        onClick={updateService}\n                        className=\"flex-1 py-3 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700\"\n                      >\n                        Save Changes\n                      </button>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            )}\n\n            {/* Completed Jobs / Service Calls - Table format matching monthly invoices */}\n            <div className=\"bg-white rounded-xl p-6 shadow-lg\">\n              <div className=\"flex justify-between items-center mb-4 flex-wrap gap-3\">\n                <h3 className=\"text-xl font-bold text-gray-800\">Completed Jobs / Service Calls</h3>\n                <div className=\"flex gap-3 items-center flex-wrap\">\n                  {/* Search */}\n                  <div>\n                    <label className=\"text-xs text-gray-500 block\">Search Customer</label>\n                    <input\n                      type=\"text\"\n                      placeholder=\" Customer name...\"\n                      value={jobsSearch}\n                      onChange={e => setJobsSearch(e.target.value)}\n                      className=\"px-3 py-2 border rounded-lg text-sm w-40\"\n                    />\n                  </div>\n                  <div>\n                    <label className=\"text-xs text-gray-500 block\">Filter Date</label>\n                    <input\n                      type=\"date\"\n                      value={jobsDateFilter}\n                      onChange={e => setJobsDateFilter(e.target.value)}\n                      className=\"px-3 py-2 border rounded-lg text-sm\"\n                    />\n                  </div>\n                  {jobsDateFilter && (\n                    <button\n                      onClick={() => setJobsDateFilter('')}\n                      className=\"text-xs text-blue-600 hover:underline mt-4\"\n                    >\n                      Clear Date\n                    </button>\n                  )}\n                  <div className=\"text-sm text-gray-500 mt-4\">\n                    Showing: {new Date(invoiceMonth + '-01').toLocaleDateString('en-US', { month: 'long', year: 'numeric' })}\n                  </div>\n                </div>\n              </div>\n              \n              <table className=\"w-full\">\n                <thead className=\"bg-purple-50\">\n                  <tr>\n                    <th className=\"px-4 py-3 text-left text-sm font-medium text-gray-500\">Customer</th>\n                    <th className=\"px-4 py-3 text-left text-sm font-medium text-gray-500\">Job Type</th>\n                    <th className=\"px-4 py-3 text-left text-sm font-medium text-gray-500\">Date</th>\n                    <th className=\"px-4 py-3 text-left text-sm font-medium text-gray-500\">Labor</th>\n                    <th className=\"px-4 py-3 text-left text-sm font-medium text-gray-500\">Parts/Chem</th>\n                    <th className=\"px-4 py-3 text-left text-sm font-medium text-gray-500\">Total</th>\n                    <th className=\"px-4 py-3 text-right text-sm font-medium text-gray-500\">Actions</th>\n                  </tr>\n                </thead>\n                <tbody className=\"divide-y divide-gray-200\">\n                  {getAllMonthJobServices(invoiceMonth)\n                    .filter(s => !jobsSearch || s.customerName.toLowerCase().includes(jobsSearch.toLowerCase()))\n                    .filter(s => !jobsDateFilter || s.date === jobsDateFilter)\n                    .length > 0 ? (\n                    getAllMonthJobServices(invoiceMonth)\n                      .filter(s => !jobsSearch || s.customerName.toLowerCase().includes(jobsSearch.toLowerCase()))\n                      .filter(s => !jobsDateFilter || s.date === jobsDateFilter)\n                      .map(s => {\n                      const customer = customers.find(c => c.id === s.customerId);\n                      const jobInvoiceKey = `job-${s.id}`;\n                      const isJobPaid = paidInvoices[jobInvoiceKey]?.paid;\n                      const jobPaymentInfo = paidInvoices[jobInvoiceKey];\n                      const isJobBilled = billedCustomers[jobInvoiceKey];\n                      \n                      let rowClass = 'hover:bg-gray-50';\n                      if (isJobPaid) {\n                        rowClass = 'bg-blue-50 hover:bg-blue-100';\n                      } else if (isJobBilled) {\n                        rowClass = 'bg-green-50 hover:bg-green-100';\n                      }\n                      \n                      return (\n                        <tr key={s.id} className={rowClass}>\n                          <td className=\"px-4 py-4\">\n                            <div className=\"flex items-center gap-2 flex-wrap\">\n                              <div className=\"font-medium text-gray-800\">{s.customerName}</div>\n                              {isJobPaid && (\n                                <span className=\"text-xs bg-blue-500 text-white px-2 py-0.5 rounded\">\n                                   Paid {jobPaymentInfo?.method === 'check' ? `(#${jobPaymentInfo.checkNumber})` : \n                                          jobPaymentInfo?.method === 'cash' ? '(Cash)' : \n                                          `(${jobPaymentInfo?.source || 'Card'})`}\n                                </span>\n                              )}\n                              {!isJobPaid && isJobBilled && <span className=\"text-xs bg-green-500 text-white px-2 py-0.5 rounded\"> Billed</span>}\n                            </div>\n                          </td>\n                          <td className=\"px-4 py-4 text-gray-600 capitalize\">{s.jobType || s.poolType}</td>\n                          <td className=\"px-4 py-4 text-gray-600\">{new Date(s.date).toLocaleDateString()}</td>\n                          <td className=\"px-4 py-4 text-gray-600\">${s.weeklyRate.toFixed(2)}</td>\n                          <td className=\"px-4 py-4 text-teal-600\">${((s.additionalItemsCost || 0) + (s.chemicalCost || 0)).toFixed(2)}</td>\n                          <td className=\"px-4 py-4 font-bold text-green-600\">${s.totalAmount.toFixed(2)}</td>\n                          <td className=\"px-4 py-4 text-right\">\n                            <div className=\"flex gap-1 justify-end flex-wrap\">\n                              <button\n                                onClick={() => downloadJobInvoice(s, defaultPaymentTerms)}\n                                className=\"px-2 py-1 bg-blue-600 text-white rounded hover:bg-blue-700 text-xs\"\n                              >\n                                PDF\n                              </button>\n                              {customer?.email && (\n                                <button\n                                  onClick={async () => {\n                                    let paymentLink = null;\n                                    if (s.totalAmount > 0) {\n                                      const invoiceNumber = `JOB-${s.id.toString().slice(-8)}`;\n                                      const stripeResult = await createStripeCheckout(customer, s.totalAmount, `${s.jobType || 'Service Call'} - ${customer.name}`, invoiceNumber);\n                                      if (stripeResult?.paymentUrl) {\n                                        paymentLink = stripeResult.paymentUrl;\n                                      }\n                                    }\n                                    await sendJobCompletionEmail(customer, {\n                                      jobType: s.jobType || s.poolType,\n                                      basePrice: s.weeklyRate,\n                                      additionalItems: s.additionalItems || [],\n                                      chemicalsUsed: s.chemicalsUsed || [],\n                                      total: s.totalAmount,\n                                      notes: s.techNotes || ''\n                                    }, paymentLink);\n                                    // Mark as billed\n                                    const newBilledCustomers = { ...billedCustomers, [jobInvoiceKey]: { billed: true, billedDate: new Date().toISOString() } };\n                                    saveBilledCustomers(newBilledCustomers);\n                                  }}\n                                  disabled={isSendingEmail}\n                                  className=\"px-2 py-1 bg-green-600 text-white rounded hover:bg-green-700 text-xs\"\n                                >\n                                  {isSendingEmail ? '' : ''} Email\n                                </button>\n                              )}\n                              {!isJobPaid && (\n                                <button\n                                  onClick={() => {\n                                    setPaymentToMark({ \n                                      invoiceKey: jobInvoiceKey, \n                                      customerId: s.customerId, \n                                      customerName: s.customerName, \n                                      amount: s.totalAmount \n                                    });\n                                    setPaymentMethod({ method: 'electronic', checkNumber: '', source: '' });\n                                    setShowPaymentMethodModal(true);\n                                  }}\n                                  className=\"px-2 py-1 bg-purple-600 text-white rounded hover:bg-purple-700 text-xs\"\n                                >\n                                  Mark Paid\n                                </button>\n                              )}\n                              <button\n                                onClick={() => openEditServiceModal(s)}\n                                className=\"px-2 py-1 bg-gray-500 text-white rounded hover:bg-gray-600 text-xs\"\n                                title=\"Edit\"\n                              >\n                                \n                              </button>\n                              <button\n                                onClick={() => {\n                                  if (confirm(`Delete this ${s.jobType || 'service'} invoice for ${s.customerName}?`)) {\n                                    saveHistory(serviceHistory.filter(h => h.id !== s.id));\n                                  }\n                                }}\n                                className=\"px-2 py-1 bg-red-500 text-white rounded hover:bg-red-600 text-xs\"\n                                title=\"Delete\"\n                              >\n                                \n                              </button>\n                            </div>\n                          </td>\n                        </tr>\n                      );\n                    })\n                  ) : (\n                    <tr>\n                      <td colSpan=\"7\" className=\"px-4 py-8 text-center text-gray-500\">\n                        {jobsSearch || jobsDateFilter ? 'No jobs match your search' : 'No completed jobs for this month'}\n                      </td>\n                    </tr>\n                  )}\n                </tbody>\n              </table>\n            </div>\n          </div>\n        )}\n\n        {/* HISTORY TAB */}\n        {activeTab === 'history' && (\n          <div className=\"space-y-4\">\n            <div className=\"flex justify-between items-center flex-wrap gap-3\">\n              <h2 className=\"text-xl font-bold text-gray-800\">Service History</h2>\n              <div className=\"flex items-center gap-3 flex-wrap\">\n                {/* Search */}\n                <div>\n                  <label className=\"text-xs text-gray-500 block\">Search Customer</label>\n                  <input\n                    type=\"text\"\n                    placeholder=\" Customer name...\"\n                    value={historySearch}\n                    onChange={e => setHistorySearch(e.target.value)}\n                    className=\"px-3 py-2 border rounded-lg text-sm w-40\"\n                  />\n                </div>\n                <div>\n                  <label className=\"text-xs text-gray-500 block\">Filter Date</label>\n                  <input\n                    type=\"date\"\n                    value={historyDateFilter}\n                    onChange={e => setHistoryDateFilter(e.target.value)}\n                    className=\"px-3 py-2 border rounded-lg text-sm\"\n                  />\n                </div>\n                {(historySearch || historyDateFilter) && (\n                  <button\n                    onClick={() => { setHistorySearch(''); setHistoryDateFilter(''); }}\n                    className=\"text-xs text-blue-600 hover:underline mt-4\"\n                  >\n                    Clear Filters\n                  </button>\n                )}\n                <div className=\"text-lg font-bold text-green-600 mt-4\">\n                  Total: ${serviceHistory\n                    .filter(s => !historySearch || s.customerName.toLowerCase().includes(historySearch.toLowerCase()))\n                    .filter(s => !historyDateFilter || s.date === historyDateFilter)\n                    .reduce((sum, s) => sum + s.totalAmount, 0).toFixed(2)}\n                </div>\n              </div>\n            </div>\n\n            {serviceHistory\n              .filter(s => !historySearch || s.customerName.toLowerCase().includes(historySearch.toLowerCase()))\n              .filter(s => !historyDateFilter || s.date === historyDateFilter)\n              .length > 0 ? (\n              <div className=\"space-y-3\">\n                {serviceHistory\n                  .filter(s => !historySearch || s.customerName.toLowerCase().includes(historySearch.toLowerCase()))\n                  .filter(s => !historyDateFilter || s.date === historyDateFilter)\n                  .map(service => (\n                  <div key={service.id} className=\"bg-white rounded-xl p-4 shadow-lg border-l-4 border-green-500\">\n                    <div className=\"flex items-start justify-between\">\n                      <div className=\"flex-1\">\n                        <div className=\"font-bold text-gray-800\">{service.customerName}</div>\n                        <div className=\"text-sm text-gray-500\">\n                          {new Date(service.date).toLocaleDateString()}  {service.poolType}\n                        </div>\n                      </div>\n                      <div className=\"text-right\">\n                        <div className=\"text-xl font-bold text-green-600\">${service.totalAmount.toFixed(2)}</div>\n                        {(service.chemicalCost > 0 || service.additionalItemsCost > 0) && (\n                          <div className=\"text-xs text-gray-500\">\n                            Base: ${service.weeklyRate.toFixed(2)}\n                            {service.chemicalCost > 0 && ` + Chemicals: $${service.chemicalCost.toFixed(2)}`}\n                            {service.additionalItemsCost > 0 && ` + Items: $${service.additionalItemsCost.toFixed(2)}`}\n                          </div>\n                        )}\n                      </div>\n                      <div className=\"flex gap-1 ml-3\">\n                        <button\n                          onClick={() => openEditServiceModal(service)}\n                          className=\"p-2 text-blue-500 hover:text-blue-700 hover:bg-blue-50 rounded\"\n                          title=\"Edit\"\n                        >\n                          <Icons.Edit />\n                        </button>\n                        <button\n                          onClick={() => deleteService(service.id)}\n                          className=\"p-2 text-red-500 hover:text-red-700 hover:bg-red-50 rounded\"\n                          title=\"Delete\"\n                        >\n                          <Icons.Trash />\n                        </button>\n                      </div>\n                    </div>\n                    {service.chemicalsUsed && service.chemicalsUsed.length > 0 && (\n                      <div className=\"mt-2 pt-2 border-t border-gray-100\">\n                        <div className=\"text-xs text-teal-700 font-medium mb-1\">Chemicals Used:</div>\n                        <div className=\"flex flex-wrap gap-1\">\n                          {service.chemicalsUsed.map((chem, idx) => (\n                            <span key={idx} className=\"text-xs bg-teal-50 text-teal-700 px-2 py-0.5 rounded\">\n                              {chem.name}: {chem.quantity} {chem.unit} (${chem.totalCost.toFixed(2)})\n                            </span>\n                          ))}\n                        </div>\n                      </div>\n                    )}\n                    {service.additionalItems && service.additionalItems.length > 0 && (\n                      <div className=\"mt-2 pt-2 border-t border-gray-100\">\n                        <div className=\"text-xs text-purple-700 font-medium mb-1\">Additional Items:</div>\n                        <div className=\"flex flex-wrap gap-1\">\n                          {service.additionalItems.map((item, idx) => (\n                            <span key={idx} className=\"text-xs bg-purple-50 text-purple-700 px-2 py-0.5 rounded\">\n                              {item.name} x{item.quantity} (${item.totalCost.toFixed(2)})\n                            </span>\n                          ))}\n                        </div>\n                      </div>\n                    )}\n                  </div>\n                ))}\n              </div>\n            ) : (\n              <div className=\"bg-white rounded-xl p-12 shadow-lg text-center\">\n                <div className=\"text-6xl mb-4\"></div>\n                <h3 className=\"text-xl font-bold text-gray-800 mb-2\">\n                  {historySearch || historyDateFilter ? 'No matching services' : 'No service history'}\n                </h3>\n                <p className=\"text-gray-500\">\n                  {historySearch || historyDateFilter ? 'Try adjusting your search filters.' : 'Complete services to see them here.'}\n                </p>\n              </div>\n            )}\n          </div>\n        )}\n\n        {/* SETTINGS TAB */}\n        {activeTab === 'settings' && (\n          <div className=\"space-y-6\">\n            {/* Company Profile Section */}\n            <div className=\"bg-white rounded-xl p-6 shadow-lg\">\n              <h2 className=\"text-xl font-bold text-gray-800 mb-4\"> Company Profile</h2>\n              <p className=\"text-sm text-gray-500 mb-4\">This information will be used in your emails and invoices.</p>\n              \n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">Company Name</label>\n                  <input\n                    type=\"text\"\n                    value={companySettings.companyName}\n                    onChange={e => setCompanySettings({ ...companySettings, companyName: e.target.value })}\n                    className=\"w-full px-4 py-2 border rounded-lg\"\n                    placeholder=\"Your Pool Company\"\n                  />\n                </div>\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">Owner/Contact Name</label>\n                  <input\n                    type=\"text\"\n                    value={companySettings.ownerName}\n                    onChange={e => setCompanySettings({ ...companySettings, ownerName: e.target.value })}\n                    className=\"w-full px-4 py-2 border rounded-lg\"\n                    placeholder=\"John Smith\"\n                  />\n                </div>\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">Phone</label>\n                  <input\n                    type=\"tel\"\n                    value={companySettings.phone}\n                    onChange={e => setCompanySettings({ ...companySettings, phone: e.target.value })}\n                    className=\"w-full px-4 py-2 border rounded-lg\"\n                    placeholder=\"(555) 123-4567\"\n                  />\n                </div>\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">Email</label>\n                  <input\n                    type=\"email\"\n                    value={companySettings.email}\n                    onChange={e => setCompanySettings({ ...companySettings, email: e.target.value })}\n                    className=\"w-full px-4 py-2 border rounded-lg\"\n                    placeholder=\"info@yourpoolco.com\"\n                  />\n                </div>\n                <div className=\"md:col-span-2\">\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">Business Address</label>\n                  <input\n                    type=\"text\"\n                    value={companySettings.address}\n                    onChange={e => setCompanySettings({ ...companySettings, address: e.target.value })}\n                    className=\"w-full px-4 py-2 border rounded-lg\"\n                    placeholder=\"123 Main St, City, State ZIP\"\n                  />\n                </div>\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">Website (optional)</label>\n                  <input\n                    type=\"url\"\n                    value={companySettings.website}\n                    onChange={e => setCompanySettings({ ...companySettings, website: e.target.value })}\n                    className=\"w-full px-4 py-2 border rounded-lg\"\n                    placeholder=\"https://yourpoolco.com\"\n                  />\n                </div>\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">Logo URL (optional)</label>\n                  <input\n                    type=\"url\"\n                    value={companySettings.logoUrl}\n                    onChange={e => setCompanySettings({ ...companySettings, logoUrl: e.target.value })}\n                    className=\"w-full px-4 py-2 border rounded-lg\"\n                    placeholder=\"https://yoursite.com/logo.png\"\n                  />\n                </div>\n              </div>\n              \n              <div className=\"mt-4 pt-4 border-t\">\n                <h4 className=\"font-medium text-gray-700 mb-3\">Brand Colors</h4>\n                <div className=\"flex gap-4\">\n                  <div>\n                    <label className=\"block text-sm text-gray-600 mb-1\">Primary Color</label>\n                    <div className=\"flex items-center gap-2\">\n                      <input\n                        type=\"color\"\n                        value={companySettings.primaryColor}\n                        onChange={e => setCompanySettings({ ...companySettings, primaryColor: e.target.value })}\n                        className=\"w-10 h-10 rounded cursor-pointer\"\n                      />\n                      <input\n                        type=\"text\"\n                        value={companySettings.primaryColor}\n                        onChange={e => setCompanySettings({ ...companySettings, primaryColor: e.target.value })}\n                        className=\"w-24 px-2 py-1 border rounded text-sm\"\n                      />\n                    </div>\n                  </div>\n                  <div>\n                    <label className=\"block text-sm text-gray-600 mb-1\">Accent Color</label>\n                    <div className=\"flex items-center gap-2\">\n                      <input\n                        type=\"color\"\n                        value={companySettings.accentColor}\n                        onChange={e => setCompanySettings({ ...companySettings, accentColor: e.target.value })}\n                        className=\"w-10 h-10 rounded cursor-pointer\"\n                      />\n                      <input\n                        type=\"text\"\n                        value={companySettings.accentColor}\n                        onChange={e => setCompanySettings({ ...companySettings, accentColor: e.target.value })}\n                        className=\"w-24 px-2 py-1 border rounded text-sm\"\n                      />\n                    </div>\n                  </div>\n                </div>\n              </div>\n              \n              <button\n                onClick={() => saveCompanySettings(companySettings)}\n                className=\"mt-4 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700\"\n              >\n                Save Company Settings\n              </button>\n            </div>\n\n            {/* Email Templates Section */}\n            <div className=\"bg-white rounded-xl p-6 shadow-lg\">\n              <h2 className=\"text-xl font-bold text-gray-800 mb-4\"> Email Templates</h2>\n              <p className=\"text-sm text-gray-500 mb-4\">Customize the emails sent to your customers. Use merge tags to personalize content.</p>\n              \n              {/* Merge Tags Reference */}\n              <div className=\"bg-blue-50 p-4 rounded-lg mb-6\">\n                <h4 className=\"font-medium text-blue-800 mb-2\">Available Merge Tags</h4>\n                <div className=\"grid grid-cols-2 md:grid-cols-4 gap-2 text-sm\">\n                  {[\n                    '{{company_name}}', '{{owner_name}}', '{{company_phone}}', '{{company_email}}',\n                    '{{customer_name}}', '{{customer_email}}', '{{service_date}}', '{{month}}',\n                    '{{total}}', '{{subtotal}}', '{{chemical_total}}', '{{chemicals_used}}',\n                    '{{service_summary}}', '{{payment_link}}', '{{quote_number}}', '{{line_items}}'\n                  ].map(tag => (\n                    <code key={tag} className=\"bg-white px-2 py-1 rounded text-blue-700 text-xs\">{tag}</code>\n                  ))}\n                </div>\n              </div>\n\n              {/* Template Cards */}\n              <div className=\"space-y-4\">\n                {/* Weekly Update Template */}\n                <div className=\"border rounded-lg p-4\">\n                  <div className=\"flex justify-between items-start mb-3\">\n                    <div>\n                      <h3 className=\"font-bold text-gray-800\"> Weekly Service Update</h3>\n                      <p className=\"text-sm text-gray-500\">Sent after completing weekly service</p>\n                    </div>\n                    <div className=\"flex gap-2\">\n                      <button\n                        onClick={() => setPreviewTemplate('weeklyUpdate')}\n                        className=\"px-3 py-1 bg-gray-100 text-gray-700 rounded hover:bg-gray-200 text-sm\"\n                      >\n                        Preview\n                      </button>\n                      <button\n                        onClick={() => setEditingTemplate('weeklyUpdate')}\n                        className=\"px-3 py-1 bg-blue-600 text-white rounded hover:bg-blue-700 text-sm\"\n                      >\n                        Edit\n                      </button>\n                    </div>\n                  </div>\n                  <div className=\"bg-gray-50 p-3 rounded\">\n                    <div className=\"text-sm text-gray-600\"><strong>Subject:</strong> {emailTemplates.weeklyUpdate.subject}</div>\n                  </div>\n                </div>\n\n                {/* Monthly Invoice Template */}\n                <div className=\"border rounded-lg p-4\">\n                  <div className=\"flex justify-between items-start mb-3\">\n                    <div>\n                      <h3 className=\"font-bold text-gray-800\"> Monthly Invoice</h3>\n                      <p className=\"text-sm text-gray-500\">Sent with monthly billing</p>\n                    </div>\n                    <div className=\"flex gap-2\">\n                      <button\n                        onClick={() => setPreviewTemplate('monthlyInvoice')}\n                        className=\"px-3 py-1 bg-gray-100 text-gray-700 rounded hover:bg-gray-200 text-sm\"\n                      >\n                        Preview\n                      </button>\n                      <button\n                        onClick={() => setEditingTemplate('monthlyInvoice')}\n                        className=\"px-3 py-1 bg-blue-600 text-white rounded hover:bg-blue-700 text-sm\"\n                      >\n                        Edit\n                      </button>\n                    </div>\n                  </div>\n                  <div className=\"bg-gray-50 p-3 rounded\">\n                    <div className=\"text-sm text-gray-600\"><strong>Subject:</strong> {emailTemplates.monthlyInvoice.subject}</div>\n                  </div>\n                </div>\n\n                {/* Quote Template */}\n                <div className=\"border rounded-lg p-4\">\n                  <div className=\"flex justify-between items-start mb-3\">\n                    <div>\n                      <h3 className=\"font-bold text-gray-800\"> Quote</h3>\n                      <p className=\"text-sm text-gray-500\">Sent when creating quotes for customers</p>\n                    </div>\n                    <div className=\"flex gap-2\">\n                      <button\n                        onClick={() => setPreviewTemplate('quote')}\n                        className=\"px-3 py-1 bg-gray-100 text-gray-700 rounded hover:bg-gray-200 text-sm\"\n                      >\n                        Preview\n                      </button>\n                      <button\n                        onClick={() => setEditingTemplate('quote')}\n                        className=\"px-3 py-1 bg-blue-600 text-white rounded hover:bg-blue-700 text-sm\"\n                      >\n                        Edit\n                      </button>\n                    </div>\n                  </div>\n                  <div className=\"bg-gray-50 p-3 rounded\">\n                    <div className=\"text-sm text-gray-600\"><strong>Subject:</strong> {emailTemplates.quote.subject}</div>\n                  </div>\n                </div>\n              </div>\n            </div>\n\n            {/* Edit Template Modal */}\n            {editingTemplate && (\n              <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\">\n                <div className=\"bg-white rounded-xl p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto\">\n                  <div className=\"flex justify-between items-center mb-4\">\n                    <h3 className=\"text-xl font-bold text-gray-800\">\n                      Edit {editingTemplate === 'weeklyUpdate' ? 'Weekly Update' : editingTemplate === 'monthlyInvoice' ? 'Monthly Invoice' : 'Quote'} Template\n                    </h3>\n                    <button onClick={() => setEditingTemplate(null)} className=\"text-gray-500 hover:text-gray-700\">\n                      <Icons.X />\n                    </button>\n                  </div>\n\n                  <div className=\"space-y-4\">\n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700 mb-1\">Email Subject</label>\n                      <input\n                        type=\"text\"\n                        value={emailTemplates[editingTemplate].subject}\n                        onChange={e => setEmailTemplates({\n                          ...emailTemplates,\n                          [editingTemplate]: { ...emailTemplates[editingTemplate], subject: e.target.value }\n                        })}\n                        className=\"w-full px-4 py-2 border rounded-lg\"\n                      />\n                    </div>\n                    \n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700 mb-1\">Email Body</label>\n                      <textarea\n                        value={emailTemplates[editingTemplate].body}\n                        onChange={e => setEmailTemplates({\n                          ...emailTemplates,\n                          [editingTemplate]: { ...emailTemplates[editingTemplate], body: e.target.value }\n                        })}\n                        className=\"w-full px-4 py-2 border rounded-lg font-mono text-sm\"\n                        rows=\"15\"\n                      />\n                    </div>\n\n                    <div className=\"bg-amber-50 p-3 rounded-lg\">\n                      <h4 className=\"font-medium text-amber-800 mb-2\"> Tips</h4>\n                      <ul className=\"text-sm text-amber-700 space-y-1\">\n                        <li> Use **text** for bold formatting</li>\n                        <li> Use merge tags like {'{{customer_name}}'} for personalization</li>\n                        <li> Use {'{{#if condition}}...{{/if}}'} for conditional content</li>\n                      </ul>\n                    </div>\n\n                    <div className=\"flex gap-3\">\n                      <button\n                        onClick={() => setEditingTemplate(null)}\n                        className=\"flex-1 py-2 border-2 border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50\"\n                      >\n                        Cancel\n                      </button>\n                      <button\n                        onClick={() => {\n                          saveEmailTemplates(emailTemplates);\n                          setEditingTemplate(null);\n                        }}\n                        className=\"flex-1 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700\"\n                      >\n                        Save Template\n                      </button>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            )}\n\n            {/* Preview Template Modal */}\n            {previewTemplate && (\n              <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\">\n                <div className=\"bg-white rounded-xl p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto\">\n                  <div className=\"flex justify-between items-center mb-4\">\n                    <h3 className=\"text-xl font-bold text-gray-800\">Email Preview</h3>\n                    <button onClick={() => setPreviewTemplate(null)} className=\"text-gray-500 hover:text-gray-700\">\n                      <Icons.X />\n                    </button>\n                  </div>\n\n                  <div className=\"border rounded-lg overflow-hidden\">\n                    <div className=\"bg-gray-100 px-4 py-2 border-b\">\n                      <div className=\"text-sm\">\n                        <strong>Subject:</strong> {emailTemplates[previewTemplate].subject\n                          .replace('{{company_name}}', companySettings.companyName || 'Your Company')\n                          .replace('{{month}}', 'January 2025')\n                          .replace('{{quote_number}}', 'Q-001')}\n                      </div>\n                    </div>\n                    <div className=\"p-4 bg-white\">\n                      <pre className=\"whitespace-pre-wrap font-sans text-sm text-gray-700\">\n                        {emailTemplates[previewTemplate].body\n                          .replace(/\\{\\{company_name\\}\\}/g, companySettings.companyName || 'Your Company')\n                          .replace(/\\{\\{owner_name\\}\\}/g, companySettings.ownerName || 'Owner Name')\n                          .replace(/\\{\\{company_phone\\}\\}/g, companySettings.phone || '(555) 123-4567')\n                          .replace(/\\{\\{company_email\\}\\}/g, companySettings.email || 'info@company.com')\n                          .replace(/\\{\\{customer_name\\}\\}/g, 'John Smith')\n                          .replace(/\\{\\{service_date\\}\\}/g, new Date().toLocaleDateString())\n                          .replace(/\\{\\{month\\}\\}/g, 'January 2025')\n                          .replace(/\\{\\{total\\}\\}/g, '450.00')\n                          .replace(/\\{\\{subtotal\\}\\}/g, '400.00')\n                          .replace(/\\{\\{chemical_total\\}\\}/g, '50.00')\n                          .replace(/\\{\\{chemicals_used\\}\\}/g, ' Chlorine: 2 lbs ($15.00)\\n Shock: 1 lb ($12.00)')\n                          .replace(/\\{\\{service_summary\\}\\}/g, '4 weekly services @ $100.00 each')\n                          .replace(/\\{\\{payment_link\\}\\}/g, 'https://pay.stripe.com/example')\n                          .replace(/\\{\\{quote_number\\}\\}/g, 'Q-001')\n                          .replace(/\\{\\{quote_date\\}\\}/g, new Date().toLocaleDateString())\n                          .replace(/\\{\\{valid_days\\}\\}/g, '30')\n                          .replace(/\\{\\{line_items\\}\\}/g, ' Pool Opening - $250.00\\n Filter Cleaning - $75.00')\n                          .replace(/\\*\\*(.*?)\\*\\*/g, '$1')}\n                      </pre>\n                    </div>\n                  </div>\n\n                  <button\n                    onClick={() => setPreviewTemplate(null)}\n                    className=\"mt-4 w-full py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300\"\n                  >\n                    Close Preview\n                  </button>\n                </div>\n              </div>\n            )}\n\n            {/* Server Configuration */}\n            <div className=\"bg-white rounded-xl p-6 shadow-lg\">\n              <h2 className=\"text-xl font-bold text-gray-800 mb-4\"> Server Configuration</h2>\n              <p className=\"text-sm text-gray-500 mb-4\">Configure your email and payment server settings.</p>\n              \n              <div className=\"bg-amber-50 border border-amber-200 rounded-lg p-4 mb-4\">\n                <h4 className=\"font-medium text-amber-800 mb-2\"> Server Required</h4>\n                <p className=\"text-sm text-amber-700\">\n                  To send emails and process payments, you need to deploy the Pool Authority server. \n                  This handles Gmail SMTP and Stripe integration securely.\n                </p>\n              </div>\n\n              <div className=\"space-y-4\">\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">Server URL</label>\n                  <input\n                    type=\"url\"\n                    placeholder=\"https://your-app.railway.app\"\n                    className=\"w-full px-4 py-2 border rounded-lg\"\n                    defaultValue=\"http://localhost:3001\"\n                  />\n                  <p className=\"text-xs text-gray-500 mt-1\">Your Railway deployment URL (or localhost for testing)</p>\n                </div>\n              </div>\n\n              <div className=\"mt-6 p-4 bg-gray-50 rounded-lg\">\n                <h4 className=\"font-medium text-gray-800 mb-2\"> Deploy to Railway</h4>\n                <ol className=\"text-sm text-gray-600 space-y-2\">\n                  <li>1. Create a free account at <a href=\"https://railway.app\" target=\"_blank\" className=\"text-blue-600 hover:underline\">railway.app</a></li>\n                  <li>2. Connect your GitHub repository with the server code</li>\n                  <li>3. Add environment variables (STRIPE_SECRET_KEY, GMAIL_USER, GMAIL_APP_PASSWORD)</li>\n                  <li>4. Deploy and copy your server URL above</li>\n                </ol>\n              </div>\n            </div>\n\n            {/* Email Log */}\n            <div className=\"bg-white rounded-xl p-6 shadow-lg\">\n              <div className=\"flex justify-between items-center mb-4\">\n                <h2 className=\"text-xl font-bold text-gray-800\"> Email History</h2>\n                {emailLog.length > 0 && (\n                  <button\n                    onClick={() => {\n                      if (window.confirm('Clear all email history?')) {\n                        saveEmailLog([]);\n                      }\n                    }}\n                    className=\"text-sm text-red-600 hover:text-red-800\"\n                  >\n                    Clear History\n                  </button>\n                )}\n              </div>\n              \n              {emailLog.length > 0 ? (\n                <div className=\"space-y-2 max-h-96 overflow-y-auto\">\n                  {emailLog.slice(0, 50).map(log => (\n                    <div key={log.id} className=\"flex items-center justify-between p-3 bg-gray-50 rounded-lg\">\n                      <div className=\"flex items-center gap-3\">\n                        <span className={`text-lg ${log.status === 'sent' ? 'text-green-500' : 'text-red-500'}`}>\n                          {log.status === 'sent' ? '' : ''}\n                        </span>\n                        <div>\n                          <div className=\"font-medium text-gray-800\">{log.customerName}</div>\n                          <div className=\"text-sm text-gray-500\">{log.subject}</div>\n                          <div className=\"text-xs text-gray-400\">{log.to}</div>\n                        </div>\n                      </div>\n                      <div className=\"text-right\">\n                        <div className=\"text-xs text-gray-500\">\n                          {new Date(log.sentDate).toLocaleDateString()}\n                        </div>\n                        <div className=\"text-xs text-gray-400\">\n                          {new Date(log.sentDate).toLocaleTimeString()}\n                        </div>\n                        <span className={`text-xs px-2 py-0.5 rounded ${\n                          log.type === 'invoice' ? 'bg-blue-100 text-blue-700' :\n                          log.type === 'weekly-update' ? 'bg-green-100 text-green-700' :\n                          'bg-purple-100 text-purple-700'\n                        }`}>\n                          {log.type}\n                        </span>\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              ) : (\n                <div className=\"text-center py-8 text-gray-500\">\n                  <div className=\"text-4xl mb-2\"></div>\n                  <p>No emails sent yet</p>\n                  <p className=\"text-sm\">Emails will appear here when you send invoices, quotes, or updates</p>\n                </div>\n              )}\n            </div>\n          </div>\n        )}\n      </div>\n\n      {/* Invoice Terms Modal */}\n      {showInvoiceTermsModal && invoiceTermsAction && (\n        <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\">\n          <div className=\"bg-white rounded-xl p-6 w-full max-w-md\">\n            <div className=\"flex justify-between items-center mb-4\">\n              <h3 className=\"text-xl font-bold\">\n                {invoiceTermsAction.type === 'reminder' ? 'Send Payment Reminder' : 'Invoice Options'}\n              </h3>\n              <button onClick={() => setShowInvoiceTermsModal(false)} className=\"text-gray-500 hover:text-gray-700\">\n                <Icons.X />\n              </button>\n            </div>\n            \n            <div className={`mb-4 p-3 rounded-lg ${invoiceTermsAction.type === 'reminder' ? 'bg-red-50' : 'bg-gray-50'}`}>\n              <div className=\"font-medium\">{invoiceTermsAction.customer.name}</div>\n              <div className=\"text-sm text-gray-500\">{new Date(invoiceMonth + '-01').toLocaleDateString('en-US', { month: 'long', year: 'numeric' })}</div>\n              <div className=\"text-lg font-bold text-green-600 mt-1\">${invoiceTermsAction.total.toFixed(2)}</div>\n              {invoiceTermsAction.type === 'reminder' && invoiceTermsAction.daysPastDue && (\n                <div className=\"text-sm text-red-600 mt-1\"> {invoiceTermsAction.daysPastDue} days past due</div>\n              )}\n            </div>\n            \n            {invoiceTermsAction.type !== 'reminder' && (\n              <div className=\"mb-4\">\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">Payment Terms</label>\n                <select\n                  value={selectedInvoiceTerms}\n                  onChange={e => setSelectedInvoiceTerms(e.target.value)}\n                  className=\"w-full px-4 py-2 border rounded-lg\"\n                >\n                  <option value=\"due_receipt\">Due on Receipt</option>\n                  <option value=\"net7\">Net 7</option>\n                  <option value=\"net15\">Net 15</option>\n                  <option value=\"net30\">Net 30</option>\n                  <option value=\"net45\">Net 45</option>\n                  <option value=\"net60\">Net 60</option>\n                </select>\n              </div>\n            )}\n\n            {invoiceTermsAction.type === 'reminder' && (\n              <div className=\"mb-4 p-3 bg-amber-50 rounded-lg text-sm text-amber-800\">\n                <strong>Note:</strong> This will send a friendly payment reminder email with a new payment link attached.\n              </div>\n            )}\n            \n            <div className=\"flex gap-3\">\n              <button\n                onClick={() => setShowInvoiceTermsModal(false)}\n                className=\"flex-1 py-2 border-2 border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50\"\n              >\n                Cancel\n              </button>\n              <button\n                onClick={async () => {\n                  const { type, customer, services, serviceTotal, chemicalTotal, total, daysPastDue } = invoiceTermsAction;\n                  const monthName = new Date(invoiceMonth + '-01').toLocaleDateString('en-US', { month: 'long', year: 'numeric' });\n                  \n                  if (type === 'pdf') {\n                    downloadInvoice(customer, invoiceMonth, selectedInvoiceTerms);\n                  } else if (type === 'email') {\n                    const serviceSummary = `${services.length} service${services.length !== 1 ? 's' : ''} @ $${customer.weeklyRate}/visit`;\n                    \n                    let paymentLink = null;\n                    if (total > 0) {\n                      const invoiceNumber = `INV-${Date.now().toString().slice(-8)}`;\n                      const stripeResult = await createStripeCheckout(customer, total, `Pool Service - ${monthName}`, invoiceNumber);\n                      if (stripeResult?.paymentUrl) {\n                        paymentLink = stripeResult.paymentUrl;\n                      }\n                    }\n                    \n                    await sendInvoiceEmail(customer, {\n                      month: monthName,\n                      serviceSummary,\n                      services,\n                      subtotal: serviceTotal,\n                      chemicalTotal,\n                      total,\n                      paymentTerms: selectedInvoiceTerms,\n                      billingMonth: invoiceMonth\n                    }, paymentLink);\n                  } else if (type === 'reminder') {\n                    const serviceSummary = `${services.length} service${services.length !== 1 ? 's' : ''} @ $${customer.weeklyRate}/visit`;\n                    \n                    // Create new payment link for reminder\n                    let paymentLink = null;\n                    if (total > 0) {\n                      const invoiceNumber = `REM-${Date.now().toString().slice(-8)}`;\n                      const stripeResult = await createStripeCheckout(customer, total, `Pool Service - ${monthName} (Overdue)`, invoiceNumber);\n                      if (stripeResult?.paymentUrl) {\n                        paymentLink = stripeResult.paymentUrl;\n                      }\n                    }\n                    \n                    await sendPaymentReminder(customer, {\n                      month: monthName,\n                      serviceSummary,\n                      total,\n                      daysPastDue\n                    }, paymentLink);\n                  }\n                  \n                  setShowInvoiceTermsModal(false);\n                }}\n                disabled={isSendingEmail}\n                className={`flex-1 py-2 text-white rounded-lg disabled:opacity-50 ${\n                  invoiceTermsAction.type === 'reminder' ? 'bg-red-600 hover:bg-red-700' : 'bg-blue-600 hover:bg-blue-700'\n                }`}\n              >\n                {isSendingEmail ? ' Sending...' : \n                  invoiceTermsAction.type === 'pdf' ? ' Generate PDF' : \n                  invoiceTermsAction.type === 'reminder' ? ' Send Reminder' : ' Send Invoice'}\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Employee Manager Modal */}\n      {showEmployeeManager && (\n        <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\">\n          <div className=\"bg-white rounded-xl p-6 w-full max-w-lg max-h-[90vh] overflow-y-auto\">\n            <div className=\"flex justify-between items-center mb-4\">\n              <h3 className=\"text-xl font-bold text-indigo-700\"> Manage Employees</h3>\n              <button onClick={() => setShowEmployeeManager(false)} className=\"text-gray-500 hover:text-gray-700\">\n                <Icons.X />\n              </button>\n            </div>\n\n            {/* Add New Employee */}\n            <div className=\"bg-indigo-50 p-4 rounded-lg mb-4\">\n              <h4 className=\"font-medium text-indigo-800 mb-3\">Add New Employee</h4>\n              <div className=\"space-y-3\">\n                <input\n                  type=\"text\"\n                  placeholder=\"Employee Name\"\n                  value={newEmployee.name}\n                  onChange={(e) => setNewEmployee({ ...newEmployee, name: e.target.value })}\n                  className=\"w-full px-3 py-2 border rounded-lg\"\n                />\n                <div className=\"grid grid-cols-2 gap-3\">\n                  <input\n                    type=\"tel\"\n                    placeholder=\"Phone (optional)\"\n                    value={newEmployee.phone}\n                    onChange={(e) => setNewEmployee({ ...newEmployee, phone: e.target.value })}\n                    className=\"px-3 py-2 border rounded-lg\"\n                  />\n                  <input\n                    type=\"email\"\n                    placeholder=\"Email (optional)\"\n                    value={newEmployee.email}\n                    onChange={(e) => setNewEmployee({ ...newEmployee, email: e.target.value })}\n                    className=\"px-3 py-2 border rounded-lg\"\n                  />\n                </div>\n                <button\n                  onClick={() => {\n                    if (newEmployee.name.trim()) {\n                      const colorIndex = employees.length % employeeColors.length;\n                      saveEmployees([...employees, { \n                        ...newEmployee, \n                        id: Date.now(),\n                        colorIndex\n                      }]);\n                      setNewEmployee({ name: '', phone: '', email: '' });\n                    }\n                  }}\n                  disabled={!newEmployee.name.trim()}\n                  className=\"w-full py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 disabled:bg-gray-300\"\n                >\n                  Add Employee\n                </button>\n              </div>\n            </div>\n\n            {/* Employee List */}\n            <div className=\"space-y-2\">\n              <h4 className=\"font-medium text-gray-700\">Current Employees ({employees.length})</h4>\n              {employees.length > 0 ? (\n                employees.map((emp, idx) => {\n                  const color = employeeColors[idx % employeeColors.length];\n                  const assignedRecurring = recurringServices.filter(r => r.employeeId === emp.id && r.active).length;\n                  const assignedJobs = oneTimeJobs.filter(j => j.employeeId === emp.id).length;\n                  \n                  return (\n                    <div key={emp.id} className=\"flex items-center justify-between p-3 bg-gray-50 rounded-lg\">\n                      <div className=\"flex items-center gap-3\">\n                        <div \n                          className=\"w-10 h-10 rounded-full flex items-center justify-center text-white font-bold\"\n                          style={{ backgroundColor: color.bg }}\n                        >\n                          {emp.name.charAt(0).toUpperCase()}\n                        </div>\n                        <div>\n                          <div className=\"font-medium\">{emp.name}</div>\n                          <div className=\"text-xs text-gray-500\">\n                            {emp.phone && <span className=\"mr-2\">{emp.phone}</span>}\n                            {emp.email && <span>{emp.email}</span>}\n                          </div>\n                          <div className=\"text-xs text-indigo-600\">\n                            {assignedRecurring} recurring  {assignedJobs} jobs\n                          </div>\n                        </div>\n                      </div>\n                      <button\n                        onClick={() => {\n                          if (confirm(`Remove ${emp.name}? Their assignments will become unassigned.`)) {\n                            // Remove employee and clear their assignments\n                            saveEmployees(employees.filter(e => e.id !== emp.id));\n                            saveRecurring(recurringServices.map(r => \n                              r.employeeId === emp.id ? { ...r, employeeId: null } : r\n                            ));\n                            saveJobs(oneTimeJobs.map(j => \n                              j.employeeId === emp.id ? { ...j, employeeId: null } : j\n                            ));\n                          }\n                        }}\n                        className=\"text-red-500 hover:text-red-700 p-2\"\n                      >\n                        <Icons.Trash />\n                      </button>\n                    </div>\n                  );\n                })\n              ) : (\n                <p className=\"text-gray-500 text-center py-4\">No employees yet. Add your first employee above!</p>\n              )}\n            </div>\n\n            <button\n              onClick={() => setShowEmployeeManager(false)}\n              className=\"w-full mt-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300\"\n            >\n              Done\n            </button>\n          </div>\n        </div>\n      )}\n\n      {/* Schedule Quote as Job Modal */}\n      {showScheduleQuoteJob && quoteToSchedule && (\n        <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\">\n          <div className=\"bg-white rounded-xl p-6 w-full max-w-md\">\n            <div className=\"flex justify-between items-center mb-4\">\n              <h3 className=\"text-xl font-bold text-purple-700\"> Schedule Job</h3>\n              <button onClick={() => { setShowScheduleQuoteJob(false); setQuoteToSchedule(null); }} className=\"text-gray-500 hover:text-gray-700\">\n                <Icons.X />\n              </button>\n            </div>\n\n            {/* Quote Info */}\n            <div className=\"bg-purple-50 p-4 rounded-lg mb-4\">\n              <div className=\"font-bold text-lg\">{quoteToSchedule.customerName}</div>\n              <div className=\"text-sm text-gray-600\">Quote #{quoteToSchedule.quoteNumber}</div>\n              <div className=\"text-xl font-bold text-purple-700 mt-2\">${quoteToSchedule.total.toFixed(2)}</div>\n              <div className=\"text-xs text-gray-500 mt-2\">\n                {quoteToSchedule.items.map(i => i.description).join(', ')}\n              </div>\n            </div>\n\n            {/* Date Picker */}\n            <div className=\"mb-4\">\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">Select Date for Job</label>\n              <input\n                type=\"date\"\n                value={quoteJobDate}\n                onChange={(e) => setQuoteJobDate(e.target.value)}\n                min={getLocalDateString()}\n                className=\"w-full px-4 py-3 border-2 border-purple-200 rounded-lg text-lg focus:border-purple-500 focus:outline-none\"\n              />\n              {quoteJobDate && (\n                <div className=\"mt-2 text-center text-purple-700 font-medium\">\n                  {(() => {\n                    const [y, m, d] = quoteJobDate.split('-').map(Number);\n                    return new Date(y, m - 1, d).toLocaleDateString('en-US', { \n                      weekday: 'long', \n                      month: 'long', \n                      day: 'numeric',\n                      year: 'numeric'\n                    });\n                  })()}\n                </div>\n              )}\n            </div>\n\n            {/* Quick Date Buttons */}\n            <div className=\"mb-4\">\n              <label className=\"block text-xs text-gray-500 mb-2\">Quick Select</label>\n              <div className=\"grid grid-cols-4 gap-2\">\n                <button\n                  onClick={() => setQuoteJobDate(getLocalDateString())}\n                  className={`py-2 px-3 rounded-lg text-sm font-medium ${\n                    quoteJobDate === getLocalDateString() \n                      ? 'bg-purple-600 text-white' \n                      : 'bg-gray-100 hover:bg-gray-200'\n                  }`}\n                >\n                  Today\n                </button>\n                <button\n                  onClick={() => {\n                    const tomorrow = new Date();\n                    tomorrow.setDate(tomorrow.getDate() + 1);\n                    setQuoteJobDate(getLocalDateString(tomorrow));\n                  }}\n                  className={`py-2 px-3 rounded-lg text-sm font-medium ${\n                    (() => {\n                      const tomorrow = new Date();\n                      tomorrow.setDate(tomorrow.getDate() + 1);\n                      return quoteJobDate === getLocalDateString(tomorrow);\n                    })() \n                      ? 'bg-purple-600 text-white' \n                      : 'bg-gray-100 hover:bg-gray-200'\n                  }`}\n                >\n                  Tomorrow\n                </button>\n                <button\n                  onClick={() => {\n                    const nextWeek = new Date();\n                    nextWeek.setDate(nextWeek.getDate() + 7);\n                    setQuoteJobDate(getLocalDateString(nextWeek));\n                  }}\n                  className=\"py-2 px-3 rounded-lg text-sm font-medium bg-gray-100 hover:bg-gray-200\"\n                >\n                  +1 Week\n                </button>\n                <button\n                  onClick={() => {\n                    const nextMonth = new Date();\n                    nextMonth.setDate(nextMonth.getDate() + 30);\n                    setQuoteJobDate(getLocalDateString(nextMonth));\n                  }}\n                  className=\"py-2 px-3 rounded-lg text-sm font-medium bg-gray-100 hover:bg-gray-200\"\n                >\n                  +1 Month\n                </button>\n              </div>\n            </div>\n\n            {/* Action Buttons */}\n            <div className=\"flex gap-3\">\n              <button\n                onClick={() => { setShowScheduleQuoteJob(false); setQuoteToSchedule(null); }}\n                className=\"flex-1 py-3 border-2 border-gray-300 text-gray-700 rounded-lg font-medium hover:bg-gray-50\"\n              >\n                Cancel\n              </button>\n              <button\n                onClick={confirmQuoteToJob}\n                disabled={!quoteJobDate}\n                className=\"flex-1 py-3 bg-purple-600 text-white rounded-lg font-medium hover:bg-purple-700 disabled:bg-gray-300\"\n              >\n                 Schedule Job\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Global Complete Job Modal - shows on any tab */}\n      {showCompleteJobModal && jobToComplete && (\n        <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\">\n          <div className=\"bg-white rounded-xl p-6 w-full max-w-lg max-h-[90vh] overflow-y-auto\">\n            <div className=\"flex justify-between items-center mb-4\">\n              <h3 className=\"text-xl font-bold text-green-700\"> Complete Job</h3>\n              <button onClick={() => { setShowCompleteJobModal(false); setJobToComplete(null); setJobCompletionItems([]); setJobChemicals([]); }} className=\"text-gray-500 hover:text-gray-700\">\n                <Icons.X />\n              </button>\n            </div>\n\n            {/* Job Info */}\n            <div className=\"bg-gray-50 p-4 rounded-lg mb-4\">\n              <div className=\"font-bold text-lg\">{jobToComplete.customerName}</div>\n              <div className=\"text-sm text-gray-600 capitalize\">{jobToComplete.jobType?.replace('-', ' ') || 'Service'}</div>\n              {jobToComplete.notes && <div className=\"text-sm text-gray-500 mt-1\">{jobToComplete.notes}</div>}\n            </div>\n\n            {/* Base Price */}\n            <div className=\"flex justify-between items-center p-3 bg-purple-50 rounded-lg mb-4\">\n              <span className=\"font-medium\">Job Price:</span>\n              <span className=\"text-xl font-bold text-purple-700\">${jobToComplete.price?.toFixed(2) || '0.00'}</span>\n            </div>\n\n            {/* Add Wear Items */}\n            {wearItems.length > 0 && (\n              <div className=\"mb-4\">\n                <h4 className=\"font-bold text-gray-700 mb-2\">Quick Add Wear Items</h4>\n                <div className=\"flex flex-wrap gap-2\">\n                  {wearItems.map(item => (\n                    <button\n                      key={item.id}\n                      onClick={() => addWearItemToJob(item)}\n                      className=\"px-3 py-1.5 bg-gray-100 hover:bg-gray-200 rounded-lg text-sm flex items-center gap-1\"\n                    >\n                      <span>{item.name}</span>\n                      <span className=\"text-green-600 font-medium\">${item.price.toFixed(2)}</span>\n                    </button>\n                  ))}\n                </div>\n              </div>\n            )}\n\n            {/* Add Custom Item */}\n            <div className=\"mb-4 bg-gray-50 p-3 rounded-lg\">\n              <h4 className=\"font-medium text-gray-700 mb-2\">Add Custom Item</h4>\n              <div className=\"flex gap-2\">\n                <input\n                  type=\"text\"\n                  placeholder=\"Item name\"\n                  className=\"flex-1 px-3 py-2 border rounded-lg text-sm\"\n                  id=\"globalCustomJobItemName\"\n                />\n                <input\n                  type=\"number\"\n                  step=\"0.01\"\n                  placeholder=\"Price\"\n                  className=\"w-24 px-3 py-2 border rounded-lg text-sm\"\n                  id=\"globalCustomJobItemPrice\"\n                />\n                <button\n                  onClick={() => {\n                    const name = document.getElementById('globalCustomJobItemName').value;\n                    const price = parseFloat(document.getElementById('globalCustomJobItemPrice').value) || 0;\n                    if (name && price > 0) {\n                      addCustomItemToJob(name, price);\n                      document.getElementById('globalCustomJobItemName').value = '';\n                      document.getElementById('globalCustomJobItemPrice').value = '';\n                    }\n                  }}\n                  className=\"px-3 py-2 bg-purple-600 text-white rounded-lg text-sm hover:bg-purple-700\"\n                >\n                  Add\n                </button>\n              </div>\n            </div>\n\n            {/* Add Chemicals */}\n            <div className=\"mb-4\">\n              <h4 className=\"font-bold text-gray-700 mb-2\">Add Chemicals Used</h4>\n              {chemicalInventory.length > 0 ? (\n                <div className=\"space-y-2\">\n                  {chemicalInventory.map(chem => (\n                    <div key={chem.id} className=\"flex items-center gap-3 p-3 bg-teal-50 rounded-lg\">\n                      <div className=\"flex-1\">\n                        <div className=\"font-medium text-gray-800\">{chem.name}</div>\n                        <div className=\"text-xs text-gray-500\">\n                          ${chem.costPerUnit.toFixed(2)}/{chem.unit}  {chem.quantity} {chem.unit} in stock\n                        </div>\n                      </div>\n                      <input\n                        type=\"number\"\n                        min=\"0\"\n                        max={chem.quantity}\n                        step=\"0.1\"\n                        placeholder=\"Qty\"\n                        className=\"w-20 px-2 py-1 border rounded text-center\"\n                        id={`global-job-chem-qty-${chem.id}`}\n                      />\n                      <button\n                        onClick={() => {\n                          const input = document.getElementById(`global-job-chem-qty-${chem.id}`);\n                          const qty = parseFloat(input.value) || 0;\n                          if (qty > 0 && qty <= chem.quantity) {\n                            addChemicalToJob(chem, qty);\n                            input.value = '';\n                          }\n                        }}\n                        className=\"px-3 py-1 bg-teal-600 text-white rounded hover:bg-teal-700 text-sm\"\n                      >\n                        Add\n                      </button>\n                    </div>\n                  ))}\n                </div>\n              ) : (\n                <p className=\"text-gray-500 text-sm p-3 bg-gray-50 rounded-lg\">\n                  No chemicals in inventory. Add chemicals in the Chemicals tab.\n                </p>\n              )}\n            </div>\n\n            {/* Chemicals Added */}\n            {jobChemicals.length > 0 && (\n              <div className=\"mb-4\">\n                <h4 className=\"font-bold text-gray-700 mb-2\">Chemicals for This Job</h4>\n                <div className=\"border rounded-lg overflow-hidden\">\n                  <table className=\"w-full\">\n                    <thead className=\"bg-teal-50\">\n                      <tr>\n                        <th className=\"px-3 py-2 text-left text-sm\">Chemical</th>\n                        <th className=\"px-3 py-2 text-left text-sm\">Qty</th>\n                        <th className=\"px-3 py-2 text-left text-sm\">Cost</th>\n                        <th className=\"px-3 py-2\"></th>\n                      </tr>\n                    </thead>\n                    <tbody>\n                      {jobChemicals.map(chem => (\n                        <tr key={chem.id} className=\"border-t\">\n                          <td className=\"px-3 py-2 text-sm\">{chem.name}</td>\n                          <td className=\"px-3 py-2 text-sm\">{chem.quantityUsed} {chem.unit}</td>\n                          <td className=\"px-3 py-2 text-sm font-medium\">${(chem.quantityUsed * chem.costPerUnit).toFixed(2)}</td>\n                          <td className=\"px-3 py-2\">\n                            <button \n                              onClick={() => removeChemicalFromJob(chem.id)}\n                              className=\"text-red-500 hover:text-red-700\"\n                            >\n                              <Icons.X />\n                            </button>\n                          </td>\n                        </tr>\n                      ))}\n                      <tr className=\"border-t bg-teal-50\">\n                        <td colSpan=\"2\" className=\"px-3 py-2 font-bold text-right\">Chemical Total:</td>\n                        <td colSpan=\"2\" className=\"px-3 py-2 font-bold text-teal-700\">\n                          ${jobChemicals.reduce((sum, c) => sum + (c.quantityUsed * c.costPerUnit), 0).toFixed(2)}\n                        </td>\n                      </tr>\n                    </tbody>\n                  </table>\n                </div>\n              </div>\n            )}\n\n            {/* Items Added */}\n            {jobCompletionItems.length > 0 && (\n              <div className=\"mb-4\">\n                <h4 className=\"font-bold text-gray-700 mb-2\">Additional Items</h4>\n                <div className=\"border rounded-lg overflow-hidden\">\n                  <table className=\"w-full\">\n                    <thead className=\"bg-purple-50\">\n                      <tr>\n                        <th className=\"px-3 py-2 text-left text-sm\">Item</th>\n                        <th className=\"px-3 py-2 text-left text-sm\">Qty</th>\n                        <th className=\"px-3 py-2 text-left text-sm\">Total</th>\n                        <th className=\"px-3 py-2\"></th>\n                      </tr>\n                    </thead>\n                    <tbody>\n                      {jobCompletionItems.map(item => (\n                        <tr key={item.id} className=\"border-t\">\n                          <td className=\"px-3 py-2 text-sm\">{item.name}</td>\n                          <td className=\"px-3 py-2 text-sm\">\n                            <div className=\"flex items-center gap-1\">\n                              <button \n                                onClick={() => {\n                                  if (item.quantity > 1) {\n                                    setJobCompletionItems(jobCompletionItems.map(i => \n                                      i.id === item.id ? { ...i, quantity: i.quantity - 1 } : i\n                                    ));\n                                  }\n                                }}\n                                className=\"w-6 h-6 bg-gray-200 rounded text-sm hover:bg-gray-300\"\n                              >-</button>\n                              <span className=\"w-6 text-center\">{item.quantity}</span>\n                              <button \n                                onClick={() => {\n                                  setJobCompletionItems(jobCompletionItems.map(i => \n                                    i.id === item.id ? { ...i, quantity: i.quantity + 1 } : i\n                                  ));\n                                }}\n                                className=\"w-6 h-6 bg-gray-200 rounded text-sm hover:bg-gray-300\"\n                              >+</button>\n                            </div>\n                          </td>\n                          <td className=\"px-3 py-2 text-sm font-medium\">${(item.price * item.quantity).toFixed(2)}</td>\n                          <td className=\"px-3 py-2\">\n                            <button onClick={() => removeItemFromJob(item.id)} className=\"text-red-500 hover:text-red-700\">\n                              <Icons.X />\n                            </button>\n                          </td>\n                        </tr>\n                      ))}\n                      <tr className=\"border-t bg-purple-50\">\n                        <td colSpan=\"2\" className=\"px-3 py-2 font-bold text-right\">Items Total:</td>\n                        <td colSpan=\"2\" className=\"px-3 py-2 font-bold text-purple-700\">\n                          ${jobCompletionItems.reduce((sum, i) => sum + (i.price * i.quantity), 0).toFixed(2)}\n                        </td>\n                      </tr>\n                    </tbody>\n                  </table>\n                </div>\n              </div>\n            )}\n\n            {/* Grand Total */}\n            <div className=\"bg-green-50 p-4 rounded-lg mb-4 border-2 border-green-200\">\n              <div className=\"flex justify-between items-center\">\n                <div>\n                  <div className=\"text-sm text-gray-600\">Job Price</div>\n                  <div className=\"text-sm text-gray-600\">Additional Items</div>\n                  <div className=\"text-sm text-gray-600\">Chemicals</div>\n                  <div className=\"font-bold text-lg mt-1\">Grand Total</div>\n                </div>\n                <div className=\"text-right\">\n                  <div className=\"text-sm\">${jobToComplete.price?.toFixed(2) || '0.00'}</div>\n                  <div className=\"text-sm\">${jobCompletionItems.reduce((sum, i) => sum + (i.price * i.quantity), 0).toFixed(2)}</div>\n                  <div className=\"text-sm\">${jobChemicals.reduce((sum, c) => sum + (c.quantityUsed * c.costPerUnit), 0).toFixed(2)}</div>\n                  <div className=\"font-bold text-xl text-green-700\">\n                    ${((jobToComplete.price || 0) + jobCompletionItems.reduce((sum, i) => sum + (i.price * i.quantity), 0) + jobChemicals.reduce((sum, c) => sum + (c.quantityUsed * c.costPerUnit), 0)).toFixed(2)}\n                  </div>\n                </div>\n              </div>\n            </div>\n\n            {/* Technician Notes */}\n            <div className=\"mb-4\">\n              <h4 className=\"font-bold text-gray-700 mb-2\"> Technician Notes (sent to customer)</h4>\n              <textarea\n                value={jobCompletionNotes}\n                onChange={e => setJobCompletionNotes(e.target.value)}\n                placeholder=\"Any notes for the customer about the work performed, issues found, recommendations...\"\n                className=\"w-full px-3 py-2 border rounded-lg text-sm\"\n                rows=\"3\"\n              />\n            </div>\n\n            {/* Send Email Checkbox */}\n            {(() => {\n              const customer = customers.find(c => c.id === parseInt(jobToComplete.customerId));\n              return customer?.email ? (\n                <div className=\"mb-4 p-3 bg-green-50 rounded-lg\">\n                  <label className=\"flex items-center gap-3 cursor-pointer\">\n                    <input\n                      type=\"checkbox\"\n                      checked={sendJobEmailOnComplete}\n                      onChange={e => setSendJobEmailOnComplete(e.target.checked)}\n                      className=\"w-5 h-5 text-green-600 rounded\"\n                    />\n                    <div>\n                      <span className=\"font-medium text-green-800\"> Send job completion email</span>\n                      <div className=\"text-xs text-green-600\">Will send to: {customer.email}</div>\n                    </div>\n                  </label>\n                </div>\n              ) : (\n                <div className=\"mb-4 p-3 bg-amber-50 rounded-lg text-sm text-amber-700\">\n                   No email on file for this customer. Add their email in the Customers tab to enable job completion emails.\n                </div>\n              );\n            })()}\n\n            {/* Action Buttons */}\n            <div className=\"flex gap-3\">\n              <button\n                onClick={() => { setShowCompleteJobModal(false); setJobToComplete(null); setJobCompletionItems([]); setJobChemicals([]); setJobCompletionNotes(''); }}\n                className=\"flex-1 py-3 border-2 border-gray-300 text-gray-700 rounded-lg font-medium hover:bg-gray-50\"\n              >\n                Cancel\n              </button>\n              <button\n                onClick={completeJobWithItems}\n                disabled={isSendingEmail}\n                className=\"flex-1 py-3 bg-green-600 text-white rounded-lg font-medium hover:bg-green-700 disabled:bg-green-400\"\n              >\n                {isSendingEmail ? ' Sending...' : ' Complete Job'}\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Payment Method Modal */}\n      {showPaymentMethodModal && paymentToMark && (\n        <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\">\n          <div className=\"bg-white rounded-xl p-6 w-full max-w-md\">\n            <div className=\"flex justify-between items-center mb-4\">\n              <h3 className=\"text-xl font-bold\">Mark Payment Received</h3>\n              <button onClick={() => setShowPaymentMethodModal(false)} className=\"text-gray-500 hover:text-gray-700\">\n                <Icons.X />\n              </button>\n            </div>\n            \n            <div className=\"mb-4 p-3 bg-gray-50 rounded-lg\">\n              <div className=\"font-medium\">{paymentToMark.customerName}</div>\n              <div className=\"text-lg font-bold text-green-600\">${paymentToMark.amount.toFixed(2)}</div>\n            </div>\n            \n            <div className=\"mb-4\">\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">Payment Method</label>\n              <div className=\"grid grid-cols-3 gap-2\">\n                {['cash', 'check', 'electronic'].map(method => (\n                  <button\n                    key={method}\n                    onClick={() => setPaymentMethod({ ...paymentMethod, method })}\n                    className={`py-2 px-3 rounded-lg border-2 capitalize ${\n                      paymentMethod.method === method \n                        ? 'border-blue-500 bg-blue-50 text-blue-700' \n                        : 'border-gray-200 hover:border-gray-300'\n                    }`}\n                  >\n                    {method === 'electronic' ? ' Card' : method === 'check' ? ' Check' : ' Cash'}\n                  </button>\n                ))}\n              </div>\n            </div>\n            \n            {paymentMethod.method === 'check' && (\n              <div className=\"mb-4\">\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">Check Number</label>\n                <input\n                  type=\"text\"\n                  value={paymentMethod.checkNumber}\n                  onChange={e => setPaymentMethod({ ...paymentMethod, checkNumber: e.target.value })}\n                  placeholder=\"Enter check number\"\n                  className=\"w-full px-4 py-2 border rounded-lg\"\n                />\n              </div>\n            )}\n            \n            {paymentMethod.method === 'electronic' && (\n              <div className=\"mb-4\">\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">Payment Source</label>\n                <input\n                  type=\"text\"\n                  value={paymentMethod.source}\n                  onChange={e => setPaymentMethod({ ...paymentMethod, source: e.target.value })}\n                  placeholder=\"e.g., Stripe, Venmo, Zelle, Credit Card\"\n                  className=\"w-full px-4 py-2 border rounded-lg\"\n                />\n              </div>\n            )}\n            \n            <div className=\"flex gap-3\">\n              <button\n                onClick={() => setShowPaymentMethodModal(false)}\n                className=\"flex-1 py-2 border-2 border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50\"\n              >\n                Cancel\n              </button>\n              <button\n                onClick={() => {\n                  const newPaidInvoices = {\n                    ...paidInvoices,\n                    [paymentToMark.invoiceKey]: {\n                      paid: true,\n                      method: paymentMethod.method,\n                      checkNumber: paymentMethod.checkNumber,\n                      source: paymentMethod.source,\n                      paidDate: new Date().toISOString(),\n                      amount: paymentToMark.amount\n                    }\n                  };\n                  savePaidInvoices(newPaidInvoices);\n                  setShowPaymentMethodModal(false);\n                  showEmailNotification('success', `Payment marked as received from ${paymentToMark.customerName}`);\n                }}\n                className=\"flex-1 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700\"\n              >\n                 Confirm Payment\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n      \n      {/* Version Footer */}\n      <div className=\"fixed bottom-2 right-2 text-xs text-gray-400 bg-white/80 px-2 py-1 rounded\">\n        v2.4.0\n      </div>\n    </div>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}